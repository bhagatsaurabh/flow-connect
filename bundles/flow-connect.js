!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var s in i)("object"==typeof exports?exports:t)[s]=i[s]}}(self,(function(){return(()=>{"use strict";var t,e={712:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalEventType=e.Align=e.LOD=e.ViewPort=void 0,function(t){t.INSIDE="INSIDE",t.OUTSIDE="OUTSIDE",t.INTERSECT="INTERSECT"}(e.ViewPort||(e.ViewPort={})),function(t){t[t.LOD0=0]="LOD0",t[t.LOD1=1]="LOD1",t[t.LOD2=2]="LOD2"}(e.LOD||(e.LOD={})),function(t){t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right"}(e.Align||(e.Align={})),function(t){t[t.Emitter=0]="Emitter",t[t.Receiver=1]="Receiver"}(e.GlobalEventType||(e.GlobalEventType={}))},20:function(t,e,i){var s=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var o=Object.getOwnPropertyDescriptor(e,i);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,o)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),o=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||s(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),o(i(712),e),o(i(5013),e)},5013:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0})},1278:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Color=void 0;const s=i(974),o=i(6645);class n{constructor(t){this.rgbaValue=t,this.hexValue=n.rgbaToHex(this.rgbaValue),this.rgbaString=n.rgbaToString(this.rgbaValue),this.rgbaCSSString=n.rgbaToCSSString(this.rgbaValue)}isEqual(t){return t.rgbaValue[0]===this.rgbaValue[0]&&t.rgbaValue[1]===this.rgbaValue[1]&&t.rgbaValue[2]===this.rgbaValue[2]&&t.rgbaValue[3]===this.rgbaValue[3]}static Random(){return new n(new Uint8ClampedArray([Math.floor((0,s.getRandom)(0,255)),Math.floor((0,s.getRandom)(0,255)),Math.floor((0,s.getRandom)(0,255)),255]))}static hexToRGBA(t){return new Uint8ClampedArray([parseInt(t.slice(1,3),16),parseInt(t.slice(3,5),16),parseInt(t.slice(5,7),16),parseInt(t.slice(7,9),16)])}static _componentToHex(t){let e=t.toString(16);return 1===e.length?"0"+e:e}static rgbaToHex(t){return"#"+n._componentToHex(t[0])+n._componentToHex(t[1])+n._componentToHex(t[2])+n._componentToHex(t[3])}static rgbaToString(t){return`${t[0]}:${t[1]}:${t[2]}:${t[3]}`}static rgbaToCSSString(t){return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${(0,s.normalize)(t[3],0,255).toFixed(3)})`}static scale(t){if(!Array.isArray(t))return void o.Log.error("An array is expected to create a color scale");if(t.length<=1)return void o.Log.error("At least two colors are required to create a color scale");let e=[];return t[0]instanceof Uint8ClampedArray||Array.isArray(t[0])&&"number"==typeof t[0][0]?t.forEach((t=>e.push(new n(t)))):"string"==typeof t[0]?t.forEach((t=>e.push(new n(n.hexToRGBA(t))))):e=t,t=>{t=(0,s.clamp)(t,0,1);let i=(e.length-1)*t,o=Math.floor(i),n=Math.ceil(i);t=i-o;let h=e[o],r=e[n];return"rgba("+h.rgbaValue.map(((e,i)=>(e=(0,s.lerp)(e,r.rgbaValue[i],t),i<3&&(e=Math.round(e)),e)))+")"}}serialize(){return{rgba:[this.rgbaValue[0],this.rgbaValue[1],this.rgbaValue[2],this.rgbaValue[3]]}}static deSerialize(t){return new n(t.rgba)}}e.Color=n},4907:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Connector=void 0;const s=i(7892),o=i(974),n=i(6894),h=i(7900),r=i(7055),l=i(7417);class a extends l.Hooks{constructor(t,e,i,s=d()){super(),this.flow=t,this.renderResolver=()=>null,this.style=s.style?{...u(),...s.style}:u(),this.id=(0,o.get)(s.id,(0,o.getNewUUID)()),this.floatingTip=s.floatingTip,this.start=e,this.end=i,this.start&&(this.startNode=this.start.node),this.end&&(this.endNode=this.end.node),e&&i&&(this.floatingTip=null,this.start.connectors.push(this),this.end.connectors.length>0?(this.end.connectors[0].removeConnection(),this.end.connectors[0]=this):this.end.connectors.push(this),s.isDeserialization||this.flow.executionGraph.connect(this.startNode,this.endNode),this.start.onConnect(this),this.end.onConnect(this))}get data(){return this._data}set data(t){this._data=t,this.end&&this.end.call("data",this.end,t),this.flow.state!==n.FlowState.Stopped&&this.flow.executionGraph.setDirty(this.endNode)}completeConnection(t){this.start?(this.end=t,this.endNode=this.end.node):(this.start=t,this.startNode=this.start.node),this.start.connectors.includes(this)||this.start.connectors.push(this),this.end.connectors[0]=this,this.floatingTip=null,this.startNode.currHitTerminal&&this.startNode.currHitTerminal.onExit(null,null),this.startNode.currHitTerminal=null,this.endNode.currHitTerminal&&this.endNode.currHitTerminal.onExit(null,null),this.endNode.currHitTerminal=null,this.flow.executionGraph.connect(this.startNode,this.endNode),this.start.onConnect(this),this.end.onConnect(this)}removeConnection(){this.start&&(this.start.connectors.includes(this)&&this.start.connectors.splice(this.start.connectors.indexOf(this),1),this.startNode.currHitTerminal&&(this.startNode.currHitTerminal.onExit(null,null),this.startNode.currHitTerminal=null)),this.end&&(this.end.connectors.includes(this)&&this.end.connectors.splice(this.end.connectors.indexOf(this),1),this.endNode.currHitTerminal&&(this.endNode.currHitTerminal.onExit(null,null),this.endNode.currHitTerminal=null)),this.flow.removeConnector(this.id)}setData(t){this._data=t,this.end&&this.end.call("data",this.end,t)}canConnect(t){let e,i,s=this.start?this.start:this.end;return s.type===h.TerminalType.IN?(e=t,i=s):(e=s,i=t),!!i&&(e!==i&&(e.node!==i.node&&(e.type!==i.type&&(!!this.flow.rules[e.dataType].includes(i.dataType)&&!!this.flow.executionGraph.canConnect(e.node,i.node)))))}render(){let t=this.flow.flowConnect.context;t.save();let e=this.flow.renderResolver.connector,i=this.flow.flowConnect.renderResolver.connector;(this.renderResolver&&this.renderResolver(this)||e&&e(this)||i&&i(this)||this._render)(t,this.getRenderParams(),this),t.restore();let s=this.flow.flowConnect.offContext;s.save(),this._offRender(),s.restore(),this.call("render",this)}_render(t,e,i){let o=e.start.x,n=e.start.y,h=e.end.x,r=e.end.y,l=s.Vector2.Distance(o,n,h,r);l*=.2;let[a,u]=[o+l,n],[d,p]=[h-l,r],[c,f]=[(a+d)/2,(u+p)/2];i.style.border&&(t.strokeStyle=i.style.borderColor,t.lineWidth=i.style.width+2,t.beginPath(),t.moveTo(o,n),t.quadraticCurveTo(a,u,c,f),t.moveTo(c,f),t.quadraticCurveTo(d,p,h,r),t.stroke()),t.strokeStyle=i.style.color,t.lineWidth=i.style.width,t.beginPath(),t.moveTo(o,n),t.quadraticCurveTo(a,u,c,f),t.moveTo(c,f),t.quadraticCurveTo(d,p,h,r),t.stroke()}_offRender(){}getRenderParams(){let t,e;return this.start?this.startNode.renderState.nodeState===r.NodeState.MAXIMIZED?t=this.start.position.serialize():(t=this.startNode.position.serialize(),t.x+=this.startNode.width+this.startNode.style.terminalStripMargin+this.start.style.radius,t.y+=this.startNode.style.titleHeight/2):t=this.floatingTip.serialize(),this.end?this.endNode.renderState.nodeState===r.NodeState.MAXIMIZED?e=this.end.position.serialize():(e=this.endNode.position.serialize(),e.x-=this.endNode.style.terminalStripMargin+this.end.style.radius,e.y+=this.endNode.style.titleHeight/2):e=this.floatingTip.serialize(),{start:t,end:e}}serialize(){return{id:this.id,startId:this.start.id,endId:this.end.id,startNodeId:this.startNode.id,endNodeId:this.endNode.id,style:this.style}}static deSerialize(t,e,i,s){return new a(t,e,i,{style:s.style,id:s.id,isDeserialization:!0})}}e.Connector=a;let u=()=>({width:5,color:"#7fff00aa",border:!0,borderColor:"grey"}),d=()=>({style:{},id:(0,o.getNewUUID)()})},6894:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FlowState=e.Flow=void 0;const s=i(7892),o=i(7055),n=i(7417),h=i(6166),r=i(4907),l=i(1141),a=i(587),u=i(8915),d=i(974),p=i(1571),c=i(6645);class f extends n.Hooks{constructor(t,e,i,s,o=(0,d.getNewUUID)()){super(),this.flowConnect=t,this.name=e,this.rules=i,this.terminalColors=s,this.id=o,this.globalEvents=new n.Hooks,this.parentFlow=null,this.listeners={},this.renderResolver={},this.nodes=new Map,this.groups=[],this.connectors=new Map,this.nodeHitColors=new Map,this.groupHitColors=new Map,this.sortedNodes=new l.AVLTree(((t,e)=>t.zIndex-e.zIndex),(t=>t.id)),this.inputs=[],this.outputs=[],this.executionGraph=new p.Graph,this.registerListeners(),this.flowConnect.on("tick",(()=>{this.state===g.Running&&this.call("tick",this)}))}get state(){return this.executionGraph.state}registerListeners(){let t=this.flowConnect.on("transform",(()=>this.call("transform",this)));this.listeners.transform=t}deregisterListeners(){this.flowConnect.off("transform",this.listeners.transform),delete this.listeners.transform}existsInFlow(t){for(let e of[...this.nodes.values()]){if(e.subFlow===t)return!0;if(e.subFlow)return e.subFlow.existsInFlow(t)}return!1}addInput(t,e,i){let s=new u.TunnelNode(this,"Input",i,100,[],[{name:t,dataType:e}]);return s.on("process",(()=>{s.outputs[0].setData(s.proxyTerminal.getData())})),this.inputs.push(s),this.nodes.set(s.id,s),this.sortedNodes.add(s),this.executionGraph.add(s),this.call("add-input",this,s),s}addOutput(t,e,i){let s=new u.TunnelNode(this,"Output",i,100,[{name:t,dataType:e}],[]);return this.outputs.push(s),this.nodes.set(s.id,s),this.sortedNodes.add(s),this.executionGraph.add(s),this.call("add-output",this,s),s}addSubFlow(t,e=s.Vector2.Zero()){if(t.parentFlow)return c.Log.error("Provided flow is already a sub-flow, a sub-flow cannot have multiple parent flows"),null;let i=new a.SubFlowNode(this,t,e,150,t.inputs.map((t=>({name:t.outputs[0].name,dataType:t.outputs[0].dataType}))),t.outputs.map((t=>({name:t.inputs[0].name,dataType:t.inputs[0].dataType}))),{name:t.name});return this.nodes.set(i.id,i),this.sortedNodes.add(i),this.executionGraph.add(i),t.parentFlow=this,i}createNode(t,e,i,s){let n=[],h=[];return void 0!==(s=s?{...y(),...s}:y()).inputs&&(n=s.inputs),void 0!==s.outputs&&(h=s.outputs),new o.Node(this,t,e,i,n,h,{style:s.style,terminalStyle:s.terminalStyle,state:s.state})}removeNode(t){}removeConnector(t){this.connectors.get(t)===this.flowConnect.floatingConnector&&(this.flowConnect.floatingConnector=null),this.connectors.delete(t)}removeAllFocus(){this.nodes.forEach((t=>t.focused=!1))}render(){this.groups.forEach((t=>t.render())),this.connectors.forEach((t=>t.render())),this.sortedNodes.forEach((t=>t.render())),this.call("render",this)}start(){this.state===g.Stopped&&(this.executionGraph.start(),this.call("start",this))}stop(){if(this.state!==g.Stopped){for(let t=this.executionGraph.nodes.length-1;t>=0;t-=1)this.executionGraph.nodes[t].filter((t=>t.flowNode instanceof a.SubFlowNode)).map((t=>t.flowNode)).forEach((t=>t.subFlow.stop()));this.executionGraph.stop(),this.call("stop",this)}}serialize(){return{id:this.id,name:this.name,rules:this.rules,terminalColors:this.terminalColors,nodes:[...this.nodes.values()].map((t=>t.serialize())),groups:this.groups.map((t=>t.serialize())),connectors:[...this.connectors.values()].map((t=>t.serialize())),inputs:this.inputs.map((t=>t.serialize())),outputs:this.outputs.map((t=>t.serialize())),executionGraph:this.executionGraph.serialize()}}static deSerialize(t,e){let i=new f(t,e.name,e.rules,e.terminalColors,e.id);return e.nodes.forEach((t=>{let e;e=t.subFlow?a.SubFlowNode.deSerialize(i,t):o.Node.deSerialize(i,t),i.nodes.set(e.id,e),i.sortedNodes.add(e)})),e.groups.forEach((t=>{let e=h.Group.deSerialize(i,t);i.groups.push(e),e.nodes.forEach((t=>t.group=e))})),e.inputs.forEach((t=>{let e=u.TunnelNode.deSerialize(i,t);i.inputs.push(e),i.nodes.set(e.id,e),i.sortedNodes.add(e)})),e.outputs.forEach((t=>{let e=u.TunnelNode.deSerialize(i,t);i.outputs.push(e),i.nodes.set(e.id,e),i.sortedNodes.add(e)})),e.connectors.forEach((t=>{let e=i.nodes.get(t.startNodeId),s=e.outputs.concat(e.outputsUI).find((e=>e.id===t.startId)),o=i.nodes.get(t.endNodeId),n=o.inputs.concat(o.inputsUI).find((e=>e.id===t.endId)),h=r.Connector.deSerialize(i,s,n,t);i.connectors.set(t.id,h)})),i.executionGraph=p.Graph.deSerialize(i,e.executionGraph),i}}var g;e.Flow=f,function(t){t.Running="Running",t.Idle="Idle",t.Stopped="Stopped"}(g=e.FlowState||(e.FlowState={}));let y=()=>({style:{},terminalStyle:{}})},1571:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GraphNode=e.Graph=void 0;const s=i(6645),o=i(974),n=i(6894),h=i(7055),r=i(8240);class l{constructor(){this.state=n.FlowState.Stopped,this.nodes=[],this.graphNodes=new Map,this.dirtyNodes=new Map}add(t){this.nodes[0]||this.nodes.push([]);let e=new a(t);this.nodes[0].push(e),this.graphNodes.set(t.id,e)}connect(t,e){let i=this.graphNodes.get(t.id),s=this.graphNodes.get(e.id);i.childs.includes(s)||(i.childs.push(s),s.order<=i.order&&this.updateOrder(s,i.order+1))}disconnect(t,e){let i=this.graphNodes.get(t.id),s=this.graphNodes.get(e.id),o=new Set;if(t.outputs.forEach((t=>t.connectors.forEach((t=>t.endNode&&o.add(t.endNode))))),o.has(e))return;i.childs.splice(i.childs.indexOf(s),1);let n=e.inputs.filter((t=>t.connectors.length>0)).map((t=>this.graphNodes.get(t.connectors[0].startNode.id).order)).reduce(((t,e)=>Math.max(t,e)),0);this.updateOrder(s,n)}updateOrder(t,e){this._updateOrder(t,e);let i=[];for(i.push(t);0!==i.length;){let t=i.shift();t.childs.forEach((e=>{e.order<=t.order&&this._updateOrder(e,t.order+1),i.includes(e)||i.push(e)}))}}_updateOrder(t,e){this.nodes[t.order].splice(this.nodes[t.order].indexOf(t),1),this.nodes[e]||(this.nodes[e]=[]),t.order=e,this.nodes[e].push(t)}canConnect(t,e){return!this.graphNodes.get(e.id).childs.includes(this.graphNodes.get(t.id))}async start(){if(this.state===n.FlowState.Stopped){if(this.state=n.FlowState.Running,this.nodes[0])try{for(await this.runAll(this.nodes[0]);0!==this.dirtyNodes.size;)await this.runAll(this.lowestDirty([...this.dirtyNodes.values()]))}catch(t){return s.Log.error("Error while executing graph",t),void(this.state=n.FlowState.Stopped)}}else if(this.state===n.FlowState.Idle){this.state=n.FlowState.Running;try{for(;0!==this.dirtyNodes.size;)await this.runAll(this.lowestDirty([...this.dirtyNodes.values()]))}catch(t){return s.Log.error("Error while executing graph",t),void(this.state=n.FlowState.Stopped)}}this.state=n.FlowState.Idle}stop(){this.state=n.FlowState.Stopped}async runAll(t){await Promise.all(t.map((t=>new Promise((e=>{t.flowNode.run(),this.clearDirty(t),e()})))))}setDirty(t){let e=t instanceof h.Node?this.graphNodes.get(t.id):t;e&&this.dirtyNodes.set(e.id,e)}clearDirty(t){let e=t instanceof h.Node?this.graphNodes.get(t.id):t;this.dirtyNodes.delete(e.id)}lowestDirty(t){let e=Math.min(...t.map((t=>t.order)));return t.filter((t=>t.order===e))}propagate(t,e){let i=t instanceof h.Node?this.graphNodes.get(t.id):t,s=new r.List;for(s.append(i);0!==s.length;){let t=s.removeFirst();e(t.flowNode),t.childs.forEach((t=>s.append(t)))}}debugNode(t,e){console.log(`${e}[${t.flowNode.name}, ${t.order}]`),t.childs.forEach((t=>this.debugNode(t,e+"  ")))}debugGraph(){this.nodes[0].forEach((t=>{this.debugNode(t,"")}))}serialize(){let t={};return this.graphNodes.forEach(((e,i)=>t[i]=this.graphNodes.get(i).id)),{nodes:this.nodes.map((t=>t.map((t=>t.serialize())))),nodeToGraphNode:t}}static deSerialize(t,e){let i=new l,s={},o={};return e.nodes.forEach(((e,n)=>{i.nodes[n]=e.map((e=>{let i=a.deSerialize(t.nodes.get(e.nodeId),e);return o[i.id]=i,s[i.id]=e,i}))})),Object.keys(o).forEach((t=>{o[t].childs=s[t].childs.map((t=>o[t]))})),Object.keys(e.nodeToGraphNode).forEach((t=>{i.graphNodes.set(t,o[e.nodeToGraphNode[t]])})),i}}e.Graph=l;class a{constructor(t,e,i){this.flowNode=t,this.childs=[],this.order=e||0,this.id=i||(0,o.getNewUUID)()}serialize(){return{id:this.id,nodeId:this.flowNode.id,order:this.order,childs:this.childs.map((t=>t.id))}}static deSerialize(t,e){return new a(t,e.order,e.id)}}e.GraphNode=a},6166:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Group=void 0;const s=i(7892),o=i(974),n=i(1278),h=i(7417),r=i(712);class l extends h.Hooks{constructor(t,e,i=d()){if(super(),this.flow=t,this.renderResolver=()=>null,this.nodes=[],this.nodeDeltas=[],this.renderState=r.ViewPort.INSIDE,this.width=(0,o.get)(i.width,0),this.height=(0,o.get)(i.height,0),this.style=(0,o.get)(i.style,{}),this.id=(0,o.get)(i.id,(0,o.getNewUUID)()),this.hitColor=i.hitColor,this.style={...u(),...i.style},this.id=(0,o.getNewUUID)(),this._position=e,!this.style.color||!this.style.borderColor){let t=a.Random();this.style.borderColor=t[0],this.style.color=t[1]}this.name=i.name,this.setHitColor(i.hitColor),this.computeTextMetrics(),this.flow.on("transform",(()=>this.updateRenderState()))}get name(){return this._name}set name(t){t&&""!==t.trim()?this._name=t:this._name="No Name",this.computeTextMetrics()}get position(){return this._position}set position(t){this._position=t,this.updateRenderState(),this.recomputeNodePositions()}setHitColor(t){if(!t)for(t=n.Color.Random();this.flow.groupHitColors.get(t.rgbaString);)t=n.Color.Random();this.hitColor=t,this.flow.groupHitColors.set(this.hitColor.rgbaString,this)}computeTextMetrics(){let t=this.flow.flowConnect.context;t.font=this.style.fontSize+" "+this.style.font;let e=t.measureText(this.name);if(this.textWidth=e.width,e=t.measureText("M"),t.font=null,this.textHeight=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent,void 0===this.textHeight){let t=document.createElement("span");t.textContent="M",t.style.font=this.style.fontSize+" "+this.style.font,document.body.appendChild(t),this.textHeight=t.offsetHeight,document.body.removeChild(t)}}updateRenderState(){let t=this.position.transform(this.flow.flowConnect.transform);this.renderState=(0,o.intersects)(0,0,this.flow.flowConnect.canvasDimensions.width,this.flow.flowConnect.canvasDimensions.height,t.x,t.y,t.x+this.width*this.flow.flowConnect.scale,t.y+this.height*this.flow.flowConnect.scale)}setContainedNodes(){let t=this.position.transform(this.flow.flowConnect.transform);this.nodes=[...this.flow.nodes.values()].filter((t=>!t.group&&t.renderState.viewport===r.ViewPort.INSIDE)).filter((e=>{let i=e.position.transform(this.flow.flowConnect.transform);return(0,o.intersects)(t.x,t.y,t.x+this.width*this.flow.flowConnect.scale,t.y+this.height*this.flow.flowConnect.scale,i.x,i.y,i.x+e.width*this.flow.flowConnect.scale,i.y+e.ui.height*this.flow.flowConnect.scale)===r.ViewPort.INSIDE})),this.nodes.forEach(((t,e)=>{t.group=this,this.nodeDeltas[e]=t.position.subtract(this.position)}))}recomputeNodePositions(){this.nodes.forEach(((t,e)=>{t.position=this.position.add(this.nodeDeltas[e])}))}render(){if(this.renderState===r.ViewPort.OUTSIDE)return;let t=this.flow.flowConnect.context;t.save();let e=this.flow.renderResolver.group,i=this.flow.flowConnect.renderResolver.group;(this.renderResolver&&this.renderResolver(this)||e&&e(this)||i&&i(this)||this._render)(t,this.getRenderParams(),this),t.restore(),this.flow.flowConnect.offGroupContext.save(),this._offRender(),this.flow.flowConnect.offGroupContext.restore(),this.call("render",this)}_render(t,e,i){t.strokeStyle=i.style.borderColor,t.lineWidth=2,t.fillStyle=i.style.color,t.strokeRect(e.position.x,e.position.y,e.width,e.height),t.fillRect(e.position.x,e.position.y,e.width,e.height),t.fillStyle=i.style.titleColor,t.textBaseline="bottom",t.font=i.style.fontSize+" "+i.style.font,t.fillText(i.name,e.position.x,e.position.y-10)}_offRender(){this.flow.flowConnect.offGroupContext.fillStyle=this.hitColor.rgbaCSSString,this.flow.flowConnect.offGroupContext.fillRect(this.position.x,this.position.y,this.width,this.height),this.flow.flowConnect.offGroupContext.fillRect(this.position.x,this.position.y-this.textHeight-10,this.textWidth,this.textHeight+10)}getRenderParams(){return{position:this.position.serialize(),width:this.width,height:this.height}}onClick(t,e){this.call("click",this,t,e);let i=this.position.transform(this.flow.flowConnect.transform);t.y<i.y&&this.flow.flowConnect.showGenericInput(i.subtract(0,(10+this.textHeight)*this.flow.flowConnect.scale),this.name,{width:Math.max(this.textWidth,50)*this.flow.flowConnect.scale+"px",height:this.textHeight*this.flow.flowConnect.scale+"px",fontSize:parseInt(this.style.fontSize.replace("px",""))*this.flow.flowConnect.scale+"px",fontFamily:this.style.font},{type:"text"},(t=>{this.name=t}))}serialize(){return{id:this.id,hitColor:this.hitColor.serialize(),position:this.position.serialize(),name:this.name,width:this.width,height:this.height,style:this.style,nodes:this.nodes.map((t=>t.id)),nodeDeltas:this.nodeDeltas.map((t=>t.serialize()))}}static deSerialize(t,e){let i=new l(t,s.Vector2.deSerialize(e.position),{width:e.width,height:e.height,name:e.name,style:e.style,id:e.id,hitColor:n.Color.deSerialize(e.hitColor)});return e.nodes.forEach((e=>{i.nodes.push(t.nodes.get(e))})),e.nodeDeltas.forEach((t=>{i.nodeDeltas.push(s.Vector2.deSerialize(t))})),i}}e.Group=l;let a={colors:[["rgba(239, 134, 119, 1)","rgba(239, 134, 119, .5)"],["rgba(160, 231, 125, 1)","rgba(160, 231, 125, .5)"],["rgba(130, 182, 217, 1)","rgba(130, 182, 217, .5)"]],RED:()=>a.colors[0],GREEN:()=>a.colors[1],BLUE:()=>a.colors[2],Random:()=>a.colors[Math.floor(Math.random()*a.colors.length)]},u=()=>({titleColor:"#000",fontSize:"16px",font:"arial"}),d=()=>({width:0,height:0,style:{},id:(0,o.getNewUUID)()})},7417:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Hooks=void 0;e.Hooks=class{constructor(){this.registeredEvents={},this.lastId=0}on(t,e){this.registeredEvents[t]||(this.registeredEvents[t]={});let i=this.lastId;return this.registeredEvents[t][i]=e,this.lastId+=1,i}call(t,...e){this.registeredEvents[t]&&(e||(e=[]),Object.values(this.registeredEvents[t]).forEach((t=>t(...e))))}off(t,e){this.registeredEvents[t]&&delete this.registeredEvents[t][e]}offAll(){this.registeredEvents={}}}},6676:function(t,e,i){var s=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var o=Object.getOwnPropertyDescriptor(e,i);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,o)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),o=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||s(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),o(i(1278),e),o(i(4907),e),o(i(6894),e),o(i(1571),e),o(i(6166),e),o(i(7417),e),o(i(7055),e),o(i(587),e),o(i(7900),e),o(i(8915),e),o(i(7892),e)},7055:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeButton=e.NodeState=e.Node=void 0;const s=i(7892),o=i(712),n=i(8637),h=i(974),r=i(1278),l=i(6894),a=i(7900),u=i(7417),d=i(6645);class p extends u.Hooks{constructor(t,e,i,s,r,l,a=g()){super(),this.flow=t,this.name=e,this.renderResolver={},this.stateObserver=new u.Hooks,this.renderState={viewport:o.ViewPort.INSIDE,nodeState:c.MAXIMIZED,lod:o.LOD.LOD2},this.focused=!1,this.inputs=[],this.outputs=[],this.inputsUI=[],this.outputsUI=[],this.group=null,this.style=(0,h.get)(a.style,{}),this.terminalStyle=(0,h.get)(a.terminalStyle,{}),this.id=(0,h.get)(a.id,(0,h.getNewUUID)()),a.state=(0,h.get)(a.state,{}),this.hitColor=a.hitColor,this._width=s,this.style={...f(),...a.style},this._position=i,this.setupState(a.state),this.uiNodes=new Map,this.terminals=new Map,this.nodeButtons=new Map,this._zIndex=0,this.setHitColor(a.hitColor),this.setupTerminals(a,r,l),a.ui?this.ui=a.ui instanceof n.Container?a.ui:n.Container.deSerialize(this,a.ui):this.ui=new n.Container(this,s),this.addNodeButton((()=>this.toggleNodeState()),this._renderNodeButton,o.Align.Left),this.reflow(),this.ui.update(),this.flow.on("transform",(()=>this.updateRenderState())),this.flow.nodes.set(this.id,this),this.flow.sortedNodes.add(this),this.flow.executionGraph.add(this)}get height(){return this.ui.height}get context(){return this.flow.flowConnect.context}get offContext(){return this.flow.flowConnect.offContext}get offUIContext(){return this.flow.flowConnect.offUIContext}get position(){return this._position}set position(t){this._position=t,this.reflow(),this.ui.update(),this.updateRenderState()}get zIndex(){return this._zIndex}set zIndex(t){this.flow.sortedNodes.remove(this)?(this._zIndex=t,this.flow.sortedNodes.add(this)):this._zIndex=t}get width(){return this._width}set width(t){this._width=t,this.ui.width=t,this.ui.update()}setupTerminals(t,e,i){this.inputs.push(...e.map((e=>new a.Terminal(this,a.TerminalType.IN,e.dataType,e.name,{style:e.style?e.style:{...t.terminalStyle},id:e.id?e.id:null,hitColor:e.hitColor?r.Color.deSerialize(e.hitColor):null})))),this.outputs.push(...i.map((e=>new a.Terminal(this,a.TerminalType.OUT,e.dataType,e.name,{style:e.style?e.style:{...t.terminalStyle},id:e.id?e.id:null,hitColor:e.hitColor?r.Color.deSerialize(e.hitColor):null}))))}setupState(t){this.state=new Proxy({},{set:(t,e,i)=>{let s=t[e];return t[e]=i,this.stateObserver.call(e,s,i),!0}}),Object.keys(t).forEach((e=>this.state[e]=t[e]))}watch(t,e){if(void 0!==this.state[t])return this.stateObserver.on(t,e);d.Log.error(`Cannot watch prop '${t}', prop not found`)}unwatch(t,e){void 0!==this.state[t]?this.stateObserver.off(t,e):d.Log.error(`Cannot unwatch prop '${t}', prop not found`)}setHitColor(t){if(!t)for(t=r.Color.Random();this.flow.nodeHitColors.get(t.rgbaString);)t=r.Color.Random();this.hitColor=t,this.flow.nodeHitColors.set(this.hitColor.rgbaString,this)}addNodeButton(t,e,i){let s,n=new y(this,t,e,i),h=[...this.nodeButtons.values()].filter((t=>t.align===n.align)).length-1;return s=i===o.Align.Left?h*(this.style.nodeButtonSize+this.style.nodeButtonSpacing):this.width-h*(this.style.nodeButtonSize+this.style.nodeButtonSpacing)-this.style.nodeButtonSize,n.deltaX=s,n}reflow(){let t=this.position.y+this.style.terminalRowHeight/2+this.style.padding/2+this.style.titleHeight;this.inputs.length>this.outputs.length?(this.recalculateInputTerminals(t),t=this.position.y+this.inputs.length*this.style.terminalRowHeight/2-this.outputs.length*this.style.terminalRowHeight/2+this.style.terminalRowHeight/2+this.style.padding/2+this.style.titleHeight,this.recalculateOutputTerminals(t)):(this.recalculateOutputTerminals(t),t=this.position.y+this.outputs.length*this.style.terminalRowHeight/2-this.inputs.length*this.style.terminalRowHeight/2+this.style.terminalRowHeight/2+this.style.padding/2+this.style.titleHeight,this.recalculateInputTerminals(t))}updateRenderState(){let t=this.position.transform(this.flow.flowConnect.transform);this.renderState.viewport=(0,h.intersects)(0,0,this.flow.flowConnect.canvasDimensions.width,this.flow.flowConnect.canvasDimensions.height,t.x,t.y,t.x+this.width*this.flow.flowConnect.scale,t.y+(this.renderState.nodeState===c.MAXIMIZED?this.ui.height:this.style.titleHeight)*this.flow.flowConnect.scale),this.flow.flowConnect.scale>.6?this.renderState.lod=o.LOD.LOD2:this.flow.flowConnect.scale<=.6&&this.flow.flowConnect.scale>.3?this.renderState.lod=o.LOD.LOD1:this.renderState.lod=o.LOD.LOD0,this.renderState.viewport===o.ViewPort.INTERSECT&&this.ui.updateRenderState()}recalculateInputTerminals(t){this.inputs.forEach((e=>{e.position.x=this.position.x-this.style.terminalStripMargin-e.style.radius,e.position.y=t,t+=this.style.terminalRowHeight}))}recalculateOutputTerminals(t){this.outputs.forEach((e=>{e.position.x=this.position.x+this.ui.width+this.style.terminalStripMargin+e.style.radius,e.position.y=t,t+=this.style.terminalRowHeight}))}getHitTerminal(t,e,i){let s=null;i=i.transform(this.flow.flowConnect.transform);let o=this.position.transform(this.flow.flowConnect.transform);return(this.inputs.length+this.inputsUI.length>0&&i.x<o.x||this.outputs.length+this.outputsUI.length>0&&i.x>o.x+this.ui.width*this.flow.flowConnect.scale)&&(s=this.terminals.get(t)),this.currHitTerminal&&this.currHitTerminal!==s&&(this.currHitTerminal.onExit(e,i),s&&s.onEnter(e,i)),s}getHitUINode(t){let e=this.uiNodes.get(t);return e instanceof n.Container?null:e}getHitNodeButton(t){return this.nodeButtons.get(t)}run(){this.flow.state!==l.FlowState.Stopped&&this.call("process",this,this.inputs.map((t=>t.connectors.length>0?t.connectors[0].data:null)))}render(){if(this.renderState.viewport===o.ViewPort.OUTSIDE)return;this.renderState.nodeState===c.MAXIMIZED&&this.ui.render();let t=this.context;t.save(),this.renderTerminals(t),this.renderName(t),this.renderFocused(t);let e=this.flow.renderResolver.node,i=this.flow.flowConnect.renderResolver.node;(this.renderResolver.node&&this.renderResolver.node(this)||e&&e(this)||i&&i(this)||this._render)(t,this.getRenderParams(),this),t.restore(),this.nodeButtons.forEach((t=>t.render())),this.offContext.save(),this._offRender(),this.offContext.restore(),this.call("render",this)}renderTerminals(t){if(this.renderState.nodeState===c.MAXIMIZED)this.renderState.lod>0&&(this.inputs.forEach((t=>t.render())),this.outputs.forEach((t=>t.render()))),t.fillStyle=this.style.color,t.font=this.style.fontSize+" "+this.style.font,t.textBaseline="middle",this.inputs.forEach((e=>{t.fillText(e.name,e.position.x+e.style.radius+this.style.terminalStripMargin+this.style.padding,e.position.y)})),this.outputs.forEach((e=>{t.fillText(e.name,e.position.x-e.style.radius-this.style.terminalStripMargin-this.style.padding-t.measureText(e.name).width,e.position.y)}));else{if(t.fillStyle=this.style.minimizedTerminalColor,this.inputs.length+this.inputsUI.length>0){let e=this.inputs.length>0?this.inputs[0].style.radius:this.inputsUI[0].style.radius;t.fillRect(this.position.x-this.style.terminalStripMargin-2*e,this.position.y+this.style.titleHeight/2-e,2*e,2*e)}if(this.outputs.length+this.outputsUI.length>0){let e=this.outputs.length>0?this.outputs[0].style.radius:this.outputsUI[0].style.radius;t.fillRect(this.position.x+this.width+this.style.terminalStripMargin,this.position.y+this.style.titleHeight/2-e,2*e,2*e)}}}renderName(t){t.fillStyle=this.style.titleColor,t.font=this.style.titleFontSize+" "+this.style.titleFont,t.textBaseline="middle",t.fillText(this.name,this.position.x+this.ui.width/2-t.measureText(this.name).width/2,this.position.y+this.style.titleHeight/2)}renderFocused(t){if(this.focused){let e,i;t.strokeStyle=this.style.outlineColor,t.lineWidth=2,e=0===this.inputs.length?0===this.inputsUI.length?0:2*this.inputsUI[0].style.radius:2*this.inputs[0].style.radius,e+=2*this.style.terminalStripMargin,i=0===this.outputs.length?0===this.outputsUI.length?0:2*this.outputsUI[0].style.radius:2*this.outputs[0].style.radius,i+=2*this.style.terminalStripMargin,t.strokeRoundRect(this.position.x-e,this.position.y,this.width+e+i,this.renderState.nodeState===c.MAXIMIZED?this.ui.height+this.style.padding:this.style.titleHeight,4)}}_render(){}_offRender(){this.offContext.fillStyle=this.hitColor.rgbaCSSString;let t=this.position.x,e=this.position.y,i=0,s=0;if(this.inputs.length+this.inputsUI.length!==0){let e=this.inputs.length>0?this.inputs[0].style.radius:this.inputsUI[0].style.radius;t-=this.style.terminalStripMargin+2*e,i=2*e+this.style.terminalStripMargin}if(this.outputs.length+this.outputsUI.length!==0){s=2*(this.outputs.length>0?this.outputs[0].style.radius:this.outputsUI[0].style.radius)+this.style.terminalStripMargin}this.offContext.fillRect(t,e,this.ui.width+i+s,this.renderState.nodeState===c.MAXIMIZED?this.ui.height:this.style.titleHeight)}_renderNodeButton(t,e,i){let s=i.node.style;t.fillStyle=s.maximizeButtonColor,t.fillRect(e.position.x,e.position.y,s.nodeButtonSize,s.nodeButtonSize)}getRenderParams(){return{position:this.position.serialize(),width:this.width,height:this.ui.height,focus:this.focused}}addTerminal(t){t instanceof a.Terminal||(t=a.Terminal.deSerialize(this,t)),t.type===a.TerminalType.IN?this.inputs.push(t):this.outputs.push(t),this.ui.update(),this.reflow()}removeTerminal(t){let e=t.type,i=e===a.TerminalType.IN?this.inputs.indexOf(t):this.outputs.indexOf(t);i<0?d.Log.error("Cannot remove terminal, terminal not found"):(t.disconnect(),e===a.TerminalType.IN?this.inputs.splice(i,1):this.outputs.splice(i,1),t.offAll(),this.ui.update(),this.reflow())}getInput(t){if("string"==typeof t){let e=this.inputs.find((e=>e.name===t));if(e)return e.getData()}else if(this.inputs[t])return this.inputs[t].getData();return null}getInputs(){return this.inputs.map((t=>t.getData()))}setOutputs(t,e){if("string"==typeof t){let i=this.outputs.find((e=>e.name===t));i&&i.setData(e)}else if("number"==typeof t)this.outputs[t]&&this.outputs[t].setData(e);else{let e=new Map;Object.entries(t).forEach((t=>{let i=this.outputs.find((e=>e.name===t[0]));if(!i)throw d.Log.error("Terminal '"+t[0]+"' not found");e.set(i,t[1])}));let i=new Map,s=e.keys(),o=s.next().value;for(;o;)o.connectors.forEach((t=>{i.has(t.endNode)?i.get(t.endNode).push(t):i.set(t.endNode,[t])})),o=s.next().value;let n=i.values(),h=n.next().value;for(;h;){for(let t=1;t<h.length;t++)h[t].setData(e.get(h[t].start));h[0].data=e.get(h[0].start),h=n.next().value}}this.flow.state===l.FlowState.Idle&&this.flow.executionGraph.start()}toggleNodeState(){this.renderState.nodeState=this.renderState.nodeState===c.MAXIMIZED?c.MINIMIZED:c.MAXIMIZED}dispose(){this.flow.removeNode(this.id)}onDown(t,e){this.call("down",this,t,e);let i=r.Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(t.x,t.y,1,1).data);this.currHitUINode=this.getHitUINode(i),this.currHitUINode&&this.currHitUINode.onDown(t,e);let s=this.getHitTerminal(i,t,e);s&&(this.currHitTerminal=s,this.currHitTerminal.onDown(t,e))}onOver(t,e){this.call("over",this,t,e);let i=r.Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(t.x,t.y,1,1).data),s=this.getHitTerminal(i,t,e);s!==this.prevHitTerminal?(this.prevHitTerminal&&this.prevHitTerminal.onExit(t,e),s&&s.onEnter(t,e)):s&&!this.currHitTerminal&&s.onOver(t,e),this.prevHitTerminal=s;let o=this.getHitUINode(i);o!==this.prevHitUINode?(this.prevHitUINode&&this.prevHitUINode.onExit(t,e),o&&o.onEnter(t,e)):o&&!this.currHitUINode&&o.onOver(t,e),this.prevHitUINode=o}onEnter(t,e){this.call("enter",this,t,e)}onExit(t,e){this.call("exit",this,t,e);let i=r.Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(t.x,t.y,1,1).data),s=this.getHitTerminal(i,t,e);s&&s.onExit(t,e),this.prevHitTerminal&&this.prevHitTerminal.onExit(t,e),this.prevHitTerminal=null,this.currHitTerminal&&this.currHitTerminal.onExit(t,e)}onUp(t,e){this.call("up",this,t,e);let i=r.Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(t.x,t.y,1,1).data);this.currHitUINode=null;let s=this.getHitUINode(i);s&&s.onUp(t.clone(),e.clone());let o=this.getHitTerminal(i,t,e);o&&o.onUp(t,e)}onClick(t,e){this.call("click",this,t,e);let i=r.Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(t.x,t.y,1,1).data);if(e.y<this.position.y+this.style.titleHeight*this.flow.flowConnect.scale){let t=this.getHitNodeButton(i);t&&t.callback()}else{this.currHitTerminal&&this.currHitTerminal.onClick(t,e);let s=this.getHitUINode(i);s&&s.onClick(t.clone(),e.clone())}}onDrag(t,e){this.call("drag",this,t,e);let i=r.Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(t.x,t.y,1,1).data),s=this.getHitUINode(i);this.currHitUINode&&this.currHitUINode.draggable&&(s===this.currHitUINode?this.currHitUINode.onDrag(t,e):(this.currHitUINode.onExit(t,e),this.currHitUINode=null,this.flow.flowConnect.currHitNode=null,this.flow.flowConnect.pointers=[]))}onContextMenu(){this.call("rightclick",this)}onWheel(t,e,i){this.call("wheel",this,t,e,i);let s=r.Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(e.x,e.y,1,1).data),o=this.getHitUINode(s);o&&o.zoomable&&o.onWheel(t,e,i)}createLabel(t,e){return new n.Label(this,t,e)}createImage(t,e){return new n.Image(this,t,e)}createSlider(t,e,i){return new n.Slider(this,t,e,i)}createSlider2D(t){return new n.Slider2D(this,t)}createVSlider(t,e,i){return new n.VSlider(this,t,e,i)}createDial(t,e,i,s){return new n.Dial(this,t,e,i,s)}createHozLayout(t=[],e){return new n.HorizontalLayout(this,t,e)}createStack(t){return new n.Stack(this,t)}createButton(t,e){return new n.Button(this,t,e)}createToggle(t){return new n.Toggle(this,t)}createRadioGroup(t,e,i){return new n.RadioGroup(this,t,e,i)}createSelect(t,e){return new n.Select(this,t,e)}createSource(t){return new n.Source(this,t)}createDisplay(t,e,i){return new n.Display(this,t,e,i)}createInput(t){return new n.Input(this,t)}createEnvelope(t,e,i){return new n.Envelope(this,t,e,i)}serialize(){return{id:this.id,name:this.name,position:this.position.serialize(),width:this.width,state:this.state,inputs:this.inputs.map((t=>t.serialize())),outputs:this.outputs.map((t=>t.serialize())),style:this.style,terminalStyle:this.terminalStyle,hitColor:this.hitColor.serialize(),zIndex:this.zIndex,focused:this.focused,renderState:this.renderState,ui:this.ui.serialize()}}static deSerialize(t,e){return new p(t,e.name,s.Vector2.deSerialize(e.position),e.width,e.inputs,e.outputs,{style:e.style,terminalStyle:e.terminalStyle,state:e.state,id:e.id,hitColor:r.Color.deSerialize(e.hitColor),ui:e.ui})}}var c;e.Node=p,function(t){t.MAXIMIZED="Maximized",t.MINIMIZED="Minimized"}(c=e.NodeState||(e.NodeState={}));let f=()=>({font:"arial",fontSize:".75rem",titleFont:"arial",titleFontSize:".85rem",color:"#000",titleColor:"#000",maximizeButtonColor:"darkgrey",nodeButtonSize:10,nodeButtonSpacing:5,expandButtonColor:"#000",minimizedTerminalColor:"green",outlineColor:"#000",padding:10,spacing:10,rowHeight:20,titleHeight:29,terminalRowHeight:24,terminalStripMargin:8}),g=()=>({style:{},terminalStyle:{},state:{},id:(0,h.getNewUUID)()});class y extends u.Hooks{constructor(t,e,i,s,o){super(),this.node=t,this.callback=e,this.align=s,this.renderResolver=()=>null,this.style={},this.deltaX=0,this.style=(0,h.get)(o,{}),this.setHitColor(),this.defaultRenderFn=i}setHitColor(){let t=r.Color.Random();for(;this.node.nodeButtons.get(t.rgbaString);)t=r.Color.Random();this.hitColor=t,this.node.nodeButtons.set(this.hitColor.rgbaString,this)}render(){this.node.context.save();let t=this.node.renderResolver.nodeButton,e=this.node.flow.renderResolver.nodeButton,i=this.node.flow.flowConnect.renderResolver.nodeButton;(this.renderResolver&&this.renderResolver(this)||t&&t(this)||e&&e(this)||i&&i(this)||this.defaultRenderFn)(this.node.context,this.getRenderParams(),this),this.node.context.restore(),this.node.offUIContext.save(),this._offUIRender(),this.node.offUIContext.restore(),this.call("render",this)}getRenderParams(){let t=this.node.position.serialize();return t.x+=this.deltaX,t.y+=this.node.style.titleHeight/2-this.node.style.nodeButtonSize/2,{position:t}}_offUIRender(){this.node.offUIContext.fillStyle=this.hitColor.rgbaCSSString,this.node.offUIContext.fillRect(this.node.position.x+this.deltaX,this.node.position.y+this.node.style.titleHeight/2-this.node.style.nodeButtonSize/2,this.node.style.nodeButtonSize,this.node.style.nodeButtonSize)}}e.NodeButton=y},587:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SubFlowNode=void 0;const s=i(7892),o=i(1278),n=i(6894),h=i(7055),r=i(7900),l=i(712);class a extends h.Node{constructor(t,e,i,s,o,n,h=u()){super(t,h.name||"New SubFlow",i,s,o||[],n||[],{style:h.style,terminalStyle:h.terminalStyle,state:h.state,id:h.id,hitColor:h.hitColor}),this.subFlow=e,this.subFlow.on("add-input",((t,e)=>{let i=new r.Terminal(this,r.TerminalType.IN,e.outputs[0].dataType,e.outputs[0].name);e.proxyTerminal=i,this.addTerminal(i)})),this.subFlow.on("add-output",((t,e)=>{let i=new r.Terminal(this,r.TerminalType.OUT,e.inputs[0].dataType,e.inputs[0].name);e.proxyTerminal=i,this.addTerminal(i)})),this.subFlow.inputs.forEach(((t,e)=>t.proxyTerminal=this.inputs[e])),this.subFlow.outputs.forEach(((t,e)=>t.proxyTerminal=this.outputs[e])),this.addNodeButton((()=>this.flow.flowConnect.render(this.subFlow)),((t,e,i)=>{let s=i.node.style;t.strokeStyle=s.expandButtonColor,t.beginPath(),t.moveTo(e.position.x,e.position.y+s.nodeButtonSize/2),t.lineTo(e.position.x,e.position.y+s.nodeButtonSize),t.lineTo(e.position.x+s.nodeButtonSize,e.position.y),t.lineTo(e.position.x+s.nodeButtonSize,e.position.y+s.nodeButtonSize/2),t.moveTo(e.position.x+s.nodeButtonSize,e.position.y),t.lineTo(e.position.x+s.nodeButtonSize/2,e.position.y),t.moveTo(e.position.x,e.position.y+s.nodeButtonSize),t.lineTo(e.position.x+s.nodeButtonSize/2,e.position.y+s.nodeButtonSize),t.closePath(),t.stroke()}),l.Align.Right)}run(){this.flow.state!==n.FlowState.Stopped&&this.subFlow.start()}serialize(){return{id:this.id,name:this.name,position:this.position.serialize(),width:this.width,state:this.state,inputs:this.inputs.map((t=>t.serialize())),outputs:this.outputs.map((t=>t.serialize())),style:this.style,terminalStyle:this.terminalStyle,hitColor:this.hitColor.serialize(),zIndex:this.zIndex,focused:this.focused,renderState:this.renderState,ui:this.ui.serialize(),subFlow:this.subFlow.serialize()}}static deSerialize(t,e){let i=n.Flow.deSerialize(t.flowConnect,e.subFlow);return new a(t,i,s.Vector2.deSerialize(e.position),e.width,e.inputs,e.outputs,{name:e.name,style:e.style,terminalStyle:e.terminalStyle,state:e.state,id:e.id,hitColor:o.Color.deSerialize(e.hitColor)})}}e.SubFlowNode=a;let u=()=>({style:{},terminalStyle:{},state:{}})},7900:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TerminalType=e.Terminal=void 0;const s=i(7892),o=i(974),n=i(1278),h=i(4907),r=i(7417),l=i(6645),a=i(3612);class u extends r.Hooks{constructor(t,e,i,n,h=c()){super(),this.node=t,this.type=e,this.dataType=i,this.name=n,this.options=h,this.renderResolver=()=>null,this.hitColor=h.hitColor,h.propName&&(this.propName=h.propName),this.style=h.style?{...p(),...h.style}:p(),this.id=(0,o.get)(h.id,(0,o.getNewUUID)()),this.setHitColor(this.hitColor),this.connectors=[],this.position=s.Vector2.Zero(),this.focus=!1,this.type===d.IN&&this.on("data",((t,e)=>{this.propName&&(this.node.state[this.propName]=e)}))}get propName(){return this._propName}set propName(t){if(!t||""===t)return void l.Log.error("Failed to set prop name '"+t+"', prop name is invalid");let e=this._propName,i=t;(0,o.exists)(this.watcherId)&&this.node.unwatch(e,this.watcherId),this._propName=i,this.watcherId=this.node.watch(i,((t,e)=>{this.type===d.OUT&&this.setData(e)}))}getData(){if(this.type!==d.OUT)return this.connectors.length>0?this.connectors[0].data:null;l.Log.error("Cannot call 'getData' on output terminal")}setData(t){this.type!==d.IN?this.connectors.forEach((e=>e.data=t)):l.Log.error("Cannot call 'setData' on input terminal")}setHitColor(t){if(!t)for(t=n.Color.Random();this.node.terminals.get(t.rgbaString)||this.node.uiNodes.get(t.rgbaString);)t=n.Color.Random();this.hitColor=t,this.node.terminals.set(this.hitColor.rgbaString,this)}render(){let t=this.node.context;t.save();let e=this.node.renderResolver.terminal,i=this.node.flow.renderResolver.terminal,s=this.node.flow.flowConnect.renderResolver.terminal;(this.renderResolver&&this.renderResolver(this)||e&&e(this)||i&&i(this)||s&&s(this)||this._render)(t,this.getRenderParams(),this),t.restore(),this.offUIRender(),this.call("render",this)}_render(t,e,i){e.focus&&(t.beginPath(),t.arc(e.position.x,e.position.y,3*i.style.radius,0,a.Constant.TAU),t.fillStyle=i.style.outerFocusColor,t.fill()),"event"===i.dataType?(t.beginPath(),t.moveTo(e.position.x,e.position.y-1.3*i.style.radius),t.lineTo(e.position.x+1.3*i.style.radius,e.position.y),t.lineTo(e.position.x,e.position.y+1.3*i.style.radius),t.lineTo(e.position.x-1.3*i.style.radius,e.position.y),t.lineTo(e.position.x,e.position.y-1.3*i.style.radius),t.closePath()):(t.beginPath(),t.arc(e.position.x,e.position.y,i.style.radius,0,a.Constant.TAU)),t.fillStyle=e.focus?i.style.focusColor:i.node.flow.terminalColors[i.dataType]||i.style.color,t.strokeStyle=i.style.borderColor,t.shadowBlur=i.style.shadowBlur,t.shadowColor=i.style.shadowColor,t.fill(),t.stroke()}getRenderParams(){return{focus:this.focus,position:this.position.serialize()}}connect(t,e){if(this.type!==t.type){let e=this.type===d.OUT?this:t,i=this.type===d.IN?this:t;if(i.connectors.length>0&&e.connectors.includes(i.connectors[0]))return!1}if((0,o.canConnect)(this,t,this.node.flow.rules,this.node.flow.executionGraph)){let i=new h.Connector(this.node.flow,this.type===d.OUT?this:t,this.type===d.IN?this:t,{style:e});return this.node.flow.connectors.set(i.id,i),!0}return!1}disconnect(t){if(this.type===d.IN)return this._disconnect(this.connectors[0]),!0;if("string"==typeof t){let e=this.connectors.find((e=>e.id===t));if(!e)return l.Log.error("Connector not found while disconnecting",t),!1;this._disconnect(e)}else if(t instanceof h.Connector){if(!this.connectors.find((e=>e.id===t.id)))return l.Log.error("Connector cannot be disconnected from the terminal because its not associated with it",t),!1;this._disconnect(t)}else this.connectors.forEach((t=>this._disconnect(t)));return!0}_disconnect(t){let[e,i]=[t.start,t.end];this.node.flow.connectors.delete(t.id),t.start.connectors.splice(t.start.connectors.findIndex((e=>e.id===t.id)),1),t.end.connectors.pop(),this.node.flow.executionGraph.disconnect(e.node,i.node),t.start.onDisconnect(t,e,i),t.end.onDisconnect(t,e,i)}offUIRender(){let t=this.node.offUIContext;t.save(),t.beginPath(),t.arc(this.position.x,this.position.y,this.style.radius+this.node.style.terminalStripMargin,0,a.Constant.TAU),t.fillStyle=this.hitColor.rgbaCSSString,t.fill(),t.restore()}isConnected(){return this.connectors.length>0}onEnter(t,e){this.call("enter",this,t,e),this.focus=!0,this.node.flow.flowConnect.cursor="pointer"}onExit(t,e){this.call("exit",this,t,e),this.focus=!1,this.node.flow.flowConnect.cursor="unset"}onDown(t,e){if(this.call("down",this,t,e),this.connectors.length>0)if(this.type===d.IN){let[t,i]=[this.connectors[0].start,this.connectors[0].end];this.connectors[0].endNode.currHitTerminal=null,this.connectors[0].end=null,this.connectors[0].endNode=null,this.connectors[0].floatingTip=e,this.node.flow.flowConnect.floatingConnector=this.connectors[0];let s=this.connectors.pop();this.node.flow.executionGraph.disconnect(t.node,i.node),s.start.onDisconnect(s,t,i),this.onDisconnect(s,t,i)}else{if(this.node.flow.flowConnect.floatingConnector)return;let t=new h.Connector(this.node.flow,this,null,{floatingTip:e});this.node.flow.connectors.set(t.id,t),this.node.flow.flowConnect.floatingConnector=t}else{if(this.node.flow.flowConnect.floatingConnector)return;let t=new h.Connector(this.node.flow,this.type===d.IN?null:this,this.type===d.IN?this:null,{floatingTip:e});this.node.flow.connectors.set(t.id,t),this.node.flow.flowConnect.floatingConnector=t}}onUp(t,e){this.call("up",this,t,e)}onDrag(t,e){this.call("drag",this,t,e)}onClick(t,e){this.call("click",this,t,e)}onOver(t,e){this.call("over",this,t,e)}onContextMenu(){this.call("rightclick",this)}onConnect(t){this.call("connect",this,t)}onDisconnect(t,e,i){this.call("disconnect",this,t,e,i)}onEvent(t){this.type===d.IN&&this.call("event",this,t)}emit(t){this.type===d.OUT&&0!==this.connectors.length&&(this.connectors.forEach((e=>{e.end&&e.end.onEvent(t)})),this.call("emit",this,t))}serialize(){return{name:this.name,type:this.type,dataType:this.dataType,propName:this.propName,id:this.id,style:this.style,hitColor:this.hitColor.serialize()}}static deSerialize(t,e){return new u(t,e.type,e.dataType,e.name,{propName:e.propName,style:e.style,id:e.id,hitColor:n.Color.deSerialize(e.hitColor)})}}var d;e.Terminal=u,function(t){t[t.IN=1]="IN",t[t.OUT=2]="OUT"}(d=e.TerminalType||(e.TerminalType={}));let p=()=>({radius:4,color:"#888",borderColor:"#222",shadowBlur:0,shadowColor:"#ccc",focusColor:"#00ff00",outerFocusColor:"#bbbbbb80"});const c=()=>({style:{}})},8915:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TunnelNode=void 0;const s=i(7892),o=i(1278),n=i(7055);class h extends n.Node{constructor(t,e,i,s,o,n,h=r()){super(t,e,i,s,o,n,{style:h.style,terminalStyle:h.terminalStyle,state:h.state,id:h.id,hitColor:h.hitColor}),this.inputs.length>0?this.inputs[0].on("data",((t,e)=>this.proxyTerminal.setData(e))):this.outputs[0].on("connect",((t,e)=>{this.proxyTerminal.connectors.length>0&&(e.data=this.proxyTerminal.connectors[0].data)}))}get proxyTerminal(){return this._proxyTerminal}set proxyTerminal(t){this._proxyTerminal=t,this._proxyTerminal.on("data",((t,e)=>this.outputs[0].setData(e)))}serialize(){return{id:this.id,name:this.name,position:this.position.serialize(),width:this.width,state:this.state,inputs:this.inputs.map((t=>t.serialize())),outputs:this.outputs.map((t=>t.serialize())),style:this.style,terminalStyle:this.terminalStyle,hitColor:this.hitColor.serialize(),zIndex:this.zIndex,focused:this.focused,renderState:this.renderState,ui:this.ui.serialize(),proxyTerminalId:this.proxyTerminal.id}}static deSerialize(t,e){return new h(t,e.name,s.Vector2.deSerialize(e.position),e.width,e.inputs,e.outputs,{style:e.style,terminalStyle:e.terminalStyle,state:e.state,id:e.id,hitColor:o.Color.deSerialize(e.hitColor)})}}e.TunnelNode=h;let r=()=>({style:{},terminalStyle:{},state:{}})},7892:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Vector2=void 0;const s=i(974);class o{constructor(t,e){t instanceof DOMPoint?[this.x,this.y]=[t.x,t.y]:[this.x,this.y]=[t||0,e||0]}addInPlace(t,e){return t instanceof o?(this.x+=t.x,this.y+=t.y):void 0===e?(this.x+=t,this.y+=t):(this.x+=t,this.y+=e),this}multiplyInPlace(t,e){return t instanceof o?(this.x*=t.x,this.y*=t.y):void 0===e?(this.x*=t,this.y*=t):(this.x*=t,this.y*=e),this}subtractInPlace(t,e){return t instanceof o?(this.x-=t.x,this.y-=t.y):void 0===e?(this.x-=t,this.y-=t):(this.x-=t,this.y-=e),this}normalizeInPlace(t,e,i,o){return void 0!==i&&void 0!==o?(this.x=(0,s.normalize)(this.x,t,e),this.y=(0,s.normalize)(this.y,i,o)):(this.x=(0,s.normalize)(this.x,t,e),this.y=(0,s.normalize)(this.y,t,e)),this}clampInPlace(t,e,i,o){return void 0!==i&&void 0!==o?(this.x=(0,s.clamp)(this.x,t,e),this.y=(0,s.clamp)(this.y,i,o)):(this.x=(0,s.clamp)(this.x,t,e),this.y=(0,s.clamp)(this.y,t,e)),this}transformInPlace(t){let e=t.transformPoint(this);return[this.x,this.y]=[e.x,e.y],this}absInPlace(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}add(t,e){return new o(this.x,this.y).addInPlace(t,e)}multiply(t,e){return new o(this.x,this.y).multiplyInPlace(t,e)}subtract(t,e){return new o(this.x,this.y).subtractInPlace(t,e)}normalize(t,e,i,s){return new o(this.x,this.y).normalizeInPlace(t,e,i,s)}clamp(t,e,i,s){return new o(this.x,this.y).clampInPlace(t,e,i,s)}isInside(t,e,i,s){if(t instanceof o&&e instanceof o){if(this.x<t.x||this.x>e.x)return!1;if(this.y<t.y||this.y>e.y)return!1}else{if(this.x<t||this.x>i)return!1;if(this.y<e||this.y>s)return!1}return!0}assign(t,e){return t instanceof o?(this.x=t.x,this.y=t.y):void 0===e?(this.x=t,this.y=t):(this.x=t,this.y=e),this}transform(t){return new o(this.x,this.y).transformInPlace(t)}abs(){return new o(this.x,this.y).absInPlace()}toString(){return"["+this.x.toFixed(3)+", "+this.y.toFixed(3)+"]"}clone(){return new o(this.x,this.y)}max(){return Math.max(this.x,this.y)}isEqual(t,e){return void 0!==e?o.Distance(this,t)<=e:this.x===t.x&&this.y===t.y}static Distance(t,e,i,s){return t instanceof o&&e instanceof o?Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)):"number"==typeof t&&"number"==typeof e?Math.sqrt(Math.pow(i-t,2)+Math.pow(s-e,2)):void 0}static Midpoint(t,e){return new o((t.x+e.x)/2,(t.y+e.y)/2)}static Zero(){return new o(0,0)}static Random(t,e,i,s){return new o(Math.random()*(e-t)+t,Math.random()*(s-i)+i)}serialize(){return{x:this.x,y:this.y}}static deSerialize(t){return new o(t.x,t.y)}}e.Vector2=o},6184:function(t,e,i){var s=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var o=Object.getOwnPropertyDescriptor(e,i);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,o)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),o=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||s(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),e.Constant=e.FlowConnectState=e.FlowConnect=void 0;const n=i(6676),h=i(7892),r=i(974),l=i(6645),a=i(7900),u=i(6894),d=i(712),p=i(3511);class c extends n.Hooks{constructor(t){super(),this.audioBufferCache=new Map,this.arrayBufferCache=new Map,this.canvasDimensions={top:0,left:0,width:0,height:0},this.state=f.Stopped,this.flows=[],this.pointers=[],this.keymap={},this.touchControls={CreateGroup:!1},this.genericInput=document.createElement("input"),this.minScale=.1,this.maxScale=5,this.wheelScaleDelta=1.05,this.pinchScaleDelta=1.02,this.disableScale=!1,this._transform=new DOMMatrix,this.inverseTransform=new DOMMatrix,this.identity=new DOMMatrix,this.startTime=-1,this.renderResolver={},this.prepareCanvas(t),this.setupHitCanvas(),this.calcCanvasDimension(!0),this.registerChangeListeners(),this.attachStyles(),this.canvasUtils(),this.registerEvents(),this.setGenericInput()}static async create(t){let e=new c(t);return await e.setupAudioContext(),e}get context(){return this._context}get audioContext(){return this._audioContext}get offContext(){return this._offContext}get offUIContext(){return this._offUIContext}get offGroupContext(){return this._offGroupContext}get cursor(){return this.canvas.style.cursor}set cursor(t){this.canvas.style.cursor=t}get scale(){return this._transform.a}get transform(){return this._transform}get time(){return this.startTime<0?this.startTime:performance.now()-this.startTime}registerChangeListeners(){let t=!1;document.addEventListener("scroll",(()=>{t||(window.requestAnimationFrame((()=>{this.calcCanvasDimension(!1),t=!1})),t=!0)})),this.registerObservers(this.canvas.parentElement)}registerObservers(t){this.parentResizeObserver&&this.parentResizeObserver.disconnect(),this.bodyResizeObserver&&this.bodyResizeObserver.disconnect(),this.parentResizeObserver=new ResizeObserver((()=>{this.calcCanvasDimension(!0),this.updateTransform(null,null,null)})),this.parentResizeObserver.observe(t),t!==document.body&&(this.bodyResizeObserver=new ResizeObserver((()=>{this.calcCanvasDimension(!0),this.updateTransform(null,null,null)})),this.bodyResizeObserver.observe(document.body))}prepareCanvas(t){t?t instanceof HTMLDivElement?(this.canvas=document.createElement("canvas"),this.canvas.width=t.clientWidth,this.canvas.height=t.clientHeight,t.appendChild(this.canvas)):t instanceof HTMLCanvasElement?this.canvas=t:l.Log.error("mount provided is not of type HTMLDivElement or HTMLCanvasElement"):(this.canvas=document.createElement("canvas"),this.canvas.width=document.body.clientWidth,this.canvas.height=document.body.clientHeight,document.body.appendChild(this.canvas)),Object.assign(this.canvas.style,{position:"absolute",width:"100%",height:"100%"}),this._context=this.canvas.getContext("2d")}setupHitCanvas(){"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof OffscreenCanvasRenderingContext2D?(this.offCanvas=new OffscreenCanvas(this.canvasDimensions.width,this.canvasDimensions.height),this.offUICanvas=new OffscreenCanvas(this.canvasDimensions.width,this.canvasDimensions.height),this.offGroupCanvas=new OffscreenCanvas(this.canvasDimensions.width,this.canvasDimensions.height)):(this.offCanvas=document.createElement("canvas"),this.offUICanvas=document.createElement("canvas"),this.offGroupCanvas=document.createElement("canvas")),this._offContext=this.offCanvas.getContext("2d"),this._offUIContext=this.offUICanvas.getContext("2d"),this._offGroupContext=this.offGroupCanvas.getContext("2d")}attachStyles(){this.canvas.style.touchAction="none";let t=document.createElement("style");t.innerHTML="input.flow-connect-input { position: fixed; visibility: hidden; pointer-events: none; z-index: 100; border: none; border-radius: 0; box-sizing: border-box;} input.flow-connect-input:focus { outline: none; }",document.getElementsByTagName("head")[0].appendChild(t)}calcCanvasDimension(t){if(t&&this.canvas.parentElement){let t=this.canvas.parentElement.getBoundingClientRect();this.canvas.width=t.width,this.canvas.height=t.height,this.call("dimension-change",this,this.canvas.width,this.canvas.height)}let e=this.canvas.getBoundingClientRect();this.canvasDimensions={top:Math.round(e.top),left:Math.round(e.left),width:Math.round(e.width),height:Math.round(e.height)},this.offCanvas.width=this.canvasDimensions.width,this.offCanvas.height=this.canvasDimensions.height,this.offUICanvas.width=this.canvasDimensions.width,this.offUICanvas.height=this.canvasDimensions.height,this.offGroupCanvas.width=this.canvasDimensions.width,this.offGroupCanvas.height=this.canvasDimensions.height}canvasUtils(){c.prototype.canvasUtils=r.noop,CanvasRenderingContext2D.prototype.roundRect=function(t,e,i,s,o){this.beginPath(),this.moveTo(t+o,e),this.lineTo(t+i-o,e),this.quadraticCurveTo(t+i,e,t+i,e+o),this.lineTo(t+i,e+s-o),this.quadraticCurveTo(t+i,e+s,t+i-o,e+s),this.lineTo(t+o,e+s),this.quadraticCurveTo(t,e+s,t,e+s-o),this.lineTo(t,e+o),this.quadraticCurveTo(t,e,t+o,e),this.closePath()},CanvasRenderingContext2D.prototype.strokeRoundRect=function(t,e,i,s,o){void 0===o&&(o=5),this.roundRect(t,e,i,s,o),this.stroke()},CanvasRenderingContext2D.prototype.fillRoundRect=function(t,e,i,s,o){void 0===o&&(o=5),this.roundRect(t,e,i,s,o),this.fill()}}registerEvents(){let t,e=h.Vector2.Zero(),i=-1;window.onkeydown=t=>{!this.keymap[t.key]&&(this.keymap[t.key]=!0)},window.onkeyup=t=>{this.keymap[t.key]=!1},this.canvas.onpointerdown=i=>{this.currFlow&&(this.addPointer(i.pointerId,this.getRelativePosition(i)),1===this.pointers.length?(e=this.pointers[0].screenPosition,this.currHitNode=this.getHitNode(this.pointers[0].screenPosition),this.currHitNode?(this.currHitNode.zIndex=Number.MAX_SAFE_INTEGER,this.keymap.Control?this.currHitNode.focused=!this.currHitNode.focused:(this.currFlow.removeAllFocus(),this.currHitNode.focused=!0),this.currHitNode.onDown(this.pointers[0].screenPosition.clone(),this.pointers[0].realPosition.clone()),t=this.currHitNode.position.subtract(this.pointers[0].realPosition)):this.keymap.Control?(this.keymap.Control||this.touchControls.CreateGroup)&&(this.groupStartPoint=this.pointers[0].realPosition.clone(),this.currGroup=new n.Group(this.currFlow,this.groupStartPoint.clone(),{name:"New Group"})):(this.currFlow.removeAllFocus(),this.currHitGroup=this.getHitGroup(this.pointers[0].screenPosition),this.currHitGroup&&(t=this.currHitGroup.position.subtract(this.pointers[0].realPosition)))):(this.currHitNode=null,this.currHitGroup=null,this.currFlow.removeAllFocus(),this.floatingConnector&&this.floatingConnector.removeConnection()))},this.canvas.onpointerup=t=>{if(!this.currFlow)return;this.removePointer(this.pointers,t),this.pointers.length<2&&(i=-1);let e=this.getRelativePosition(t),s=e.transform(this.inverseTransform);this.currHitNode&&this.handleGrouping(e),this.currHitNode=null,this.currHitGroup=null;let o=this.getHitNode(e);if(o&&o.onUp(e.clone(),s.clone()),this.currGroup){let t=this.currGroup;this.currGroup=null,t.width>10&&t.height>10&&(this.currFlow.groups.push(t),t.setContainedNodes())}this.floatingConnector&&this.handleConnection(o,e,s)},this.canvas.onpointerout=t=>{if(this.currFlow){if(this.removePointer(this.pointers,t),0===this.pointers.length){if(this.currHitNode){let e=this.getRelativePosition(t);this.handleGrouping(e)}this.currHitNode=null,this.currHitGroup=null}if(this.currGroup){let t=this.currGroup;this.currGroup=null,t.width>10&&t.height>10&&(this.currFlow.groups.push(t),t.setContainedNodes())}if(this.floatingConnector&&this.floatingConnector.removeConnection(),this.prevHitNode){let e=this.getRelativePosition(t),i=e.transform(this.inverseTransform);this.prevHitNode.onExit(e,i),this.prevHitNode=null}}},this.canvas.onpointermove=s=>{if(!this.currFlow)return;let o=this.getRelativePosition(s),n=o.transform(this.inverseTransform);if(this.updatePointer(s.pointerId,o,n),2===this.pointers.length){let t=h.Vector2.Distance(this.pointers[0].screenPosition,this.pointers[1].screenPosition);i>0&&t!==i&&this.handleZoom(t>i,h.Vector2.Midpoint(this.pointers[0].screenPosition,this.pointers[1].screenPosition),this.pinchScaleDelta),i=t}if(this.currGroup&&(n.x<this.groupStartPoint.x&&(this.currGroup.position.x=n.x),this.currGroup.width=Math.abs(this.groupStartPoint.x-n.x),n.y<this.groupStartPoint.y&&(this.currGroup.position.y=n.y),this.currGroup.height=Math.abs(this.groupStartPoint.y-n.y)),this.currHitNode){if(this.currHitNode.onDrag(o.clone(),n.clone()),this.currHitNode&&!(this.currHitNode.currHitUINode&&this.currHitNode.currHitUINode.draggable||this.currHitNode.currHitTerminal||this.floatingConnector)){this.currHitNode.position=n.add(t);let e=this.getHitGroup(o);if(e&&e===this.currHitNode.group){let t=e.position.transform(this._transform),i=this.currHitNode.position.transform(this._transform);if((0,r.intersects)(t.x,t.y,t.x+e.width*this.scale,t.y+e.height*this.scale,i.x,i.y,i.x+this.currHitNode.width*this.scale,i.y+this.currHitNode.ui.height*this.scale)===d.ViewPort.INSIDE){let t=e.nodes.findIndex((t=>t.id===this.currHitNode.id));e.nodeDeltas[t]=this.currHitNode.position.subtract(e.position)}}}}else if(this.currHitGroup)this.currHitGroup.position=n.add(t);else if(1===this.pointers.length&&!this.keymap.Control&&!this.touchControls.CreateGroup){let t=o.subtract(e).multiplyInPlace(1/this.scale);e=o,this.updateTransform(null,null,t)}if(this.floatingConnector&&(this.floatingConnector.floatingTip=n),"mouse"===s.pointerType&&!this.currHitNode){let t=this.getHitNode(o);t!==this.prevHitNode?(this.prevHitNode&&this.prevHitNode.onExit(o,n),t&&t.onEnter(o,n)):t&&!this.currHitNode&&t.onOver(o,n),this.prevHitNode=t}},this.canvas.onclick=t=>{if(!this.currFlow)return;let e=this.getRelativePosition(t),i=e.transform(this.inverseTransform),s=this.getHitNode(e);if(s&&s.onClick(e.clone(),i.clone()),!s){let t=this.getHitGroup(e);t&&t.onClick(e.clone(),i.clone())}},this.canvas.oncontextmenu=t=>{if(!this.currFlow)return;t.preventDefault();let e=this.getRelativePosition(t),i=this.getHitNode(e);i&&i.onContextMenu(),this.keymap.Control||this.currFlow.removeAllFocus(),i&&(i.focused=!0)},this.canvas.onwheel=t=>{if(!this.currFlow)return;let e=this.getRelativePosition(t),i=this.getHitNode(e);if(i){let s=n.Color.rgbaToString(this.offUIContext.getImageData(e.x,e.y,1,1).data),o=i.getHitUINode(s);if(o&&o.zoomable)return void i.onWheel(t.deltaY<0,e,e.transform(this.inverseTransform))}this.disableScale||(t.preventDefault(),this.handleZoom(t.deltaY<0,e,this.wheelScaleDelta))}}setGenericInput(){this.genericInput.className="flow-connect-input",this.genericInput.style.visibility="hidden",this.genericInput.style.pointerEvents="none",this.genericInput.style.padding="0",this.genericInput.onblur=()=>{this.genericInput.style.visibility="hidden",this.genericInput.style.pointerEvents="none",this.genericInput.onchange=null},document.body.appendChild(this.genericInput)}async setupAudioContext(){window.__FLOWCONNECT_AUDIO_CTX__?this._audioContext=window.__FLOWCONNECT_AUDIO_CTX__:(this._audioContext=new AudioContext,window.__FLOWCONNECT_AUDIO_CTX__=this._audioContext);let t=(0,p.generateAudioWorklets)(p.WorkletUtils.CircularBuffer);return await this.audioContext.audioWorklet.addModule(p.WorkletUtils.CircularBuffer),Promise.all(Object.keys(t).map((e=>this.audioContext.audioWorklet.addModule(t[e]))))}showGenericInput(t,e,i,s,o){document.activeElement!==this.genericInput&&(Object.assign(this.genericInput.style,i),Object.assign(this.genericInput,s),Object.assign(this.genericInput.style,{left:t.x+this.canvasDimensions.left+"px",top:t.y+this.canvasDimensions.top-3+"px",visibility:"visible",pointerEvents:"all"}),this.genericInput.value=e,this.genericInput.onchange=()=>o(this.genericInput.value),this.genericInput.focus())}changeParent(t){this.registerObservers(t)}updatePointer(t,e,i){let s=this.pointers.find((e=>e.id===t));s&&(s.screenPosition=e,s.realPosition=i)}handleZoom(t,e,i){this._transform.a>=this.maxScale&&t||this._transform.a<=this.minScale&&!t||(this.updateTransform(t?i:1/i,e,null),this.call("scale",this.scale))}handleGrouping(t){let e,i=this.getHitGroup(t);if(i){let t=i.position.transform(this._transform),s=this.currHitNode.position.transform(this._transform);e=(0,r.intersects)(t.x,t.y,t.x+i.width*this.scale,t.y+i.height*this.scale,s.x,s.y,s.x+this.currHitNode.width*this.scale,s.y+this.currHitNode.ui.height*this.scale)}if(this.currHitNode.group)if(this.currHitNode.group!==i){let t=this.currHitNode.group.nodes.findIndex((t=>t.id===this.currHitNode.id));this.currHitNode.group.nodes.splice(t,1),this.currHitNode.group.nodeDeltas.splice(t,1),this.currHitNode.group=null}else if(e!==d.ViewPort.INSIDE){let t=this.currHitNode.group.nodes.findIndex((t=>t.id===this.currHitNode.id));this.currHitNode.group.nodes.splice(t,1),this.currHitNode.group.nodeDeltas.splice(t,1),this.currHitNode.group=null}i&&e===d.ViewPort.INSIDE&&(this.currHitNode.group=i,i.nodes.push(this.currHitNode),i.nodeDeltas.push(this.currHitNode.position.subtract(i.position)))}handleConnection(t,e,i){if(!t)return void this.floatingConnector.removeConnection();let s=t.getHitTerminal(n.Color.rgbaToString(this._offUIContext.getImageData(e.x,e.y,1,1).data),e.clone(),i.clone());if(s&&(t.currHitTerminal=s),!s)return void this.floatingConnector.removeConnection();let o=t.currHitTerminal;if(this.floatingConnector.canConnect(o)){if(o.type===a.TerminalType.OUT)this.floatingConnector.completeConnection(o),t.currHitTerminal=null;else if(o.connectors.length>0){if(o.connectors[0].start===this.floatingConnector.start)return this.floatingConnector.removeConnection(),void(t.currHitTerminal=null);let e=o.connectors[0].start.connectors.indexOf(o.connectors[0]),[i]=o.connectors[0].start.connectors.splice(e,1),[s,n]=[i.start,i.end];this.currFlow.connectors.delete(i.id),this.currFlow.executionGraph.disconnect(s.node,n.node),i.start.onDisconnect(i,s,n),i.end.onDisconnect(i,s,n),this.floatingConnector.completeConnection(o),t.currHitTerminal=null}else this.floatingConnector.completeConnection(o),t.currHitTerminal=null;this.floatingConnector=null}else this.floatingConnector.removeConnection(),t.currHitTerminal=null}getRelativePosition(t){return new h.Vector2(t.clientX-this.canvasDimensions.left,t.clientY-this.canvasDimensions.top)}updateTransform(t,e,i){if(t){let i=e.transform(this.inverseTransform);this._transform.translateSelf(i.x,i.y).scaleSelf(t,t).translateSelf(-i.x,-i.y)}i&&this._transform.translateSelf(i.x,i.y),this.inverseTransform=this._transform.inverse(),this._context.setTransform(this._transform),this._offContext.setTransform(this._transform),this._offUIContext.setTransform(this._transform),this._offGroupContext.setTransform(this._transform),this.call("transform",this)}translateBy(t){this.updateTransform(null,null,t)}scaleBy(t,e){this.updateTransform(t,e)}addPointer(t,e){this.pointers.push({id:t,screenPosition:e,realPosition:e.transform(this.inverseTransform)})}removePointer(t,e){t.splice(t.findIndex((t=>t.id===e.pointerId)),1)}getHitNode(t){let e=n.Color.rgbaToString(this._offContext.getImageData(t.x,t.y,1,1).data);return this.currFlow.nodeHitColors.get(e)}getHitGroup(t){let e=n.Color.rgbaToString(this._offGroupContext.getImageData(t.x,t.y,1,1).data);return this.currFlow.groupHitColors.get(e)}clear(){this._context.save(),this._context.setTransform(this.identity),this._context.clearRect(0,0,this.canvasDimensions.width,this.canvasDimensions.height),this._context.restore(),this._offContext.save(),this._offContext.setTransform(this.identity),this._offContext.clearRect(0,0,this.canvasDimensions.width,this.canvasDimensions.height),this._offContext.restore(),this._offUIContext.save(),this._offUIContext.setTransform(this.identity),this._offUIContext.clearRect(0,0,this.canvasDimensions.width,this.canvasDimensions.height),this._offUIContext.restore(),this._offGroupContext.save(),this._offGroupContext.setTransform(this.identity),this._offGroupContext.clearRect(0,0,this.canvasDimensions.width,this.canvasDimensions.height),this._offGroupContext.restore()}startGlobalTime(){this.startTime<0&&(this.startTime=performance.now(),this._startGlobalTime(),this.state=f.Running,this.call("start",this))}_startGlobalTime(){this.call("tick",this),this.timerId=window.requestAnimationFrame(this._startGlobalTime.bind(this))}stopGlobalTime(){this.isRootFlowStopped()&&(cancelAnimationFrame(this.timerId),this.startTime=-1,this.state=f.Stopped,this.call("tickreset",this),this.call("stop",this))}isRootFlowStopped(){let t=this.currFlow;for(;;){if(!t.parentFlow)return t.state===u.FlowState.Stopped;t=t.parentFlow}}_render(){this.clear(),this.currGroup&&this.currGroup.render(),this.currFlow.render(),this.call("render",this),this.frameId=window.requestAnimationFrame(this._render.bind(this))}createFlow(t={name:"New Flow",rules:{},terminalColors:{}}){t.rules||(t.rules={}),t.terminalColors||(t.terminalColors={}),t.rules={...t.rules,...g()};let e=new n.Flow(this,t.name,t.rules,t.terminalColors);return this.flows.push(e),e.on("start",(()=>this.startGlobalTime())),e.on("stop",(()=>this.stopGlobalTime())),e}render(t){t!==this.currFlow&&(this.currFlow&&(window.cancelAnimationFrame(this.frameId),this.currFlow.deregisterListeners()),this.rootFlow&&this.rootFlow.existsInFlow(t)||(this.rootFlow=t),this.currFlow=t,this._render())}top(){this.render(this.rootFlow)}fromJson(t){let e,i=null;try{e=JSON.parse(t),i=n.Flow.deSerialize(this,e)}catch(t){l.Log.error(t)}return i}toJson(t){let e=t.serialize();try{return JSON.stringify(e,null)}catch(t){l.Log.error(t)}}}var f;e.FlowConnect=c,function(t){t.Stopped="Stopped",t.Running="Running"}(f=e.FlowConnectState||(e.FlowConnectState={}));let g=()=>({string:["string","any"],number:["number","audioparam","any"],boolean:["boolean","any"],array:["array","any"],file:["file","any"],event:["event","any"],vector2:["vector2","any"],"array-buffer":["array-buffer","any"],audio:["audio","audioparam"],audioparam:["audioparam"],"audio-buffer":["audio-buffer","any"],any:["any"]});o(i(20),e),o(i(6676),e);var y=i(3612);Object.defineProperty(e,"Constant",{enumerable:!0,get:function(){return y.Constant}}),o(i(8637),e),o(i(5928),e)},3511:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.generateAudioWorklets=e.WorkletUtils=void 0,e.WorkletUtils={CircularBuffer:URL.createObjectURL(new Blob(["export default class CircularBuffer {\n      constructor(bufferLength, noOfChannels) {\n        this.noOfChannels = noOfChannels;\n        this.bufferLength = bufferLength;\n\n        this.read = this.write = this.frames = 0;\n        this.channels = [];\n        for (let i = 0; i < this.noOfChannels; ++i) this.channels[i] = new Float32Array(bufferLength);\n      }\n      pushBlock(buffer) {\n        let sourceLength = buffer[0].length;\n        for (let i = 0; i < sourceLength; ++i) {\n          let write = (this.write + i) % this.bufferLength;\n          for (let c = 0; c < this.noOfChannels; ++c) {\n            this.channels[c][write] = buffer[c][i];\n          }\n        }\n        this.write += sourceLength;\n        if (this.write >= this.bufferLength) this.write = 0;\n        this.frames += sourceLength;\n        if (this.frames > this.bufferLength) this.frames = this.bufferLength;\n      }\n      popBlock(buffer) {\n        if (this.frames === 0) return;\n        let destinationLength = buffer[0].length;\n        for (let i = 0; i < destinationLength; ++i) {\n          let read = (this.read + i) % this.bufferLength;\n          for (let c = 0; c < this.noOfChannels; ++c) {\n            buffer[c][i] = this.channels[c][read];\n          }\n        }\n        this.read += destinationLength;\n        if (this.read >= this.bufferLength) this.read = 0;\n        this.frames -= destinationLength;\n        if (this.frames < 0) this.frames = 0;\n      }\n    }"],{type:"application/javascript"}))};e.generateAudioWorklets=t=>({Worklet_ProxyParamForSource:URL.createObjectURL(new Blob(["registerProcessor('proxy-param-for-source', class ProxyParamForSource extends AudioWorkletProcessor {\n          static get parameterDescriptors() {\n            return [{\n              name: 'detune',\n              defaultValue: 0,\n              minValue: -2400,\n              maxValue: 2400,\n              automationRate: 'k-rate'\n            }, {\n              name: 'playbackRate',\n              defaultValue: 1,\n              minValue: 0.25,\n              maxValue: 3,\n              automationRate: 'k-rate'\n            }]\n          }\n          process(inputs, outputs, parameters) {\n            outputs[0].forEach(channel => {\n              for (let i = 0; i < channel.length; i++) {\n                // wierd bug, the detune is off by 1200 cents, have to offset this anomaly\n                channel[i] = (parameters['detune'].length > 1 ? parameters['detune'][i] : parameters['detune'][0]) - 1200;\n              }\n            });\n            outputs[1].forEach(channel => {\n              for (let i = 0; i < channel.length; i++) {\n                channel[i] = (parameters['playbackRate'].length > 1 ? parameters['playbackRate'][i] : parameters['playbackRate'][0]);\n              }\n            });\n            return true;\n          }\n        })"],{type:"application/javascript"})),Worklet_ProxyParam:URL.createObjectURL(new Blob(["registerProcessor('proxy-param', class ProxyParam extends AudioWorkletProcessor {\n          static get parameterDescriptors() {\n            return [{\n              name: 'param',\n              defaultValue: 0,\n              minValue: -340282346638528859811704183484516925439,\n              maxValue: 340282346638528859811704183484516925439,\n              automationRate: 'k-rate'\n            }]\n          }\n\n          min = -340282346638528859811704183484516925439;\n          max =  340282346638528859811704183484516925439;\n          offset = 0;\n          constructor(...args) {\n            super(...args);\n            this.port.onmessage = (e) => {\n              switch(e.data.type) {\n                case 'set-range': {\n                  this.min = e.data.value.min;\n                  this.max = e.data.value.max;\n                  break;\n                }\n                case 'set-offset': {\n                  this.offset = -e.data.value\n                  break;\n                }\n                default: break;\n              }\n            }\n          }\n          clamp(value) { return Math.min(Math.max(value, this.min), this.max); }\n          process(inputs, outputs, parameters) {\n            outputs[0].forEach(channel => {\n              for (let i = 0; i < channel.length; i++) {\n                channel[i] = this.clamp((parameters['param'].length > 1 ? parameters['param'][i] : parameters['param'][0]) + this.offset);\n              }\n            });\n            return true;\n          }\n        })"],{type:"application/javascript"})),Worklet_Debug:URL.createObjectURL(new Blob(["registerProcessor('debug', class Debug extends AudioWorkletProcessor {\n          throttle = 1000;\n          lastPeak = -Infinity;\n          constructor(...args) {\n            super(...args);\n            this.port.onmessage = (e) => {\n              this.throttle = e.data;\n            }\n          }\n          process(inputs, outputs, parameters) {\n            if (Date.now() - this.lastPeak > this.throttle) {\n              let data = {\n                inputs: inputs.map(input => input.length),\n                outputs: outputs.map(output => output.length)\n              };\n              this.port.postMessage(data);\n              this.lastPeak = Date.now();\n            }\n            let input = inputs[0];\n            let output = outputs[0]\n            for (let i = 0 ; i < input.length ; i+=1) {\n              for(let c = 0 ; c < input[i].length ; c+=1) {\n                output[i][c] = input[i][c];\n              }\n            }\n            return true;\n          }\n        })"],{type:"application/javascript"})),Worklet_MoogEffect:URL.createObjectURL(new Blob([`import CircularBuffer from '${t}'\n      registerProcessor('moog-effect', class MoogEffect extends AudioWorkletProcessor {\n      cutoff = 0.065;\n      resonance = 3.5;\n      f = 0; inputFactor = 0; fb = 0;\n\n      constructor(options) {\n        super();\n        this.bufferSize = options.processorOptions.bufferSize;\n\n        this.setParams();\n        this.port.onmessage = (e) => {\n          this.cutoff = e.data.cutoff;\n          this.resonance = e.data.resonance;\n          this.setParams();\n        }\n      }\n      setParams() {\n        this.f = this.cutoff * 1.16;\n        this.inputFactor = 0.35013 * (this.f * this.f) * (this.f * this.f);\n        this.fb = this.resonance * (1.0 - 0.15 * this.f * this.f);\n      }\n      channelsChanged(newNoOfChannels) {\n        this.channelCount = newNoOfChannels;\n        this.inputBuffer = new CircularBuffer(this.bufferSize, this.channelCount);\n        this.outputBuffer = new CircularBuffer(this.bufferSize, this.channelCount);\n        this.in1 = new Array(this.channelCount).fill(0);\n        this.in2 = new Array(this.channelCount).fill(0);\n        this.in3 = new Array(this.channelCount).fill(0);\n        this.in4 = new Array(this.channelCount).fill(0);\n        this.out1 = new Array(this.channelCount).fill(0);\n        this.out2 = new Array(this.channelCount).fill(0);\n        this.out3 = new Array(this.channelCount).fill(0);\n        this.out4 = new Array(this.channelCount).fill(0);\n      }\n\n      _process(input, output) {\n        for (let c = 0; c < input.length; ++c) {\n          for (let i = 0; i < input[c].length; ++i) {\n            input[c][i] -= this.out4[c] * this.fb;\n            input[c][i] *= this.inputFactor;\n            this.out1[c] = input[c][i] + 0.3 * this.in1[c] + (1 - this.f) * this.out1[c];\n            this.in1[c] = input[c][i];\n            this.out2[c] = this.out1[c] + 0.3 * this.in2[c] + (1 - this.f) * this.out2[c];\n            this.in2[c] = this.out1[c];\n            this.out3[c] = this.out2[c] + 0.3 * this.in3[c] + (1 - this.f) * this.out3[c];\n            this.in3[c] = this.out2[c];\n            this.out4[c] = this.out3[c] + 0.3 * this.in4[c] + (1 - this.f) * this.out4[c];\n            this.in4[c] = this.out3[c];\n            output[c][i] = this.out4[c];\n          }\n        }\n      }\n      process(inputs, outputs, parameters) {\n        let input = inputs[0], output = outputs[0];\n        if (input.length === 0) return true;\n\n        if (!this.prevChannelCount || this.prevChannelCount !== inputs[0].length) {\n          this.channelsChanged(inputs[0].length);\n          this.prevChannelCount = inputs[0].length;\n        }\n\n        this.inputBuffer.pushBlock(input);\n        if (this.inputBuffer.frames >= this.bufferSize) {\n          let tmpInBuffer = [], tmpOutBuffer = [];\n          for (let i = 0; i < this.channelCount; ++i) {\n            tmpInBuffer[i] = new Float32Array(this.bufferSize);\n            tmpOutBuffer[i] = new Float32Array(this.bufferSize);\n          }\n\n          this.inputBuffer.popBlock(tmpInBuffer);\n          this._process(tmpInBuffer, tmpOutBuffer);\n          this.outputBuffer.pushBlock(tmpOutBuffer);\n        }\n        this.outputBuffer.popBlock(output);\n        return true;\n      }\n    })`],{type:"application/javascript"})),Worklet_BitcrusherEffect:URL.createObjectURL(new Blob([`import CircularBuffer from '${t}'\n      registerProcessor('bitcrusher-effect', class BitcrusherEffect extends AudioWorkletProcessor {\n      bits = 4;\n      normFreq = 0.1;\n      step = 0;\n\n      constructor(options) {\n        super();\n        this.bufferSize = options.processorOptions.bufferSize;\n\n        this.setParams();\n        this.port.onmessage = (e) => {\n          this.bits = e.data.bits;\n          this.normFreq = e.data.normFreq;\n          this.setParams();\n        }\n      }\n      setParams() {\n        this.step = Math.pow(1 / 2, this.bits);\n      }\n      channelsChanged(newNoOfChannels) {\n        this.channelCount = newNoOfChannels;\n        this.inputBuffer = new CircularBuffer(this.bufferSize, this.channelCount);\n        this.outputBuffer = new CircularBuffer(this.bufferSize, this.channelCount);\n        this.phaser = new Array(this.channelCount).fill(0);\n        this.last = new Array(this.channelCount).fill(0);\n      }\n\n      _process(input, output) {\n        for (let c = 0; c < input.length; ++c) {\n          for (let i = 0; i < input[c].length; ++i) {\n            this.phaser[c] += this.normFreq;\n            if (this.phaser[c] >= 1.0) {\n              this.phaser[c] -= 1.0;\n              this.last[c] = this.step * Math.floor(input[c][i] / this.step + 0.5);\n            }\n            output[c][i] = this.last[c];\n          }\n        }\n      }\n      process(inputs, outputs, parameters) {\n        let input = inputs[0], output = outputs[0];\n        if (input.length === 0) return true;\n        if (!this.prevChannelCount || this.prevChannelCount !== inputs[0].length) {\n          this.channelsChanged(inputs[0].length);\n          this.prevChannelCount = inputs[0].length;\n        }\n        this.inputBuffer.pushBlock(input);\n        if (this.inputBuffer.frames >= this.bufferSize) {\n          let tmpInBuffer = [], tmpOutBuffer = [];\n          for (let i = 0; i < this.channelCount; ++i) {\n            tmpInBuffer[i] = new Float32Array(this.bufferSize);\n            tmpOutBuffer[i] = new Float32Array(this.bufferSize);\n          }\n          this.inputBuffer.popBlock(tmpInBuffer);\n          this._process(tmpInBuffer, tmpOutBuffer);\n          this.outputBuffer.pushBlock(tmpOutBuffer);\n        }\n        this.outputBuffer.popBlock(output);\n        return true;\n      }\n    })`],{type:"application/javascript"})),Worklet_LFO:URL.createObjectURL(new Blob(["registerProcessor('lfo', class LFO extends AudioWorkletProcessor {\n      oscillation = 0.3;\n      offset = 0.85;\n      phaseInc = 0;\n      phase = 0;\n\n      constructor(options) {\n        super();\n        this.sampleRate = options.processorOptions.sampleRate;\n\n        this.port.onmessage = (e) => {\n          switch(e.data.type) {\n            case 'set-oscillation': { this.oscillation = e.data.value; break; }\n            case 'set-offset': { this.offset = e.data.value; break; }\n            case 'set-phase': { this.phase = e.data.value; break; }\n            case 'set-frequency': { this.phaseInc = 2 * Math.PI * e.data.value * 128 / this.sampleRate; break; }\n            case 'set-all': {\n              this.oscillation = e.data.value.oscillation;\n              this.offset = e.data.value.offset;\n              this.phase = e.data.value.phase;\n              this.phaseInc = 2 * Math.PI * e.data.value.frequency * 128 / this.sampleRate;\n              break;\n            }\n            default: return;\n          }\n        }\n      }\n      process(inputs, outputs, parameters) {\n        let output = outputs[0][0];\n\n        for (let i = 0; i < output.length; ++i) {\n          this.phase += this.phaseInc;\n          if (this.phase > 2 * Math.PI) this.phase = 0;\n          output[i] = this.offset + this.oscillation * Math.sin(this.phase);\n        }\n\n        return true;\n      }\n    })"],{type:"application/javascript"})),Worklet_Noise:URL.createObjectURL(new Blob(["registerProcessor('noise', class Noise extends AudioWorkletProcessor {\n      type = 'white';\n      types = ['white', 'pink', 'brownian'];\n\n      constructor(options) {\n        super();\n        this.port.onmessage = (e) => {\n          if (!this.types.includes(e.data)) this.type = 'white';\n          else this.type = e.data;\n        }\n\n        this.generate = {\n          'white': (output) => {\n            for (let i = 0; i < output.length; ++i) output[i] = Math.random() * 2 - 1;\n          },\n          'pink': (output) => {\n            let b0, b1, b2, b3, b4, b5, b6;\n            b0 = b1 = b2 = b3 = b4 = b5 = b6 = 0.0;\n\n            for (let i = 0; i < output.length; ++i) {\n              let white = Math.random() * 2 - 1;\n              b0 = 0.99886 * b0 + white * 0.0555179;\n              b1 = 0.99332 * b1 + white * 0.0750759;\n              b2 = 0.96900 * b2 + white * 0.1538520;\n              b3 = 0.86650 * b3 + white * 0.3104856;\n              b4 = 0.55000 * b4 + white * 0.5329522;\n              b5 = -0.7616 * b5 - white * 0.0168980;\n              output[i] = b0 + b1 + b2 + b3 + b4 + b5 + b6 + white * 0.5362;\n              output[i] *= 0.11;\n              b6 = white * 0.115926;\n            }\n          },\n          'brownian': (output) => {\n            let lastOut = 0.0;\n            for (let i = 0; i < output.length; i++) {\n              let white = Math.random() * 2 - 1;\n              output[i] = (lastOut + (0.02 * white)) / 1.02;\n              lastOut = output[i];\n              output[i] *= 3.5;\n            }\n          }\n        }\n      }\n      process(inputs, outputs, parameters) {\n        this.generate[this.type](outputs[0][0]);\n        return true;\n      }\n    })"],{type:"application/javascript"})),Worklet_Proxy:URL.createObjectURL(new Blob(["registerProcessor('proxy', class Proxy extends AudioWorkletProcessor {\n\n      constructor() { super(); }\n      process(inputs, outputs, parameters) {\n        inputs.forEach((input, index) => input.forEach((channel, cIndex) => {\n          outputs[index][cIndex].set(channel);\n        }));\n        return true;\n      }\n    })"],{type:"application/javascript"}))})},3612:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Constant=void 0;class i{}e.Constant=i,i.TAU=2*Math.PI,i.SIN_60=.866,i.PHI=1.618033988749895},5124:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.imageIcon=e.fileIcon=void 0,e.fileIcon="data:image/svg+xml;charset=UTF-8,%3c?xml version='1.0' encoding='iso-8859-1'?%3e%3c!-- --%3e%3csvg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 477.867 477.867' style='enable-background:new 0 0 477.867 477.867;' xml:space='preserve'%3e%3cg%3e%3cg%3e%3cpath d='M324.267,119.467c-9.426,0-17.067-7.641-17.067-17.067V0H102.4C74.123,0,51.2,22.923,51.2,51.2v375.467 c0,28.277,22.923,51.2,51.2,51.2h273.067c28.277,0,51.2-22.923,51.2-51.2v-307.2H324.267z'/%3e%3c/g%3e%3c/g%3e%3cg%3e%3cg%3e%3cpolygon points='341.333,10.001 341.333,85.333 416.666,85.333 '/%3e%3c/g%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3c/svg%3e",e.imageIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAQAAAAAYLlVAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAHdElNRQfjDAMLKTYM6GTwAAACaElEQVRo3u2ZP2gUQRSHv90zGKMY/IPxBBGSEGKUixGsFFSQnAZEbUQrEXuvCIiIiKWCbbQXLBRsgpVgockhIhYJGg0oJEWwuNOYYJI7E29scufuZndvNjs30+yb5vbd2/l9Ozvv7cyuRdU6ybATPVZknK9Ox2FGEZrbCH1V+dMsapcXCBbJgkWaL2zVNPRem6M7xV1OGpKHZrCYpMsYAExalNhYO8yzpEF0E0drv8u4pkW7lqtud2raWiRDLAEwDrBBOrKFixxnFwXe8JQFdQhyWZBlxhH3nYEYiq4skAMYYMVTx1c4pw+glaLPo+Qn21UAyEzCq+zw8W7jWozbUDMZgFMR/coBdgf407oAZiP6lQPkA/yjKgBksmAfJZ8sKNOxTsXIWTDNLR/vHb6FnJOihzZVIwBwk2VXGbqNFdLn+dW6+ZYD9UZAfkGynyE+UuQTj3y7/W/9Dth5TqgCkLW9FFx9lrigE6CJ/JrpuswVfQBDvluQCtf1AFwO3AVVuNF4gIP8Dt2K3WsswBYm6u4GH2I3CsDiWV15geAJTY0BGJSSFwiG6YkCkJYqqMf4Iw0gGJMDaOEBPxAIZsiFrp7bXAvWqC0AYA/vXf+8C7w9KV7GkA8AyDC9JnCOS74A92PJ+wKcYT4g+DGbPfJnqagGyPE3JHyCjEO+k9mY8h6AroBa7mxL5Fblm/kQW94DMCZ50nMOcYRXCuSFhVh38VFixrfnCUACkAAkAAlAApAA2JSN6pdtpowCTNm8MAowbJHmM62G5H/RDZA19Ol2gf4qSR8j2uVf0ws43vZ10Kvt832B8eprzn/ptwK4iL9QVQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOS0xMi0wM1QxMTo0MTo1NCswMDowME8knnIAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTktMTItMDNUMTE6NDE6NTQrMDA6MDA+eSbOAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAABJRU5ErkJggg=="},5162:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Slider2D=void 0;const s=i(7900),o=i(7892),n=i(974),h=i(2681),r=i(1278),l=i(6894),a=i(3612);class u extends h.UINode{constructor(t,e=p(t)){super(t,o.Vector2.Zero(),h.UIType.Slider2D,{draggable:!0,style:e.style?{...d(),...e.style}:d(),propName:e.propName,input:e.input&&("boolean"==typeof e.input?new s.Terminal(t,s.TerminalType.IN,"vector2","",{}):s.Terminal.deSerialize(t,e.input)),output:e.output&&("boolean"==typeof e.output?new s.Terminal(t,s.TerminalType.OUT,"vector2","",{}):s.Terminal.deSerialize(t,e.output)),id:e.id,hitColor:e.hitColor}),this.pointDiameter=20,this.height=(0,n.get)(e.height,4*this.node.style.rowHeight),this._value=this.propName?this.getProp():(0,n.get)(e.value,new o.Vector2(.5,.5)),this._value.clampInPlace(0,1),this.input&&(this.input.on("connect",((t,e)=>{e.data&&(this.value=e.data)})),this.input.on("data",((t,e)=>{e&&(this.value=e)}))),this.output&&this.output.on("connect",((t,e)=>e.data=this.value)),this.node.on("process",(()=>{this.output&&this.output.setData(this.value)})),this.thumbHitColor=r.Color.Random().hexValue,"undefined"!=typeof OffscreenCanvas?this.offThumbCanvas=new OffscreenCanvas(this.width,this.height):(this.offThumbCanvas=document.createElement("canvas"),this.offThumbCanvas.width=this.width,this.offThumbCanvas.height=this.height),this.offThumbContext=this.offThumbCanvas.getContext("2d"),this.renderOffThumb()}get value(){return this.propName?this.getProp():this._value}set value(t){t=t.clamp(0,1);let e=this.value,i=t;this.propName?this.setProp(i):this._value=i,this.renderOffThumb(),this.node.flow.state!==l.FlowState.Stopped&&this.call("change",this,e,i)}renderOffThumb(){let[t,e]=[this.width-this.pointDiameter,this.height-this.pointDiameter];this.offThumbContext.clearRect(0,0,t,e);let i=new o.Vector2(this.value.x,1-this.value.y).multiply(t,e).add(this.pointDiameter/2);this.offThumbContext.fillStyle=this.thumbHitColor,this.offThumbContext.beginPath(),this.offThumbContext.arc(i.x,i.y,this.pointDiameter/2,0,a.Constant.TAU),this.offThumbContext.fill()}paint(){let t=this.node.context;t.fillStyle=this.style.backgroundColor,t.strokeStyle=this.style.borderColor,t.lineWidth=this.style.borderWidth,t.fillRect(this.position.x,this.position.y,this.width,this.height),t.strokeRect(this.position.x,this.position.y,this.width,this.height);let[e,i]=[this.width-this.pointDiameter,this.height-this.pointDiameter],s=new o.Vector2(this.value.x,1-this.value.y).multiplyInPlace(e,i).addInPlace(this.position).addInPlace(this.pointDiameter/2);t.fillStyle=this.style.thumbColor,t.beginPath(),t.arc(s.x,s.y,this.pointDiameter/2,0,a.Constant.TAU),t.fill()}paintLOD1(){let t=this.context;t.strokeStyle="#000",t.fillStyle=this.style.backgroundColor,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillRect(this.position.x,this.position.y,this.width,this.height)}offPaint(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)}reflow(){let[t,e]=[this.width,this.height];Math.floor(this.offThumbCanvas.width)===Math.floor(t)&&Math.floor(this.offThumbCanvas.height)===Math.floor(e)||(this.offThumbCanvas.width=t,this.offThumbCanvas.height=e,this.renderOffThumb()),this.input&&this.input.position.assign(this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.position.y+this.height/2),this.output&&this.output.position.assign(this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.position.y+this.height/2)}getHitPoint(t){let e=t.subtract(this.position),i=r.Color.rgbaToHex(this.offThumbContext.getImageData(e.x,e.y,1,1).data);return this.thumbHitColor===i}movePoint(t){let[e,i]=[this.width-this.pointDiameter,this.height-this.pointDiameter];this._value=t.clamp(this.position.x+this.pointDiameter/2,this.position.x+this.width-this.pointDiameter/2,this.position.y+this.pointDiameter/2,this.position.y+this.height-this.pointDiameter/2).subtractInPlace(this.position.add(this.pointDiameter/2)).clampInPlace(0,e,0,i).normalizeInPlace(0,e,0,i),this.value=new o.Vector2(this._value.x,1-this._value.y)}onPropChange(t,e){this._value=e,this.renderOffThumb(),this.output&&this.output.setData(this.value)}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||this.call("down",this,t,e)}onUp(t,e){this.disabled||(this.node.flow.state!==l.FlowState.Stopped&&this.call("change",this,null,this._value),this.isHit=!1,this.call("up",this,t,e))}onClick(t,e){this.disabled||this.call("click",this,t,e)}onDrag(t,e){this.disabled||(this.movePoint(e),this.call("drag",this,t,e))}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||(this.isHit&&(this.movePoint(e),this.node.flow.state!==l.FlowState.Stopped&&this.call("change",this,null,this._value)),this.isHit=!1,this.call("exit",this,t,e))}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){this.disabled}serialize(){return{value:this.value.serialize(),propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,height:this.height,style:this.style,id:this.id,hitColor:this.hitColor.serialize(),type:this.type,childs:[]}}static deSerialize(t,e){return new u(t,{value:o.Vector2.deSerialize(e.value),propName:e.propName,input:e.input,output:e.output,height:e.height,style:e.style,id:e.id,hitColor:r.Color.deSerialize(e.hitColor)})}}e.Slider2D=u;let d=()=>({backgroundColor:"#666",thumbColor:"#fff",borderColor:"#000",borderWidth:1}),p=t=>({height:4*t.style.rowHeight})},3283:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Button=void 0;const s=i(7900),o=i(7892),n=i(5120),h=i(2681),r=i(1278),l=i(712),a=i(974);class u extends h.UINode{constructor(t,e,i=p(t)){super(t,o.Vector2.Zero(),h.UIType.Button,{style:i.style?{...d(),...i.style}:d(),input:i.input&&("boolean"==typeof i.input?new s.Terminal(t,s.TerminalType.IN,"event","",{}):new s.Terminal(t,i.input.type,i.input.dataType,i.input.name,{style:i.input.style,id:i.input.id,hitColor:r.Color.deSerialize(i.input.hitColor)})),output:i.output&&("boolean"==typeof i.output?new s.Terminal(t,s.TerminalType.OUT,"event","",{}):s.Terminal.deSerialize(t,i.output)),id:i.id,hitColor:i.hitColor}),this.text=e,this.input&&this.input.on("event",(()=>this.call("click",this))),this.height=(0,a.get)(i.height,this.node.style.rowHeight+2*this.style.padding),this.label=new n.Label(this.node,e,{style:{fontSize:this.style.fontSize,font:this.style.font,align:l.Align.Center,color:this.style.color},height:this.height}),this.label.on("click",((t,e)=>this.call("click",this,e))),this.children.push(this.label)}paint(){Object.assign(this.context,{fillStyle:this.style.backgroundColor,shadowColor:this.style.shadowColor,shadowBlur:this.style.shadowBlur,shadowOffsetX:this.style.shadowOffset.x,shadowOffsetY:this.style.shadowOffset.y}),this.context.strokeRect(this.position.x,this.position.y,this.width,this.height),this.context.fillRect(this.position.x,this.position.y,this.width,this.height)}paintLOD1(){this.context.strokeStyle="#000",this.paint(),this.context.strokeRect(this.position.x,this.position.y,this.width,this.height)}offPaint(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)}reflow(){this.label.position=this.position,this.label.height=this.height,this.label.width=this.width,this.input&&this.input.position.assign(this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.position.y+this.height/2),this.output&&this.output.position.assign(this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.position.y+this.height/2)}onPropChange(){}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||this.call("down",this,t,e)}onUp(t,e){this.disabled||this.call("up",this,t,e)}onClick(t,e){this.disabled||this.call("click",this,t,e)}onDrag(t,e){this.disabled||this.call("drag",this,t,e)}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||this.call("exit",this,t,e)}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){this.disabled||this.call("rightclick",this)}serialize(){return{text:this.text,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,height:this.height,id:this.id,style:this.style,hitColor:this.hitColor.serialize(),type:this.type,childs:[]}}static deSerialize(t,e){return new u(t,e.text,{input:e.input,output:e.output,height:e.height,style:e.style,id:e.id,hitColor:r.Color.deSerialize(e.hitColor)})}}e.Button=u;let d=()=>({backgroundColor:"#666",padding:5,color:"#fff",font:"arial",fontSize:"11px",shadowColor:"#555",shadowBlur:3,shadowOffset:new o.Vector2(3,3)}),p=t=>({height:1.5*t.style.rowHeight})},5818:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Container=void 0;const s=i(1278),o=i(7892),n=i(8637),h=i(2681),r=i(712);class l extends h.UINode{constructor(t,e,i=u()){super(t,t.position,h.UIType.Container,{style:i.style?{...a(),...i.style}:a(),id:i.id,hitColor:i.hitColor}),this.renderResolver=()=>null,this.width=e,this.height=2*this.node.style.padding,this.contentWidth=this.width-2*this.node.style.padding}paint(){let t=this.context,e=this.node.renderResolver.uiContainer,i=this.node.flow.renderResolver.uiContainer,s=this.node.flow.flowConnect.renderResolver.uiContainer;(this.renderResolver&&this.renderResolver(this)||e&&e(this)||i&&i(this)||s&&s(this)||this._paint)(t,this.getRenderParams(),this)}_paint(t,e,i){t.shadowColor=i.style.shadowColor,t.shadowBlur=i.style.shadowBlur,t.shadowOffsetX=i.style.shadowOffset.x,t.shadowOffsetY=i.style.shadowOffset.y,t.fillStyle=i.style.backgroundColor,t.strokeStyle=i.style.borderColor,t.lineWidth=i.style.borderWidth,t.roundRect(e.position.x,e.position.y,e.width,e.height,5),t.stroke(),t.fill()}paintLOD1(){let t=this.context;t.fillStyle=this.style.backgroundColor,t.strokeStyle=this.style.borderColor,t.lineWidth=this.style.borderWidth,t.roundRect(this.position.x,this.position.y+this.node.style.titleHeight,this.width,this.height-this.node.style.titleHeight,5),t.stroke(),t.fill()}offPaint(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)}getRenderParams(){let t=this.position.serialize();return t.y+=this.node.style.titleHeight,{position:t,width:this.width,height:this.height-this.node.style.titleHeight}}reflow(){this.position=this.node.position;let t=Math.max(this.node.inputs.length,this.node.outputs.length)*this.node.style.terminalRowHeight+this.node.style.titleHeight,e=this.position.x+this.node.style.padding,i=this.position.y+t;this.children.filter((t=>t.visible)).forEach((t=>{i+=this.node.style.spacing;let s=this.width-2*this.node.style.padding;if(t.width=(t.width>s?s:t.width)||s,t.width<s){let s;s=t.style.align===r.Align.Center?this.position.x+this.width/2-t.width/2:t.style.align===r.Align.Right?this.position.x+this.width-this.node.style.padding-t.width:e,t.position=new o.Vector2(s,i)}else t.position=new o.Vector2(e,i);i+=t.height})),this.height=i+this.node.style.padding-this.position.y}onPropChange(){}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||this.call("down",this,t,e)}onUp(t,e){this.disabled||this.call("up",this,t,e)}onClick(t,e){this.disabled||this.call("click",this,t,e)}onDrag(t,e){this.disabled||this.call("drag",this,t,e)}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||this.call("exit",this,t,e)}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){}serialize(){return{width:this.width,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,id:this.id,style:{backgroundColor:this.style.backgroundColor,shadowColor:this.style.shadowColor,shadowBlur:this.style.shadowBlur,shadowOffset:this.style.shadowOffset.serialize(),borderWidth:this.style.borderWidth,borderColor:this.style.borderColor},hitColor:this.hitColor.serialize(),type:this.type,childs:this.children.map((t=>t.serialize()))}}static deSerialize(t,e){let i=new l(t,e.width,{style:e.style,id:e.id,hitColor:s.Color.deSerialize(e.hitColor)});return i.children.push(...e.childs.map((e=>{switch(e.type){case h.UIType.Button:return n.Button.deSerialize(t,e);case h.UIType.Container:return l.deSerialize(t,e);case h.UIType.Display:return n.Display.deSerialize(t,e);case h.UIType.HorizontalLayout:return n.HorizontalLayout.deSerialize(t,e);case h.UIType.Stack:return n.Stack.deSerialize(t,e);case h.UIType.Image:return n.Image.deSerialize(t,e);case h.UIType.Input:return n.Input.deSerialize(t,e);case h.UIType.Label:return n.Label.deSerialize(t,e);case h.UIType.Select:return n.Select.deSerialize(t,e);case h.UIType.Slider:return n.Slider.deSerialize(t,e);case h.UIType.Source:return n.Source.deSerialize(t,e);case h.UIType.Toggle:return n.Toggle.deSerialize(t,e);default:return}}))),i}}e.Container=l;let a=()=>({backgroundColor:"#ddd",shadowColor:"#666",shadowBlur:3,shadowOffset:new o.Vector2(3,3),borderWidth:1,borderColor:"#444"}),u=()=>({})},1087:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Dial=void 0;const s=i(7900),o=i(7892),n=i(974),h=i(2681),r=i(1278),l=i(6894),a=i(3612);class u extends h.UINode{constructor(t,e,i,r,l=p(e)){super(t,o.Vector2.Zero(),h.UIType.Dial,{draggable:!0,style:l.style?{...d(r),...l.style}:d(r),propName:l.propName,input:l.input&&("boolean"==typeof l.input?new s.Terminal(t,s.TerminalType.IN,"number","",{}):s.Terminal.deSerialize(t,l.input)),output:l.output&&("boolean"==typeof l.output?new s.Terminal(t,s.TerminalType.OUT,"number","",{}):s.Terminal.deSerialize(t,l.output)),id:l.id,hitColor:l.hitColor}),this.min=e,this.max=i,this.thumbStart=o.Vector2.Zero(),this.thumbEnd=o.Vector2.Zero(),this.height=r,this._value=(0,n.get)(l.value,e),this.temp=(0,n.normalize)(this._value,this.min,this.max),this.input&&(this.input.on("connect",((t,e)=>{e.data&&(this.value=e.data)})),this.input.on("data",((t,e)=>{e&&(this.value=e)}))),this.output&&this.output.on("connect",((t,e)=>e.data=this.value)),this.node.on("process",(()=>{this.output&&this.output.setData(this.value)}))}get value(){return this.propName?this.getProp():this._value}set value(t){let e=this.value,i=(0,n.clamp)(t,this.min,this.max);this.propName?this.setProp(i):this._value=i,this.temp=(0,n.normalize)(i,this.min,this.max),this.node.flow.state!==l.FlowState.Stopped&&this.call("change",this,e,i)}paint(){let t=this.context,e=Math.min(this.width,this.height);t.fillStyle=this.style.color,t.strokeStyle=this.style.borderColor,t.lineWidth=this.style.borderWidth,t.shadowColor=this.style.shadowColor,t.shadowBlur=this.style.shadowBlur,t.shadowOffsetX=3,t.shadowOffsetY=3,t.beginPath(),t.arc(this.position.x+this.width/2,this.position.y+this.height/2,e/2,0,a.Constant.TAU),t.stroke(),t.fill(),t.lineCap="round",t.lineWidth=10,t.strokeStyle=this.style.thumbColor,t.shadowColor=this.style.thumbShadowColor,t.shadowBlur=this.style.thumbShadowBlur,t.beginPath(),t.moveTo(this.thumbStart.x,this.thumbStart.y),t.lineTo(this.thumbEnd.x,this.thumbEnd.y),t.stroke()}paintLOD1(){let t=this.context;t.strokeStyle="#000",t.fillStyle=this.style.color,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillRect(this.position.x,this.position.y,this.width,this.height)}offPaint(){let t=this.offUIContext,e=Math.min(this.width,this.height);t.fillStyle=this.hitColor.hexValue,t.beginPath(),t.arc(this.position.x+this.width/2,this.position.y+this.height/2,e/2,0,a.Constant.TAU),t.fill()}reflow(){let t=this.position.add(this.width/2,this.height/2),e=(0,n.normalize)(this.value,this.min,this.max)*a.Constant.TAU+Math.PI/2,i=Math.min(this.width,this.height);this.thumbStart.assign(t.x+Math.cos(e)*(i/5),t.y+Math.sin(e)*(i/5)),this.thumbEnd.assign(t.x+Math.cos(e)*(i/2-10),t.y+Math.sin(e)*(i/2-10)),this.input&&this.input.position.assign(this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.position.y+this.height/2),this.output&&this.output.position.assign(this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.position.y+this.height/2)}pointToValue(t){let e=t.subtract(this.position.add(this.width/2,this.height/2)),i=Math.atan2(e.y,e.x);return i<0&&(i+=a.Constant.TAU),(i/a.Constant.TAU-.25+1)%1}onPropChange(t,e){this._value=e,this.temp=(0,n.normalize)(e,this.min,this.max),this.reflow(),this.output&&this.output.setData(this._value)}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||(this.lastAngle=void 0,this.deltaValue=this.pointToValue(e),this.temp=(0,n.normalize)(this.value,this.min,this.max),this.onDrag(t,e),this.call("down",this,t,e))}onUp(t,e){this.disabled||this.call("up",this,t,e)}onClick(t,e){this.disabled||this.call("click",this,t,e)}onDrag(t,e){if(this.disabled)return;let i=this.pointToValue(e),s=i-this.deltaValue;s=Math.abs(s)>.5?0:s,this.deltaValue=i,this.temp=this.temp+s,this.temp=(0,n.clamp)(this.temp,0,1);let o=this.temp*a.Constant.TAU;o<0&&(o+=a.Constant.TAU),void 0!==this.lastAngle&&Math.abs(this.lastAngle-o)>2&&(o=this.lastAngle>3?a.Constant.TAU:0),this.lastAngle=o;let h=o/a.Constant.TAU;this.value=(0,n.denormalize)((0,n.clamp)(h,0,1),this.min,this.max),this.temp=h,this.reflow(),this.call("drag",this,t,e)}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||(this.lastAngle=void 0,this.call("exit",this,t,e))}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){this.disabled}serialize(){return{min:this.min,max:this.max,value:this.value,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,size:this.height,id:this.id,hitColor:this.hitColor.serialize(),style:this.style,type:this.type,childs:[]}}static deSerialize(t,e){return new u(t,e.min,e.max,e.size,{value:e.value,propName:e.propName,input:e.input,output:e.output,style:e.style,id:e.id,hitColor:r.Color.deSerialize(e.hitColor)})}}e.Dial=u;let d=t=>({color:"#e3e3e3",borderColor:"#000",borderWidth:1,shadowColor:"grey",shadowBlur:5,thumbColor:"#c9c9c9",thumbShadowColor:"#858585",thumbShadowBlur:5,size:t,visible:!0}),p=t=>({value:t})},119:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasType=e.Display=void 0;const s=i(1278),o=i(7900),n=i(7892),h=i(2681);class r extends h.UINode{constructor(t,e,i,s=u()){super(t,n.Vector2.Zero(),h.UIType.Display,{draggable:!0,zoomable:!0,style:s.style?{...a(),...s.style}:a(),input:s.clear&&"boolean"!=typeof s.clear?o.Terminal.deSerialize(t,s.clear):new o.Terminal(t,o.TerminalType.IN,"event","",{}),id:s.id,hitColor:s.hitColor}),this.offCanvasConfigs=[],this.height=e,"undefined"!=typeof OffscreenCanvas?i.forEach((t=>{let e,i,s;t.canvasType===l.HTMLCanvasElement?(e=document.createElement("canvas"),e.width=this.node.width-2*this.node.style.padding,e.height=this.height):e=new OffscreenCanvas(this.node.width-2*this.node.style.padding,this.height),i=e.getContext("2d"),s={canvas:e,context:i,rendererConfig:t,shouldRender:!0},this.offCanvasConfigs.push(s)})):i.forEach((t=>{let e=document.createElement("canvas");e.width=this.node.width-2*this.node.style.padding,e.height=this.height;let i=e.getContext("2d"),s={canvas:e,context:i,rendererConfig:t,shouldRender:!0};this.offCanvasConfigs.push(s)})),this.input.on("event",(()=>{this.offCanvasConfigs.filter((t=>!t.rendererConfig.auto)).forEach((t=>{t.context.clearRect(0,0,t.canvas.width,t.canvas.height)}))})),this.node.flow.flowConnect.on("scale",(()=>this.reflow()))}customRender(t){return Promise.all(t.map((t=>new Promise((e=>{t.shouldRender?(t.rendererConfig.clear&&t.context.clearRect(0,0,t.canvas.width,t.canvas.height),this.style.backgroundColor&&(t.context.fillStyle=this.style.backgroundColor,t.context.fillRect(0,0,t.canvas.width,t.canvas.height)),e(t.rendererConfig.renderer(t.context,t.canvas.width,t.canvas.height))):e(!1)})))))}paint(){let t=this.context;t.strokeStyle=this.style.borderColor,t.lineWidth=1,t.strokeRect(this.position.x,this.position.y,this.width,this.height);let e=this.offCanvasConfigs.filter((t=>t.rendererConfig.auto));this.customRender(e).then((t=>{t.forEach(((t,i)=>e[i].shouldRender=t))})),this.offCanvasConfigs.forEach((e=>{t.drawImage(e.canvas,0,0,e.canvas.width,e.canvas.height,this.position.x,this.position.y,this.node.width-2*this.node.style.padding,this.height)}))}paintLOD1(){let t=this.context;t.strokeStyle=this.style.borderColor,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillStyle="lightgrey",t.fillRect(this.position.x,this.position.y,this.width,this.height)}offPaint(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)}reflow(){let t=(this.node.width-2*this.node.style.padding)*this.node.flow.flowConnect.scale,e=this.height*this.node.flow.flowConnect.scale;this.offCanvasConfigs.forEach((i=>{Math.floor(i.canvas.width)===Math.floor(t)&&Math.floor(i.canvas.height)===Math.floor(e)||(i.canvas.width=t,i.canvas.height=e,i.shouldRender||(i.rendererConfig.renderer(i.context,i.canvas.width,i.canvas.height),i.shouldRender=!1))})),this.input.position.assign(this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.position.y+this.height/2)}onPropChange(){}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||this.call("down",this,t,e)}onUp(t,e){this.disabled||this.call("up",this,t,e)}onClick(t,e){this.disabled||this.call("click",this,t,e)}onDrag(t,e){this.disabled||this.call("drag",this,t,e)}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||this.call("exit",this,t,e)}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){this.disabled||this.call("rightclick",this)}serialize(){return{height:this.height,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,id:this.id,hitColor:this.hitColor.serialize(),style:this.style,type:this.type,childs:[]}}static deSerialize(t,e){return new r(t,e.height,null,{style:e.style,id:e.id,hitColor:s.Color.deSerialize(e.hitColor),clear:e.input})}}var l;e.Display=r,function(t){t.OffscreenCanvas="OffscreenCanvas",t.HTMLCanvasElement="HTMLCanvasElement"}(l=e.CanvasType||(e.CanvasType={}));let a=()=>({borderColor:"#000",visible:!0}),u=()=>({})},9440:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Envelope=void 0;const s=i(7892),o=i(2681),n=i(7900),h=i(1278),r=i(6894),l=i(3612),a=i(8240),u=i(296);class d extends o.UINode{constructor(t,e,i=[],r=c()){super(t,s.Vector2.Zero(),o.UIType.Envelope,{draggable:!0,style:r.style?{...p(),...r.style}:p(),input:r.input&&("boolean"==typeof r.input?new n.Terminal(t,n.TerminalType.IN,"array","",{}):n.Terminal.deSerialize(t,r.input)),output:r.output&&("boolean"==typeof r.output?new n.Terminal(t,n.TerminalType.OUT,"array","",{}):n.Terminal.deSerialize(t,r.output)),id:r.id,hitColor:r.hitColor}),this.pointHitColorPoint=new u.BiMap,this.pointDiameter=10,this.height=e,i.forEach((t=>t.clampInPlace(0,1,0,1))),i.sort(((t,e)=>t.x-e.x)),this._value=new a.List(((t,e)=>t.x-e.x),i),this.pointHitColorPoint.clear(),this._value.forEach((t=>this.pointHitColorPoint.set(h.Color.Random().hexValue,t))),this.input&&(this.input.on("connect",((t,e)=>{e.data&&(this.value=e.data)})),this.input.on("data",((t,e)=>{e&&(this.value=e)}))),this.output&&this.output.on("connect",((t,e)=>e.data=this.value)),"undefined"!=typeof OffscreenCanvas?this.offPointsCanvas=new OffscreenCanvas(this.width,this.height):(this.offPointsCanvas=document.createElement("canvas"),this.offPointsCanvas.width=this.width,this.offPointsCanvas.height=this.height),this.offPointsContext=this.offPointsCanvas.getContext("2d"),this.renderOffPoints()}get value(){return this._value.toArray().map((t=>t.clone()))}set value(t){let e=this.value;t.forEach((t=>t.clampInPlace(0,1,0,1))),t.sort(((t,e)=>t.x-e.x)),this._value=new a.List(((t,e)=>t.x-e.x),t),this.pointHitColorPoint.clear(),this._value.forEach((t=>this.pointHitColorPoint.set(h.Color.Random().hexValue,t))),this.renderOffPoints(),this.node.flow.state!==r.FlowState.Stopped&&this.call("change",this,e,this._value.toArray())}renderOffPoints(){let[t,e]=[this.width-this.pointDiameter,this.height-this.pointDiameter];this.offPointsContext.clearRect(0,0,t,e),this._value.forEach((i=>{let o=new s.Vector2(i.data.x,1-i.data.y).multiply(t,e).add(this.pointDiameter/2);this.offPointsContext.fillStyle=this.pointHitColorPoint.get(i),this.offPointsContext.beginPath(),this.offPointsContext.arc(o.x,o.y,this.pointDiameter/2,0,l.Constant.TAU),this.offPointsContext.fill()}))}paint(){let t=this.node.context;t.fillStyle=this.style.backgroundColor,t.strokeStyle=this.style.borderColor,t.lineWidth=this.style.borderWidth,t.fillRect(this.position.x,this.position.y,this.width,this.height),t.strokeRect(this.position.x,this.position.y,this.width,this.height);let[e,i]=[this.width-this.pointDiameter,this.height-this.pointDiameter],o=this._value.map((t=>new s.Vector2(t.data.x,1-t.data.y).multiplyInPlace(e,i).addInPlace(this.position).addInPlace(this.pointDiameter/2)));o.length>0&&(t.strokeStyle=this.style.lineColor,t.lineWidth=2,t.beginPath(),t.moveTo(this.position.x,o[0].y),o.forEach((e=>t.lineTo(e.x,e.y))),t.lineTo(this.position.x+this.width,o[o.length-1].y),t.stroke()),t.fillStyle=this.style.pointColor,o.forEach((e=>{t.beginPath(),t.arc(e.x,e.y,this.pointDiameter/2,0,l.Constant.TAU),t.fill()}))}paintLOD1(){this.context.fillStyle=this.style.backgroundColor,this.context.fillRect(this.position.x,this.position.y,this.width,this.height)}offPaint(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)}reflow(){let[t,e]=[this.width,this.height];Math.floor(this.offPointsCanvas.width)===Math.floor(t)&&Math.floor(this.offPointsCanvas.height)===Math.floor(e)||(this.offPointsCanvas.width=t,this.offPointsCanvas.height=e,this.renderOffPoints()),this.input&&this.input.position.assign(this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.position.y+this.height/2),this.output&&this.output.position.assign(this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.position.y+this.height/2)}getHitPoint(t){let e=t.subtract(this.position),i=h.Color.rgbaToHex(this.offPointsContext.getImageData(e.x,e.y,1,1).data);return this.pointHitColorPoint.get(i)}movePoint(t){let[e,i]=[this.width-this.pointDiameter,this.height-this.pointDiameter];this.currHitPoint.data=t.clamp(this.position.x+this.pointDiameter/2,this.position.x+this.width-this.pointDiameter/2,this.position.y+this.pointDiameter/2,this.position.y+this.height-this.pointDiameter/2).subtractInPlace(this.position.add(this.pointDiameter/2)).clampInPlace(0,e,0,i).normalizeInPlace(0,e,0,i).clampInPlace(this.currHitPoint.prev?.data.x||0,this.currHitPoint.next?.data.x||1,-1/0,1/0),this.currHitPoint.data=new s.Vector2(this.currHitPoint.data.x,1-this.currHitPoint.data.y),this.renderOffPoints()}newPoint(t,e,i){let o,n=this._value.toArray(),l=t.subtract(this.position.add(this.pointDiameter/2)).normalizeInPlace(0,e,0,i);l=new s.Vector2(l.x,1-l.y);let a=this._value.searchTail((t=>t.data.x<=l.x));o=null===a?this._value.prepend(l):this._value.addAfter(l,a),this.pointHitColorPoint.set(h.Color.Random().hexValue,o),this.renderOffPoints(),this.node.flow.state!==r.FlowState.Stopped&&this.call("change",this,n,this._value.toArray())}deletePoint(){let t=this._value.toArray();this._value.delete(this.currHitPoint),this.pointHitColorPoint.delete(this.currHitPoint),this.renderOffPoints(),this.node.flow.state!==r.FlowState.Stopped&&this.call("change",this,t,this._value.toArray())}onPropChange(){}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||(this.currHitPoint=this.getHitPoint(e),this.lastDownPosition=e,this.call("down",this,t,e))}onUp(t,e){if(this.disabled)return;let[i,o]=[this.width-this.pointDiameter,this.height-this.pointDiameter];!this.currHitPoint&&this.lastDownPosition?s.Vector2.Distance(this.lastDownPosition,e)<=2&&this.newPoint(e,i,o):this.currHitPoint&&this.currHitPoint===this.getHitPoint(e)&&this.lastDownPosition&&this.lastDownPosition.isEqual(e,.5)?this.deletePoint():this.currHitPoint&&this.node.flow.state!==r.FlowState.Stopped&&this.call("change",this,null,this._value.toArray()),this.currHitPoint=null,this.lastDownPosition=null,this.call("up",this,t,e)}onClick(t,e){this.disabled||this.call("click",this,t,e)}onDrag(t,e){this.disabled||(this.currHitPoint&&this.movePoint(e),this.call("drag",this,t,e))}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||(this.currHitPoint&&(this.movePoint(e),this.node.flow.state!==r.FlowState.Stopped&&this.call("change",this,null,this._value.toArray())),this.currHitPoint=null,this.lastDownPosition=null,this.call("exit",this,t,e))}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){this.disabled}serialize(){return{values:this.value.map((t=>t.serialize())),propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,id:this.id,hitColor:this.hitColor.serialize(),style:this.style,height:this.height,type:this.type,childs:[]}}static deSerialize(t,e){return new d(t,e.height,e.values.map((t=>s.Vector2.deSerialize(t))),{input:e.input,output:e.output,style:e.style,id:e.id,hitColor:h.Color.deSerialize(e.hitColor)})}}e.Envelope=d;let p=()=>({backgroundColor:"#4a4a4a",pointColor:"#9cffee",lineColor:"#9cd6ff",borderColor:"#000",borderWidth:1,visible:!0}),c=()=>({})},8104:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.HorizontalLayout=void 0;const s=i(1278),o=i(7892),n=i(8637),h=i(2681),r=i(974),l=i(7900);class a extends h.UINode{constructor(t,e=[],i=d()){super(t,o.Vector2.Zero(),h.UIType.HorizontalLayout,{style:i.style?{...u(),...i.style}:u(),input:i.input&&("boolean"==typeof i.input?new l.Terminal(t,l.TerminalType.IN,"any","",{}):l.Terminal.deSerialize(t,i.input)),output:i.output&&("boolean"==typeof i.output?new l.Terminal(t,l.TerminalType.OUT,"any","",{}):l.Terminal.deSerialize(t,i.output)),id:i.id,hitColor:i.hitColor}),e&&e.length>0&&this.children.push(...e)}paint(){}paintLOD1(){}offPaint(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)}reflow(){let t=this.children.filter((t=>t.visible)),e=this.width-(t.length>0?t.length-1:0)*this.style.spacing,i=e,s=0;t.forEach((t=>s=Math.max(s,t.height))),this.height=s;let o=this.children.filter((t=>!!t.width));o.forEach((t=>t.width=(0,r.clamp)(t.width,0,e)));let n=o.reduce(((t,e)=>t+e.width),0),h=i;n=(0,r.clamp)(n,0,h),h-=n;let l=h,a=this.position.x;t.forEach((t=>{let i,s;i=t.width?t.width:"number"==typeof t.style.grow?t.style.grow*l:0,i=(0,r.clamp)(i,0,e),t.width=i,t.height<this.height?s=this.position.y+this.height/2-t.height/2:(t.height=this.height,s=this.position.y),t.position.assign(a,s),e-=i,a+=i+this.style.spacing})),this.input&&this.input.position.assign(this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.position.y+this.height/2),this.output&&this.output.position.assign(this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.position.y+this.height/2),this.node.ui.reflow()}onPropChange(){}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||this.call("down",this,t,e)}onUp(t,e){this.disabled||this.call("up",this,t,e)}onClick(t,e){this.disabled||this.call("click",this,t,e)}onDrag(t,e){this.disabled||this.call("drag",this,t,e)}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||this.call("exit",this,t,e)}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){}serialize(){return{propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,id:this.id,style:this.style,hitColor:this.hitColor.serialize(),type:this.type,childs:this.children.map((t=>t.serialize()))}}static deSerialize(t,e){let i=new a(t,[],{style:e.style,input:e.input,output:e.output,id:e.id,hitColor:s.Color.deSerialize(e.hitColor)});return i.children.push(...e.childs.map((e=>{switch(e.type){case h.UIType.Button:return n.Button.deSerialize(t,e);case h.UIType.Container:return n.Container.deSerialize(t,e);case h.UIType.Display:return n.Display.deSerialize(t,e);case h.UIType.HorizontalLayout:return a.deSerialize(t,e);case h.UIType.Stack:return n.Stack.deSerialize(t,e);case h.UIType.Image:return n.Image.deSerialize(t,e);case h.UIType.Input:return n.Input.deSerialize(t,e);case h.UIType.Label:return n.Label.deSerialize(t,e);case h.UIType.Select:return n.Select.deSerialize(t,e);case h.UIType.Slider:return n.Slider.deSerialize(t,e);case h.UIType.Source:return n.Source.deSerialize(t,e);case h.UIType.Toggle:return n.Toggle.deSerialize(t,e);default:return}}))),i}}e.HorizontalLayout=a;let u=()=>({spacing:0,visible:!0}),d=()=>({})},7799:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Image=void 0;const s=i(1278),o=i(7892),n=i(5124),h=i(6645),r=i(2681),l=i(712),a=i(7900),u=i(6894),d=i(974);class p extends r.UINode{constructor(t,e,i=f()){super(t,o.Vector2.Zero(),r.UIType.Image,{style:i.style?{...c(),...i.style}:c(),propName:i.propName,input:i.input&&("boolean"==typeof i.input?new a.Terminal(t,a.TerminalType.IN,"string","",{}):a.Terminal.deSerialize(t,i.input)),output:i.output&&("boolean"==typeof i.output?new a.Terminal(t,a.TerminalType.OUT,"string","",{}):a.Terminal.deSerialize(t,i.output)),id:i.id,hitColor:i.hitColor}),this._src=(0,d.get)(e,n.imageIcon),this.setupImage()}get src(){return this.propName?this.getProp():this._src}set src(t){let e=this._src,i=t;this.propName?this.setProp(i):this._src=i,this.setupImage(),this.node.flow.state!==u.FlowState.Stopped&&this.call("change",this,e,i)}setupImage(){this.source||(this.source=document.createElement("img"),this.source.onerror=t=>h.Log.error(t),this.source.onload=()=>{this.imageCanvas.width=this.source.width,this.imageCanvas.height=this.source.height,this.imageContext.drawImage(this.source,0,0),this.ratio=this.source.width/this.source.height,this.reflow(),this.node.ui.update()}),this.imageCanvas||("undefined"!=typeof OffscreenCanvas?this.imageCanvas=new OffscreenCanvas(0,0):(this.imageCanvas=document.createElement("canvas"),this.imageCanvas.width=0,this.imageCanvas.height=0),this.imageContext=this.imageCanvas.getContext("2d")),this.source.src=this._src}paint(){if(this.imageCanvas&&this.imageCanvas.width>0&&this.imageCanvas.height>0){let t=this.position.x;this.source.width<this.node.ui.contentWidth&&(this.style.align===l.Align.Center?t+=this.node.ui.contentWidth/2-this.source.width/2:this.style.align===l.Align.Right&&(t+=+(this.node.ui.contentWidth-this.source.width))),this.context.drawImage(this.imageCanvas,0,0,this.source.width,this.source.height,t,this.position.y,this.source.width<this.width?this.source.width:this.width,this.height)}}paintLOD1(){if(this.imageCanvas){let t=this.position.x;this.source.width<this.node.ui.contentWidth&&(this.style.align===l.Align.Center?t+=this.node.ui.contentWidth/2-this.source.width/2:this.style.align===l.Align.Right&&(t+=+(this.node.ui.contentWidth-this.source.width)));let e=this.context;e.fillStyle="lightgrey",e.strokeStyle="#000",e.fillRect(t,this.position.y,this.source.width<this.width?this.source.width:this.width,this.height),e.strokeRect(t,this.position.y,this.source.width<this.width?this.source.width:this.width,this.height)}}offPaint(){this.offUIContext.fillStyle=this.hitColor.hexValue;let t=this.position.x;this.source.width<this.node.ui.contentWidth&&(this.style.align===l.Align.Center?t+=this.node.ui.contentWidth/2-this.source.width/2:this.style.align===l.Align.Right&&(t+=+(this.node.ui.contentWidth-this.source.width))),this.offUIContext.fillRect(t,this.position.y,this.source.width<this.width?this.source.width:this.width,this.height)}reflow(){this.source.width&&this.source.height&&(this.source.width>this.width?this.height=this.width/this.ratio:(this.width=this.source.width,this.height=this.source.height),this.input&&this.input.position.assign(this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.position.y+this.height/2),this.output&&this.output.position.assign(this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.position.y+this.height/2))}onPropChange(t,e){this._src=e,this.setupImage(),this.output&&this.output.setData(e)}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||this.call("down",this,t,e)}onUp(t,e){this.disabled||this.call("up",this,t,e)}onClick(t,e){this.disabled||this.call("click",this,t,e)}onDrag(t,e){this.disabled||this.call("drag",this,t,e)}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||this.call("exit",this,t,e)}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){}serialize(){return{source:this._src,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,style:this.style,id:this.id,hitColor:this.hitColor.serialize(),type:this.type,childs:[]}}static deSerialize(t,e){return new p(t,e.source,{propName:e.propName,input:e.input,output:e.output,style:e.style,id:e.id,hitColor:s.Color.deSerialize(e.hitColor)})}}e.Image=p;let c=()=>({align:l.Align.Left,visible:!0}),f=()=>({})},8637:function(t,e,i){var s=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var o=Object.getOwnPropertyDescriptor(e,i);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,o)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),o=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||s(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),o(i(5162),e),o(i(3283),e),o(i(5818),e),o(i(1087),e),o(i(119),e),o(i(9440),e),o(i(8104),e),o(i(7799),e),o(i(560),e),o(i(5120),e),o(i(6518),e),o(i(4136),e),o(i(2526),e),o(i(8002),e),o(i(8735),e),o(i(6369),e),o(i(2681),e),o(i(510),e)},560:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.InputType=e.Input=void 0;const s=i(7892),o=i(2681),n=i(5120),h=i(7900),r=i(1278),l=i(6894),a=i(712),u=i(974);class d extends o.UINode{constructor(t,e=f(t)){super(t,s.Vector2.Zero(),o.UIType.Input,{style:e.style?{...c(),...e.style}:c(),propName:e.propName,input:e.input&&("boolean"==typeof e.input?new h.Terminal(t,h.TerminalType.IN,e.style.type,"",{}):h.Terminal.deSerialize(t,e.input)),output:e.output&&("boolean"==typeof e.output?new h.Terminal(t,h.TerminalType.OUT,e.style.type,"",{}):h.Terminal.deSerialize(t,e.output)),id:e.id,hitColor:e.hitColor}),this.height=(0,u.get)(e.height,this.node.style.rowHeight),this.style.type===p.Number&&"string"==typeof e.value&&(e.value=parseFloat(e.value)),this._value=e.value,this.setupLabel(),this.setupInputElement(),this.input&&(this.input.on("connect",((t,e)=>{e.data&&(this.value=e.data)})),this.input.on("data",((t,e)=>{e&&(this.value=e)}))),this.output&&this.output.on("connect",((t,e)=>e.data=this.value)),this.node.on("process",(()=>{this.output&&this.output.setData(this.value)}))}get value(){return this.propName?this.getProp():this._value}set value(t){let e;e=this.style.type===p.Number&&"string"==typeof t?parseFloat(t):t;let i=this.value,s=e;this.propName?this.setProp(s):(this._value=s,this.setLabelText(this._value),this.inputEl.value=this._value.toString()),this.node.flow.state!==l.FlowState.Stopped&&this.call("change",this,s,i)}setupLabel(){this.label=new n.Label(this.node,this.value.toString(),{style:{fontSize:this.style.fontSize,font:this.style.font,align:this.style.align,color:this.style.color,padding:5,precision:this.style.precision||null},height:this.height}),this.label.on("click",(()=>{if(document.activeElement!==this.inputEl){let t=this.position.transform(this.node.flow.flowConnect.transform);Object.assign(this.inputEl.style,{visibility:"visible","pointer-events":"all",top:t.y+this.node.flow.flowConnect.canvasDimensions.top+1+"px",left:t.x+this.node.flow.flowConnect.canvasDimensions.left+1+"px",width:(this.width-1)*this.node.flow.flowConnect.scale+"px",height:(this.height-1)*this.node.flow.flowConnect.scale+"px","font-family":this.style.font,"font-size":parseInt(this.style.fontSize.replace("px",""))*this.node.flow.flowConnect.scale+"px",color:this.style.color,"background-color":this.inputEl.validity.patternMismatch?"red":this.style.backgroundColor,"text-align":this.style.align}),this.style.type===p.Number&&(this.inputEl.step=this.style.step),this.inputEl.focus()}})),this.children.push(this.label)}setupInputElement(){this.inputEl=document.createElement("input"),this.inputEl.className="flow-connect-input",this.inputEl.spellcheck=!1;let t="string"===this.style.type?"text":this.style.type;this.inputEl.type=this.style.pattern?"text":t,this.inputEl.value=this.value.toString(),this.style.pattern&&(this.inputEl.pattern=this.style.pattern),this.style.type===p.Number&&this.style.step&&(this.inputEl.step=this.style.step),this.style.maxLength&&(this.inputEl.maxLength=this.style.maxLength),this.inputEl.addEventListener("blur",(()=>{this.inputEl.style.visibility="hidden",this.inputEl.style.pointerEvents="none",this.value=this.inputEl.value,this.setLabelText(this.style.type===p.Number?parseFloat(this.value):this.value.toString()),this.call("blur",this)})),this.inputEl.oninput=()=>{this.style.pattern&&(this.inputEl.style.backgroundColor=this.inputEl.validity.patternMismatch?"orange":this.style.backgroundColor,this.label.style.color=this.inputEl.validity.patternMismatch?"orange":this.style.color),this.call("input",this)},document.body.appendChild(this.inputEl)}setLabelText(t){this.label.text="number"==typeof t&&(0,u.exists)(this.style.precision)?t.toFixed(this.style.precision):t}paint(){this.context.strokeStyle=this.style.border,this.context.strokeRect(this.position.x,this.position.y,this.width,this.height)}paintLOD1(){let t=this.context;t.strokeStyle=this.style.border,t.fillStyle=this.style.backgroundColor,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillRect(this.position.x,this.position.y,this.width,this.height)}offPaint(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)}reflow(){this.label.position=this.position,this.label.height=this.height,this.label.width=this.width,this.input&&this.input.position.assign(this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.position.y+this.height/2),this.output&&this.output.position.assign(this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.position.y+this.height/2)}onPropChange(t,e){this.style.type===p.Number&&"string"==typeof e&&(e=parseFloat(e)),this._value=e,this.setLabelText(this._value),this.inputEl.value=this._value.toString(),this.output&&this.output.setData(this._value)}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||this.call("down",this,t,e)}onUp(t,e){this.disabled||this.call("up",this,t,e)}onClick(t,e){this.disabled||this.call("click",this,t,e)}onDrag(t,e){this.disabled||this.call("drag",this,t,e)}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||this.call("exit",this,t,e)}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){this.disabled}serialize(){return{value:this.value,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,height:this.height,style:this.style,id:this.id,hitColor:this.hitColor.serialize(),type:this.type,childs:[]}}static deSerialize(t,e){return new d(t,{value:e.value,propName:e.propName,input:e.input,output:e.output,height:e.height,style:e.style,id:e.id,hitColor:r.Color.deSerialize(e.hitColor)})}}var p;e.Input=d,function(t){t.Text="string",t.Number="number"}(p=e.InputType||(e.InputType={}));let c=()=>({backgroundColor:"#eee",color:"#000",fontSize:"11px",font:"arial",border:"1px solid black",align:a.Align.Left,type:p.Text}),f=t=>({height:1.5*t.style.rowHeight})},5120:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Label=void 0;const s=i(7900),o=i(7892),n=i(2681),h=i(1278),r=i(974),l=i(6894),a=i(712);class u extends n.UINode{constructor(t,e,i=p(t)){super(t,o.Vector2.Zero(),n.UIType.Label,{style:i.style?{...d(),...i.style}:d(),propName:i.propName,input:i.input&&("boolean"==typeof i.input?new s.Terminal(t,s.TerminalType.IN,"any","",{}):s.Terminal.deSerialize(t,i.input)),output:i.output&&("boolean"==typeof i.output?new s.Terminal(t,s.TerminalType.OUT,"string","",{}):s.Terminal.deSerialize(t,i.output)),id:i.id,hitColor:i.hitColor}),this._text=this.propName?this.getProp():e,this.reflow(),this.height=(0,r.get)(i.height,this.textHeight+5),this.style.grow||(this.width=this.orgTextWidth),this.input&&(this.input.on("connect",((t,e)=>{(0,r.exists)(e.data)&&(this.text=e.data)})),this.input.on("data",((t,e)=>{(0,r.exists)(e)&&(this.text=e)}))),this.output&&this.output.on("connect",((t,e)=>e.data=this.text)),this.node.on("process",(()=>{this.output&&this.output.setData(this.text)}))}get text(){let t;return t=this.propName?this.getProp():this._text,"number"==typeof t&&(t=this.format(t)),t}set text(t){let e=this._text,i=t;this.propName?this.setProp(i):(this._text=i,this.reflow()),this.node.flow.state!==l.FlowState.Stopped&&this.call("change",this,e,i)}paint(){let t=this.context;t.fillStyle=this.style.backgroundColor,t.fillRect(this.position.x,this.position.y,this.width,this.height),t.fillStyle=this.style.color,t.font=this.style.fontSize+" "+this.style.font,t.textBaseline="middle";let e=this.position.y+this.height/2,i=this.position.x;this.style.align===a.Align.Center?i+=this.width/2-this.textWidth/2:this.style.align===a.Align.Right?i+=this.width-this.textWidth-this.style.padding:i+=this.style.padding,t.fillText(this.displayText,i,e)}paintLOD1(){let t=this.context;t.strokeStyle="#000",t.fillStyle=this.style.color,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillRect(this.position.x,this.position.y,this.width,this.height)}offPaint(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)}reflow(){let t=this.context;t.font=this.style.fontSize+" "+this.style.font,this.orgTextWidth=t.measureText(this.text).width,this.displayText=this.getBestFitString();let e=t.measureText(this.displayText);t.font=null,this.textWidth=e.width,this.textHeight=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent+5,this.input&&this.input.position.assign(this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.position.y+this.height/2),this.output&&this.output.position.assign(this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.position.y+this.height/2)}getBestFitString(){let t=this.text;"string"!=typeof t&&(t=t.toString());let e=this.context.measureText(t).width;const i=this.context.measureText("").width;if(e<=this.width||e<=i)return t;const s=(0,r.binarySearch)({max:t.length,getValue:e=>this.context.measureText(t.substring(0,e)).width,match:this.width-i});return t.substring(0,s)+""}format(t){return(0,r.exists)(this.style.precision)?t.toFixed(this.style.precision):t.toString()}onPropChange(t,e){this._text=e,this.reflow(),this.output&&this.output.setData(this._text)}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||this.call("down",this,t,e)}onUp(t,e){this.disabled||this.call("up",this,t,e)}onClick(t,e){this.disabled||this.call("click",this,t,e)}onDrag(t,e){this.disabled||this.call("drag",this,t,e)}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||this.call("exit",this,t,e)}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){this.disabled}serialize(){return{text:this.text,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,height:this.height,style:this.style,id:this.id,hitColor:this.hitColor.serialize(),type:this.type,childs:[]}}static deSerialize(t,e){return new u(t,e.text,{propName:e.propName,input:e.input,output:e.output,height:e.height,style:e.style,id:e.id,hitColor:h.Color.deSerialize(e.hitColor)})}}e.Label=u;let d=()=>({color:"#000",backgroundColor:"transparent",fontSize:"11px",font:"arial",align:a.Align.Left,padding:0,visible:!0}),p=t=>({height:1.5*t.style.rowHeight})},6518:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RadioGroup=void 0;const s=i(7900),o=i(7892),n=i(2681),h=i(1278),r=i(6894),l=i(5120),a=i(712),u=i(974);class d extends n.UINode{constructor(t,e=["default"],i="default",h=c(t)){super(t,o.Vector2.Zero(),n.UIType.RadioGroup,{style:h.style?{...p(),...h.style}:p(),propName:h.propName,input:h.input&&("boolean"==typeof h.input?new s.Terminal(t,s.TerminalType.IN,"boolean","",{}):s.Terminal.deSerialize(t,h.input)),output:h.output&&("boolean"==typeof h.output?new s.Terminal(t,s.TerminalType.OUT,"boolean","",{}):s.Terminal.deSerialize(t,h.output)),id:h.id,hitColor:h.hitColor}),0===e.length&&(e=["default"]),this._values=e;let r=this.propName?this.getProp():i;this._selected=this._values.includes(r)?r:this._values[0],this.height=(0,u.get)(h.height,this.node.style.rowHeight),this.input&&(this.input.on("connect",((t,e)=>{e.data&&(this._selected=e.data)})),this.input.on("data",((t,e)=>{void 0!==e&&(this._selected=e)}))),this.output&&this.output.on("connect",((t,e)=>e.data=this._selected)),this.setupLabels(),this.node.on("process",(()=>{this.output&&this.output.setData(this._selected)}))}get selected(){return this.propName?this.getProp():this._selected}set selected(t){this._values.includes(t)||(t=this._values[0]);let e=this.selected,i=t;this.propName?this.setProp(i):this._selected=i,this.node.flow.state!==r.FlowState.Stopped&&this.call("change",this,e,i)}setupLabels(){this.children.push(...this._values.map((t=>{let e=new l.Label(this.node,t,{style:{align:a.Align.Center,backgroundColor:this.style.backgroundColor,color:this.style.color}});return e.on("click",(t=>{if(t.text===this.selected)return;let e=this.children[this._values.indexOf(this.selected)];Object.assign(e.style,{backgroundColor:this.style.backgroundColor,color:this.style.color}),Object.assign(t.style,{backgroundColor:this.style.selectedBackgroundColor,color:this.style.selectedColor}),this.selected=t.text})),e}))),Object.assign(this.children[this._values.indexOf(this._selected)].style,{backgroundColor:this.style.selectedBackgroundColor,color:this.style.selectedColor})}paint(){let t=this.context;t.strokeStyle=this.style.borderColor,t.lineWidth=this.style.borderWidth,t.strokeRect(this.position.x,this.position.y,this.width,this.height);let e=this.width/this.children.length,i=this.position.x+e;for(let s=0;s<this.children.length-1;s+=1)t.beginPath(),t.moveTo(i,this.position.y),t.lineTo(i,this.position.y+this.height),t.stroke(),i+=e}paintLOD1(){let t=this.context;t.strokeStyle=this.style.borderColor,t.fillStyle=this.style.backgroundColor,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillRect(this.position.x,this.position.y,this.width,this.height)}offPaint(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)}reflow(){let t=this.position.x;this.children.forEach((e=>{e.height=this.height,e.width=this.width/this.children.length,e.position.assign(t,this.position.y),t+=e.width})),this.input&&this.input.position.assign(this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.position.y+this.height/2),this.output&&this.output.position.assign(this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.position.y+this.height/2)}onPropChange(t,e){this._values.includes(e)||(e=this._values[0]),this._selected=e,this.output&&this.output.setData(this._selected)}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||this.call("down",this,t,e)}onUp(t,e){this.disabled||this.call("up",this,t,e)}onClick(t,e){this.disabled||this.call("click",this,t,e)}onDrag(t,e){this.disabled||this.call("drag",this,t,e)}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||this.call("exit",this,t,e)}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){this.disabled}serialize(){return{values:this._values,selected:this.selected,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,height:this.height,style:this.style,id:this.id,hitColor:this.hitColor.serialize(),type:this.type,childs:[]}}static deSerialize(t,e){return new d(t,e.values,e.selected,{propName:e.propName,input:e.input,output:e.output,height:e.height,style:e.style,id:e.id,hitColor:h.Color.deSerialize(e.hitColor)})}}e.RadioGroup=d;let p=()=>({color:"#000",selectedColor:"#fff",backgroundColor:"transparent",selectedBackgroundColor:"#555",borderColor:"#000",borderWidth:1,visible:!0}),c=t=>({height:1.5*t.style.rowHeight})},4136:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Select=void 0;const s=i(7900),o=i(7892),n=i(5120),h=i(2681),r=i(3612),l=i(1278),a=i(6894),u=i(712),d=i(974);class p extends h.UINode{constructor(t,e=[],i=f(t)){super(t,o.Vector2.Zero(),h.UIType.Select,{style:i.style?{...c(),...i.style}:c(),propName:i.propName,input:i.input&&("boolean"==typeof i.input?new s.Terminal(t,s.TerminalType.IN,"any","",{}):s.Terminal.deSerialize(t,i.input)),output:i.output&&("boolean"==typeof i.output?new s.Terminal(t,s.TerminalType.OUT,"string","",{}):s.Terminal.deSerialize(t,i.output)),id:i.id,hitColor:i.hitColor}),this.values=e,this.height=(0,d.get)(i.height,this.node.style.rowHeight),this._selected=0===this.values.length?"None":this.values[0],this.label=new n.Label(this.node,this.selected,{style:{align:u.Align.Center,...this.style},height:this.height}),this.children.push(this.label),this.input&&(this.input.on("connect",((t,e)=>{"number"==typeof e.data?this.selected=this.values[e.data]:"string"==typeof e.data&&(this.selected=e.data)})),this.input.on("data",((t,e)=>{"number"==typeof e?this.selected=this.values[e]:"string"==typeof e&&(this.selected=e)}))),this.output&&this.output.on("connect",((t,e)=>e.data=this.selected)),this.node.on("process",(()=>{this.output&&this.output.setData(this.selected)}))}get selected(){if(this.propName){let t=this.getProp(),e=this.values.includes(t)?t:this.values[0];return t=0===this.values.length?"None":e,t}return this._selected}set selected(t){let e=this.values.includes(t)?t:this.values[0],i=this.selected,s=0===this.values.length?"None":e;this.propName?this.setProp(s):(this._selected=s,this.label.text=s),this.node.flow.state!==a.FlowState.Stopped&&this.call("change",this,i,s)}paint(){let t=this.context;t.fillStyle=this.style.arrowColor,t.beginPath(),t.moveTo(this.position.x,this.position.y+this.height/2),t.lineTo(this.position.x+this.height*r.Constant.SIN_60,this.position.y),t.lineTo(this.position.x+this.height*r.Constant.SIN_60,this.position.y+this.height),t.lineTo(this.position.x,this.position.y+this.height/2),t.closePath(),t.fill(),t.fillStyle=this.style.arrowColor,t.beginPath(),t.moveTo(this.position.x+this.width,this.position.y+this.height/2),t.lineTo(this.position.x+this.width-this.height*r.Constant.SIN_60,this.position.y),t.lineTo(this.position.x+this.width-this.height*r.Constant.SIN_60,this.position.y+this.height),t.lineTo(this.position.x+this.width,this.position.y+this.height/2),t.closePath(),t.fill()}paintLOD1(){let t=this.context;t.fillStyle=this.style.arrowColor,t.strokeStyle="#000",t.fillRect(this.position.x,this.position.y,this.width,this.height),t.strokeRect(this.position.x,this.position.y,this.width,this.height)}offPaint(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)}reflow(){this.label.width=.7*this.width,this.label.position.assign(this.position.x+.15*this.width,this.position.y+this.height/2-this.label.height/2),this.input&&this.input.position.assign(this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.position.y+this.height/2),this.output&&this.output.position.assign(this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.position.y+this.height/2)}onPropChange(t,e){let i=this.values.includes(e)?e:this.values[0],s=0===this.values.length?"None":i;this._selected=s,this.label.text=this._selected,this.output&&this.output.setData(this.selected)}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||this.call("down",this,t,e)}onUp(t,e){this.disabled||this.call("up",this,t,e)}onClick(t,e){if(this.disabled)return;if(0===this.values.length)return;let i;if(e.x<this.position.x+.15*this.width)i=-1;else{if(!(e.x>this.position.x+.85*this.width))return;i=1}let s=this.values.length;this.selected=this.values[((this.values.indexOf(this.selected)+i)%s+s)%s],this.label.text=this.selected,this.call("click",this,t,e)}onDrag(t,e){this.disabled||this.call("drag",this,t,e)}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||this.call("exit",this,t,e)}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){this.disabled}serialize(){return{values:this.values,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,height:this.height,style:this.style,id:this.id,hitColor:this.hitColor.serialize(),type:this.type,childs:[]}}static deSerialize(t,e){return new p(t,e.values,{propName:e.propName,input:e.input,output:e.output,height:e.height,style:e.style,id:e.id,hitColor:l.Color.deSerialize(e.hitColor)})}}e.Select=p;let c=()=>({arrowColor:"#000",visible:!0}),f=t=>({height:1.5*t.style.rowHeight})},2526:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Slider=void 0;const s=i(7900),o=i(7892),n=i(974),h=i(2681),r=i(1278),l=i(6894),a=i(3612);class u extends h.UINode{constructor(t,e,i,r=p(t)){super(t,o.Vector2.Zero(),h.UIType.Slider,{draggable:!0,style:r.style?{...d(t,r.height),...r.style}:d(t,r.height),propName:r.propName,input:r.input&&("boolean"==typeof r.input?new s.Terminal(t,s.TerminalType.IN,"number","",{}):s.Terminal.deSerialize(t,r.input)),output:r.output&&("boolean"==typeof r.output?new s.Terminal(t,s.TerminalType.OUT,"number","",{}):s.Terminal.deSerialize(t,r.output)),id:r.id,hitColor:r.hitColor}),this.min=e,this.max=i,this.height=(0,n.get)(r.height,this.node.style.rowHeight),this._value=this.propName?this.getProp():(0,n.get)(r.value,e),this._value=(0,n.clamp)(this._value,this.min,this.max),this.input&&(this.input.on("connect",((t,e)=>{e.data&&(this.value=e.data)})),this.input.on("data",((t,e)=>{e&&(this.value=e)}))),this.output&&this.output.on("connect",((t,e)=>e.data=this.value)),this.node.on("process",(()=>{this.output&&this.output.setData(this.value)}))}get value(){return this.propName?this.getProp():this._value}set value(t){t=(0,n.clamp)(t,this.min,this.max);let e=this.value,i=t;i=(0,n.exists)(this.style.precision)?parseFloat(i.toFixed(this.style.precision)):i,this.propName?this.setProp(i):(this._value=i,this.reflow()),this.node.flow.state!==l.FlowState.Stopped&&this.call("change",this,e,i)}paint(){let t=this.context;t.lineWidth=this.style.railHeight,t.strokeStyle=this.style.color,t.lineCap="butt";let e=Math.max(this.position.x,this.position.x+this.thumbFill-3);e!==this.position.x&&(t.beginPath(),t.moveTo(this.position.x,this.position.y+this.height/2),t.lineTo(e,this.position.y+this.height/2),t.stroke()),e=Math.min(this.position.x+2*this.style.thumbRadius+this.thumbFill+3,this.position.x+this.width),e!==this.position.x+this.width&&(t.beginPath(),t.moveTo(e,this.position.y+this.height/2),t.lineTo(this.position.x+this.width,this.position.y+this.height/2),t.stroke()),t.fillStyle=this.style.thumbColor,t.beginPath(),t.arc(this.position.x+this.style.thumbRadius+this.thumbFill,this.position.y+this.height/2,this.style.thumbRadius,0,a.Constant.TAU),t.fill()}paintLOD1(){let t=this.context;t.strokeStyle="#000",t.fillStyle=this.style.color,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillRect(this.position.x,this.position.y,this.width,this.height)}offPaint(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)}reflow(){this.thumbFill=(0,n.denormalize)((0,n.normalize)(this.value,this.min,this.max),0,this.width-2*this.style.thumbRadius),this.input&&this.input.position.assign(this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.position.y+this.height/2),this.output&&this.output.position.assign(this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.position.y+this.height/2)}onPropChange(t,e){this._value=e,this.reflow(),this.output&&this.output.setData(this.value)}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||this.call("down",this,t,e)}onUp(t,e){this.disabled||this.call("up",this,t,e)}onClick(t,e){this.disabled||this.call("click",this,t,e)}onDrag(t,e){if(this.disabled)return;let i=this.position.y+this.height/2-this.style.railHeight/2;this.thumbFill=e.clamp(this.position.x+this.style.thumbRadius,this.position.x+this.width-this.style.thumbRadius,i,i).subtractInPlace(this.position.x+this.style.thumbRadius,0).x,this.value=(0,n.denormalize)((0,n.normalize)(this.thumbFill,0,this.width-2*this.style.thumbRadius),this.min,this.max),this.call("drag",this,t,e)}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||this.call("exit",this,t,e)}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){this.disabled}serialize(){return{min:this.min,max:this.max,value:this.value,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,height:this.height,style:this.style,id:this.id,hitColor:this.hitColor.serialize(),type:this.type,childs:[]}}static deSerialize(t,e){return new u(t,e.min,e.max,{value:e.value,propName:e.propName,input:e.input,output:e.output,height:e.height,style:e.style,id:e.id,hitColor:r.Color.deSerialize(e.hitColor)})}}e.Slider=u;let d=(t,e)=>({color:"#444",thumbColor:"#000",railHeight:3,thumbRadius:void 0!==e?e/2:1.5*t.style.rowHeight/2}),p=t=>({height:1.5*t.style.rowHeight})},8002:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Source=void 0;const s=i(7900),o=i(7892),n=i(5124),h=i(7799),r=i(5120),l=i(2681),a=i(1278),u=i(6894),d=i(712),p=i(974);class c extends l.UINode{constructor(t,e=g(t)){super(t,o.Vector2.Zero(),l.UIType.Source,{style:e.style?{...f(),...e.style}:f(),propName:e.propName,input:e.input&&("boolean"==typeof e.input?new s.Terminal(t,s.TerminalType.IN,"file","",{}):s.Terminal.deSerialize(t,e.input)),output:e.output&&("boolean"==typeof e.output?new s.Terminal(t,s.TerminalType.OUT,"file","",{}):s.Terminal.deSerialize(t,e.output)),id:e.id,hitColor:e.hitColor}),this.accept=e.accept,this.height=(0,p.get)(e.height,this.node.style.rowHeight),this.setupInputElement(e),this.label=new r.Label(this.node,"Select",{style:{align:d.Align.Center,...this.style},height:this.height}),this.fileIcon=new h.Image(this.node,n.fileIcon),this.label.on("click",(()=>this.htmlInput.click())),this.children.push(this.label,this.fileIcon),this.input&&(this.input.on("connect",((t,e)=>{e.data&&(this.file=e.data)})),this.input.on("data",((t,e)=>{e&&(this.file=e)}))),this.output&&this.output.on("connect",((t,e)=>e.data=this.file)),this.node.on("process",(()=>{this.output&&this.output.setData(this.file)}))}get file(){return this.propName?this.getProp():this._file}set file(t){let e=this.file,i=t;this.propName?this.setProp(i):(this._file=i,this.label.text=i.name.substring(0,this._file.name.toString().lastIndexOf("."))),this.node.flow.state!==u.FlowState.Stopped&&this.call("change",this,e,i)}setupInputElement(t){this.htmlInput=document.createElement("input"),this.htmlInput.type="file",t.accept&&(this.htmlInput.accept=t.accept),this.htmlInput.onchange=()=>{if(this.htmlInput.files.length>0){let t=this.file;this.file=this.htmlInput.files[0],this.node.flow.state===u.FlowState.Stopped&&this.call("upload",this,t,this.file)}}}paint(){this.context.strokeStyle=this.style.borderColor,this.context.strokeRect(this.position.x,this.position.y,this.width,this.height)}paintLOD1(){let t=this.context;t.strokeStyle=this.style.borderColor,t.fillStyle=this.style.color,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillRect(this.position.x,this.position.y,this.width,this.height)}offPaint(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)}reflow(){this.label.width=this.width,this.label.height=this.height,this.label.position=this.position,this.fileIcon.width=.1*this.width,this.fileIcon.position.assign(this.position.x+5,this.position.y+this.height/2-this.fileIcon.height/2),this.input&&this.input.position.assign(this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.position.y+this.height/2),this.output&&this.output.position.assign(this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.position.y+this.height/2)}onPropChange(t,e){this._file=e,this.label.text=this._file.name.substring(0,this._file.name.toString().lastIndexOf(".")),this.output&&this.output.setData(this._file)}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||this.call("down",this,t,e)}onUp(t,e){this.disabled||this.call("up",this,t,e)}onClick(t,e){this.disabled||this.call("click",this,t,e)}onDrag(t,e){this.disabled||this.call("drag",this,t,e)}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||this.call("exit",this,t,e)}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){this.disabled}serialize(){return{accept:this.accept,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,height:this.height,style:this.style,id:this.id,hitColor:this.hitColor.serialize(),type:this.type,childs:[]}}static deSerialize(t,e){return new c(t,{accept:e.accept,propName:e.propName,input:e.input,output:e.output,height:e.height,style:e.style,id:e.id,hitColor:a.Color.deSerialize(e.hitColor)})}}e.Source=c;let f=()=>({borderColor:"#000",visible:!0}),g=t=>({height:1.5*t.style.rowHeight})},8735:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Stack=void 0;const s=i(1278),o=i(7892),n=i(8637),h=i(2681);class r extends h.UINode{constructor(t,e=a()){super(t,o.Vector2.Zero(),h.UIType.Stack,{style:e.style?{...l(),...e.style}:l(),id:e.id,hitColor:e.hitColor}),e.childs&&this.children.push(...e.childs)}paint(){}paintLOD1(){}offPaint(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)}reflow(){let t=this.children.filter((t=>t.visible)),e=t.reduce(((t,e)=>t+e.height),0),i=(t.length-1)*this.style.spacing;this.height=e+i;let s=this.position.y;t.forEach((t=>{t.position.assign(this.position.x,s),t.width=this.width,s+=t.height+this.style.spacing}))}onPropChange(){}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||this.call("down",this,t,e)}onUp(t,e){this.disabled||this.call("up",this,t,e)}onClick(t,e){this.disabled||this.call("click",this,t,e)}onDrag(t,e){this.disabled||this.call("drag",this,t,e)}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||this.call("exit",this,t,e)}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){}serialize(){return{style:this.style,id:this.id,hitColor:this.hitColor.serialize(),type:this.type,propName:null,input:null,output:null,childs:this.children.map((t=>t.serialize()))}}static deSerialize(t,e){let i=new r(t,{style:e.style,id:e.id,hitColor:s.Color.deSerialize(e.hitColor),childs:[]});return i.children.push(...e.childs.map((e=>{switch(e.type){case h.UIType.Button:return n.Button.deSerialize(t,e);case h.UIType.Container:return n.Container.deSerialize(t,e);case h.UIType.Display:return n.Display.deSerialize(t,e);case h.UIType.HorizontalLayout:case h.UIType.Stack:return r.deSerialize(t,e);case h.UIType.Image:return n.Image.deSerialize(t,e);case h.UIType.Input:return n.Input.deSerialize(t,e);case h.UIType.Label:return n.Label.deSerialize(t,e);case h.UIType.Select:return n.Select.deSerialize(t,e);case h.UIType.Slider:return n.Slider.deSerialize(t,e);case h.UIType.Source:return n.Source.deSerialize(t,e);case h.UIType.Toggle:return n.Toggle.deSerialize(t,e);default:return}}))),i}}e.Stack=r;let l=()=>({spacing:0,visible:!0}),a=()=>({})},6369:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Toggle=void 0;const s=i(7900),o=i(7892),n=i(2681),h=i(1278),r=i(6894),l=i(974),a=i(3612);class u extends n.UINode{constructor(t,e=d(t)){super(t,o.Vector2.Zero(),n.UIType.Toggle,{style:e.style?{...p(),...e.style}:p(),propName:e.propName,input:e.input&&("boolean"==typeof e.input?new s.Terminal(t,s.TerminalType.IN,"boolean","",{}):s.Terminal.deSerialize(t,e.input)),output:e.output&&("boolean"==typeof e.output?new s.Terminal(t,s.TerminalType.OUT,"boolean","",{}):s.Terminal.deSerialize(t,e.output)),id:e.id,hitColor:e.hitColor}),this._checked=!1,this._checked=this.propName?this.getProp():e.value,this.height=(0,l.get)(e.height,this.node.style.rowHeight),this.style.grow||(this.width=2.5*this.height),this.input&&(this.input.on("connect",((t,e)=>{e.data&&(this.checked=e.data)})),this.input.on("data",((t,e)=>{void 0!==e&&(this.checked=e)}))),this.output&&this.output.on("connect",((t,e)=>e.data=this.checked)),this.node.on("process",(()=>{this.output&&this.output.setData(this.checked)}))}get checked(){return this.propName?this.getProp():this._checked}set checked(t){let e=this.checked,i=t;this.propName?this.setProp(i):this._checked=i,this.node.flow.state!==r.FlowState.Stopped&&this.call("change",this,e,i)}paint(){let t=this.context;t.strokeStyle=this.style.backgroundColor,t.lineWidth=.75*this.height,t.lineCap="round",t.beginPath(),t.moveTo(this.position.x+this.context.lineWidth/2,this.position.y+this.height/2),t.lineTo(this.position.x+this.width-this.context.lineWidth/2,this.position.y+this.height/2),t.stroke(),t.fillStyle=this.style.color,t.beginPath(),t.arc(this.checked?this.position.x+this.width-this.height/2:this.position.x+this.height/2,this.position.y+this.height/2,this.height/2,0,a.Constant.TAU),t.fill()}paintLOD1(){let t=this.context;t.strokeStyle=this.style.color,t.fillStyle=this.style.backgroundColor,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillRect(this.position.x,this.position.y,this.width,this.height)}offPaint(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)}reflow(){this.input&&this.input.position.assign(this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.position.y+this.height/2),this.output&&this.output.position.assign(this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.position.y+this.height/2)}onPropChange(t,e){this._checked=e,this.output&&this.output.setData(this.checked)}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||this.call("down",this,t,e)}onUp(t,e){this.disabled||this.call("up",this,t,e)}onClick(t,e){this.disabled||(this.checked=!this.checked,this.call("click",this,t,e))}onDrag(t,e){this.disabled||this.call("drag",this,t,e)}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||this.call("exit",this,t,e)}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){this.disabled}serialize(){return{checked:this.checked,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,height:this.height,style:this.style,id:this.id,hitColor:this.hitColor.serialize(),type:this.type,childs:[]}}static deSerialize(t,e){return new u(t,{propName:e.propName,input:e.input,output:e.output,height:e.height,style:e.style,id:e.id,hitColor:h.Color.deSerialize(e.hitColor)})}}e.Toggle=u;let d=t=>({value:!1,height:1.5*t.style.rowHeight}),p=()=>({backgroundColor:"#999",color:"#000",visible:!0})},2681:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UIType=e.UINode=void 0;const s=i(1278),o=i(7417),n=i(7055),h=i(712),r=i(974);class l extends o.Hooks{constructor(t,e,i,s=u()){super(),this.node=t,this.type=i,this.width=0,this.height=0,this.setHitColor(s.hitColor),this.id=(0,r.get)(s.id,(0,r.getNewUUID)()),this.draggable=(0,r.get)(s.draggable,!1),this.zoomable=(0,r.get)(s.zoomable,!1),this._visible=(0,r.get)(s.visible,!0),this.style=(0,r.get)(s.style,{}),this.children=[],this.position=e,this.disabled=!1,this.propName=s.propName,this.propName&&this.node.watch(this.propName,((t,e)=>this.onPropChange(t,e))),this.input=s.input,this.output=s.output,this.input&&(this.node.inputsUI.push(this.input),this.input.on("connect",(()=>this.disabled=!0)),this.input.on("disconnect",(()=>this.disabled=!1))),this.output&&this.node.outputsUI.push(this.output)}get context(){return this.node.context}get offUIContext(){return this.node.offUIContext}get disabled(){return this._disabled}set disabled(t){this._disabled=t,this.children.forEach((e=>e.disabled=t))}get visible(){return this._visible}set visible(t){this._visible=t,this.node.ui.update()}append(t){Array.isArray(t)?this.children.push(...t):this.children.push(t),this.update(),this.node.ui.update()}update(){this.reflow(),this.call("update",this),this.children.forEach((t=>t.update()))}updateRenderState(){if(this.node.renderState.nodeState===n.NodeState.MINIMIZED)return;let t=this.position.transform(this.node.flow.flowConnect.transform);this.renderState=(0,r.intersects)(0,0,this.node.flow.flowConnect.canvasDimensions.width,this.node.flow.flowConnect.canvasDimensions.height,t.x,t.y,t.x+this.width*this.node.flow.flowConnect.scale,t.y+this.height*this.node.flow.flowConnect.scale),this.children.forEach((t=>t.updateRenderState()))}setHitColor(t){if(!t)for(t=s.Color.Random();this.node.uiNodes.get(t.rgbaString)||this.node.terminals.get(t.rgbaString);)t=s.Color.Random();this.hitColor=t,this.node.uiNodes.set(this.hitColor.rgbaString,this)}render(){if(!this.visible)return;if(this.renderState===h.ViewPort.OUTSIDE)return;let t=this.context;this.node.renderState.lod===h.LOD.LOD1?(t.save(),this.paintLOD1(),t.restore()):this.node.renderState.lod===h.LOD.LOD2?(t.save(),this.paint(),t.restore(),this.offUIContext.save(),this.offPaint(),this.offUIContext.restore()):this.type===a.Container&&(t.save(),this.paintLOD1(),t.restore()),this.node.renderState.lod>0&&(this.input&&this.input.render(),this.output&&this.output.render()),this.call("render",this),this.children.forEach((t=>t.render()))}getProp(){return this.node.state[this.propName]}setProp(t){this.node.state[this.propName]=t}query(t){let e=[];t=t.trim();let i=[this];for(;0!==i.length;){let s=i.shift();s.type===t&&e.push(s),s.children.forEach((t=>i.push(t)))}return e}}var a;e.UINode=l,function(t){t.Button="button",t.Container="container",t.Display="display",t.HorizontalLayout="horizontal-layout",t.Stack="stack",t.Image="image",t.Input="input",t.Label="label",t.Select="select",t.Slider="slider",t.Dial="dial",t.Source="source",t.Toggle="toggle",t.Envelope="envelope",t.RadioGroup="radiogroup",t.Slider2D="slider2d",t.VSlider="vslider"}(a=e.UIType||(e.UIType={}));let u=()=>({draggable:!1,zoomable:!1,visible:!0,style:{},propName:null,input:null,output:null,id:(0,r.getNewUUID)(),hitColor:null})},510:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VSlider=void 0;const s=i(7900),o=i(7892),n=i(974),h=i(2681),r=i(1278),l=i(6894),a=i(3612);class u extends h.UINode{constructor(t,e,i,r=p(t)){super(t,o.Vector2.Zero(),h.UIType.VSlider,{draggable:!0,style:r.style?{...d(t,r.width),...r.style}:d(t,r.width),propName:r.propName,input:r.input&&("boolean"==typeof r.input?new s.Terminal(t,s.TerminalType.IN,"number","",{}):s.Terminal.deSerialize(t,r.input)),output:r.output&&("boolean"==typeof r.output?new s.Terminal(t,s.TerminalType.OUT,"number","",{}):s.Terminal.deSerialize(t,r.output)),id:r.id,hitColor:r.hitColor}),this.min=e,this.max=i,this.height=(0,n.get)(r.height,5*this.node.style.rowHeight),this.width=(0,n.get)(r.width,this.node.style.rowHeight),this._value=this.propName?this.getProp():(0,n.get)(r.value,e),this._value=(0,n.clamp)(this._value,this.min,this.max),this.input&&(this.input.on("connect",((t,e)=>{e.data&&(this.value=e.data)})),this.input.on("data",((t,e)=>{e&&(this.value=e)}))),this.output&&this.output.on("connect",((t,e)=>e.data=this.value)),this.node.on("process",(()=>{this.output&&this.output.setData(this.value)}))}get value(){return this.propName?this.getProp():this._value}set value(t){t=(0,n.clamp)(t,this.min,this.max);let e=this.value,i=t;this.propName?this.setProp(i):(this._value=i,this.reflow()),this.node.flow.state!==l.FlowState.Stopped&&this.call("change",this,e,i)}paint(){let t=this.context;t.lineWidth=this.style.railWidth,t.strokeStyle=this.style.color,t.lineCap="butt";let e=Math.max(this.position.y,this.position.y+this.thumbFill-3);e!==this.position.y&&(t.beginPath(),t.moveTo(this.position.x+this.width/2,this.position.y),t.lineTo(this.position.x+this.width/2,e),t.stroke()),e=Math.min(this.position.y+2*this.style.thumbRadius+this.thumbFill+3,this.position.y+this.height),e!==this.position.y+this.height&&(t.beginPath(),t.moveTo(this.position.x+this.width/2,e),t.lineTo(this.position.x+this.width/2,this.position.y+this.height),t.stroke()),t.fillStyle=this.style.thumbColor,t.beginPath(),t.arc(this.position.x+this.width/2,this.position.y+this.style.thumbRadius+this.thumbFill,this.style.thumbRadius,0,a.Constant.TAU),t.fill()}paintLOD1(){let t=this.context;t.strokeStyle="#000",t.fillStyle=this.style.color,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillRect(this.position.x,this.position.y,this.width,this.height)}offPaint(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)}reflow(){this.thumbFill=(0,n.denormalize)(1-(0,n.normalize)(this.value,this.min,this.max),0,this.height-2*this.style.thumbRadius),this.input&&this.input.position.assign(this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.position.y+this.height/2),this.output&&this.output.position.assign(this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.position.y+this.height/2)}onPropChange(t,e){this._value=e,this.reflow(),this.output&&this.output.setData(this.value)}onOver(t,e){this.disabled||this.call("over",this,t,e)}onDown(t,e){this.disabled||this.call("down",this,t,e)}onUp(t,e){this.disabled||this.call("up",this,t,e)}onClick(t,e){this.disabled||this.call("click",this,t,e)}onDrag(t,e){if(this.disabled)return;let i=this.position.x+this.width/2-this.style.railWidth/2;this.thumbFill=e.clamp(i,i,this.position.y+this.style.thumbRadius,this.position.y+this.height-this.style.thumbRadius).subtractInPlace(0,this.position.y+this.style.thumbRadius).y,this.value=(0,n.denormalize)(1-(0,n.normalize)(this.thumbFill,0,this.height-2*this.style.thumbRadius),this.min,this.max),this.call("drag",this,t,e)}onEnter(t,e){this.disabled||this.call("enter",this,t,e)}onExit(t,e){this.disabled||this.call("exit",this,t,e)}onWheel(t,e,i){this.disabled||this.call("wheel",this,t,e,i)}onContextMenu(){this.disabled}serialize(){return{min:this.min,max:this.max,value:this.value,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,height:this.height,width:this.width,style:this.style,id:this.id,hitColor:this.hitColor.serialize(),type:this.type,childs:[]}}static deSerialize(t,e){return new u(t,e.min,e.max,{value:e.value,propName:e.propName,input:e.input,output:e.output,height:e.height,width:e.width,style:e.style,id:e.id,hitColor:r.Color.deSerialize(e.hitColor)})}}e.VSlider=u;let d=(t,e)=>({color:"#444",thumbColor:"#000",railWidth:4,thumbRadius:void 0!==e?e/2:1.5*t.style.rowHeight/2}),p=t=>({height:5*t.style.rowHeight,width:t.style.rowHeight})},1141:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AVLTreeNode=e.AVLTree=void 0;e.AVLTree=class{constructor(t,e){this.comparator=t,this.dataToTreeNodeMapper=e,this.root=null,this.dataRefToTreeNode={},this.size=0}height(t){return t?t.height:0}rightRotate(t){let e=t.left;return t.left=e.right,e.right=t,t.height=Math.max(t.left?t.left.height:0,t.right?t.right.height:0)+1,e.height=Math.max(e.left?e.left.height:0,e.right?e.right.height:0)+1,e}leftRotate(t){let e=t.right;return t.right=e.left,e.left=t,t.height=Math.max(t.left?t.left.height:0,t.right?t.right.height:0)+1,e.height=Math.max(e.left?e.left.height:0,e.right?e.right.height:0)+1,e}getBalance(t){return t?(t.left?t.left.height:0)-(t.right?t.right.height:0):0}add(t){let e={node:null};return this.root=this._insert(this.root,t,e),this.dataRefToTreeNode[this.dataToTreeNodeMapper(t)]=e.node,this.size+=1,e.node}_insert(t,e,s){if(!t){let t=new i([e]);return s.node=t,t}if(0===this.comparator(e,t.data[0]))return t.data.push(e),s.node=t,t;this.comparator(e,t.data[0])<0?t.left=this._insert(t.left,e,s):t.right=this._insert(t.right,e,s),t.height=1+Math.max(t.left?t.left.height:0,t.right?t.right.height:0);let o=this.getBalance(t);return o>1&&this.comparator(e,t.left.data[0])<0?this.rightRotate(t):o>1&&this.comparator(e,t.left.data[0])>0?(t.left=this.leftRotate(t.left),this.rightRotate(t)):o<-1&&this.comparator(e,t.right.data[0])>0?this.leftRotate(t):o<-1&&this.comparator(e,t.right.data[0])<0?(t.right=this.rightRotate(t.right),this.leftRotate(t)):t}remove(t){let e={deleted:!1};return this.root=this._delete(this.root,t,e),delete this.dataRefToTreeNode[this.dataToTreeNodeMapper(t)],this.size-=1,e.deleted}_delete(t,e,i){if(!t)return t;if(this.comparator(e,t.data[0])<0)t.left=this._delete(t.left,e,i);else if(this.comparator(e,t.data[0])>0)t.right=this._delete(t.right,e,i);else{if(t.data.length>1){let s=t.data.findIndex((t=>this.dataToTreeNodeMapper(t)===this.dataToTreeNodeMapper(e)));return s>-1?(t.data.splice(s,1),i.deleted=!0):i.deleted=!1,t}if(t.left&&t.right){let e=this.minValue(t.right);t.data=e.data,t.right=this._delete(t.right,e.data[0],i),i.deleted=!0}else{let e=null;e=t.left?t.left:t.right,t=e||null,i.deleted=!0}}if(!t)return t;t.height=Math.max(t.left?t.left.height:0,t.right?t.right.height:0)+1;let s=this.getBalance(t);return s>1&&this.getBalance(t.left)>=0?this.rightRotate(t):s>1&&this.getBalance(t.left)<0?(t.left=this.leftRotate(t.left),this.rightRotate(t)):s<-1&&this.getBalance(t.right)<=0?this.leftRotate(t):s<-1&&this.getBalance(t.right)>0?(t.right=this.rightRotate(t.right),this.leftRotate(t)):t}minValue(t){let e=t;for(;e.left;)e=e.left;return e}forEach(t){this._inorder(this.root,t)}_inorder(t,e){null!==t&&(this._inorder(t.left,e),t.data.forEach((t=>e(t))),this._inorder(t.right,e))}_reverseInorder(t,e){null!==t&&(this._inorder(t.right,e),t.data.forEach((t=>e(t))),this._inorder(t.left,e))}};class i{constructor(t){this.data=t,this.height=1,this.left=null,this.right=null}}e.AVLTreeNode=i},296:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BiMap=void 0;e.BiMap=class{constructor(){this.map=new Map,this.reverseMap=new Map}get(t){return this.map.get(t)||this.reverseMap.get(t)}set(t,e){this.map.set(t,e),this.reverseMap.set(e,t)}has(t){return this.map.has(t)||this.reverseMap.has(t)}delete(t){let e=this.map.get(t),i=this.reverseMap.get(t);void 0!==e&&this.map.delete(t),void 0!==i&&this.reverseMap.delete(t),this.map.delete(e),this.reverseMap.delete(e),this.map.delete(i),this.reverseMap.delete(i)}clear(){this.map.clear(),this.reverseMap.clear()}}},9433:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Evaluator=void 0;const s=i(3814),o=i(3612),n=i(3855);class h{constructor(t){this.variables=t,this.history={},this.orderedExprs=[],this.historyLimit=3,this.parser=new n.Parser}evaluate(t,e){let i;if(this.history[t])i=this.history[t];else{if(this.orderedExprs.length===this.historyLimit){let t=this.orderedExprs.shift();delete this.history[t]}this.orderedExprs.push(t),this.history[t]=this.parser.parse(t),i=this.history[t]}let o=[];for(let t of i)switch(t.type){case s.TokenType.Literal:o.push(t.value);break;case s.TokenType.Variable:if(t.value!==t.value.toLowerCase()){if(!Array.isArray(this.variables[t.value]))throw new Error("Spread operator only allowed for array variables: "+t.value.toLowerCase());o.push(this.variables[t.value])}else Array.isArray(this.variables[t.value])&&void 0!==e?o.push(this.variables[t.value][e]):o.push(this.variables[t.value]);break;case s.TokenType.Operator:{let[e,i]=[o.pop(),o.pop()];if("number"!=typeof e||"number"!=typeof i)throw new Error("Only numbers are allowed for operators");switch(t.value){case"+":o.push(e+i);break;case"*":o.push(e*i);break;case"-":o.push(i-e);break;case"/":o.push(i/e);break;case"%":o.push(i%e);break;case"^":o.push(Math.pow(i,e));break;case"&":o.push(i&e);break;case"|":o.push(i|e);break;default:throw new Error("Unknow operator: "+t.value)}break}case s.TokenType.Function:{let e=[];for(let i=0;i<t.count;i+=1)e.push(o.pop());o.push(h.functions[t.value](...e));break}default:throw new Error("Unknown token type: "+t.type)}return o[0]}}e.Evaluator=h,h.constants={tau:o.Constant.TAU,pi:Math.PI,phi:o.Constant.PHI,ln2:Math.LN2,ln10:Math.LN10,log2e:Math.LOG2E,log10e:Math.LOG10E},h.functions={cos:Math.cos,acos:Math.acos,acosh:Math.acosh,sin:Math.sin,asin:Math.asin,asinh:Math.asinh,tan:Math.tan,atan:Math.atan,atanh:Math.atanh,atan2:Math.atan2,abs:Math.abs,ceil:Math.ceil,round:Math.round,floor:Math.floor,exp:Math.exp,random:Math.random,sqrt:Math.sqrt,cbrt:Math.cbrt,log10:Math.log10,log2:Math.log2,log:(t,e)=>e?Math.log(t)/Math.log(e):Math.log(t),dist:(t,e,i,s)=>Math.sqrt(Math.pow(i-t,2)+Math.pow(s-e,2)),gcd:(t,e)=>{for(;0!==e;){const i=t%e;t=e,e=i}return t<0?-t:t},max:(...t)=>Array.isArray(t[0])?Math.max(...t[0]):Math.max(...t),min:(...t)=>Array.isArray(t[0])?Math.min(...t[0]):Math.min(...t),hypot:(...t)=>{let e=0,i=0;return(Array.isArray(t[0])?t[0]:t).forEach((t=>{const s=Math.abs(t);i<s?(e=e*(i/s)*(i/s),e+=1,i=s):e+=s>0?s/i*(s/i):s})),i*Math.sqrt(e)},lcm:(t,e)=>{if(0===t)return t;if(0===e)return e;const i=t*e;for(;0!==e;){const i=e;e=t%i,t=i}return Math.abs(i/t)},sum:(...t)=>(Array.isArray(t[0])?t[0]:t).reduce(((t,e)=>t+e),0),mean:(...t)=>{let e=Array.isArray(t[0])?t[0]:t;return h.functions.sum(e)/e.length},median:(...t)=>{let e=Array.isArray(t[0])?t[0]:t;return e.sort(((t,e)=>t-e)),e.length%2==0?(e[e.length/2-1]+e[e.length/2])/2:e[Math.floor(e.length/2)]},std:(...t)=>{let e=Array.isArray(t[0])?t[0]:t;return Math.sqrt(h.functions.var(e))},var:(...t)=>{let e=Array.isArray(t[0])?t[0]:t,i=h.functions.mean(e);return e.reduce(((t,e)=>t+Math.pow(e-i,2)),0)/e.length},fact:t=>{let e=1;for(let i=t;i>1;i-=1)e*=i;return e}},h.multiargFunctions=["max","min","hypot","sum","mean","median","std","var"]},5928:function(t,e,i){var s=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var o=Object.getOwnPropertyDescriptor(e,i);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,o)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),o=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||s(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),o(i(1141),e),o(i(9433),e),o(i(3814),e),o(i(8240),e),o(i(6645),e),o(i(3855),e),o(i(974),e),o(i(296),e)},3814:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Token=e.TokenType=e.Lexer=void 0;const s=i(9433);class o{constructor(){this.result=[],this.numberBuffer=[],this.letterBuffer=[]}tokenize(t){let e;for(this.result=[],this.numberBuffer=[],this.letterBuffer=[];-1!==(e=t.indexOf("..."));)t=t.substring(0,e)+t.charAt(e+3).toUpperCase()+t.substring(e+4);return(t=this.replaceConstants(t)).replace(/\s+/g,"").split("").forEach((t=>{if(this.isDigit(t))this.numberBuffer.push(t);else if(this.isDecimalPoint(t))this.numberBuffer.push(t);else if(this.isLetter(t))this.numberBuffer.length&&(this.processNumberBuffer(),this.result.push(new h(n.Operator,"*"))),this.letterBuffer.push(t);else if(this.isOperator(t))this.numberBuffer.length?this.processNumberBuffer():this.letterBuffer.length&&this.processLetterBuffer(),this.result.push(new h(n.Operator,t));else if(this.isLeftParenthesis(t))this.letterBuffer.length?(this.result.push(new h(n.Function,this.letterBuffer.join(""))),this.letterBuffer=[]):this.numberBuffer.length&&(this.processNumberBuffer(),this.result.push(new h(n.Operator,"*"))),this.result.push(new h(n.LParenthesis,t));else if(this.isRightParenthesis(t))this.letterBuffer.length&&this.processLetterBuffer(),this.numberBuffer.length&&this.processNumberBuffer(),this.result.push(new h(n.RParenthesis,t));else{if(!this.isComma(t))throw Error("Unknown character: "+t);this.numberBuffer.length&&this.processNumberBuffer(),this.letterBuffer.length&&this.processLetterBuffer(),this.result.push(new h(n.ArgSeperator,t))}})),this.numberBuffer.length&&this.processNumberBuffer(),this.letterBuffer.length&&this.processLetterBuffer(),this.result}replaceConstants(t){return t.replace(/pi/g,s.Evaluator.constants.pi.toString()).replace(/tau/g,s.Evaluator.constants.tau.toString()).replace(/phi/g,s.Evaluator.constants.phi.toString()).replace(/ln2/g,s.Evaluator.constants.ln2.toString()).replace(/ln10/g,s.Evaluator.constants.ln10.toString()).replace(/log2e/g,s.Evaluator.constants.log2e.toString()).replace(/log10e/g,s.Evaluator.constants.log10e.toString())}processNumberBuffer(){let t=parseFloat(this.numberBuffer.join(""));this.numberBuffer=[],isNaN(t)||this.result.push(new h(n.Literal,t))}processLetterBuffer(){for(var t=0;t<this.letterBuffer.length;t++)this.result.push(new h(n.Variable,this.letterBuffer[t])),t<this.letterBuffer.length-1&&this.result.push(new h(n.Operator,"*"));this.letterBuffer=[]}isComma(t){return","===t}isDigit(t){return/\d/.test(t)}isLetter(t){return/[a-zA-Z]/.test(t)}isOperator(t){return o.operators.includes(t)}isLeftParenthesis(t){return"("===t}isRightParenthesis(t){return")"==t}isDecimalPoint(t){return"."===t}}var n;e.Lexer=o,o.operators=["+","-","*","/","^","%","&","|"],function(t){t.Literal="Literal",t.Variable="Variable",t.Operator="Operator",t.LParenthesis="LParenthesis",t.RParenthesis="RParenthesis",t.Function="Function",t.ArgSeperator="ArgSeperator"}(n=e.TokenType||(e.TokenType={}));class h{constructor(t,e){this.type=t,this.value=e,this.count=0}get precedence(){return h.precedence[this.value]}get associativity(){return h.associativity[this.value]}toString(){return this.type+"("+this.value+")"}}e.Token=h,h.associativity={"^":"right","*":"left","/":"left","+":"left","-":"left","%":"left","&":"left","|":"left"},h.precedence={"|":0,"&":1,"+":2,"-":2,"*":3,"/":3,"%":3,"^":4}},8240:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ListNode=e.List=void 0;const s=i(7417);class o extends s.Hooks{constructor(t,e){super(),this.comparator=t,this.head=null,this.tail=null,this.length=0,e&&e.forEach((t=>this.append(t)))}prepend(t){let e=new n(t);return null===this.head?(this.head=e,this.tail=e):(this.head.prev=e,e.next=this.head,this.head=e),this.length+=1,this.call("prepend",this,e),e}append(t){let e=t instanceof n?t:new n(t);return null===this.tail?(this.head=e,this.tail=e):(this.tail.next=e,e.prev=this.tail,this.tail=e),this.length+=1,this.call("append",this,e),e}removeFirst(t=!0){let e;return null===this.head?null:(1===this.length?(e=this.head.data,this.head=null,this.tail=null):(e=this.head.data,this.head.next.prev=null,this.head=this.head.next),this.length-=1,t&&this.call("removefirst",this,e),e)}removeLast(){let t;return null===this.tail?null:(1===this.length?(t=this.tail.data,this.head=null,this.tail=null):(t=this.tail.data,this.tail.prev.next=null,this.tail=this.tail.prev),this.length-=1,this.call("removelast",this,t),t)}addAfter(t,e){let i=new n(t);return i.next=e.next,i.prev=e,e.next=i,i.next&&(i.next.prev=i),e===this.tail&&(this.tail=i),this.length+=1,i}addBefore(t,e){let i=new n(t);return i.prev=e.prev,i.next=e,e.prev=i,i.prev&&(i.prev.next=i),e===this.head&&(this.head=i),this.length+=1,i}delete(t){1===this.length?(this.head=null,this.tail=null):t===this.head?this.removeFirst():t===this.tail?this.removeLast():(t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),this.length-=1)}searchHead(t){let e=this.head;for(;null!==e;){if(t(e))return e;e=e.next}return null}searchTail(t){let e=this.tail;for(;null!==e;){if(t(e))return e;e=e.prev}return null}get(t){if(t>=this.length)return null;if(0===t)return this.head?this.head.data:null;if(t===this.length-1)return this.tail?this.tail.data:null;{let e=0,i=this.head;for(;null!==i;){if(e===t)return i.data;e+=1,i=i.next}return null}}forEach(t){let e=this.head;for(;null!==e;)t(e),e=e.next}map(t){let e=[];return this.forEach((i=>e.push(t(i)))),e}toArray(){let t=[];return this.forEach((e=>t.push(e.data))),t}toString(){return this.toArray().join(", ")}}e.List=o;class n{constructor(t){this.prev=null,this.next=null,this.data=t||null}}e.ListNode=n},6645:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),e.Log=e.LogLevel=void 0,function(t){t[t.TRACE=1]="TRACE",t[t.DEBUG=2]="DEBUG",t[t.WARN=3]="WARN",t[t.INFO=4]="INFO",t[t.LOG=5]="LOG",t[t.ERROR=6]="ERROR",t[t.DISABLED=7]="DISABLED"}(i=e.LogLevel||(e.LogLevel={}));class s{static trace(...t){this.LOG_LEVEL>i.TRACE||console.trace.apply(this,t)}static debug(...t){this.LOG_LEVEL>i.DEBUG||console.debug.apply(this,t)}static warn(...t){this.LOG_LEVEL>i.WARN||console.warn.apply(this,t)}static info(...t){this.LOG_LEVEL>i.INFO||console.info.apply(this,t)}static log(...t){this.LOG_LEVEL>i.LOG||console.log.apply(this,t)}static error(...t){this.LOG_LEVEL>i.ERROR||console.error.apply(this,t)}}e.Log=s,s.LOG_LEVEL=i.INFO},3855:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Parser=void 0;const s=i(3814);e.Parser=class{constructor(){this.lexer=new s.Lexer}peek(t){return t.slice(-1)[0]}parse(t){let e=this.lexer.tokenize(t),i=[],o=[],n=[],h=[];for(e.forEach((t=>{if(t.type===s.TokenType.Literal||t.type===s.TokenType.Variable)o.push(t),void 0!==this.peek(n)&&(n.pop(),n.push(!0));else if(t.type===s.TokenType.Function)i.push(t),h.push(0),void 0!==this.peek(n)&&(n.pop(),n.push(!0)),n.push(!1);else if(t.type===s.TokenType.ArgSeperator){for(;this.peek(i)&&this.peek(i).type!==s.TokenType.LParenthesis;)o.push(i.pop());n.pop()&&h.push(h.pop()+1),n.push(!1)}else if(t.type==s.TokenType.Operator){for(;this.peek(i)&&this.peek(i).type===s.TokenType.Operator&&("left"===t.associativity&&t.precedence<=this.peek(i).precedence||"right"===t.associativity&&t.precedence<this.peek(i).precedence);)o.push(i.pop());i.push(t)}else if(t.type===s.TokenType.LParenthesis)i.push(t);else if(t.type===s.TokenType.RParenthesis){for(;this.peek(i)&&this.peek(i).type!==s.TokenType.LParenthesis;)o.push(i.pop());if(i.pop(),this.peek(i)&&this.peek(i).type===s.TokenType.Function){let t=i.pop(),e=h.pop();n.pop()&&(e+=1),t.count=e,o.push(t)}}}));this.peek(i);)o.push(i.pop());return o}}},974:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.noop=e.binarySearch=e.get=e.exists=e.isInRange=e.isEmpty=e.canConnect=e.lerp=e.clamp=e.intersects=e.getRandom=e.denormalize=e.normalize=e.getNewUUID=void 0;const s=i(712);e.getNewUUID=()=>{var t=()=>(65536*(1+Math.random())|0).toString(16).substring(1);return t()+"-"+t()+"-"+t()+"-"+t()};e.normalize=(t,e,i)=>e===i?1:(t-e)/(i-e);e.denormalize=(t,e,i)=>(i-e)*t+e;e.getRandom=(t,e)=>Math.random()*(e-t)+t;e.intersects=(t,e,i,o,n,h,r,l)=>!(n>i||r<t||h>o||l<e)?n<t||h<e||r>i||l>o?s.ViewPort.INTERSECT:s.ViewPort.INSIDE:s.ViewPort.OUTSIDE;e.clamp=(t,e,i)=>Math.min(Math.max(t,e),i);e.lerp=(t,e,i)=>(1-i)*t+i*e;e.canConnect=(t,e,i,s)=>!!e&&(t!==e&&(t.node!==e.node&&(t.type!==e.type&&(!!i[t.dataType].includes(e.dataType)&&!!s.canConnect(t.node,e.node)))));e.isEmpty=t=>{for(let e in t)return!1;return!0};e.isInRange=(t,e,i)=>Math.min(t,e)>=e&&Math.max(t,i)<=i;e.exists=t=>null!=t;e.get=(t,i)=>(0,e.exists)(t)?t:i;e.binarySearch=({max:t,getValue:e,match:i})=>{let s=0;for(;s<=t;){let o=Math.floor((s+t)/2);const n=e(o);if(n===i)return o;n<i?s=o+1:t=o-1}return t};e.noop=()=>{}}},i={};function s(t){var o=i[t];if(void 0!==o)return o.exports;var n=i[t]={exports:{}};return e[t].call(n.exports,n,n.exports,s),n.exports}s.m=e,t=[],s.O=(e,i,o,n)=>{if(!i){var h=1/0;for(u=0;u<t.length;u++){for(var[i,o,n]=t[u],r=!0,l=0;l<i.length;l++)(!1&n||h>=n)&&Object.keys(s.O).every((t=>s.O[t](i[l])))?i.splice(l--,1):(r=!1,n<h&&(h=n));if(r){t.splice(u--,1);var a=o();void 0!==a&&(e=a)}}return e}n=n||0;for(var u=t.length;u>0&&t[u-1][2]>n;u--)t[u]=t[u-1];t[u]=[i,o,n]},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={833:0};s.O.j=e=>0===t[e];var e=(e,i)=>{var o,n,[h,r,l]=i,a=0;if(h.some((e=>0!==t[e]))){for(o in r)s.o(r,o)&&(s.m[o]=r[o]);if(l)var u=l(s)}for(e&&e(i);a<h.length;a++)n=h[a],s.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return s.O(u)},i=self.webpackChunkflow_connect=self.webpackChunkflow_connect||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();var o=s(6184);return o=s.O(o)})()}));
//# sourceMappingURL=flow-connect.js.map