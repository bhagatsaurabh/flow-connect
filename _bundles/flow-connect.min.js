!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i,o=e();for(i in o)("object"==typeof exports?exports:t)[i]=o[i]}}(self,function(){return(()=>{"use strict";var o={278:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Color=void 0;var o=i(974),i=(n.Random=function(){return new n(new Uint8ClampedArray([Math.floor(o.getRandom(0,255)),Math.floor(o.getRandom(0,255)),Math.floor(o.getRandom(0,255)),255]))},n.hexToRGBA=function(t){return new Uint8ClampedArray([parseInt(t.slice(1,3),16),parseInt(t.slice(3,5),16),parseInt(t.slice(5,7),16),parseInt(t.slice(7,9),16)])},n._componentToHex=function(t){t=t.toString(16);return 1===t.length?"0"+t:t},n.rgbaToHex=function(t){return"#"+n._componentToHex(t[0])+n._componentToHex(t[1])+n._componentToHex(t[2])+n._componentToHex(t[3])},n.rgbaToString=function(t){return t[0]+":"+t[1]+":"+t[2]+":"+t[3]},n.rgbaToCSSString=function(t){return"rgba("+t[0]+", "+t[1]+", "+t[2]+", "+o.normalize(t[3],0,255).toFixed(3)+")"},n.prototype.serialize=function(){return{rgba:[this.rgbaValue[0],this.rgbaValue[1],this.rgbaValue[2],this.rgbaValue[3]]}},n.deSerialize=function(t){return new n(t.rgba)},n);function n(t){this.rgbaValue=t,this.hexValue=n.rgbaToHex(this.rgbaValue),this.rgbaString=n.rgbaToString(this.rgbaValue),this.rgbaCSSString=n.rgbaToCSSString(this.rgbaValue)}e.Color=i},907:function(t,e,i){var h=this&&this.__assign||function(){return(h=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Connector=void 0;var p=i(281),c=i(522),l=i(974),i=(Object.defineProperty(n.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,this.end&&this.end.call("data",t),this.flow.state===c.FlowState.Running&&this.flow.executionGraph.state!==c.GraphState.FullRun&&this.flow.executionGraph.setDirtyNode(this.endNode)},enumerable:!1,configurable:!0}),n.prototype.completeConnection=function(t){this.start?(this.end=t,this.endNode=this.end.node):(this.start=t,this.startNode=this.start.node),this.start.connectors.includes(this)||this.start.connectors.push(this),(this.end.connectors[0]=this).floatingTip=null,this.startNode.currHitTerminal&&this.startNode.currHitTerminal.onExit(null,null),this.startNode.currHitTerminal=null,this.endNode.currHitTerminal&&this.endNode.currHitTerminal.onExit(null,null),this.endNode.currHitTerminal=null,this.flow.executionGraph.connect(this.startNode,this.endNode),this.start.call("connect",this.start,this),this.end.call("connect",this.end,this)},n.prototype.removeConnection=function(){this.start&&(this.start.connectors.includes(this)&&this.start.connectors.splice(this.start.connectors.indexOf(this),1),this.startNode.currHitTerminal&&(this.startNode.currHitTerminal.onExit(null,null),this.startNode.currHitTerminal=null)),this.end&&(this.end.connectors.includes(this)&&this.end.connectors.splice(this.end.connectors.indexOf(this),1),this.endNode.currHitTerminal&&(this.endNode.currHitTerminal.onExit(null,null),this.endNode.currHitTerminal=null))},n.prototype.setData=function(t){this._data=t,this.end&&this.end.call("data",t)},n.prototype.canConnect=function(t){var e=this.start||this.end;return!!t&&(e!==t&&(e.node!==t.node&&(e.type!==t.type&&(!!this.flow.rules[e.dataType].includes(t.dataType)&&!!this.flow.executionGraph.canConnect(e.node,t.node)))))},n.prototype.render=function(){this.flow.flowConnect.context.save(),this._render(),this.flow.flowConnect.context.restore(),this.flow.flowConnect.offContext.save(),this._offRender(),this.flow.flowConnect.offContext.restore()},n.prototype._render=function(){var t,e,i=this.start?this.startNode.renderState.nodeState===c.NodeState.MAXIMIZED?(t=(s=[this.start.position.x,this.start.position.y])[0],s[1]):(t=(r=[this.startNode.position.x+this.startNode.width+this.startNode.style.terminalStripMargin+this.start.style.radius,this.startNode.position.y+this.startNode.style.titleHeight/2])[0],r[1]):(t=(h=[this.floatingTip.x,this.floatingTip.y])[0],h[1]),o=this.end?this.endNode.renderState.nodeState===c.NodeState.MAXIMIZED?(e=(l=[this.end.position.x,this.end.position.y])[0],l[1]):(e=(a=[this.endNode.position.x-this.endNode.style.terminalStripMargin-this.end.style.radius,this.endNode.position.y+this.endNode.style.titleHeight/2])[0],a[1]):(e=(u=[this.floatingTip.x,this.floatingTip.y])[0],u[1]),n=p.Vector2.Distance(t,i,e,o),s=[t+(n*=.2),i],r=s[0],h=s[1],l=[e-n,o],a=l[0],u=l[1],s=[(r+a)/2,(h+u)/2],n=s[0],l=s[1],s=this.flow.flowConnect.context;s.beginPath(),s.moveTo(t,i),s.quadraticCurveTo(r,h,n,l),s.moveTo(n,l),s.quadraticCurveTo(a,u,e,o),s.strokeStyle="grey",s.lineWidth=this.style.width+2,s.stroke(),s.beginPath(),s.moveTo(t,i),s.quadraticCurveTo(r,h,n,l),s.moveTo(n,l),s.quadraticCurveTo(a,u,e,o),s.strokeStyle=this.style.color,s.lineWidth=this.style.width,s.stroke()},n.prototype._offRender=function(){},n.prototype.serialize=function(){return{id:this.id,startId:this.start.id,endId:this.end.id,startNodeId:this.startNode.id,endNodeId:this.endNode.id,style:this.style}},n.deSerialize=function(t,e,i,o){return new n(t,e,i,null,o.style,o.id,!0)},n);function n(t,e,i,o,n,s,r){void 0===n&&(n={}),void 0===s&&(s=l.getNewGUID()),void 0===r&&(r=!1),this.flow=t,this.floatingTip=o,this.style=n,this.id=s,this.style=h(h({},c.Constant.DefaultConnectorStyle()),n),this.start=e,this.end=i,this.start&&(this.startNode=this.start.node),this.end&&(this.endNode=this.end.node),e&&i&&(this.floatingTip=null,this.start.connectors.push(this),0<this.end.connectors.length?(this.end.connectors[0].removeConnection(),this.end.connectors[0]=this):this.end.connectors.push(this),r||this.flow.executionGraph.connect(this.startNode,this.endNode),this.start.call("connect",this.start,this),this.end.call("connect",this.end,this))}e.Connector=i},894:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Flow=void 0;var r,u=i(55),s=i(417),h=i(166),l=i(907),a=i(141),p=i(587),c=i(915),d=i(974),f=i(522),y=i(571),n=(r=s.Hooks,n(g,r),g.prototype.registerListeners=function(){var t=this,e=this.flowConnect.on("transform",function(){return t.call("transform",t)});this.listeners.transform=e},g.prototype.deregisterListeners=function(){this.flowConnect.off("transform",this.listeners.transform),delete this.listeners.transform},g.prototype.existsInFlow=function(t){for(var e=0,i=Object.values(this.nodes);e<i.length;e++){var o=i[e];if(o.subFlow===t)return!0;if(o.subFlow)return o.subFlow.existsInFlow(t)}return!1},g.prototype.addInput=function(t,e,i){e=new c.TunnelNode(this,"Input",i,100,[],[{name:t,dataType:e}],{},{},{});return this.inputs.push(e),this.nodes[e.id]=e,this.sortedNodes.add(e),this.executionGraph.add(e),this.call("add-input",this,e),e},g.prototype.addOutput=function(t,e,i){e=new c.TunnelNode(this,"Output",i,100,[{name:t,dataType:e}],[],{},{},{});return this.outputs.push(e),this.nodes[e.id]=e,this.sortedNodes.add(e),this.executionGraph.add(e),this.call("add-output",this,e),e},g.prototype.addSubFlow=function(t,e){t=new p.SubFlowNode(this,t.name,e,150,{},{},{},t.inputs.map(function(t){return{name:t.outputs[0].name,dataType:t.outputs[0].dataType}}),t.outputs.map(function(t){return{name:t.inputs[0].name,dataType:t.inputs[0].dataType}}),t);return this.nodes[t.id]=t,this.sortedNodes.add(t),this.executionGraph.add(t),t},g.prototype.createNode=function(t,e,i,o,n,s,r,h){void 0===s&&(s={}),void 0===r&&(r={});var l=[],a=[];void 0!==o&&(l=o),void 0!==n&&(a=n);h=new u.Node(this,t,e,i,l,a,s,r,h);return this.nodes[h.id]=h,this.sortedNodes.add(h),this.executionGraph.add(h),h},g.prototype.removeNode=function(t){},g.prototype.removeConnector=function(t){this.connectors[t]===this.flowConnect.floatingConnector&&(this.flowConnect.floatingConnector=null),delete this.connectors[t]},g.prototype.removeAllFocus=function(){Object.values(this.nodes).forEach(function(t){return t.focused=!1})},g.prototype.render=function(){this.groups.forEach(function(t){return t.render()}),Object.values(this.connectors).forEach(function(t){return t.render()}),this.sortedNodes.forEach(function(t){return t.render()})},g.prototype.start=function(){this.state!==f.FlowState.Running&&(this.state=f.FlowState.Running,this.call("start",this),this.flowConnect.startGlobalTime(),this.executionGraph.start())},g.prototype.stop=function(){this.state!==f.FlowState.Stopped&&(this.state=f.FlowState.Stopped,this.call("stop",this),this.flowConnect.stopGlobalTime(),Object.values(this.nodes).forEach(function(t){t instanceof p.SubFlowNode&&t.subFlow.stop()}))},g.prototype.serialize=function(){return{id:this.id,name:this.name,rules:this.rules,terminalTypeColors:this.terminalTypeColors,nodes:Object.values(this.nodes).map(function(t){return t.serialize()}),groups:this.groups.map(function(t){return t.serialize()}),connectors:Object.values(this.connectors).map(function(t){return t.serialize()}),inputs:this.inputs.map(function(t){return t.serialize()}),outputs:this.outputs.map(function(t){return t.serialize()}),executionGraph:this.executionGraph.serialize()}},g.deSerialize=function(t,e){var o=new g(t,e.name,e.rules,e.terminalTypeColors,e.id);return e.nodes.forEach(function(t){t=(t.subFlow?p.SubFlowNode:u.Node).deSerialize(o,t);o.nodes[t.id]=t,o.sortedNodes.add(t)}),e.groups.forEach(function(t){var e=h.Group.deSerialize(o,t);o.groups.push(e),e.nodes.forEach(function(t){return t.group=e})}),e.inputs.forEach(function(t){t=c.TunnelNode.deSerialize(o,t);o.inputs.push(t),o.nodes[t.id]=t,o.sortedNodes.add(t)}),e.outputs.forEach(function(t){t=c.TunnelNode.deSerialize(o,t);o.outputs.push(t),o.nodes[t.id]=t,o.sortedNodes.add(t)}),e.connectors.forEach(function(e){var t=o.nodes[e.startNodeId],i=t.outputs.concat(t.outputsUI).find(function(t){return t.id===e.startId}),t=o.nodes[e.endNodeId],t=t.inputs.concat(t.inputsUI).find(function(t){return t.id===e.endId}),t=l.Connector.deSerialize(o,i,t,e);o.connectors[e.id]=t}),o.executionGraph=y.Graph.deSerialize(o,e.executionGraph),o},g);function g(t,e,i,o,n){void 0===n&&(n=d.getNewGUID());var s=r.call(this)||this;return s.flowConnect=t,s.name=e,s.rules=i,s.terminalTypeColors=o,s.id=n,s.state=f.FlowState.Stopped,s.listeners={},s.nodes={},s.groups=[],s.connectors={},s.hitColorToNode={},s.hitColorToGroup={},s.sortedNodes=new a.AVLTree(function(t,e){return t.zIndex-e.zIndex},function(t){return t.id}),s.inputs=[],s.outputs=[],s.executionGraph=new y.Graph,s.registerListeners(),s.flowConnect.on("tick",function(){s.state===f.FlowState.Running&&s.call("tick",s)}),s}e.Flow=n},571:function(t,e,i){var o=this&&this.__awaiter||function(t,r,h,l){return new(h=h||Promise)(function(i,e){function o(t){try{s(l.next(t))}catch(t){e(t)}}function n(t){try{s(l.throw(t))}catch(t){e(t)}}function s(t){var e;t.done?i(t.value):((e=t.value)instanceof h?e:new h(function(t){t(e)})).then(o,n)}s((l=l.apply(t,r||[])).next())})},n=this&&this.__generator||function(i,o){var n,s,r,h={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;h;)try{if(n=1,s&&(r=2&e[0]?s.return:e[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,e[1])).done)return r;switch(s=0,(e=r?[2&e[0],r.value]:e)[0]){case 0:case 1:r=e;break;case 4:return h.label++,{value:e[1],done:!1};case 5:h.label++,s=e[1],e=[0];continue;case 7:e=h.ops.pop(),h.trys.pop();continue;default:if(!(r=0<(r=h.trys).length&&r[r.length-1])&&(6===e[0]||2===e[0])){h=0;continue}if(3===e[0]&&(!r||e[1]>r[0]&&e[1]<r[3])){h.label=e[1];break}if(6===e[0]&&h.label<r[1]){h.label=r[1],r=e;break}if(r&&h.label<r[2]){h.label=r[2],h.ops.push(e);break}r[2]&&h.ops.pop(),h.trys.pop();continue}e=o.call(i,h)}catch(t){e=[6,t],s=0}finally{n=r=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},s=this&&this.__spreadArray||function(t,e){for(var i=0,o=e.length,n=t.length;i<o;i++,n++)t[n]=e[i];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.Graph=e.GraphNode=void 0;var r=i(522),h=i(645),l=i(974),a=i(55),u=(p.prototype.serialize=function(){return{id:this.id,nodeId:this.flowNode.id,order:this.order,childs:this.childs.map(function(t){return t.id})}},p.deSerialize=function(t,e){return new p(t,e.order,e.id)},p);function p(t,e,i){this.flowNode=t,this.childs=[],this.order=e||0,this.id=i||l.getNewGUID()}e.GraphNode=u;c.prototype.add=function(t){this.nodes[0]||this.nodes.push([]);var e=new u(t);this.nodes[0].push(e),this.nodeToGraphNode[t.id]=e},c.prototype.connect=function(t,e){var i=this,t=this.nodeToGraphNode[t.id],e=this.nodeToGraphNode[e.id];if(!t.childs.includes(e)&&(t.childs.push(e),e.order<=t.order)){this.updateOrder(e,t.order+1);var o=[];o.push(e);for(;0!==o.length;)!function(){var e=o.shift();e.childs.forEach(function(t){t.order<=e.order&&(i.updateOrder(t,e.order+1),o.includes(t)||o.push(t))})}()}},c.prototype.updateOrder=function(t,e){this.nodes[t.order].splice(this.nodes[t.order].indexOf(t),1),this.nodes[e]||(this.nodes[e]=[]),t.order=e,this.nodes[e].push(t)},c.prototype.canConnect=function(t,e){return!this.nodeToGraphNode[e.id].childs.includes(this.nodeToGraphNode[t.id])},c.prototype.start=function(){this.state===r.GraphState.Stopped&&(this.state=r.GraphState.FullRun,this.nodes.forEach(function(t){t.forEach(function(t){return t.flowNode.run()})}),this.state=r.GraphState.Idle)},c.prototype.stop=function(){this.state=r.GraphState.Stopped},c.prototype.partialRun=function(){return o(this,void 0,void 0,function(){var i=this;return n(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,e){try{i.processDirtyNodes(),t(!0)}catch(t){h.Log.error(t),e(!1)}})];case 1:return t.sent()&&0<Object.keys(this.dirtyNodes).length?[4,this.partialRun()]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}})})},c.prototype.setDirtyNode=function(t){var e=this,t=t instanceof a.Node?this.nodeToGraphNode[t.id]:t;this.dirtyNodes[t.id]||(this.dirtyNodes[t.id]=t,this.state===r.GraphState.Idle&&(this.state=r.GraphState.Running,this.partialRun().then(function(){return e.state=r.GraphState.Idle})))},c.prototype.clearDirtyNode=function(t){t=t instanceof a.Node?this.nodeToGraphNode[t.id]:t;this.dirtyNodes[t.id]&&delete this.dirtyNodes[t.id]},c.prototype.processDirtyNodes=function(){var e=this,t=Object.values(this.dirtyNodes).sort(function(t,e){return t.order-e.order});h.Log.log("Dirty Nodes: ",s([],t)),t.forEach(function(t){t.flowNode.run(),e.clearDirtyNode(t)})},c.prototype.serialize=function(){var e=this,i={};return Object.keys(this.nodeToGraphNode).forEach(function(t){return i[t]=e.nodeToGraphNode[t].id}),{nodes:this.nodes.map(function(t){return t.map(function(t){return t.serialize()})}),nodeToGraphNode:i}},c.deSerialize=function(i,e){var o=new c,n={},s={};return e.nodes.forEach(function(t,e){o.nodes[e]=t.map(function(t){var e=u.deSerialize(i.nodes[t.nodeId],t);return s[e.id]=e,n[e.id]=t,e})}),Object.keys(s).forEach(function(t){s[t].childs=n[t].childs.map(function(t){return s[t]})}),Object.keys(e.nodeToGraphNode).forEach(function(t){o.nodeToGraphNode[t]=s[e.nodeToGraphNode[t]]}),o},i=c;function c(){this.state=r.GraphState.Stopped,this.nodes=[],this.nodeToGraphNode={},this.dirtyNodes={}}e.Graph=i},166:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__assign||function(){return(a=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Group=void 0;var u,s=i(281),p=i(522),c=i(974),r=i(278),i=i(417),n=(u=i.Hooks,n(h,u),Object.defineProperty(h.prototype,"name",{get:function(){return this._name},set:function(t){t&&""!==t.trim()?this._name=t:this._name="No Name",this.computeTextMetrics()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,this.updateRenderState(),this.recomputeNodePositions()},enumerable:!1,configurable:!0}),h.prototype.setHitColor=function(t){if(!t)for(t=r.Color.Random();this.flow.hitColorToGroup[t.rgbaString];)t=r.Color.Random();this.hitColor=t,this.flow.hitColorToGroup[this.hitColor.rgbaString]=this},h.prototype.computeTextMetrics=function(){var t=this.flow.flowConnect.context;t.font=this.style.fontSize+" "+this.style.font;var e=t.measureText(this.name);this.textWidth=e.width,e=t.measureText("M"),t.font=null,this.textHeight=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent,void 0===this.textHeight&&((e=document.createElement("span")).textContent="M",e.style.font=this.style.fontSize+" "+this.style.font,document.body.appendChild(e),this.textHeight=e.offsetHeight,document.body.removeChild(e))},h.prototype.updateRenderState=function(){var t=this.position.transform(this.flow.flowConnect.transform);this.renderState=c.intersects(0,0,this.flow.flowConnect.canvasDimensions.width,this.flow.flowConnect.canvasDimensions.height,t.x,t.y,t.x+this.width*this.flow.flowConnect.scale,t.y+this.height*this.flow.flowConnect.scale)},h.prototype.setContainedNodes=function(){var i=this,o=this.position.transform(this.flow.flowConnect.transform);this.nodes=Object.keys(this.flow.nodes).map(function(t){return i.flow.nodes[t]}).filter(function(t){return!t.group&&t.renderState.viewport===p.ViewPort.INSIDE}).filter(function(t){var e=t.position.transform(i.flow.flowConnect.transform);return c.intersects(o.x,o.y,o.x+i.width*i.flow.flowConnect.scale,o.y+i.height*i.flow.flowConnect.scale,e.x,e.y,e.x+t.width*i.flow.flowConnect.scale,e.y+t.ui.height*i.flow.flowConnect.scale)===p.ViewPort.INSIDE}),this.nodes.forEach(function(t,e){(t.group=i).nodeDeltas[e]=t.position.subtract(i.position)})},h.prototype.recomputeNodePositions=function(){var i=this;this.nodes.forEach(function(t,e){t.position=i.position.add(i.nodeDeltas[e])})},h.prototype.render=function(){this.renderState!==p.ViewPort.OUTSIDE&&(this.flow.flowConnect.context.save(),this._render(),this.flow.flowConnect.context.restore(),this.flow.flowConnect.offGroupContext.save(),this._offRender(),this.flow.flowConnect.offGroupContext.restore())},h.prototype._render=function(){var t=this.flow.flowConnect.context;t.strokeStyle=this.style.borderColor,t.lineWidth=2,t.fillStyle=this.style.color,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillRect(this.position.x,this.position.y,this.width,this.height),t.fillStyle=this.style.titleColor,t.textBaseline="bottom",t.font=this.style.fontSize+" "+this.style.font,t.fillText(this.name,this.position.x,this.position.y-10)},h.prototype._offRender=function(){this.flow.flowConnect.offGroupContext.fillStyle=this.hitColor.rgbaCSSString,this.flow.flowConnect.offGroupContext.fillRect(this.position.x,this.position.y,this.width,this.height),this.flow.flowConnect.offGroupContext.fillRect(this.position.x,this.position.y-this.textHeight-10,this.textWidth,this.textHeight+10)},h.prototype.onClick=function(t,e){var i=this;this.call("click",this,t,e);e=this.position.transform(this.flow.flowConnect.transform);t.y<e.y&&this.flow.flowConnect.showGenericInput(e.subtract(0,(10+this.textHeight)*this.flow.flowConnect.scale),this.name,{width:Math.max(this.textWidth,50)*this.flow.flowConnect.scale+"px",height:this.textHeight*this.flow.flowConnect.scale+"px",fontSize:parseInt(this.style.fontSize.replace("px",""))*this.flow.flowConnect.scale+"px",fontFamily:this.style.font},{type:"text"},function(t){i.name=t})},h.prototype.serialize=function(){return{id:this.id,hitColor:this.hitColor.serialize(),position:this.position.serialize(),name:this.name,width:this.width,height:this.height,style:this.style,nodes:this.nodes.map(function(t){return t.id}),nodeDeltas:this.nodeDeltas.map(function(t){return t.serialize()})}},h.deSerialize=function(e,t){var i=new h(e,s.Vector2.deSerialize(t.position),t.width,t.height,t.name,t.style,t.id,r.Color.deSerialize(t.hitColor));return t.nodes.forEach(function(t){i.nodes.push(e.nodes[t])}),t.nodeDeltas.forEach(function(t){i.nodeDeltas.push(s.Vector2.deSerialize(t))}),i},h);function h(t,e,i,o,n,s,r,h){void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s={}),void 0===r&&(r=c.getNewGUID());var l=u.call(this)||this;return l.flow=t,l.width=i,l.height=o,l.style=s,l.id=r,l.nodes=[],l.nodeDeltas=[],l.renderState=p.ViewPort.INSIDE,l.hitColor=h,l.style=a(a({},p.Constant.DefaultGroupStyle()),s),l.id=c.getNewGUID(),l._position=e,l.style.color&&l.style.borderColor||(e=p.Constant.DefaultGroupColors.Random(),l.style.borderColor=e[0],l.style.color=e[1]),l.name=n,l.setHitColor(h),l.computeTextMetrics(),l.flow.on("transform",function(){return l.updateRenderState()}),l}e.Group=n},417:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Hooks=void 0;var i=(o.prototype.on=function(t,e){this.registeredEvents[t]||(this.registeredEvents[t]={});var i=this.lastId;return this.registeredEvents[t][i]=e,this.lastId+=1,i},o.prototype.call=function(t){for(var i=[],e=1;e<arguments.length;e++)i[e-1]=arguments[e];this.registeredEvents[t]&&(i?Object.values(this.registeredEvents[t]).forEach(function(e){return new Promise(function(t){return t(e.apply(void 0,i))})}):Object.values(this.registeredEvents[t]).forEach(function(e){return new Promise(function(t){return t(e())})}))},o.prototype.off=function(t,e){this.registeredEvents[t]&&delete this.registeredEvents[t][e]},o);function o(){this.registeredEvents={},this.lastId=0}e.Hooks=i},676:function(t,e,i){var o=this&&this.__createBinding||(Object.create?function(t,e,i,o){void 0===o&&(o=i),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,o){t[o=void 0===o?i:o]=e[i]}),n=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||o(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),n(i(278),e),n(i(907),e),n(i(894),e),n(i(55),e),n(i(900),e),n(i(166),e),n(i(232),e),n(i(417),e),n(i(587),e),n(i(915),e)},232:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0})},55:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=this&&this.__assign||function(){return(d=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Node=e.NodeButton=void 0;var s=i(281),f=i(522),y=i(637),g=i(974),w=i(278),m=i(900),i=i(417),r=(h.prototype.setHitColor=function(){for(var t=w.Color.Random();this.node.hitColorToNodeButton[t.rgbaString];)t=w.Color.Random();this.hitColor=t,this.node.hitColorToNodeButton[this.hitColor.rgbaString]=this},h.prototype.render=function(){this.node.context.save(),this._render(this,this.node.position.add(this.deltaX,this.node.style.titleHeight/2-this.node.style.nodeButtonSize/2)),this.node.context.restore(),this.node.offUIContext.save(),this._offUIRender(),this.node.offUIContext.restore()},h.prototype._offUIRender=function(){this.node.offUIContext.fillStyle=this.hitColor.rgbaCSSString,this.node.offUIContext.fillRect(this.node.position.x+this.deltaX,this.node.position.y+this.node.style.titleHeight/2-this.node.style.nodeButtonSize/2,this.node.style.nodeButtonSize,this.node.style.nodeButtonSize)},h);function h(t,e,i,o){this.node=t,this.callback=e,this._render=i,this.align=o,this.deltaX=0,this.setHitColor()}e.NodeButton=r;var v,n=(v=i.Hooks,n(l,v),Object.defineProperty(l.prototype,"context",{get:function(){return this.flow.flowConnect.context},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"offContext",{get:function(){return this.flow.flowConnect.offContext},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"offUIContext",{get:function(){return this.flow.flowConnect.offUIContext},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,this.reflow(),this.ui.update(),this.updateRenderState()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this.flow.sortedNodes.remove(this)?(this._zIndex=t,this.flow.sortedNodes.add(this)):this._zIndex=t},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this.ui.width=t,this.ui.update()},enumerable:!1,configurable:!0}),l.prototype.setupProps=function(e){var n=this;this.props=new Proxy({},{set:function(t,e,i){void 0===t[e]&&(n.propObservers[e]=[]);var o=t[e];return t[e]=i,n.propObservers[e].forEach(function(t){return t(o,i)}),n.registeredEvents.propchange&&n.call("propchange",n,e,o,i),!0}}),Object.keys(e).forEach(function(t){n.props[t]=e[t]})},l.prototype.addPropObserver=function(t,e){void 0!==this.props[t]&&this.propObservers[t].push(e)},l.prototype.removePropObserver=function(t,e){this.propObservers[t]&&this.propObservers[t].splice(this.propObservers[t].indexOf(e),1)},l.prototype.setHitColor=function(t){if(!t)for(t=w.Color.Random();this.flow.hitColorToNode[t.rgbaString];)t=w.Color.Random();this.hitColor=t,this.flow.hitColorToNode[this.hitColor.rgbaString]=this},l.prototype.addNodeButton=function(t,e,i){var o=new r(this,t,e,i),e=this.nodeButtons.filter(function(t){return t.align===o.align}).length,e=i===f.Align.Left?e*(this.style.nodeButtonSize+this.style.nodeButtonSpacing):this.width-e*(this.style.nodeButtonSize+this.style.nodeButtonSpacing)-this.style.nodeButtonSize;return o.deltaX=e,this.nodeButtons.push(o),o},l.prototype.reflow=function(){var t=this.position.y+this.style.terminalRowHeight/2+this.style.padding/2+this.style.titleHeight;this.inputs.length>this.outputs.length?(this.recalculateInputTerminals(t),t=this.position.y+this.inputs.length*this.style.terminalRowHeight/2-this.outputs.length*this.style.terminalRowHeight/2+this.style.terminalRowHeight/2+this.style.padding/2+this.style.titleHeight,this.recalculateOutputTerminals(t)):(this.recalculateOutputTerminals(t),t=this.position.y+this.outputs.length*this.style.terminalRowHeight/2-this.inputs.length*this.style.terminalRowHeight/2+this.style.terminalRowHeight/2+this.style.padding/2+this.style.titleHeight,this.recalculateInputTerminals(t))},l.prototype.updateRenderState=function(){var t=this.position.transform(this.flow.flowConnect.transform);this.renderState.viewport=g.intersects(0,0,this.flow.flowConnect.canvasDimensions.width,this.flow.flowConnect.canvasDimensions.height,t.x,t.y,t.x+this.width*this.flow.flowConnect.scale,t.y+(this.renderState.nodeState===f.NodeState.MAXIMIZED?this.ui.height:this.style.titleHeight)*this.flow.flowConnect.scale),.6<this.flow.flowConnect.scale?this.renderState.lod=f.LOD.LOD2:this.flow.flowConnect.scale<=.6&&.3<this.flow.flowConnect.scale?this.renderState.lod=f.LOD.LOD1:this.renderState.lod=f.LOD.LOD0,this.renderState.viewport===f.ViewPort.INTERSECT&&this.ui.updateRenderState()},l.prototype.recalculateInputTerminals=function(e){var i=this;this.inputs.forEach(function(t){t.position.x=i.position.x-i.style.terminalStripMargin-t.style.radius,t.position.y=e,e+=i.style.terminalRowHeight})},l.prototype.recalculateOutputTerminals=function(e){var i=this;this.outputs.forEach(function(t){t.position.x=i.position.x+i.ui.width+i.style.terminalStripMargin+t.style.radius,t.position.y=e,e+=i.style.terminalRowHeight})},l.prototype.getHitTerminal=function(t,e,i){var o=null;i=i.transform(this.flow.flowConnect.transform);var n=this.position.transform(this.flow.flowConnect.transform);return(0<this.inputs.length+this.inputsUI.length&&i.x<n.x||0<this.outputs.length+this.outputsUI.length&&i.x>n.x+this.ui.width*this.flow.flowConnect.scale)&&(o=this.hitColorToTerminal[t]),this.currHitTerminal&&this.currHitTerminal!==o&&(this.currHitTerminal.onExit(e,i),o&&o.onEnter(e,i)),o},l.prototype.getHitUINode=function(t){t=this.hitColorToUI[t];return t instanceof y.Container?null:t},l.prototype.getHitNodeButton=function(t){return this.hitColorToNodeButton[t]},l.prototype.run=function(){this.flow.state!==f.FlowState.Stopped&&this.call("process",this,this.inputs.map(function(t){return 0<t.connectors.length?t.connectors[0].data:null}))},l.prototype._render=function(){var t,e,i=this,o=this.context;this.renderState.nodeState===f.NodeState.MAXIMIZED?0<this.renderState.lod&&(this.inputs.forEach(function(t){return t.render()}),this.outputs.forEach(function(t){return t.render()})):(o.fillStyle="green",0<this.inputs.length+this.inputsUI.length&&(e=(0<this.inputs.length?this.inputs:this.inputsUI)[0].style.radius,o.fillRect(this.position.x-this.style.terminalStripMargin-2*e,this.position.y+this.style.titleHeight/2-e,2*e,2*e)),0<this.outputs.length+this.outputsUI.length&&(e=(0<this.outputs.length?this.outputs:this.outputsUI)[0].style.radius,o.fillRect(this.position.x+this.width+this.style.terminalStripMargin,this.position.y+this.style.titleHeight/2-e,2*e,2*e))),o.fillStyle=this.style.titleColor,o.font=this.style.titleFontSize+" "+this.style.titleFont,o.textBaseline="middle",o.fillText(this.name,this.position.x+this.ui.width/2-o.measureText(this.name).width/2,this.position.y+this.style.titleHeight/2),this.renderState.nodeState===f.NodeState.MAXIMIZED&&(o.fillStyle=this.style.color,o.font=this.style.fontSize+" "+this.style.font,o.textBaseline="middle",this.inputs.forEach(function(t){o.fillText(t.name,t.position.x+t.style.radius+i.style.terminalStripMargin+i.style.padding,t.position.y)}),this.outputs.forEach(function(t){o.fillText(t.name,t.position.x-t.style.radius-i.style.terminalStripMargin-i.style.padding-o.measureText(t.name).width,t.position.y)})),this.focused&&(o.strokeStyle="#000",o.lineWidth=2,t=0===this.inputs.length?0===this.inputsUI.length?0:2*this.inputsUI[0].style.radius:2*this.inputs[0].style.radius,t+=2*this.style.terminalStripMargin,e=0===this.outputs.length?0===this.outputsUI.length?0:2*this.outputsUI[0].style.radius:2*this.outputs[0].style.radius,e+=2*this.style.terminalStripMargin,o.strokeRoundRect(this.position.x-t,this.position.y,this.width+t+e,this.renderState.nodeState===f.NodeState.MAXIMIZED?this.ui.height+this.style.padding:this.style.titleHeight,4))},l.prototype._offRender=function(){this.offContext.fillStyle=this.hitColor.rgbaCSSString;var t,e=this.position.x,i=this.position.y,o=0,n=0;this.inputs.length+this.inputsUI.length!==0&&(t=(0<this.inputs.length?this.inputs:this.inputsUI)[0].style.radius,e-=this.style.terminalStripMargin+2*t,o=2*t+this.style.terminalStripMargin),this.outputs.length+this.outputsUI.length!==0&&(n=2*(t=(0<this.outputs.length?this.outputs:this.outputsUI)[0].style.radius)+this.style.terminalStripMargin),this.offContext.fillRect(e,i,this.ui.width+o+n,this.renderState.nodeState===f.NodeState.MAXIMIZED?this.ui.height:this.style.titleHeight)},l.prototype.addTerminal=function(t){((t=!(t instanceof m.Terminal)?m.Terminal.deSerialize(this,t):t).type===f.TerminalType.IN?this.inputs:this.outputs).push(t),this.ui.update(),this.reflow()},l.prototype.getInput=function(e){if("string"==typeof e){var t=this.inputs.find(function(t){return t.name===e});if(t)return t.getData()}else if(this.inputs[e])return this.inputs[e].getData();return null},l.prototype.getInputs=function(){return this.inputs.map(function(t){return t.getData()})},l.prototype.setOutput=function(e,t){if("string"==typeof e){var i=this.outputs.find(function(t){return t.name===e});if(i)return i.setData(t)}else this.outputs[e]&&this.outputs[e].setData(t)},l.prototype.setOutputs=function(t){var i=this,o=new Map;Object.entries(t).forEach(function(e){var t=i.outputs.find(function(t){return t.name===e[0]});if(!t)throw"Error";o.set(t,e[1])});for(var e,n=new Map,s=o.keys();(e=s.next().value)&&e;)e.connectors.forEach(function(t){n.has(t.endNode)?n.get(t.endNode).push(t):n.set(t.endNode,[t])});for(var r,h=n.values();(r=h.next().value)&&r;){for(var l=1;l<r.length;l+=1)r[l].setData(o.get(r[l].start));r[0].data=o.get(r[0].start)}},l.prototype.toggleNodeState=function(){this.renderState.nodeState=this.renderState.nodeState===f.NodeState.MAXIMIZED?f.NodeState.MINIMIZED:f.NodeState.MAXIMIZED},l.prototype.dispose=function(){this.flow.removeNode(this.id)},l.prototype.render=function(){this.renderState.viewport!==f.ViewPort.OUTSIDE&&(this.renderState.nodeState===f.NodeState.MAXIMIZED&&this.ui.render(),this.context.save(),this._render(),this.context.restore(),this.nodeButtons.forEach(function(t){return t.render()}),this.offContext.save(),this._offRender(),this.offContext.restore())},l.prototype.onDown=function(t,e){this.call("down",this,t,e);var i=w.Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(t.x,t.y,1,1).data);this.currHitUINode=this.getHitUINode(i),this.currHitUINode&&this.currHitUINode.onDown(t,e);i=this.getHitTerminal(i,t,e);i&&(this.currHitTerminal=i,this.currHitTerminal.onDown(t,e))},l.prototype.onOver=function(t,e){this.call("over",this,t,e);var i=w.Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(t.x,t.y,1,1).data),o=this.getHitTerminal(i,t,e);o!==this.prevHitTerminal?(this.prevHitTerminal&&this.prevHitTerminal.onExit(t,e),o&&o.onEnter(t,e)):o&&!this.currHitTerminal&&o.onOver(t,e),this.prevHitTerminal=o;i=this.getHitUINode(i);i!==this.prevHitUINode?(this.prevHitUINode&&this.prevHitUINode.onExit(t,e),i&&i.onEnter(t,e)):i&&!this.currHitUINode&&i.onOver(t,e),this.prevHitUINode=i},l.prototype.onEnter=function(t,e){this.call("enter",this,t,e)},l.prototype.onExit=function(t,e){this.call("exit",this,t,e);var i=w.Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(t.x,t.y,1,1).data),i=this.getHitTerminal(i,t,e);i&&i.onExit(t,e),this.prevHitTerminal&&this.prevHitTerminal.onExit(t,e),this.prevHitTerminal=null,this.currHitTerminal&&this.currHitTerminal.onExit(t,e)},l.prototype.onUp=function(t,e){this.call("up",this,t,e);var i=w.Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(t.x,t.y,1,1).data);this.currHitUINode=null;var o=this.getHitUINode(i);o&&o.onUp(t.clone(),e.clone());i=this.getHitTerminal(i,t,e);i&&i.onUp(t,e)},l.prototype.onClick=function(t,e){this.call("click",this,t,e);var i,o=w.Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(t.x,t.y,1,1).data);e.y<this.position.y+this.style.titleHeight*this.flow.flowConnect.scale?(i=this.getHitNodeButton(o))&&i.callback():(this.currHitTerminal&&this.currHitTerminal.onClick(t,e),(o=this.getHitUINode(o))&&o.onClick(t.clone(),e.clone()))},l.prototype.onDrag=function(t,e){this.call("drag",this,t,e),this.currHitUINode&&this.currHitUINode.draggable&&this.currHitUINode.onDrag(t,e)},l.prototype.onContextMenu=function(){this.call("rightclick",this)},l.prototype.createLabel=function(t,e,i,o,n){return new y.Label(this,t,e,i,o,n)},l.prototype.createImage=function(t,e,i){return new y.Image(this,t,e,i)},l.prototype.createSlider=function(t,e,i,o,n,s,r,h,l){return new y.Slider(this,t,e,i,o,n,s,r,h,l)},l.prototype.createHozLayout=function(t,e){return new y.HorizontalLayout(this,t,e)},l.prototype.createButton=function(t,e,i,o,n){return new y.Button(this,t,e,i,o,n)},l.prototype.createToggle=function(t,e,i,o,n){return new y.Toggle(this,t,e,i,o,n)},l.prototype.createSelect=function(t,e,i,o,n,s){return new y.Select(this,t,e,i,o,n,s)},l.prototype.createSource=function(t,e,i,o,n,s){return new y.Source(this,t,e,i,o,n,s)},l.prototype.createDisplay=function(t,e,i){return new y.Display(this,t,e,i)},l.prototype.createInput=function(t,e,i,o,n,s){return new y.Input(this,t,e,i,o,n,s)},l.prototype.serialize=function(){return{id:this.id,name:this.name,position:this.position.serialize(),width:this.width,props:this.props,inputs:this.inputs.map(function(t){return t.serialize()}),outputs:this.outputs.map(function(t){return t.serialize()}),style:this.style,terminalStyle:this.terminalStyle,hitColor:this.hitColor.serialize(),zIndex:this.zIndex,focused:this.focused,renderState:this.renderState,ui:this.ui.serialize()}},l.deSerialize=function(t,e){return new l(t,e.name,s.Vector2.deSerialize(e.position),e.width,e.inputs,e.outputs,e.style,e.terminalStyle,e.props,e.id,w.Color.deSerialize(e.hitColor),e.ui)},l);function l(t,e,i,o,n,s,r,h,l,a,u,p){void 0===r&&(r={}),void 0===h&&(h={}),void 0===l&&(l={}),void 0===a&&(a=g.getNewGUID());var c=v.call(this)||this;return c.flow=t,c.name=e,c.style=r,c.terminalStyle=h,c.id=a,c.nodeButtons=[],c.propObservers={},c.renderState={viewport:f.ViewPort.INSIDE,nodeState:f.NodeState.MAXIMIZED,lod:f.LOD.LOD2},c.focused=!1,c.inputs=[],c.outputs=[],c.inputsUI=[],c.outputsUI=[],c.group=null,c.hitColor=u,c._width=o,c.style=d(d({},f.Constant.DefaultNodeStyle()),r),c._position=i,c.setupProps(l),c.hitColorToUI={},c.hitColorToTerminal={},c.hitColorToNodeButton={},c._zIndex=0,c.setHitColor(u),(u=c.inputs).push.apply(u,n.map(function(t){return new m.Terminal(c,f.TerminalType.IN,t.dataType,t.name,t.style||d({},h),t.id||null,t.hitColor?w.Color.deSerialize(t.hitColor):null)})),(n=c.outputs).push.apply(n,s.map(function(t){return new m.Terminal(c,f.TerminalType.OUT,t.dataType,t.name,t.style||d({},h),t.id||null,t.hitColor?w.Color.deSerialize(t.hitColor):null)})),c.ui=p?p instanceof y.Container?p:y.Container.deSerialize(c,p):new y.Container(c,o),c.addNodeButton(function(){return c.toggleNodeState()},function(t,e){c.context.fillStyle=c.style.maximizeButtonColor,c.context.fillRect(e.x,e.y,c.style.nodeButtonSize,c.style.nodeButtonSize)},f.Align.Left),c.reflow(),c.ui.update(),c.flow.on("transform",function(){return c.updateRenderState()}),c}e.Node=n},587:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.SubFlowNode=void 0;var d,f=i(522),s=i(281),r=i(278),h=i(894),l=i(55),y=i(900),n=(d=l.Node,n(a,d),a.prototype.run=function(){this.flow.state!==f.FlowState.Stopped&&(this.call("process",this),this.subFlow.start())},a.prototype.serialize=function(){return{id:this.id,name:this.name,position:this.position.serialize(),width:this.width,props:this.props,inputs:this.inputs.map(function(t){return t.serialize()}),outputs:this.outputs.map(function(t){return t.serialize()}),style:this.style,terminalStyle:this.terminalStyle,hitColor:this.hitColor.serialize(),zIndex:this.zIndex,focused:this.focused,renderState:this.renderState,ui:this.ui.serialize(),subFlow:this.subFlow.serialize()}},a.deSerialize=function(t,e){var i=h.Flow.deSerialize(t.flowConnect,e.subFlow);return new a(t,e.name,s.Vector2.deSerialize(e.position),e.width,e.style,e.terminalStyle,e.props,e.inputs,e.outputs,i,e.id,r.Color.deSerialize(e.hitColor))},a);function a(t,e,i,o,n,s,r,h,l,a,u,p){void 0===n&&(n={}),void 0===s&&(s={}),void 0===r&&(r={});var c=d.call(this,t,e,i,o,h||[],l||[],n,s,r,u,p)||this;return c.subFlow=a,c.subFlow.on("add-input",function(t,e){var i=new y.Terminal(c,f.TerminalType.IN,e.outputs[0].dataType,e.outputs[0].name);e.proxyTerminal=i,c.addTerminal(i)}),c.subFlow.on("add-output",function(t,e){var i=new y.Terminal(c,f.TerminalType.OUT,e.inputs[0].dataType,e.inputs[0].name);e.proxyTerminal=i,c.addTerminal(i)}),c.subFlow.inputs.forEach(function(t,e){return t.proxyTerminal=c.inputs[e]}),c.subFlow.outputs.forEach(function(t,e){return t.proxyTerminal=c.outputs[e]}),c.addNodeButton(function(){c.flow.flowConnect.render(c.subFlow)},function(t,e){var i=c.context;i.strokeStyle=c.style.expandButtonColor,i.beginPath(),i.moveTo(e.x,e.y+c.style.nodeButtonSize/2),i.lineTo(e.x,e.y+c.style.nodeButtonSize),i.lineTo(e.x+c.style.nodeButtonSize,e.y),i.lineTo(e.x+c.style.nodeButtonSize,e.y+c.style.nodeButtonSize/2),i.moveTo(e.x+c.style.nodeButtonSize,e.y),i.lineTo(e.x+c.style.nodeButtonSize/2,e.y),i.moveTo(e.x,e.y+c.style.nodeButtonSize),i.lineTo(e.x+c.style.nodeButtonSize/2,e.y+c.style.nodeButtonSize),i.closePath(),i.stroke()},f.Align.Right),c}e.SubFlowNode=n},900:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=this&&this.__assign||function(){return(l=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Terminal=void 0;var a,u=i(281),p=i(522),c=i(974),s=i(278),r=i(907),i=i(417),n=(a=i.Hooks,n(h,a),h.prototype.setHitColor=function(t){if(!t)for(t=s.Color.Random();this.node.hitColorToTerminal[t.rgbaString]||this.node.hitColorToUI[t.rgbaString];)t=s.Color.Random();this.hitColor=t,this.node.hitColorToTerminal[this.hitColor.rgbaString]=this},h.prototype.render=function(){var t=this.node.context;t.save(),this.focus&&(t.beginPath(),t.arc(this.position.x,this.position.y,3*this.style.radius,0,2*Math.PI),t.fillStyle=this.style.focusColor,t.fill()),"event"===this.dataType?(t.beginPath(),t.moveTo(this.position.x,this.position.y-1.3*this.style.radius),t.lineTo(this.position.x+1.3*this.style.radius,this.position.y),t.lineTo(this.position.x,this.position.y+1.3*this.style.radius),t.lineTo(this.position.x-1.3*this.style.radius,this.position.y),t.lineTo(this.position.x,this.position.y-1.3*this.style.radius),t.closePath()):(t.beginPath(),t.arc(this.position.x,this.position.y,this.style.radius,0,2*Math.PI)),t.fillStyle=this.focus?"#00ff00":this.node.flow.terminalTypeColors[this.dataType]||"#888",t.strokeStyle=this.style.borderColor,t.shadowBlur=this.style.shadowBlur,t.shadowColor=this.style.shadowColor,t.fill(),t.stroke(),t.restore(),this.offUIRender()},h.prototype.connect=function(t,e){if(this.type!==t.type){var i=this.type===p.TerminalType.OUT?this:t,o=this.type===p.TerminalType.IN?this:t;if(0<o.connectors.length&&i.connectors.includes(o.connectors[0]))return!1}if(c.canConnect(this,t,this.node.flow.rules,this.node.flow.executionGraph)){e=new r.Connector(this.node.flow,this.type===p.TerminalType.OUT?this:t,this.type===p.TerminalType.IN?this:t,null,e);return this.node.flow.connectors[e.id]=e,!0}return!1},h.prototype.offUIRender=function(){var t=this.node.offUIContext;t.save(),t.beginPath(),t.arc(this.position.x,this.position.y,this.style.radius+this.node.style.terminalStripMargin,0,2*Math.PI),t.fillStyle=this.hitColor.rgbaCSSString,t.fill(),t.restore()},h.prototype.onEnter=function(t,e){this.call("enter",this,t,e),this.focus=!0,this.node.flow.flowConnect.cursor="pointer"},h.prototype.onExit=function(t,e){this.call("exit",this,t,e),this.focus=!1,this.node.flow.flowConnect.cursor="unset"},h.prototype.onDown=function(t,e){var i;this.call("down",this,t,e),0<this.connectors.length?this.type===p.TerminalType.IN?(this.connectors[0].endNode.currHitTerminal=null,this.connectors[0].end=null,this.connectors[0].floatingTip=e,this.node.flow.flowConnect.floatingConnector=this.connectors[0],this.connectors[0].start.call("disconnect",this.connectors[0].start,this.connectors[0]),this.call("disconnect",this,this.connectors[0]),this.connectors.pop()):this.node.flow.flowConnect.floatingConnector||(i=new r.Connector(this.node.flow,this,null,e,{}),this.node.flow.connectors[i.id]=i,this.node.flow.flowConnect.floatingConnector=i):this.node.flow.flowConnect.floatingConnector||(i=new r.Connector(this.node.flow,this.type===p.TerminalType.IN?null:this,this.type===p.TerminalType.IN?this:null,e,{}),this.node.flow.connectors[i.id]=i,this.node.flow.flowConnect.floatingConnector=i)},h.prototype.onUp=function(t,e){this.call("up",this,t,e)},h.prototype.onDrag=function(t,e){this.call("drag",this,t,e)},h.prototype.onClick=function(t,e){this.call("click",this,t,e)},h.prototype.onOver=function(t,e){this.call("over",this,t,e)},h.prototype.onContextMenu=function(){this.call("rightclick",this)},h.prototype.onEvent=function(t){this.type===p.TerminalType.IN&&this.call("event",this,t)},h.prototype.emit=function(e){this.type===p.TerminalType.OUT&&0!==this.connectors.length&&this.connectors.forEach(function(t){t.end&&t.end.onEvent(e)})},h.prototype.serialize=function(){return{id:this.id,type:this.type,dataType:this.dataType,name:this.name,style:this.style,hitColor:this.hitColor.serialize()}},h.deSerialize=function(t,e){return new h(t,e.type,e.dataType,e.name,e.style,e.id,s.Color.deSerialize(e.hitColor))},h);function h(t,e,i,o,n,s,r){void 0===n&&(n={});var h=a.call(this)||this;return h.node=t,h.type=e,h.dataType=i,h.name=o,h.style=n,h.id=s,h.hitColor=r,h.style=l(l({},p.Constant.DefaultTerminalStyle()),n),h.id=s||c.getNewGUID(),h.setHitColor(r),h.connectors=[],h.position=u.Vector2.Zero(),h.focus=!1,h.type===p.TerminalType.IN?h.getData=function(){return 0<h.connectors.length?h.connectors[0].data:null}:h.setData=function(e){h.connectors.forEach(function(t){return t.data=e})},h}e.Terminal=n},915:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.TunnelNode=void 0;var c,s=i(281),r=i(278),i=i(55),n=(c=i.Node,n(h,c),Object.defineProperty(h.prototype,"proxyTerminal",{get:function(){return this._proxyTerminal},set:function(t){var e=this;this._proxyTerminal=t,this._proxyTerminal.on("data",function(t){e.outputs[0].setData(t)})},enumerable:!1,configurable:!0}),h.prototype.serialize=function(){return{id:this.id,name:this.name,position:this.position.serialize(),width:this.width,props:this.props,inputs:this.inputs.map(function(t){return t.serialize()}),outputs:this.outputs.map(function(t){return t.serialize()}),style:this.style,terminalStyle:this.terminalStyle,hitColor:this.hitColor.serialize(),zIndex:this.zIndex,focused:this.focused,renderState:this.renderState,ui:this.ui.serialize(),proxyTerminalId:this.proxyTerminal.id}},h.deSerialize=function(t,e){return new h(t,e.name,s.Vector2.deSerialize(e.position),e.width,e.inputs,e.outputs,e.style,e.terminalStyle,e.props,e.id,r.Color.deSerialize(e.hitColor))},h);function h(t,e,i,o,n,s,r,h,l,a,u){var p=c.call(this,t,e,i,o,n,s,r,h,l,a,u)||this;return 0<p.inputs.length?p.inputs[0].on("data",function(t){p.proxyTerminal.setData(t)}):p.outputs[0].on("connect",function(t,e){0<p.proxyTerminal.connectors.length&&(e.data=p.proxyTerminal.connectors[0].data)}),p}e.TunnelNode=n},184:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(t,e,i,o){void 0===o&&(o=i),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,o){t[o=void 0===o?i:o]=e[i]}),h=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||r(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),e.FlowConnect=void 0;var l,u=i(676),p=i(281),c=i(522),d=i(974),a=i(522),f=i(645),n=(l=u.Hooks,n(y,l),Object.defineProperty(y.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"offContext",{get:function(){return this._offContext},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"offUIContext",{get:function(){return this._offUIContext},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"offGroupContext",{get:function(){return this._offGroupContext},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"cursor",{get:function(){return this.canvas.style.cursor},set:function(t){this.canvas.style.cursor=t},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"scale",{get:function(){return this._transform.a},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"transform",{get:function(){return this._transform},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"time",{get:function(){return this.startTime<0?this.startTime:performance.now()-this.startTime},enumerable:!1,configurable:!0}),y.prototype.registerChangeListeners=function(){var t=this,e=!1;document.addEventListener("scroll",function(){e||(window.requestAnimationFrame(function(){t.calculateCanvasDimension(),e=!1}),e=!0)}),new ResizeObserver(function(){t.calculateCanvasDimension()}).observe(this.canvas)},y.prototype.prepareCanvas=function(t,e,i){t?t instanceof HTMLDivElement?(this.canvas=document.createElement("canvas"),e&&i?(this.canvas.width=e,this.canvas.height=i):(this.canvas.width=t.clientWidth,this.canvas.height=t.clientHeight),t.appendChild(this.canvas)):t instanceof HTMLCanvasElement?(this.canvas=t,e&&i&&(this.canvas.width=e,this.canvas.height=i)):f.Log.error("mount provided is not of type HTMLDivElement or HTMLCanvasElement"):(this.canvas=document.createElement("canvas"),this.canvas.width=document.body.clientWidth,this.canvas.height=document.body.clientHeight,document.body.appendChild(this.canvas)),this._context=this.canvas.getContext("2d")},y.prototype.setupHitCanvas=function(){"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof OffscreenCanvasRenderingContext2D?(this.offCanvas=new OffscreenCanvas(this.canvasDimensions.width,this.canvasDimensions.height),this.offUICanvas=new OffscreenCanvas(this.canvasDimensions.width,this.canvasDimensions.height),this.offGroupCanvas=new OffscreenCanvas(this.canvasDimensions.width,this.canvasDimensions.height)):(this.offCanvas=document.createElement("canvas"),this.offUICanvas=document.createElement("canvas"),this.offGroupCanvas=document.createElement("canvas")),this._offContext=this.offCanvas.getContext("2d"),this._offUIContext=this.offUICanvas.getContext("2d"),this._offGroupContext=this.offGroupCanvas.getContext("2d")},y.prototype.attachStyles=function(){this.canvas.style.touchAction="none";var t=document.createElement("style");t.innerHTML="input.flow-connect-input { position: fixed; visibility: hidden; pointer-events: none; z-index: 100; border: none; border-radius: 0; box-sizing: border-box;} input.flow-connect-input:focus { outline: none; }",document.getElementsByTagName("head")[0].appendChild(t)},y.prototype.calculateCanvasDimension=function(){var t=this.canvas.getBoundingClientRect();this.canvasDimensions={top:Math.round(t.top-window.scrollY),left:Math.round(t.left-window.scrollX),width:Math.round(t.width),height:Math.round(t.height)},this.offCanvas.width=this.canvasDimensions.width,this.offCanvas.height=this.canvasDimensions.height,this.offUICanvas.width=this.canvasDimensions.width,this.offUICanvas.height=this.canvasDimensions.height,this.offGroupCanvas.width=this.canvasDimensions.width,this.offGroupCanvas.height=this.canvasDimensions.height},y.prototype.polyfill=function(){CanvasRenderingContext2D.prototype.roundRect=function(t,e,i,o,n){this.beginPath(),this.moveTo(t+n,e),this.lineTo(t+i-n,e),this.quadraticCurveTo(t+i,e,t+i,e+n),this.lineTo(t+i,e+o-n),this.quadraticCurveTo(t+i,e+o,t+i-n,e+o),this.lineTo(t+n,e+o),this.quadraticCurveTo(t,e+o,t,e+o-n),this.lineTo(t,e+n),this.quadraticCurveTo(t,e,t+n,e),this.closePath()},CanvasRenderingContext2D.prototype.strokeRoundRect=function(t,e,i,o,n){void 0===n&&(n=5),this.roundRect(t,e,i,o,n),this.stroke()},CanvasRenderingContext2D.prototype.fillRoundRect=function(t,e,i,o,n){void 0===n&&(n=5),this.roundRect(t,e,i,o,n),this.fill()}},y.prototype.registerEvents=function(){var r,h=this,l=p.Vector2.Zero(),a=-1;window.onkeydown=function(t){h.keymap[t.key]||(h.keymap[t.key]=!0)},window.onkeyup=function(t){h.keymap[t.key]=!1},this.canvas.onpointerdown=function(t){h.currFlow&&(h.addPointer(t.pointerId,h.getRelativePosition(t)),1===h.pointers.length?(l=h.pointers[0].screenPosition,h.currHitNode=h.getHitNode(h.pointers[0].screenPosition),h.currHitNode?(h.currHitNode.zIndex=Number.MAX_SAFE_INTEGER,h.keymap.Control?h.currHitNode.focused=!h.currHitNode.focused:(h.currFlow.removeAllFocus(),h.currHitNode.focused=!0),h.currHitNode.onDown(h.pointers[0].screenPosition.clone(),h.pointers[0].realPosition.clone()),r=h.currHitNode.position.subtract(h.pointers[0].realPosition)):h.keymap.Control?(h.keymap.Control||h.touchControls.CreateGroup)&&(h.groupStartPoint=h.pointers[0].realPosition.clone(),h.currGroup=new u.Group(h.currFlow,h.groupStartPoint.clone(),0,0,"New Group")):(h.currFlow.removeAllFocus(),h.currHitGroup=h.getHitGroup(h.pointers[0].screenPosition),h.currHitGroup&&(r=h.currHitGroup.position.subtract(h.pointers[0].realPosition)))):(h.currHitNode=null,h.currHitGroup=null,h.currFlow.removeAllFocus(),h.floatingConnector&&h.fallbackConnection()))},this.canvas.onpointerup=function(t){var e,i,o;h.currFlow&&(h.removePointer(h.pointers,t),h.pointers.length<2&&(a=-1),i=(e=h.getRelativePosition(t)).transform(h.inverseTransform),h.currHitNode&&h.handleGrouping(e),h.currHitNode=null,h.currHitGroup=null,(o=h.getHitNode(e))&&o.onUp(e.clone(),i.clone()),h.currGroup&&(t=h.currGroup,h.currGroup=null,10<t.width&&10<t.height&&(h.currFlow.groups.push(t),t.setContainedNodes())),h.floatingConnector&&h.handleConnection(o,e,i))},this.canvas.onpointerout=function(t){var e,i;h.currFlow&&(h.removePointer(h.pointers,t),0===h.pointers.length&&(h.currHitNode&&(i=h.getRelativePosition(t),h.handleGrouping(i)),h.currHitNode=null,h.currHitGroup=null),h.currGroup&&(e=h.currGroup,h.currGroup=null,10<e.width&&10<e.height&&(h.currFlow.groups.push(e),e.setContainedNodes())),h.floatingConnector&&h.fallbackConnection(),h.prevHitNode&&(t=(i=h.getRelativePosition(t)).transform(h.inverseTransform),h.prevHitNode.onExit(i,t),h.prevHitNode=null))},this.canvas.onpointermove=function(t){var e,i,o,n,s;h.currFlow&&(i=(e=h.getRelativePosition(t)).transform(h.inverseTransform),h.updatePointer(t.pointerId,e,i),2===h.pointers.length&&(n=p.Vector2.Distance(h.pointers[0].screenPosition,h.pointers[1].screenPosition),0<a&&n!==a&&h.handleZoom(a<n,p.Vector2.Midpoint(h.pointers[0].screenPosition,h.pointers[1].screenPosition),h.pinchScaleDelta),a=n),h.currGroup&&(i.x<h.groupStartPoint.x&&(h.currGroup.position.x=i.x),h.currGroup.width=Math.abs(h.groupStartPoint.x-i.x),i.y<h.groupStartPoint.y&&(h.currGroup.position.y=i.y),h.currGroup.height=Math.abs(h.groupStartPoint.y-i.y)),h.currHitNode?(h.currHitNode.onDrag(e.clone(),i.clone()),h.currHitNode.currHitUINode&&h.currHitNode.currHitUINode.draggable||h.currHitNode.currHitTerminal||h.floatingConnector||(h.currHitNode.position=i.add(r),(s=h.getHitGroup(e))&&s===h.currHitNode.group&&(o=s.position.transform(h._transform),n=h.currHitNode.position.transform(h._transform),d.intersects(o.x,o.y,o.x+s.width*h.scale,o.y+s.height*h.scale,n.x,n.y,n.x+h.currHitNode.width*h.scale,n.y+h.currHitNode.ui.height*h.scale)===c.ViewPort.INSIDE&&(n=s.nodes.findIndex(function(t){return t.id===h.currHitNode.id}),s.nodeDeltas[n]=h.currHitNode.position.subtract(s.position))))):h.currHitGroup?h.currHitGroup.position=i.add(r):1!==h.pointers.length||h.keymap.Control||h.touchControls.CreateGroup||(s=e.subtract(l).multiplyInPlace(1/h.scale),l=e,h.updateTransform(null,null,s)),h.floatingConnector&&(h.floatingConnector.floatingTip=i),"mouse"!==t.pointerType||h.currHitNode||((t=h.getHitNode(e))!==h.prevHitNode?(h.prevHitNode&&h.prevHitNode.onExit(e,i),t&&t.onEnter(e,i)):t&&!h.currHitNode&&t.onOver(e,i),h.prevHitNode=t))},this.canvas.onclick=function(t){var e,i;h.currFlow&&(i=(e=h.getRelativePosition(t)).transform(h.inverseTransform),(t=h.getHitNode(e))&&t.onClick(e.clone(),i.clone()),t||(t=h.getHitGroup(e))&&t.onClick(e.clone(),i.clone()))},this.canvas.oncontextmenu=function(t){h.currFlow&&(t.preventDefault(),t=h.getRelativePosition(t),(t=h.getHitNode(t))&&t.onContextMenu(),h.keymap.Control||h.currFlow.removeAllFocus(),t&&(t.focused=!0))},this.canvas.onwheel=function(t){h.currFlow&&h.handleZoom(t.deltaY<0,h.getRelativePosition(t),h.wheelScaleDelta)}},y.prototype.setGenericInput=function(){var t=this;this.genericInput.className="flow-connect-input",this.genericInput.style.visibility="hidden",this.genericInput.style.pointerEvents="none",this.genericInput.style.padding="0",this.genericInput.onblur=function(){t.genericInput.style.visibility="hidden",t.genericInput.style.pointerEvents="none",t.genericInput.onchange=null},document.body.appendChild(this.genericInput)},y.prototype.showGenericInput=function(t,e,i,o,n){var s=this;document.activeElement!==this.genericInput&&(Object.keys(i).forEach(function(t){return s.genericInput.style[t]=i[t]}),Object.keys(o).forEach(function(t){return s.genericInput[t]=o[t]}),this.genericInput.style.left=t.x+this.canvasDimensions.left+"px",this.genericInput.style.top=t.y+this.canvasDimensions.top-3+"px",this.genericInput.style.visibility="visible",this.genericInput.style.pointerEvents="all",this.genericInput.value=e,this.genericInput.onchange=function(){return n(s.genericInput.value)},this.genericInput.focus())},y.prototype.updatePointer=function(e,t,i){var o=this.pointers.find(function(t){return t.id===e});o&&(o.screenPosition=t,o.realPosition=i)},y.prototype.handleZoom=function(t,e,i){this._transform.a>=this.maxScale&&t||this._transform.a<=this.minScale&&!t||this.updateTransform(t?i:1/i,e,null)},y.prototype.handleGrouping=function(t){var e,i,o=this,n=this.getHitGroup(t);n&&(t=n.position.transform(this._transform),e=this.currHitNode.position.transform(this._transform),e=d.intersects(t.x,t.y,t.x+n.width*this.scale,t.y+n.height*this.scale,e.x,e.y,e.x+this.currHitNode.width*this.scale,e.y+this.currHitNode.ui.height*this.scale)),this.currHitNode.group&&(this.currHitNode.group!==n?(i=this.currHitNode.group.nodes.findIndex(function(t){return t.id===o.currHitNode.id}),this.currHitNode.group.nodes.splice(i,1),this.currHitNode.group.nodeDeltas.splice(i,1),this.currHitNode.group=null):e!==c.ViewPort.INSIDE&&(i=this.currHitNode.group.nodes.findIndex(function(t){return t.id===o.currHitNode.id}),this.currHitNode.group.nodes.splice(i,1),this.currHitNode.group.nodeDeltas.splice(i,1),this.currHitNode.group=null)),n&&e===c.ViewPort.INSIDE&&((this.currHitNode.group=n).nodes.push(this.currHitNode),n.nodeDeltas.push(this.currHitNode.position.subtract(n.position)))},y.prototype.handleConnection=function(t,e,i){if(t){e=t.getHitTerminal(u.Color.rgbaToString(this._offUIContext.getImageData(e.x,e.y,1,1).data),e.clone(),i.clone());if(e&&(t.currHitTerminal=e),e){i=t.currHitTerminal;if(this.floatingConnector.canConnect(i)){if(i.type===c.TerminalType.OUT)this.floatingConnector.completeConnection(i),t.currHitTerminal=null;else if(0<i.connectors.length){if(i.connectors[0].start===this.floatingConnector.start)return this.fallbackConnection(),void(t.currHitTerminal=null);e=i.connectors[0].start.connectors.indexOf(i.connectors[0]),e=i.connectors[0].start.connectors.splice(e,1)[0];delete this.currFlow.connectors[e.id],e.start.call("disconnect",e.start,e),e.end.call("disconnect",e.end,e),this.floatingConnector.completeConnection(i),t.currHitTerminal=null}else this.floatingConnector.completeConnection(i),t.currHitTerminal=null;this.floatingConnector=null}else this.fallbackConnection(),t.currHitTerminal=null}else this.fallbackConnection()}else this.fallbackConnection()},y.prototype.getRelativePosition=function(t){return new p.Vector2(t.clientX-this.canvasDimensions.left,t.clientY-this.canvasDimensions.top)},y.prototype.updateTransform=function(t,e,i){t&&(e=e.transform(this.inverseTransform),this._transform.translateSelf(e.x,e.y).scaleSelf(t,t).translateSelf(-e.x,-e.y)),i&&this._transform.translateSelf(i.x,i.y),this.inverseTransform=this._transform.inverse(),this._context.setTransform(this._transform),this._offContext.setTransform(this._transform),this._offUIContext.setTransform(this._transform),this._offGroupContext.setTransform(this._transform),this.call("transform",this)},y.prototype.fallbackConnection=function(){this.floatingConnector.removeConnection(),this.currFlow.removeConnector(this.floatingConnector.id)},y.prototype.addPointer=function(t,e){this.pointers.push({id:t,screenPosition:e,realPosition:e.transform(this.inverseTransform)})},y.prototype.removePointer=function(t,e){t.splice(t.findIndex(function(t){return t.id===e.pointerId}),1)},y.prototype.getHitNode=function(t){t=u.Color.rgbaToString(this._offContext.getImageData(t.x,t.y,1,1).data);return this.currFlow.hitColorToNode[t]},y.prototype.getHitGroup=function(t){t=u.Color.rgbaToString(this._offGroupContext.getImageData(t.x,t.y,1,1).data);return this.currFlow.hitColorToGroup[t]},y.prototype.clear=function(){this._context.save(),this._context.setTransform(this.identity),this._context.clearRect(0,0,this.canvasDimensions.width,this.canvasDimensions.height),this._context.restore(),this._offContext.save(),this._offContext.setTransform(this.identity),this._offContext.clearRect(0,0,this.canvasDimensions.width,this.canvasDimensions.height),this._offContext.restore(),this._offUIContext.save(),this._offUIContext.setTransform(this.identity),this._offUIContext.clearRect(0,0,this.canvasDimensions.width,this.canvasDimensions.height),this._offUIContext.restore(),this._offGroupContext.save(),this._offGroupContext.setTransform(this.identity),this._offGroupContext.clearRect(0,0,this.canvasDimensions.width,this.canvasDimensions.height),this._offGroupContext.restore()},y.prototype.startGlobalTime=function(){this.startTime<0&&(this.startTime=performance.now(),this._startGlobalTime())},y.prototype._startGlobalTime=function(){this.call("tick",this),this.timerId=window.requestAnimationFrame(this._startGlobalTime.bind(this))},y.prototype.stopGlobalTime=function(){for(var t=!0,e=0,i=this.flows;e<i.length;e++)if(i[e].state!==a.FlowState.Stopped){t=!1;break}t&&(cancelAnimationFrame(this.timerId),this.startTime=-1,this.call("tickreset",this))},y.prototype._render=function(){this.clear(),this.currGroup&&this.currGroup.render(),this.currFlow.render(),this.call("update",this),this.frameId=window.requestAnimationFrame(this._render.bind(this))},y.prototype.createFlow=function(t){(t=void 0===t?{name:"New Flow",rules:{},terminalTypeColors:{}}:t).rules=s(s({},t.rules),c.Constant.DefaultRules);t=new u.Flow(this,t.name,t.rules,t.terminalTypeColors);return this.flows.push(t),t},y.prototype.render=function(t){t!==this.currFlow&&(this.currFlow&&(window.cancelAnimationFrame(this.frameId),this.currFlow.deregisterListeners()),this.rootFlow&&this.rootFlow.existsInFlow(t)||(this.rootFlow=t),this.currFlow=t,this._render())},y.prototype.top=function(){this.render(this.rootFlow)},y.prototype.fromJson=function(t){var e,i=null;try{e=JSON.parse(t),i=u.Flow.deSerialize(this,e)}catch(t){f.Log.error(t)}return i},y.prototype.toJson=function(t){var e=t.serialize();try{return JSON.stringify(e,null)}catch(t){f.Log.error(t)}},y);function y(t,e,i){var o=l.call(this)||this;return o.canvasDimensions={top:0,left:0,width:0,height:0},o.flows=[],o.pointers=[],o.keymap={},o.touchControls={CreateGroup:!1},o.genericInput=document.createElement("input"),o.minScale=.1,o.maxScale=5,o.wheelScaleDelta=1.05,o.pinchScaleDelta=1.02,o._transform=new DOMMatrix,o.inverseTransform=new DOMMatrix,o.identity=new DOMMatrix,o.startTime=-1,o.prepareCanvas(t,e,i),o.setupHitCanvas(),o.calculateCanvasDimension(),o.registerChangeListeners(),o.attachStyles(),o.polyfill(),o.registerEvents(),o.setGenericInput(),o}e.FlowConnect=n,h(i(676),e),h(i(81),e),h(i(637),e),h(i(928),e)},522:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GraphState=e.FlowState=e.UIType=e.Align=e.InputType=e.TerminalType=e.LOD=e.NodeState=e.ViewPort=e.Constant=void 0;var o,n=i(281),i=(s.TAU=.017453292519943295,s.DefaultRules={string:["string","any"],number:["number","any"],boolean:["boolean","any"],file:["file","any"],event:["event","any"],any:["any"]},s.DefaultGroupColors={colors:[["rgba(239, 134, 119, 1)","rgba(239, 134, 119, .5)"],["rgba(160, 231, 125, 1)","rgba(160, 231, 125, .5)"],["rgba(130, 182, 217, 1)","rgba(130, 182, 217, .5)"]],RED:function(){return s.DefaultGroupColors.colors[0]},GREEN:function(){return s.DefaultGroupColors.colors[1]},BLUE:function(){return s.DefaultGroupColors.colors[2]},Random:function(){return s.DefaultGroupColors.colors[Math.floor(Math.random()*s.DefaultGroupColors.colors.length)]}},s.DefaultNodeStyle=function(){return{font:"arial",fontSize:".75rem",titleFont:"arial",titleFontSize:".85rem",color:"#000",titleColor:"#000",maximizeButtonColor:"darkgrey",nodeButtonSize:10,nodeButtonSpacing:5,expandButtonColor:"#000",padding:10,spacing:10,rowHeight:20,titleHeight:29,terminalRowHeight:24,terminalStripMargin:8}},s.DefaultConnectorStyle=function(){return{width:5,color:"#7fff00aa"}},s.DefaultGroupStyle=function(){return{titleColor:"#000",fontSize:"16px",font:"arial"}},s.DefaultTerminalStyle=function(){return{radius:4,borderColor:"#222",shadowBlur:0,shadowColor:"#ccc",focusColor:"#bbbbbb80"}},s.DefaultButtonStyle=function(){return{backgroundColor:"#666",padding:5,color:"#fff",font:"arial",fontSize:"11px"}},s.DefaultContainerStyle=function(){return{backgroundColor:"#dddddd",shadowColor:"#666",shadowBlur:3,shadowOffset:new n.Vector2(3,3),borderWidth:1,borderColor:"#444"}},s.DefaultDisplayStyle=function(){return{borderColor:"#000"}},s.DefaultHorizontalLayoutStyle=function(){return{}},s.DefaultImageStyle=function(){return{align:"left"}},s.DefaultInputStyle=function(){return{backgroundColor:"#eee",color:"#000",fontSize:"11px",font:"arial",border:"1px solid black",align:"left",type:o.Text}},s.DefaultLabelStyle=function(){return{color:"#000",fontSize:"11px",font:"arial",align:"left"}},s.DefaultSelectStyle=function(){return{arrowColor:"#000"}},s.DefaultSliderStyle=function(t){return{color:"#444",thumbColor:"#000",railHeight:3,thumbRadius:t/2}},s.DefaultSourceStyle=function(){return{borderColor:"#000"}},s.DefaultToggleStyle=function(){return{backgroundColor:"#999",color:"#000"}},s);function s(){}e.Constant=i,(i=e.ViewPort||(e.ViewPort={})).INSIDE="INSIDE",i.OUTSIDE="OUTSIDE",i.INTERSECT="INTERSECT",(i=e.NodeState||(e.NodeState={}))[i.MAXIMIZED=0]="MAXIMIZED",i[i.MINIMIZED=1]="MINIMIZED",(i=e.LOD||(e.LOD={}))[i.LOD0=0]="LOD0",i[i.LOD1=1]="LOD1",i[i.LOD2=2]="LOD2",(i=e.TerminalType||(e.TerminalType={}))[i.IN=1]="IN",i[i.OUT=2]="OUT",(i=o=e.InputType||(e.InputType={})).Text="text",i.Number="number",(i=e.Align||(e.Align={}))[i.Left=0]="Left",i[i.Right=1]="Right",(i=e.UIType||(e.UIType={}))[i.Button=0]="Button",i[i.Container=1]="Container",i[i.Display=2]="Display",i[i.HorizontalLayout=3]="HorizontalLayout",i[i.Image=4]="Image",i[i.Input=5]="Input",i[i.Label=6]="Label",i[i.Select=7]="Select",i[i.Slider=8]="Slider",i[i.Source=9]="Source",i[i.Toggle=10]="Toggle",(i=e.FlowState||(e.FlowState={}))[i.Running=0]="Running",i[i.Stopped=1]="Stopped",(e=e.GraphState||(e.GraphState={}))[e.Running=0]="Running",e[e.FullRun=1]="FullRun",e[e.Idle=2]="Idle",e[e.Stopped=3]="Stopped"},81:function(t,e,i){var o=this&&this.__createBinding||(Object.create?function(t,e,i,o){void 0===o&&(o=i),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,o){t[o=void 0===o?i:o]=e[i]}),n=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||o(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),n(i(522),e),n(i(281),e)},281:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Vector2=void 0;var i=(n.prototype.toString=function(){return"["+this.x.toFixed(3)+", "+this.y.toFixed(3)+"]"},n.prototype.add=function(t,e){return t instanceof n?new n(this.x+t.x,this.y+t.y):new n(this.x+t,void 0===e?this.y+t:this.y+e)},n.prototype.addInPlace=function(t,e){return t instanceof n?(this.x+=t.x,this.y+=t.y):void 0===e?(this.x+=t,this.y+=t):(this.x+=t,this.y+=e),this},n.prototype.multiply=function(t,e){return t instanceof n?new n(this.x*t.x,this.y*t.y):new n(this.x*t,void 0===e?this.y*t:this.y*e)},n.prototype.multiplyInPlace=function(t,e){return t instanceof n?(this.x*=t.x,this.y*=t.y):void 0===e?(this.x*=t,this.y*=t):(this.x*=t,this.y*=e),this},n.prototype.subtract=function(t,e){return t instanceof n?new n(this.x-t.x,this.y-t.y):new n(this.x-t,void 0===e?this.y-t:this.y-e)},n.prototype.subtractInPlace=function(t,e){return t instanceof n?(this.x-=t.x,this.y-=t.y):void 0===e?(this.x-=t,this.y-=t):(this.x-=t,this.y-=e),this},n.prototype.transform=function(t){return new n(t.transformPoint(this))},n.prototype.transformInPlace=function(t){var t=t.transformPoint(this),t=[t.x,t.y];return this.x=t[0],this.y=t[1],this},n.prototype.max=function(){return Math.max(this.x,this.y)},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.clamp=function(t,e,i,o){return this.x<t?this.x=t:this.x>e&&(this.x=e),this.y<i?this.y=i:this.y>o&&(this.y=o),this},n.Distance=function(t,e,i,o){return t instanceof n&&e instanceof n?Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)):"number"==typeof t&&"number"==typeof e?Math.sqrt(Math.pow(i-t,2)+Math.pow(o-e,2)):void 0},n.Midpoint=function(t,e){return new n((t.x+e.x)/2,(t.y+e.y)/2)},n.Zero=function(){return new n(0,0)},n.Random=function(t,e,i,o){return new n(Math.random()*(e-t)+t,Math.random()*(o-i)+i)},n.prototype.serialize=function(){return{x:this.x,y:this.y}},n.deSerialize=function(t){return new n(t.x,t.y)},n);function n(t,e){var i;t instanceof DOMPoint?(i=[t.x,t.y],this.x=i[0],this.y=i[1]):(e=[t||0,e||0],this.x=e[0],this.y=e[1])}e.Vector2=i},124:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.fileIcon=void 0,e.fileIcon="data:image/svg+xml;charset=UTF-8,%3c?xml version='1.0' encoding='iso-8859-1'?%3e%3c!-- --%3e%3csvg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 477.867 477.867' style='enable-background:new 0 0 477.867 477.867;' xml:space='preserve'%3e%3cg%3e%3cg%3e%3cpath d='M324.267,119.467c-9.426,0-17.067-7.641-17.067-17.067V0H102.4C74.123,0,51.2,22.923,51.2,51.2v375.467 c0,28.277,22.923,51.2,51.2,51.2h273.067c28.277,0,51.2-22.923,51.2-51.2v-307.2H324.267z'/%3e%3c/g%3e%3c/g%3e%3cg%3e%3cg%3e%3cpolygon points='341.333,10.001 341.333,85.333 416.666,85.333 '/%3e%3c/g%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3c/svg%3e"},283:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__assign||function(){return(a=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Button=void 0;var u,p=i(900),c=i(281),d=i(522),f=i(120),s=i(681),y=i(278),n=(u=s.UINode,n(r,u),r.prototype.paint=function(){this.context.fillStyle=this.style.backgroundColor,this.context.fillRect(this.position.x,this.position.y,this.width,this.height)},r.prototype.paintLOD1=function(){this.context.strokeStyle="#000",this.paint(),this.context.strokeRect(this.position.x,this.position.y,this.width,this.height)},r.prototype.offPaint=function(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)},r.prototype.reflow=function(){this.label.position=this.position,this.label.height=this.height,this.label.width=this.width,this.input&&(this.input.position.x=this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.input.position.y=this.position.y+this.height/2),this.output&&(this.output.position.x=this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.output.position.y=this.position.y+this.height/2)},r.prototype.onPropChange=function(){},r.prototype.onOver=function(t,e){this.disabled||this.call("over",this,t,e)},r.prototype.onDown=function(t,e){this.disabled||this.call("down",this,t,e)},r.prototype.onUp=function(t,e){this.disabled||this.call("up",this,t,e)},r.prototype.onClick=function(t,e){this.disabled||this.call("click",this,t,e)},r.prototype.onDrag=function(t,e){this.disabled||this.call("drag",this,t,e)},r.prototype.onEnter=function(t,e){this.disabled||this.call("enter",this,t,e)},r.prototype.onExit=function(t,e){this.disabled||this.call("exit",this,t,e)},r.prototype.onContextMenu=function(){this.disabled||this.call("rightclick",this)},r.prototype.serialize=function(){return{id:this.id,type:this.type,hitColor:this.hitColor.serialize(),height:this.height,text:this.text,style:this.style,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,childs:[]}},r.deSerialize=function(t,e){return new r(t,e.text,e.input,e.output,e.height,e.style,e.id,y.Color.deSerialize(e.hitColor))},r);function r(t,e,i,o,n,s,r,h){void 0===s&&(s={});var l=u.call(this,t,c.Vector2.Zero(),d.UIType.Button,!1,a(a({},d.Constant.DefaultButtonStyle()),s),null,i?"boolean"==typeof i?new p.Terminal(t,d.TerminalType.IN,"event","",{}):new p.Terminal(t,i.type,i.dataType,i.name,i.style,i.id,y.Color.deSerialize(i.hitColor)):null,o?"boolean"==typeof o?new p.Terminal(t,d.TerminalType.OUT,"event","",{}):p.Terminal.deSerialize(t,o):null,r,h)||this;return l.text=e,l.input&&l.input.on("event",function(){return l.call("click",l)}),l.height=n||l.node.style.rowHeight+2*l.style.padding,l.label=new f.Label(l.node,e,null,!1,!1,{fontSize:l.style.fontSize,font:l.style.font,align:"center",color:l.style.color},l.height),l.label.on("click",function(t,e){return l.call("click",l,e)}),l.children.push(l.label),l}e.Button=n},818:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Container=void 0;var r,h=i(278),l=i(522),a=i(281),u=i(283),p=i(119),c=i(104),d=i(799),f=i(560),y=i(120),g=i(136),w=i(526),m=i(2),v=i(369),i=i(681),n=(r=i.UINode,n(x,r),x.prototype.paint=function(){var t=this.context;t.shadowColor=this.style.shadowColor,t.shadowBlur=3,t.shadowOffsetX=this.style.shadowOffset.x,t.shadowOffsetY=this.style.shadowOffset.y,t.fillStyle=this.style.backgroundColor,t.strokeStyle=this.style.borderColor,t.lineWidth=this.style.borderWidth,t.roundRect(this.position.x,this.position.y+this.node.style.titleHeight,this.width,this.height-this.node.style.titleHeight,5),t.stroke(),t.fill()},x.prototype.paintLOD1=function(){var t=this.context;t.fillStyle=this.style.backgroundColor,t.strokeStyle=this.style.borderColor,t.lineWidth=this.style.borderWidth,t.roundRect(this.position.x,this.position.y+this.node.style.titleHeight,this.width,this.height-this.node.style.titleHeight,5),t.stroke(),t.fill()},x.prototype.offPaint=function(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)},x.prototype.reflow=function(){var e=this;this.position=this.node.position;var t=Math.max(this.node.inputs.length,this.node.outputs.length)*this.node.style.terminalRowHeight+this.node.style.titleHeight,i=this.position.x+this.node.style.padding,o=this.position.y+t;this.children.forEach(function(t){o+=e.node.style.spacing,t.width=e.width-2*e.node.style.padding,t.position=new a.Vector2(i,o),o+=t.height}),this.height=o+this.node.style.padding-this.position.y},x.prototype.onPropChange=function(){},x.prototype.onOver=function(t,e){this.call("over",this,t,e)},x.prototype.onDown=function(t,e){this.call("down",this,t,e)},x.prototype.onUp=function(t,e){this.call("up",this,t,e)},x.prototype.onClick=function(t,e){this.call("click",this,t,e)},x.prototype.onDrag=function(t,e){this.call("drag",this,t,e)},x.prototype.onEnter=function(t,e){this.call("enter",this,t,e)},x.prototype.onExit=function(t,e){this.call("exit",this,t,e)},x.prototype.onContextMenu=function(){},x.prototype.serialize=function(){return{id:this.id,type:this.type,hitColor:this.hitColor.serialize(),propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,width:this.width,style:{backgroundColor:this.style.backgroundColor,shadowColor:this.style.shadowColor,shadowBlur:this.style.shadowBlur,shadowOffset:this.style.shadowOffset.serialize(),borderWidth:this.style.borderWidth,borderColor:this.style.borderColor},childs:this.children.map(function(t){return t.serialize()})}},x.deSerialize=function(e,t){var i,o=new x(e,t.width,t.style,t.id,h.Color.deSerialize(t.hitColor));return(i=o.children).push.apply(i,t.childs.map(function(t){switch(t.type){case l.UIType.Button:return u.Button.deSerialize(e,t);case l.UIType.Container:return x.deSerialize(e,t);case l.UIType.Display:return p.Display.deSerialize(e,t);case l.UIType.HorizontalLayout:return c.HorizontalLayout.deSerialize(e,t);case l.UIType.Image:return d.Image.deSerialize(e,t);case l.UIType.Input:return f.Input.deSerialize(e,t);case l.UIType.Label:return y.Label.deSerialize(e,t);case l.UIType.Select:return g.Select.deSerialize(e,t);case l.UIType.Slider:return w.Slider.deSerialize(e,t);case l.UIType.Source:return m.Source.deSerialize(e,t);case l.UIType.Toggle:return v.Toggle.deSerialize(e,t);default:return}})),o},x);function x(t,e,i,o,n){void 0===i&&(i={});n=r.call(this,t,t.position,l.UIType.Container,!1,s(s({},l.Constant.DefaultContainerStyle()),i),null,null,null,o,n)||this;return n.width=void 0!==e?e:0,n.height=2*n.node.style.padding,n.contentWidth=n.width-2*n.node.style.padding,n}e.Container=n},119:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Display=void 0;var h,s=i(278),l=i(522),a=i(281),i=i(681),n=(h=i.UINode,n(u,h),u.prototype.customRender=function(){var e=this;return new Promise(function(t){e.offContext.clearRect(0,0,e.offCanvas.width,e.offCanvas.height),e.customRenderer(e.offContext,e.offCanvas.width,e.offCanvas.height),t()})},u.prototype.paint=function(){var t=this,e=this.context;e.strokeStyle=this.style.borderColor,e.lineWidth=1,e.strokeRect(this.position.x,this.position.y,this.width,this.height),this._rendering||(this._rendering=!0,this.customRender().finally(function(){return t._rendering=!1})),e.drawImage(this.offCanvas,0,0,this.offCanvas.width,this.offCanvas.height,this.position.x,this.position.y,this.node.width-2*this.node.style.padding,this.height)},u.prototype.paintLOD1=function(){var t=this.context;t.strokeStyle=this.style.borderColor,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillStyle="lightgrey",t.fillRect(this.position.x,this.position.y,this.width,this.height)},u.prototype.offPaint=function(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)},u.prototype.reflow=function(){this.offCanvas.width=this.node.width-2*this.node.style.padding,this.offCanvas.height=this.height},u.prototype.onPropChange=function(){},u.prototype.onOver=function(t,e){this.call("over",this,t,e)},u.prototype.onDown=function(t,e){this.call("down",this,t,e)},u.prototype.onUp=function(t,e){this.call("up",this,t,e)},u.prototype.onClick=function(t,e){this.call("click",this,t,e)},u.prototype.onDrag=function(t,e){this.call("drag",this,t,e)},u.prototype.onEnter=function(t,e){this.call("enter",this,t,e)},u.prototype.onExit=function(t,e){this.call("exit",this,t,e)},u.prototype.onContextMenu=function(){this.call("rightclick",this)},u.prototype.serialize=function(){return{id:this.id,type:this.type,hitColor:this.hitColor.serialize(),style:this.style,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,height:this.height,childs:[]}},u.deSerialize=function(t,e){return new u(t,e.height,null,e.style,e.id,s.Color.deSerialize(e.hitColor))},u);function u(t,e,i,o,n,s){void 0===o&&(o={});s=h.call(this,t,a.Vector2.Zero(),l.UIType.Display,!1,r(r({},l.Constant.DefaultDisplayStyle()),o),null,null,null,n,s)||this;return s._rendering=!1,s.customRenderer=i,s.height=e,"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof OffscreenCanvasRenderingContext2D?s.offCanvas=new OffscreenCanvas(s.node.width-2*s.node.style.padding,s.height):(s.offCanvas=document.createElement("canvas"),s.offCanvas.width=s.node.width-2*s.node.style.padding,s.offCanvas.height=s.height),s.offContext=s.offCanvas.getContext("2d"),s}e.Display=n},104:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.HorizontalLayout=void 0;var r,h=i(278),l=i(522),a=i(281),u=i(283),p=i(818),c=i(119),d=i(799),f=i(560),y=i(120),g=i(136),w=i(526),m=i(2),v=i(369),i=i(681),n=(r=i.UINode,n(x,r),x.prototype.paint=function(){},x.prototype.paintLOD1=function(){},x.prototype.offPaint=function(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)},x.prototype.reflow=function(){var i=this,o=this.width,n=this.position.x,e=0;this.children.forEach(function(t){e=Math.max(e,t.height)}),this.height=e,this.children.forEach(function(t){var e=t.style.grow?t.style.grow*i.width:1/i.children.length*i.width;o<e&&(e=o),t.width=e,t.height<i.height&&(t.height=i.height),t.position=new a.Vector2(n,i.position.y),o-=e,n+=e})},x.prototype.onPropChange=function(){},x.prototype.onOver=function(t,e){this.call("over",this,t,e)},x.prototype.onDown=function(t,e){this.call("down",this,t,e)},x.prototype.onUp=function(t,e){this.call("up",this,t,e)},x.prototype.onClick=function(t,e){this.call("click",this,t,e)},x.prototype.onDrag=function(t,e){this.call("drag",this,t,e)},x.prototype.onEnter=function(t,e){this.call("enter",this,t,e)},x.prototype.onExit=function(t,e){this.call("exit",this,t,e)},x.prototype.onContextMenu=function(){},x.prototype.serialize=function(){return{id:this.id,type:this.type,hitColor:this.hitColor.serialize(),propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,style:this.style,childs:this.children.map(function(t){return t.serialize()})}},x.deSerialize=function(e,t){var i,o=new x(e,[],t.style,t.id,h.Color.deSerialize(t.hitColor));return(i=o.children).push.apply(i,t.childs.map(function(t){switch(t.type){case l.UIType.Button:return u.Button.deSerialize(e,t);case l.UIType.Container:return p.Container.deSerialize(e,t);case l.UIType.Display:return c.Display.deSerialize(e,t);case l.UIType.HorizontalLayout:return x.deSerialize(e,t);case l.UIType.Image:return d.Image.deSerialize(e,t);case l.UIType.Input:return f.Input.deSerialize(e,t);case l.UIType.Label:return y.Label.deSerialize(e,t);case l.UIType.Select:return g.Select.deSerialize(e,t);case l.UIType.Slider:return w.Slider.deSerialize(e,t);case l.UIType.Source:return m.Source.deSerialize(e,t);case l.UIType.Toggle:return v.Toggle.deSerialize(e,t);default:return}})),o},x);function x(t,e,i,o,n){void 0===i&&(i={});o=r.call(this,t,a.Vector2.Zero(),l.UIType.HorizontalLayout,!1,s(s({},l.Constant.DefaultHorizontalLayoutStyle()),i),null,null,null,o,n)||this;return e&&(n=o.children).push.apply(n,e),o}e.HorizontalLayout=n},799:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=this&&this.__assign||function(){return(h=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Image=void 0;var l,s=i(278),a=i(522),u=i(281),p=i(645),i=i(681),n=(l=i.UINode,n(r,l),r.prototype.paint=function(){var t;this.imageCanvas&&(t=this.position.x,this.source.width<this.node.ui.contentWidth&&("center"===this.style.align?t+=this.node.ui.contentWidth/2-this.source.width/2:"right"===this.style.align&&(t+=+(this.node.ui.contentWidth-this.source.width))),this.context.drawImage(this.imageCanvas,0,0,this.source.width,this.source.height,t,this.position.y,this.width,this.height))},r.prototype.paintLOD1=function(){var t,e;this.imageCanvas&&(t=this.position.x,this.source.width<this.node.ui.contentWidth&&("center"===this.style.align?t+=this.node.ui.contentWidth/2-this.source.width/2:"right"===this.style.align&&(t+=+(this.node.ui.contentWidth-this.source.width))),(e=this.context).fillStyle="lightgrey",e.strokeStyle="#000",e.fillRect(t,this.position.y,this.width,this.height),e.strokeRect(t,this.position.y,this.width,this.height))},r.prototype.offPaint=function(){this.offUIContext.fillStyle=this.hitColor.hexValue;var t=this.position.x;this.source.width<this.node.ui.contentWidth&&("center"===this.style.align?t+=this.node.ui.contentWidth/2-this.source.width/2:"right"===this.style.align&&(t+=+(this.node.ui.contentWidth-this.source.width))),this.offUIContext.fillRect(t,this.position.y,this.width,this.height)},r.prototype.reflow=function(){this.source.width&&this.source.height&&(this.source.width>this.width?this.height=this.width/this.ratio:(this.width=this.source.width,this.height=this.source.height))},r.prototype.onPropChange=function(){},r.prototype.onOver=function(t,e){this.call("over",this,t,e)},r.prototype.onDown=function(t,e){this.call("down",this,t,e)},r.prototype.onUp=function(t,e){this.call("up",this,t,e)},r.prototype.onClick=function(t,e){this.call("click",this,t,e)},r.prototype.onDrag=function(t,e){this.call("drag",this,t,e)},r.prototype.onEnter=function(t,e){this.call("enter",this,t,e)},r.prototype.onExit=function(t,e){this.call("exit",this,t,e)},r.prototype.onContextMenu=function(){},r.prototype.serialize=function(){return{id:this.id,type:this.type,hitColor:this.hitColor.serialize(),style:this.style,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,source:this.sourceString,childs:[]}},r.deSerialize=function(t,e){return new r(t,e.source,e.propName,e.style,e.id,s.Color.deSerialize(e.hitColor))},r);function r(t,e,i,o,n,s){void 0===o&&(o={});var r=l.call(this,t,u.Vector2.Zero(),a.UIType.Image,!1,h(h({},a.Constant.DefaultImageStyle()),o),i,null,null,n,s)||this;return r.sourceString=e,r.source=document.createElement("img"),r.source.onload=function(){"undefined"!=typeof OffscreenCanvas?r.imageCanvas=new OffscreenCanvas(r.source.width,r.source.height):(r.imageCanvas=document.createElement("canvas"),r.imageCanvas.width=r.source.width,r.imageCanvas.height=r.source.height),r.imageCanvas.getContext("2d").drawImage(r.source,0,0),r.ratio=r.source.width/r.source.height,r.reflow(),r.node.ui.update()},r.source.onerror=function(t){return p.Log.error(t)},r.source.src=e,r}e.Image=n},637:function(t,e,i){var o=this&&this.__createBinding||(Object.create?function(t,e,i,o){void 0===o&&(o=i),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,o){t[o=void 0===o?i:o]=e[i]}),n=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||o(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),n(i(681),e),n(i(818),e),n(i(120),e),n(i(799),e),n(i(526),e),n(i(104),e),n(i(283),e),n(i(369),e),n(i(136),e),n(i(2),e),n(i(119),e),n(i(560),e)},560:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=this&&this.__assign||function(){return(u=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Input=void 0;var p,c=i(281),s=i(681),d=i(120),f=i(900),y=i(522),r=i(278),n=(p=s.UINode,n(h,p),Object.defineProperty(h.prototype,"value",{get:function(){return this.propName?this.node.props[this.propName]:this._value},set:function(t){t=this.style.type===y.InputType.Number&&"string"==typeof t?parseInt(t):t;this.propName?this.node.props[this.propName]=t:(this._value=t,this.label.text=this._value.toString(),this.inputEl.value=this._value.toString())},enumerable:!1,configurable:!0}),h.prototype.paint=function(){this.context.strokeStyle=this.style.border,this.context.strokeRect(this.position.x,this.position.y,this.width,this.height)},h.prototype.paintLOD1=function(){var t=this.context;t.strokeStyle=this.style.border,t.fillStyle=this.style.backgroundColor,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillRect(this.position.x,this.position.y,this.width,this.height)},h.prototype.offPaint=function(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)},h.prototype.reflow=function(){this.label.position=this.position,this.label.height=this.height,this.label.width=this.width,this.input&&(this.input.position.x=this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.input.position.y=this.position.y+this.height/2),this.output&&(this.output.position.x=this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.output.position.y=this.position.y+this.height/2)},h.prototype.onPropChange=function(t,e){e=this.style.type===y.InputType.Number&&"string"==typeof e?parseInt(e):e;this._value=e,this.label.text=this._value.toString(),this.inputEl.value=this._value.toString(),this.output&&this.output.setData(this.value)},h.prototype.onOver=function(t,e){this.disabled||this.call("over",this,t,e)},h.prototype.onDown=function(t,e){this.disabled||this.call("down",this,t,e)},h.prototype.onUp=function(t,e){this.disabled||this.call("up",this,t,e)},h.prototype.onClick=function(t,e){this.disabled||this.call("click",this,t,e)},h.prototype.onDrag=function(t,e){this.disabled||this.call("drag",this,t,e)},h.prototype.onEnter=function(t,e){this.disabled||this.call("enter",this,t,e)},h.prototype.onExit=function(t,e){this.disabled||this.call("exit",this,t,e)},h.prototype.onContextMenu=function(){this.disabled},h.prototype.serialize=function(){return{id:this.id,hitColor:this.hitColor.serialize(),type:this.type,style:this.style,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,value:this.value,height:this.height,childs:[]}},h.deSerialize=function(t,e){return new h(t,e.value,e.propName,e.input,e.output,e.height,e.style,e.id,r.Color.deSerialize(e.hitColor))},h);function h(t,e,i,o,n,s,r,h,l){void 0===r&&(r={});var a=p.call(this,t,c.Vector2.Zero(),y.UIType.Input,!1,u(u({},y.Constant.DefaultInputStyle()),r),i,o?"boolean"==typeof o?new f.Terminal(t,y.TerminalType.IN,r.type===y.InputType.Text?"string":"number","",{}):f.Terminal.deSerialize(t,o):null,n?"boolean"==typeof n?new f.Terminal(t,y.TerminalType.OUT,r.type===y.InputType.Text?"string":"number","",{}):f.Terminal.deSerialize(t,n):null,h,l)||this;return a.height=s||a.node.style.rowHeight,a.style.type===y.InputType.Number&&"string"==typeof e&&(e=parseInt(e)),a._value=e,a.label=new d.Label(a.node,a.value.toString(),null,!1,!1,{fontSize:a.style.fontSize,font:a.style.font,align:a.style.align,color:a.style.color},a.height),a.label.on("click",function(){var t;document.activeElement!==a.inputEl&&(a.inputEl.style.visibility="visible",a.inputEl.style.pointerEvents="all",t=a.position.transform(a.node.flow.flowConnect.transform),a.inputEl.style.top=t.y+a.node.flow.flowConnect.canvasDimensions.top+1+"px",a.inputEl.style.left=t.x+a.node.flow.flowConnect.canvasDimensions.left+1+"px",a.inputEl.style.width=(a.width-1)*a.node.flow.flowConnect.scale+"px",a.inputEl.style.height=(a.height-1)*a.node.flow.flowConnect.scale+"px",a.inputEl.style.fontFamily=a.style.font,a.inputEl.style.fontSize=parseInt(a.style.fontSize.replace("px",""))*a.node.flow.flowConnect.scale+"px",a.inputEl.style.color=a.style.color,a.inputEl.style.backgroundColor=a.style.backgroundColor,a.inputEl.style.textAlign=a.style.align,a.inputEl.focus())}),a.children.push(a.label),a.inputEl=document.createElement("input"),a.inputEl.className="flow-connect-input",a.inputEl.spellcheck=!1,a.inputEl.type=a.style.type,a.inputEl.value=a.value.toString(),a.inputEl.onblur=function(){a.inputEl.style.visibility="hidden",a.inputEl.style.pointerEvents="none"},a.inputEl.onchange=function(t){a.value=t.target.value,a.label.text=a.value.toString()},document.body.appendChild(a.inputEl),a.input&&(a.input.on("connect",function(t,e){e.data&&(a.value=e.data)}),a.input.on("data",function(t){t&&(a.value=t)})),a.output&&a.output.on("connect",function(t,e){return e.data=a.value}),a}e.Input=n},120:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=this&&this.__assign||function(){return(u=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Label=void 0;var p,c=i(900),d=i(281),f=i(522),s=i(681),r=i(278),n=(p=s.UINode,n(h,p),Object.defineProperty(h.prototype,"text",{get:function(){return this.propName?this.node.props[this.propName]:this._text},set:function(t){this.propName?this.node.props[this.propName]=t:(this._text=t,this.displayText=this._text,this.reflow())},enumerable:!1,configurable:!0}),h.prototype.paint=function(){var t=this.context;t.fillStyle=this.style.color,t.font=this.style.fontSize+" "+this.style.font,t.textBaseline="top";var e=this.position.y+this.height/2-this.textHeight/2,i=this.position.x;"left"===this.style.align?i+=5:"center"===this.style.align?i+=this.width/2-this.textWidth/2:"right"===this.style.align&&(i+=this.width-this.textWidth-5),t.fillText(this.displayText,i,e)},h.prototype.paintLOD1=function(){var t=this.context;t.strokeStyle="#000",t.fillStyle=this.style.color,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillRect(this.position.x,this.position.y,this.width,this.height)},h.prototype.offPaint=function(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)},h.prototype.reflow=function(){var t=this.context;t.font=this.style.fontSize+" "+this.style.font;var e=t.measureText(this.displayText);t.font=null,this.textWidth=e.width,this.textHeight=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent,void 0===this.textHeight&&((e=document.createElement("span")).style.font=this.style.fontSize+" "+this.style.font,e.textContent="M",document.body.appendChild(e),this.textHeight=e.offsetHeight,document.body.removeChild(e)),this.input&&(this.input.position.x=this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.input.position.y=this.position.y+this.height/2),this.output&&(this.output.position.x=this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.output.position.y=this.position.y+this.height/2)},h.prototype.onPropChange=function(t,e){this._text=e,this.displayText=this._text,this.reflow(),this.output&&this.output.setData(this.text)},h.prototype.onOver=function(t,e){this.disabled||this.call("over",this,t,e)},h.prototype.onDown=function(t,e){this.disabled||this.call("down",this,t,e)},h.prototype.onUp=function(t,e){this.disabled||this.call("up",this,t,e)},h.prototype.onClick=function(t,e){this.disabled||this.call("click",this,t,e)},h.prototype.onDrag=function(t,e){this.disabled||this.call("drag",this,t,e)},h.prototype.onEnter=function(t,e){this.disabled||this.call("enter",this,t,e)},h.prototype.onExit=function(t,e){this.disabled||this.call("exit",this,t,e)},h.prototype.onContextMenu=function(){this.disabled},h.prototype.serialize=function(){return{id:this.id,type:this.type,hitColor:this.hitColor.serialize(),style:this.style,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,height:this.height,text:this.text,childs:[]}},h.deSerialize=function(t,e){return new h(t,e.text,e.propName,e.input,e.output,e.style,e.height,e.id,r.Color.deSerialize(e.hitColor))},h);function h(t,e,i,o,n,s,r,h,l){void 0===e&&(e=""),void 0===s&&(s={});var a=p.call(this,t,d.Vector2.Zero(),f.UIType.Label,!1,u(u({},f.Constant.DefaultLabelStyle()),s),i,o?"boolean"==typeof o?new c.Terminal(t,f.TerminalType.IN,"string","",{}):c.Terminal.deSerialize(t,o):null,n?"boolean"==typeof n?new c.Terminal(t,f.TerminalType.OUT,"string","",{}):c.Terminal.deSerialize(t,n):null,h,l)||this;return a._text=a.propName?a.node.props[a.propName]:e,a.displayText=a._text,a.reflow(),a.height=r||a.textHeight,a.input&&(a.input.on("connect",function(t,e){e.data&&(a.text=e.data)}),a.input.on("data",function(t){t&&(a.text=t)})),a.output&&a.output.on("connect",function(t,e){return e.data=a.text}),a}e.Label=n},136:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=this&&this.__assign||function(){return(u=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Select=void 0;var p,c=i(900),d=i(281),f=i(120),s=i(681),y=i(522),r=i(278),n=(p=s.UINode,n(h,p),Object.defineProperty(h.prototype,"selected",{get:function(){if(this.propName){var t=this.node.props[this.propName];return t=0===this.options.length?"None":this.options.includes(t)?t:this.options[0]}return this._selected},set:function(t){t=0===this.options.length?"None":this.options.includes(t)?t:this.options[0];this.propName?this.node.props[this.propName]=t:(this._selected=t,this.label.text=this.selected)},enumerable:!1,configurable:!0}),h.prototype.paint=function(){var t=this.context;t.fillStyle=this.style.arrowColor,t.beginPath(),t.moveTo(this.position.x,this.position.y+this.height/2),t.lineTo(this.position.x+.15*this.width,this.position.y+.15*this.height),t.lineTo(this.position.x+.15*this.width,this.position.y+.85*this.height),t.lineTo(this.position.x,this.position.y+this.height/2),t.closePath(),t.fill(),t.fillStyle=this.style.arrowColor,t.beginPath(),t.moveTo(this.position.x+this.width,this.position.y+this.height/2),t.lineTo(this.position.x+.85*this.width,this.position.y+.15*this.height),t.lineTo(this.position.x+.85*this.width,this.position.y+.85*this.height),t.lineTo(this.position.x+this.width,this.position.y+this.height/2),t.closePath(),t.fill()},h.prototype.paintLOD1=function(){var t=this.context;t.fillStyle=this.style.arrowColor,t.strokeStyle="#000",t.fillRect(this.position.x,this.position.y,this.width,this.height),t.strokeRect(this.position.x,this.position.y,this.width,this.height)},h.prototype.offPaint=function(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)},h.prototype.reflow=function(){this.label.width=.7*this.width,this.label.position.x=this.position.x+.15*this.width,this.label.position.y=this.position.y+this.height/2-this.label.height/2,this.input&&(this.input.position.x=this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.input.position.y=this.position.y+this.height/2),this.output&&(this.output.position.x=this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.output.position.y=this.position.y+this.height/2)},h.prototype.onPropChange=function(t,e){e=0===this.options.length?"None":this.options.includes(e)?e:this.options[0];this._selected=e,this.label.text=this.selected,this.output&&this.output.setData(this.selected)},h.prototype.onOver=function(t,e){this.disabled||this.call("over",this,t,e)},h.prototype.onDown=function(t,e){this.disabled||this.call("down",this,t,e)},h.prototype.onUp=function(t,e){this.disabled||this.call("up",this,t,e)},h.prototype.onClick=function(t,e){if(!this.disabled&&(this.call("click",this,t,e),0!==this.options.length)){var i;if(e.x<this.position.x+.15*this.width)i=-1;else{if(!(e.x>this.position.x+.85*this.width))return;i=1}this.selected=this.options[((this.options.indexOf(this.selected)+i)%this.options.length+this.options.length)%this.options.length],this.label.text=this.selected,this.call("change",this,this.selected)}},h.prototype.onDrag=function(t,e){this.disabled||this.call("drag",this,t,e)},h.prototype.onEnter=function(t,e){this.disabled||this.call("enter",this,t,e)},h.prototype.onExit=function(t,e){this.disabled||this.call("exit",this,t,e)},h.prototype.onContextMenu=function(){this.disabled},h.prototype.serialize=function(){return{id:this.id,type:this.type,hitColor:this.hitColor.serialize(),style:this.style,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,options:this.options,height:this.height,childs:[]}},h.deSerialize=function(t,e){return new h(t,e.options,e.propName,e.input,e.output,e.height,e.style,e.id,r.Color.deSerialize(e.hitColor))},h);function h(t,e,i,o,n,s,r,h,l){void 0===e&&(e=[]),void 0===r&&(r={});var a=p.call(this,t,d.Vector2.Zero(),y.UIType.Select,!1,u(u({},y.Constant.DefaultSelectStyle()),r),i,o?"boolean"==typeof o?new c.Terminal(t,y.TerminalType.IN,"string","",{}):c.Terminal.deSerialize(t,o):null,n?"boolean"==typeof n?new c.Terminal(t,y.TerminalType.OUT,"string","",{}):c.Terminal.deSerialize(t,n):null,h,l)||this;return a.options=e,a.height=s||a.node.style.rowHeight,a._selected=0===a.options.length?"None":a.options[0],a.label=new f.Label(a.node,a.selected,null,!1,!1,u({align:"center"},a.style),a.height),a.children.push(a.label),a.input&&(a.input.on("connect",function(t,e){e.data&&(a.selected=e.data)}),a.input.on("data",function(t){t&&(a.selected=t)})),a.output&&a.output.on("connect",function(t,e){return e.data=a.selected}),a}e.Select=n},526:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=this&&this.__assign||function(){return(d=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Slider=void 0;var f,y=i(900),g=i(281),s=i(974),r=i(681),w=i(522),h=i(278),n=(f=r.UINode,n(l,f),Object.defineProperty(l.prototype,"value",{get:function(){return this.propName?this.node.props[this.propName]:this._value},set:function(t){t=s.clamp(t,this.min,this.max),this.propName?this.node.props[this.propName]=t:(this._value=t,this.call("change",this,this.value),this.reflow())},enumerable:!1,configurable:!0}),l.prototype.paint=function(){var t=this.context;t.lineWidth=this.style.railHeight,t.strokeStyle=this.style.color,t.lineCap="butt";var e=Math.max(this.position.x,this.position.x+this.thumbFill-3);e!==this.position.x&&(t.beginPath(),t.moveTo(this.position.x,this.position.y+this.height/2),t.lineTo(e,this.position.y+this.height/2),t.stroke()),(e=Math.min(this.position.x+2*this.style.thumbRadius+this.thumbFill+3,this.position.x+this.width))!==this.position.x+this.width&&(t.beginPath(),t.moveTo(e,this.position.y+this.height/2),t.lineTo(this.position.x+this.width,this.position.y+this.height/2),t.stroke()),t.fillStyle=this.style.thumbColor,t.beginPath(),t.arc(this.position.x+this.style.thumbRadius+this.thumbFill,this.position.y+this.height/2,this.style.thumbRadius,0,2*Math.PI),t.fill()},l.prototype.paintLOD1=function(){var t=this.context;t.strokeStyle="#000",t.fillStyle=this.style.color,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillRect(this.position.x,this.position.y,this.width,this.height)},l.prototype.offPaint=function(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)},l.prototype.reflow=function(){this.thumbFill=s.denormalize(s.normalize(this.value,this.min,this.max),0,this.width-2*this.style.thumbRadius),this.input&&(this.input.position.x=this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.input.position.y=this.position.y+this.height/2),this.output&&(this.output.position.x=this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.output.position.y=this.position.y+this.height/2)},l.prototype.onPropChange=function(t,e){this._value=e,this.reflow(),this.call("change",this,this.value),this.output&&this.output.setData(this.value)},l.prototype.onOver=function(t,e){this.disabled||this.call("over",this,t,e)},l.prototype.onDown=function(t,e){this.disabled||this.call("down",this,t,e)},l.prototype.onUp=function(t,e){this.disabled||this.call("up",this,t,e)},l.prototype.onClick=function(t,e){this.disabled||this.call("click",this,t,e)},l.prototype.onDrag=function(t,e){this.disabled||(this.call("drag",this,t,e),t=this.position.y+this.height/2-this.style.railHeight/2,this.thumbFill=e.clamp(this.position.x+this.style.thumbRadius,this.position.x+this.width-this.style.thumbRadius,t,t).subtract(this.position.x+this.style.thumbRadius,0).x,this.value=parseFloat(s.denormalize(s.normalize(this.thumbFill,0,this.width-2*this.style.thumbRadius),this.min,this.max).toFixed(this.precision)))},l.prototype.onEnter=function(t,e){this.disabled||this.call("enter",this,t,e)},l.prototype.onExit=function(t,e){this.disabled||this.call("exit",this,t,e)},l.prototype.onContextMenu=function(){this.disabled},l.prototype.serialize=function(){return{id:this.id,type:this.type,hitColor:this.hitColor.serialize(),style:this.style,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,min:this.min,max:this.max,value:this.value,precision:this.precision,height:this.height,childs:[]}},l.deSerialize=function(t,e){return new l(t,e.min,e.max,e.value,e.precision,e.propName,e.input,e.output,e.height,e.style,e.id,h.Color.deSerialize(e.hitColor))},l);function l(t,e,i,o,n,s,r,h,l,a,u,p){void 0===n&&(n=0),void 0===a&&(a={});var c=f.call(this,t,g.Vector2.Zero(),w.UIType.Slider,!0,d(d({},w.Constant.DefaultSliderStyle(l)),a),s,r?"boolean"==typeof r?new y.Terminal(t,w.TerminalType.IN,"number","",{}):y.Terminal.deSerialize(t,r):null,h?"boolean"==typeof h?new y.Terminal(t,w.TerminalType.OUT,"number","",{}):y.Terminal.deSerialize(t,h):null,u,p)||this;return c.min=e,c.max=i,c.precision=n,c.height=l||c.node.style.rowHeight,c.value=parseFloat(o.toFixed(c.precision)),c.input&&(c.input.on("connect",function(t,e){e.data&&(c.value=e.data)}),c.input.on("data",function(t){t&&(c.value=t)})),c.output&&c.output.on("connect",function(t,e){return e.data=c.value}),c}e.Slider=n},2:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=this&&this.__assign||function(){return(u=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Source=void 0;var p,c=i(900),d=i(281),f=i(124),y=i(799),g=i(120),s=i(681),w=i(522),r=i(278),n=(p=s.UINode,n(h,p),Object.defineProperty(h.prototype,"file",{get:function(){return this.propName?this.node.props[this.propName]:this._file},set:function(t){this.propName?this.node.props[this.propName]=t:(this._file=t,this.label.text=this._file.name.substring(0,this._file.name.toString().lastIndexOf(".")),this.call("change",this,this._file))},enumerable:!1,configurable:!0}),h.prototype.paint=function(){this.context.strokeStyle=this.style.borderColor,this.context.strokeRect(this.position.x,this.position.y,this.width,this.height)},h.prototype.paintLOD1=function(){var t=this.context;t.strokeStyle=this.style.borderColor,t.fillStyle=this.style.color,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillRect(this.position.x,this.position.y,this.width,this.height)},h.prototype.offPaint=function(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)},h.prototype.reflow=function(){this.label.width=this.width,this.label.height=this.height,this.label.position=this.position,this.fileIcon.width=.1*this.width,this.fileIcon.position.x=this.position.x+5,this.fileIcon.position.y=this.position.y+this.height/2-this.fileIcon.height/2,this.input&&(this.input.position.x=this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.input.position.y=this.position.y+this.height/2),this.output&&(this.output.position.x=this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.output.position.y=this.position.y+this.height/2)},h.prototype.onPropChange=function(t,e){this._file=e,this.label.text=this._file.name.substring(0,this._file.name.toString().lastIndexOf(".")),this.call("change",this,this._file),this.output&&this.output.setData(this._file)},h.prototype.onOver=function(t,e){this.disabled||this.call("over",this,t,e)},h.prototype.onDown=function(t,e){this.disabled||this.call("down",this,t,e)},h.prototype.onUp=function(t,e){this.disabled||this.call("up",this,t,e)},h.prototype.onClick=function(t,e){this.disabled||this.call("click",this,t,e)},h.prototype.onDrag=function(t,e){this.disabled||this.call("drag",this,t,e)},h.prototype.onEnter=function(t,e){this.disabled||this.call("enter",this,t,e)},h.prototype.onExit=function(t,e){this.disabled||this.call("exit",this,t,e)},h.prototype.onContextMenu=function(){this.disabled},h.prototype.serialize=function(){return{id:this.id,type:this.type,hitColor:this.hitColor.serialize(),style:this.style,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,accept:this.accept,height:this.height,childs:[]}},h.deSerialize=function(t,e){return new h(t,e.accept,e.propName,e.input,e.output,e.height,e.style,e.id,r.Color.deSerialize(e.hitColor))},h);function h(t,e,i,o,n,s,r,h,l){void 0===r&&(r={});var a=p.call(this,t,d.Vector2.Zero(),w.UIType.Source,!1,u(u({},w.Constant.DefaultSourceStyle()),r),i,o?"boolean"==typeof o?new c.Terminal(t,w.TerminalType.IN,"file","",{}):c.Terminal.deSerialize(t,o):null,n?"boolean"==typeof n?new c.Terminal(t,w.TerminalType.OUT,"file","",{}):c.Terminal.deSerialize(t,n):null,h,l)||this;return a.accept=e,a.height=s||a.node.style.rowHeight,a.htmlInput=document.createElement("input"),a.htmlInput.type="file",e&&(a.htmlInput.accept=e),a.htmlInput.onchange=function(){0<a.htmlInput.files.length&&(a.file=a.htmlInput.files[0])},a.label=new g.Label(a.node,"Select",null,!1,!1,u({align:"center"},a.style),a.height),a.label.on("click",function(){return a.htmlInput.click()}),a.fileIcon=new y.Image(a.node,f.fileIcon),a.children.push(a.label,a.fileIcon),a.input&&(a.input.on("connect",function(t,e){e.data&&(a.file=e.data)}),a.input.on("data",function(t){t&&(a.file=t)})),a.output&&a.output.on("connect",function(t,e){return e.data=a.file}),a}e.Source=n},369:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__assign||function(){return(a=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Toggle=void 0;var u,p=i(900),c=i(281),s=i(681),d=i(522),r=i(278),n=(u=s.UINode,n(h,u),Object.defineProperty(h.prototype,"checked",{get:function(){return this.propName?this.node.props[this.propName]:this._checked},set:function(t){this.propName?this.node.props[this.propName]=t:(this._checked=t,this.call("change",this,this.checked))},enumerable:!1,configurable:!0}),h.prototype.paint=function(){var t=this.context;t.strokeStyle=this.style.backgroundColor,t.lineWidth=.75*this.height,t.lineCap="round",t.beginPath(),t.moveTo(this.position.x+this.context.lineWidth/2,this.position.y+this.height/2),t.lineTo(this.position.x+this.width-this.context.lineWidth/2,this.position.y+this.height/2),t.stroke(),t.fillStyle=this.style.color,t.beginPath(),t.arc(this.checked?this.position.x+this.width-this.height/2:this.position.x+this.height/2,this.position.y+this.height/2,this.height/2,0,2*Math.PI),t.fill()},h.prototype.paintLOD1=function(){var t=this.context;t.strokeStyle=this.style.color,t.fillStyle=this.style.backgroundColor,t.strokeRect(this.position.x,this.position.y,this.width,this.height),t.fillRect(this.position.x,this.position.y,this.width,this.height)},h.prototype.offPaint=function(){this.offUIContext.fillStyle=this.hitColor.hexValue,this.offUIContext.fillRect(this.position.x,this.position.y,this.width,this.height)},h.prototype.reflow=function(){this.input&&(this.input.position.x=this.node.position.x-this.node.style.terminalStripMargin-this.input.style.radius,this.input.position.y=this.position.y+this.height/2),this.output&&(this.output.position.x=this.node.position.x+this.node.width+this.node.style.terminalStripMargin+this.output.style.radius,this.output.position.y=this.position.y+this.height/2)},h.prototype.onPropChange=function(t,e){this._checked=e,this.call("change",this,this.checked),this.output&&this.output.setData(this.checked)},h.prototype.onOver=function(t,e){this.disabled||this.call("over",this,t,e)},h.prototype.onDown=function(t,e){this.disabled||this.call("down",this,t,e)},h.prototype.onUp=function(t,e){this.disabled||this.call("up",this,t,e)},h.prototype.onClick=function(t,e){this.disabled||(this.call("click",this,t,e),this.checked=!this.checked)},h.prototype.onDrag=function(t,e){this.disabled||this.call("drag",this,t,e)},h.prototype.onEnter=function(t,e){this.disabled||this.call("enter",this,t,e)},h.prototype.onExit=function(t,e){this.disabled||this.call("exit",this,t,e)},h.prototype.onContextMenu=function(){this.disabled},h.prototype.serialize=function(){return{id:this.id,type:this.type,hitColor:this.hitColor.serialize(),style:this.style,propName:this.propName,input:this.input?this.input.serialize():null,output:this.output?this.output.serialize():null,checked:this.checked,height:this.height,childs:[]}},h.deSerialize=function(t,e){return new h(t,e.propName,e.input,e.output,e.height,e.style,e.id,r.Color.deSerialize(e.hitColor))},h);function h(t,e,i,o,n,s,r,h){void 0===s&&(s={});var l=u.call(this,t,c.Vector2.Zero(),d.UIType.Toggle,!1,a(a({},d.Constant.DefaultToggleStyle()),s),e,i?"boolean"==typeof i?new p.Terminal(t,d.TerminalType.IN,"boolean","",{}):p.Terminal.deSerialize(t,i):null,o?"boolean"==typeof o?new p.Terminal(t,d.TerminalType.OUT,"boolean","",{}):p.Terminal.deSerialize(t,o):null,r,h)||this;return l._checked=!1,l._checked=!!l.propName&&l.node.props[l.propName],l.height=n||l.node.style.rowHeight,l.input&&(l.input.on("connect",function(t,e){e.data&&(l.checked=e.data)}),l.input.on("data",function(t){void 0!==t&&(l.checked=t)})),l.output&&l.output.on("connect",function(t,e){return e.data=l.checked}),l}e.Toggle=n},681:function(t,e,i){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.UINode=void 0;var p,s=i(278),r=i(417),h=i(522),c=i(974),n=(p=r.Hooks,n(l,p),Object.defineProperty(l.prototype,"context",{get:function(){return this.node.context},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"offUIContext",{get:function(){return this.node.offUIContext},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"disabled",{get:function(){return this._disabled},set:function(e){this._disabled=e,this.children.forEach(function(t){return t.disabled=e})},enumerable:!1,configurable:!0}),l.prototype.append=function(t){var e;Array.isArray(t)?(e=this.children).push.apply(e,t):this.children.push(t),this.update()},l.prototype.update=function(){this.reflow(),this.children.forEach(function(t){return t.update()})},l.prototype.updateRenderState=function(){var t;this.node.renderState.nodeState!==h.NodeState.MINIMIZED&&(t=this.position.transform(this.node.flow.flowConnect.transform),this.renderState=c.intersects(0,0,this.node.flow.flowConnect.canvasDimensions.width,this.node.flow.flowConnect.canvasDimensions.height,t.x,t.y,t.x+this.width*this.node.flow.flowConnect.scale,t.y+this.height*this.node.flow.flowConnect.scale),this.children.forEach(function(t){return t.updateRenderState()}))},l.prototype.setHitColor=function(t){if(!t)for(t=s.Color.Random();this.node.hitColorToUI[t.rgbaString]||this.node.hitColorToTerminal[t.rgbaString];)t=s.Color.Random();this.hitColor=t,this.node.hitColorToUI[this.hitColor.rgbaString]=this},l.prototype.render=function(){var t;this.renderState!==h.ViewPort.OUTSIDE&&(t=this.context,this.node.renderState.lod===h.LOD.LOD1?(t.save(),this.paintLOD1(),t.restore()):this.node.renderState.lod===h.LOD.LOD2?(t.save(),this.paint(),t.restore(),this.offUIContext.save(),this.offPaint(),this.offUIContext.restore()):this.type===h.UIType.Container&&(t.save(),this.paintLOD1(),t.restore()),0<this.node.renderState.lod&&(this.input&&this.input.render(),this.output&&this.output.render()),this.children.forEach(function(t){return t.render()}))},l);function l(t,e,i,o,n,s,r,h,l,a){void 0===r&&(r=null),void 0===h&&(h=null),void 0===l&&(l=c.getNewGUID());var u=p.call(this)||this;return u.node=t,u.type=i,u.style=n,u.propName=s,u.input=r,u.output=h,u.id=l,u.width=0,u.height=0,u.hitColor=a,u.id=c.getNewGUID(),u.setHitColor(a),u.position=e,u.children=[],u.draggable=o,u.disabled=!1,u.propName&&u.node.addPropObserver(u.propName,u.onPropChange.bind(u)),r&&(u.node.inputsUI.push(u.input),u.input.on("connect",function(){return u.disabled=!0}),u.input.on("disconnect",function(){return u.disabled=!1})),h&&u.node.outputsUI.push(u.output),u}e.UINode=n},141:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AVLTree=e.AVLTreeNode=void 0;var n=function(t){this.data=t,this.height=1,this.left=null,this.right=null};e.AVLTreeNode=n;var i=(o.prototype.height=function(t){return t?t.height:0},o.prototype.rightRotate=function(t){var e=t.left;return t.left=e.right,(e.right=t).height=Math.max(t.left?t.left.height:0,t.right?t.right.height:0)+1,e.height=Math.max(e.left?e.left.height:0,e.right?e.right.height:0)+1,e},o.prototype.leftRotate=function(t){var e=t.right;return t.right=e.left,(e.left=t).height=Math.max(t.left?t.left.height:0,t.right?t.right.height:0)+1,e.height=Math.max(e.left?e.left.height:0,e.right?e.right.height:0)+1,e},o.prototype.getBalance=function(t){return t?(t.left?t.left.height:0)-(t.right?t.right.height:0):0},o.prototype.add=function(t){var e={node:null};return this.root=this._insert(this.root,t,e),this.dataRefToTreeNode[this.dataToTreeNodeMapper(t)]=e.node,this.size+=1,e.node},o.prototype._insert=function(t,e,i){if(!t){var o=new n([e]);return i.node=o}if(0===this.comparator(e,t.data[0]))return t.data.push(e),i.node=t;this.comparator(e,t.data[0])<0?t.left=this._insert(t.left,e,i):t.right=this._insert(t.right,e,i),t.height=1+Math.max(t.left?t.left.height:0,t.right?t.right.height:0);i=this.getBalance(t);return 1<i&&this.comparator(e,t.left.data[0])<0?this.rightRotate(t):1<i&&0<this.comparator(e,t.left.data[0])?(t.left=this.leftRotate(t.left),this.rightRotate(t)):i<-1&&0<this.comparator(e,t.right.data[0])?this.leftRotate(t):i<-1&&this.comparator(e,t.right.data[0])<0?(t.right=this.rightRotate(t.right),this.leftRotate(t)):t},o.prototype.remove=function(t){var e={deleted:!1};return this.root=this._delete(this.root,t,e),delete this.dataRefToTreeNode[this.dataToTreeNodeMapper(t)],--this.size,e.deleted},o.prototype._delete=function(t,e,i){var o,n=this;if(!t)return t;if(this.comparator(e,t.data[0])<0)t.left=this._delete(t.left,e,i);else if(0<this.comparator(e,t.data[0]))t.right=this._delete(t.right,e,i);else{if(1<t.data.length){var s=t.data.findIndex(function(t){return n.dataToTreeNodeMapper(t)===n.dataToTreeNodeMapper(e)});return-1<s?(t.data.splice(s,1),i.deleted=!0):i.deleted=!1,t}t.left&&t.right?(o=this.minValue(t.right),t.data=o.data,t.right=this._delete(t.right,o.data[0],i)):(o=null,t=(o=t.left||t.right)||(o=t,null)),i.deleted=!0}if(!t)return t;t.height=Math.max(t.left?t.left.height:0,t.right?t.right.height:0)+1;i=this.getBalance(t);return 1<i&&0<=this.getBalance(t.left)?this.rightRotate(t):1<i&&this.getBalance(t.left)<0?(t.left=this.leftRotate(t.left),this.rightRotate(t)):i<-1&&this.getBalance(t.right)<=0?this.leftRotate(t):i<-1&&0<this.getBalance(t.right)?(t.right=this.rightRotate(t.right),this.leftRotate(t)):t},o.prototype.minValue=function(t){for(var e=t;e.left;)e=e.left;return e},o.prototype.forEach=function(t){this._inorder(this.root,t)},o.prototype._inorder=function(t,e){null!==t&&(this._inorder(t.left,e),t.data.forEach(function(t){return e(t)}),this._inorder(t.right,e))},o.prototype._reverseInorder=function(t,e){null!==t&&(this._inorder(t.right,e),t.data.forEach(function(t){return e(t)}),this._inorder(t.left,e))},o);function o(t,e){this.comparator=t,this.dataToTreeNodeMapper=e,this.root=null,this.dataRefToTreeNode={},this.size=0}e.AVLTree=i},928:function(t,e,i){var o=this&&this.__createBinding||(Object.create?function(t,e,i,o){void 0===o&&(o=i),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,o){t[o=void 0===o?i:o]=e[i]}),n=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||o(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),n(i(141),e),n(i(974),e),n(i(645),e)},645:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),e.Log=e.LogLevel=void 0,(o=i=e.LogLevel||(e.LogLevel={}))[o.TRACE=0]="TRACE",o[o.DEBUG=1]="DEBUG",o[o.INFO=2]="INFO",o[o.LOG=2]="LOG",o[o.WARN=3]="WARN",o[o.ERROR=4]="ERROR",o[o.DISABLED=5]="DISABLED";var o=(n.trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.LOG_LEVEL>i.TRACE||console.trace.apply(this,t)},n.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.LOG_LEVEL>i.DEBUG||console.debug.apply(this,t)},n.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.LOG_LEVEL>i.INFO||console.info.apply(this,t)},n.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.LOG_LEVEL>i.LOG||console.log.apply(this,t)},n.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.LOG_LEVEL>i.WARN||console.warn.apply(this,t)},n.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.LOG_LEVEL>i.ERROR||console.error.apply(this,t)},n.LOG_LEVEL=i.WARN,n);function n(){}e.Log=o},974:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.canConnect=e.clamp=e.intersects=e.getRandom=e.denormalize=e.normalize=e.getNewGUID=void 0;var l=i(522);e.getNewGUID=function(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return t()+"-"+t()+"-"+t()+"-"+t()};e.normalize=function(t,e,i){return(t-e)/(i-e)};e.denormalize=function(t,e,i){return(i-e)*t+e};e.getRandom=function(t,e){return Math.random()*(e-t)+t};e.intersects=function(t,e,i,o,n,s,r,h){return!(i<n||r<t||o<s||h<e)?n<t||s<e||i<r||o<h?l.ViewPort.INTERSECT:l.ViewPort.INSIDE:l.ViewPort.OUTSIDE};e.clamp=function(t,e,i){return t<=e?e:i<t?i:t};e.canConnect=function(t,e,i,o){return!!e&&(t!==e&&(t.node!==e.node&&(t.type!==e.type&&(!!i[t.dataType].includes(e.dataType)&&!!o.canConnect(t.node,e.node)))))}}},n={};return function t(e){var i=n[e];if(void 0!==i)return i.exports;i=n[e]={exports:{}};return o[e].call(i.exports,i,i.exports,t),i.exports}(184)})()});
//# sourceMappingURL=flow-connect.min.js.map