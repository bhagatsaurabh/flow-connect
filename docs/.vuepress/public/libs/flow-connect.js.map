{"version":3,"file":"flow-connect.js","mappings":"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","sources":["webpack://flow-connect/webpack/universalModuleDefinition","webpack://flow-connect/webpack/runtime/chunk loaded","webpack://flow-connect/./src/common/enums.ts","webpack://flow-connect/./src/common/index.ts","webpack://flow-connect/./src/core/color.ts","webpack://flow-connect/./src/core/connector.ts","webpack://flow-connect/./src/core/flow.ts","webpack://flow-connect/./src/core/graph.ts","webpack://flow-connect/./src/core/group.ts","webpack://flow-connect/./src/core/hooks.ts","webpack://flow-connect/./src/core/index.ts","webpack://flow-connect/./src/core/node.ts","webpack://flow-connect/./src/core/subflow-node.ts","webpack://flow-connect/./src/core/terminal.ts","webpack://flow-connect/./src/core/tunnel-node.ts","webpack://flow-connect/./src/core/vector.ts","webpack://flow-connect/./src/flow-connect.ts","webpack://flow-connect/./src/resource/audio-worklets.ts","webpack://flow-connect/./src/resource/constants.ts","webpack://flow-connect/./src/resource/icons.ts","webpack://flow-connect/./src/ui/2d-slider.ts","webpack://flow-connect/./src/ui/button.ts","webpack://flow-connect/./src/ui/container.ts","webpack://flow-connect/./src/ui/dial.ts","webpack://flow-connect/./src/ui/display.ts","webpack://flow-connect/./src/ui/envelope.ts","webpack://flow-connect/./src/ui/horizontal-layout.ts","webpack://flow-connect/./src/ui/image.ts","webpack://flow-connect/./src/ui/index.ts","webpack://flow-connect/./src/ui/input.ts","webpack://flow-connect/./src/ui/label.ts","webpack://flow-connect/./src/ui/radio-group.ts","webpack://flow-connect/./src/ui/select.ts","webpack://flow-connect/./src/ui/slider.ts","webpack://flow-connect/./src/ui/source.ts","webpack://flow-connect/./src/ui/stack.ts","webpack://flow-connect/./src/ui/toggle.ts","webpack://flow-connect/./src/ui/ui-node.ts","webpack://flow-connect/./src/ui/v-slider.ts","webpack://flow-connect/./src/utils/avl-tree.ts","webpack://flow-connect/./src/utils/bidirectional-map.ts","webpack://flow-connect/./src/utils/evaluator.ts","webpack://flow-connect/./src/utils/index.ts","webpack://flow-connect/./src/utils/lexer.ts","webpack://flow-connect/./src/utils/linked-list.ts","webpack://flow-connect/./src/utils/logger.ts","webpack://flow-connect/./src/utils/parser.ts","webpack://flow-connect/./src/utils/utils.ts","webpack://flow-connect/webpack/bootstrap","webpack://flow-connect/webpack/runtime/hasOwnProperty shorthand","webpack://flow-connect/webpack/runtime/jsonp chunk loading","webpack://flow-connect/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, () => {\nreturn ","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","/** To distinguish whether two rectangles are inside/intersecting/disconnected */\nexport enum ViewPort {\n  INSIDE = 'INSIDE',\n  OUTSIDE = 'OUTSIDE',\n  INTERSECT = 'INTERSECT'\n}\n\n/** Levels of Detail, affects rendering while zooming in/out */\nexport enum LOD {\n  LOD0,\n  LOD1,\n  LOD2\n}\n\nexport enum Align {\n  Left,\n  Center,\n  Right\n}\n\nexport enum GlobalEventType {\n  Emitter,\n  Receiver\n}\n","export * from './enums';\nexport * from './interfaces';\n","import { clamp, getRandom, lerp, normalize } from \"../utils/utils\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Log } from \"../utils/logger\";\n\nexport class Color implements Serializable {\n  hexValue: string;\n  rgbaValue: Uint8ClampedArray | number[];\n  rgbaString: string;\n  rgbaCSSString: string;\n\n  constructor(rgba: Uint8ClampedArray | number[]) {\n    this.rgbaValue = rgba;\n    this.hexValue = Color.rgbaToHex(this.rgbaValue);\n    this.rgbaString = Color.rgbaToString(this.rgbaValue);\n    this.rgbaCSSString = Color.rgbaToCSSString(this.rgbaValue);\n  }\n  isEqual(color: Color) {\n    return color.rgbaValue[0] === this.rgbaValue[0]\n      && color.rgbaValue[1] === this.rgbaValue[1]\n      && color.rgbaValue[2] === this.rgbaValue[2]\n      && color.rgbaValue[3] === this.rgbaValue[3];\n  }\n\n  static Random(): Color {\n    return new Color(new Uint8ClampedArray(\n      [Math.floor(getRandom(0, 255)), Math.floor(getRandom(0, 255)), Math.floor(getRandom(0, 255)), 255]\n    ));\n  }\n  static hexToRGBA(hex: string): Uint8ClampedArray {\n    return new Uint8ClampedArray([parseInt(hex.slice(1, 3), 16), parseInt(hex.slice(3, 5), 16), parseInt(hex.slice(5, 7), 16), parseInt(hex.slice(7, 9), 16)]);\n  }\n  private static _componentToHex(c: number) {\n    let hex = c.toString(16);\n    return hex.length === 1 ? '0' + hex : hex;\n  }\n  static rgbaToHex(rgba: number[] | Uint8ClampedArray): string {\n    return \"#\" + Color._componentToHex(rgba[0]) + Color._componentToHex(rgba[1]) + Color._componentToHex(rgba[2]) + Color._componentToHex(rgba[3]);\n  }\n  static rgbaToString(rgba: Uint8ClampedArray | number[]): string {\n    return `${rgba[0]}:${rgba[1]}:${rgba[2]}:${rgba[3]}`;\n  }\n  static rgbaToCSSString(rgba: Uint8ClampedArray | number[]): string {\n    return `rgba(${rgba[0]}, ${rgba[1]}, ${rgba[2]}, ${normalize(rgba[3], 0, 255).toFixed(3)})`;\n  }\n\n  /** A linear interpolator for given array of colors */\n  static scale(colors: Color[] | Uint8ClampedArray | string[] | number[][]): (t: number) => string {\n    if (!Array.isArray(colors)) {\n      Log.error('An array is expected to create a color scale');\n      return;\n    }\n    if (colors.length <= 1) {\n      Log.error('At least two colors are required to create a color scale');\n      return;\n    }\n\n    let colorObjs: Color[] = [];\n    if (colors[0] instanceof Uint8ClampedArray || (Array.isArray(colors[0]) && typeof colors[0][0] === 'number')) {\n      colors.forEach(color => colorObjs.push(new Color(color as any)));\n    } else if (typeof colors[0] === 'string') {\n      colors.forEach(color => colorObjs.push(new Color(Color.hexToRGBA(color as any))));\n    } else {\n      colorObjs = colors as any;\n    }\n\n    return (t) => {\n      t = clamp(t, 0, 1);\n\n      let index = (colorObjs.length - 1) * t;\n      let start = Math.floor(index);\n      let end = Math.ceil(index);\n\n      t = index - start;\n\n      let startColor = colorObjs[start], endColor = colorObjs[end];\n\n      let result = startColor.rgbaValue.map((component, i) => {\n        component = lerp(component, endColor.rgbaValue[i], t);\n        if (i < 3) component = Math.round(component);\n        return component;\n      });\n\n      return 'rgba(' + result + ')';\n    }\n  }\n\n  serialize(): SerializedColor {\n    return {\n      rgba: [this.rgbaValue[0], this.rgbaValue[1], this.rgbaValue[2], this.rgbaValue[3]]\n    }\n  }\n  static deSerialize(data: SerializedColor) {\n    return new Color(data.rgba);\n  }\n}\n\nexport interface SerializedColor {\n  rgba: number[]\n}\n","import { Vector, SerializedVector } from \"./vector\";\nimport { get, getNewUUID } from \"../utils/utils\";\nimport { Flow, FlowState } from \"./flow\";\nimport { Terminal, TerminalType } from './terminal';\nimport { Renderable, RenderResolver, Serializable } from \"../common/interfaces\";\nimport { Node, NodeState } from \"./node\";\nimport { Hooks } from './hooks';\n\nexport class Connector extends Hooks implements Serializable, Renderable {\n  renderResolver: RenderResolver<Connector, ConnectorRenderParams> = () => null;\n\n  start: Terminal;\n  end: Terminal;\n  startNode: Node;\n  endNode: Node;\n  style: ConnectorStyle;\n  id: string;\n\n  _data: any;\n  floatingTip: Vector;\n\n  get data(): any { return this._data; }\n  set data(data: any) {\n    this._data = data;\n    this.end && this.end.call('data', this.end, data);\n    if (this.flow.state !== FlowState.Stopped) {\n      this.flow.executionGraph.setDirty(this.endNode);\n    }\n  }\n\n  constructor(\n    public flow: Flow,\n    start: Terminal,\n    end: Terminal,\n    options: ConnectorOptions = DefaultConnectorOptions()\n  ) {\n    super();\n\n    this.style = options.style ? { ...DefaultConnectorStyle(), ...options.style } : DefaultConnectorStyle();\n    this.id = get(options.id, getNewUUID());\n    this.floatingTip = options.floatingTip;\n\n    this.start = start;\n    this.end = end;\n    if (this.start) this.startNode = this.start.node;\n    if (this.end) this.endNode = this.end.node;\n    if (start && end) {\n      this.floatingTip = null;\n\n      this.start.connectors.push(this);\n      if (this.end.connectors.length > 0) {\n        this.end.connectors[0].removeConnection();\n        this.end.connectors[0] = this;\n      } else this.end.connectors.push(this);\n\n      if (!options.isDeserialization) this.flow.executionGraph.connect(this.startNode, this.endNode);\n      this.start.onConnect(this);\n      this.end.onConnect(this);\n    }\n  }\n\n  completeConnection(destination: Terminal) {\n    if (!this.start) {\n      this.start = destination;\n      this.startNode = this.start.node;\n    } else {\n      this.end = destination;\n      this.endNode = this.end.node;\n    }\n\n    if (!this.start.connectors.includes(this)) this.start.connectors.push(this);\n    this.end.connectors[0] = this;\n    this.floatingTip = null;\n\n    this.startNode.currHitTerminal && this.startNode.currHitTerminal.onExit(null, null);\n    this.startNode.currHitTerminal = null;\n    this.endNode.currHitTerminal && this.endNode.currHitTerminal.onExit(null, null);\n    this.endNode.currHitTerminal = null;\n\n    this.flow.executionGraph.connect(this.startNode, this.endNode);\n    this.start.onConnect(this);\n    this.end.onConnect(this);\n  }\n  removeConnection() {\n    if (this.start) {\n      this.start.connectors.includes(this) && this.start.connectors.splice(this.start.connectors.indexOf(this), 1);\n      if (this.startNode.currHitTerminal) {\n        this.startNode.currHitTerminal.onExit(null, null);\n        this.startNode.currHitTerminal = null;\n      }\n    }\n    if (this.end) {\n      this.end.connectors.includes(this) && this.end.connectors.splice(this.end.connectors.indexOf(this), 1);\n      if (this.endNode.currHitTerminal) {\n        this.endNode.currHitTerminal.onExit(null, null);\n        this.endNode.currHitTerminal = null;\n      }\n    }\n    this.flow.removeConnector(this.id);\n  }\n  setData(data: any) {\n    this._data = data;\n    this.end && this.end.call('data', this.end, data);\n  }\n  canConnect(other: Terminal): boolean {\n    let firstTerminal = !this.start ? this.end : this.start;\n    let source, destination;\n    if (firstTerminal.type === TerminalType.IN) {\n      source = other;\n      destination = firstTerminal;\n    } else {\n      source = firstTerminal;\n      destination = other;\n    }\n\n    if (!destination) return false;\n    if (source === destination) return false;\n    if (source.node === destination.node) return false;\n    if (source.type === destination.type) return false;\n    if (!this.flow.rules[source.dataType].includes(destination.dataType)) return false;      // Directional !!\n    if (!this.flow.executionGraph.canConnect(source.node, destination.node)) return false;\n    return true;\n  }\n\n  render() {\n    let context = this.flow.flowConnect.context;\n    context.save();\n    let flowRenderResolver = this.flow.renderResolver.connector;\n    let flowConnectRenderResolver = this.flow.flowConnect.renderResolver.connector;\n    ((this.renderResolver && this.renderResolver(this))\n      || (flowRenderResolver && flowRenderResolver(this))\n      || (flowConnectRenderResolver && flowConnectRenderResolver(this))\n      || this._render\n    )(context, this.getRenderParams(), this);\n    context.restore();\n\n    let offContext = this.flow.flowConnect.offContext;\n    offContext.save();\n    this._offRender();\n    offContext.restore();\n\n    this.call('render', this);\n  }\n  private _render(context: CanvasRenderingContext2D, params: ConnectorRenderParams, connector: Connector) {\n    let ax = params.start.x, ay = params.start.y, dx = params.end.x, dy = params.end.y;\n\n    let offset = Vector.Distance(ax, ay, dx, dy);\n    offset *= .2;\n\n    let [bx, by] = [ax + offset, ay];\n    let [cx, cy] = [dx - offset, dy];\n    let [midx, midy] = [(bx + cx) / 2, (by + cy) / 2];\n\n    if (connector.style.border) {\n      context.strokeStyle = connector.style.borderColor;\n      context.lineWidth = connector.style.width + 2;\n      context.beginPath();\n      context.moveTo(ax, ay);\n      context.quadraticCurveTo(bx, by, midx, midy);\n      context.moveTo(midx, midy);\n      context.quadraticCurveTo(cx, cy, dx, dy);\n      context.stroke();\n    }\n\n    context.strokeStyle = connector.style.color;\n    context.lineWidth = connector.style.width;\n    context.beginPath();\n    context.moveTo(ax, ay);\n    context.quadraticCurveTo(bx, by, midx, midy);\n    context.moveTo(midx, midy);\n    context.quadraticCurveTo(cx, cy, dx, dy);\n    context.stroke();\n  }\n  private _offRender() { /**/ }\n  private getRenderParams(): ConnectorRenderParams {\n    let start: SerializedVector, end: SerializedVector;\n    if (this.start) {\n      if (this.startNode.renderState.nodeState === NodeState.MAXIMIZED)\n        start = this.start.position.serialize();\n      else {\n        start = this.startNode.position.serialize();\n        start.x += this.startNode.width + this.startNode.style.terminalStripMargin + this.start.style.radius;\n        start.y += this.startNode.style.titleHeight / 2;\n      }\n    } else\n      start = this.floatingTip.serialize();\n    if (this.end) {\n      if (this.endNode.renderState.nodeState === NodeState.MAXIMIZED)\n        end = this.end.position.serialize();\n      else {\n        end = this.endNode.position.serialize();\n        end.x -= (this.endNode.style.terminalStripMargin + this.end.style.radius);\n        end.y += this.endNode.style.titleHeight / 2;\n      }\n    } else\n      end = this.floatingTip.serialize();\n\n    return { start, end };\n  }\n\n  serialize(): SerializedConnector {\n    return {\n      id: this.id,\n      startId: this.start.id,\n      endId: this.end.id,\n      startNodeId: this.startNode.id,\n      endNodeId: this.endNode.id,\n      style: this.style\n    }\n  }\n  static deSerialize(flow: Flow, start: Terminal, end: Terminal, data: SerializedConnector): Connector {\n    return new Connector(flow, start, end, {\n      style: data.style,\n      id: data.id,\n      isDeserialization: true\n    });\n  }\n}\n\nexport interface SerializedConnector {\n  startNodeId: string,\n  endNodeId: string,\n  startId: string,\n  endId: string,\n  id: string,\n  style: ConnectorStyle\n}\n\nexport interface ConnectorStyle {\n  width?: number,\n  color?: string,\n  border?: boolean,\n  borderColor?: string\n}\nlet DefaultConnectorStyle = (): ConnectorStyle => {\n  return {\n    width: 5,\n    color: '#7fff00aa',\n    border: true,\n    borderColor: 'grey'\n  };\n};\n\nexport interface ConnectorOptions {\n  floatingTip?: Vector,\n  style?: ConnectorStyle,\n  id?: string,\n  isDeserialization?: boolean\n}\nlet DefaultConnectorOptions = (): ConnectorOptions => {\n  return {\n    style: {},\n    id: getNewUUID()\n  };\n}\n\nexport interface ConnectorRenderParams {\n  start: SerializedVector,\n  end: SerializedVector\n}\n","import { FlowConnect } from \"../flow-connect\";\r\nimport { Vector } from \"./vector\";\r\nimport { Node, NodeButton, NodeButtonRenderParams, NodeRenderParams, NodeStyle, SerializedNode } from \"./node\";\r\nimport { Hooks } from './hooks';\r\nimport { Group, GroupRenderParams, SerializedGroup } from './group';\r\nimport { Connector, ConnectorRenderParams, SerializedConnector } from './connector';\r\nimport { AVLTree } from \"../utils/avl-tree\";\r\nimport { Serializable, Rules, RenderResolver } from '../common/interfaces';\r\nimport { SubFlowNode } from \"./subflow-node\";\r\nimport { TunnelNode, SerializedTunnelNode } from \"./tunnel-node\";\r\nimport { getNewUUID } from \"../utils/utils\";\r\nimport { Graph, SerializedGraph } from \"./graph\";\r\nimport { Terminal, TerminalRenderParams, TerminalStyle } from \"./terminal\";\r\nimport { Log } from '../utils/logger';\r\nimport { Container, ContainerRenderParams } from '../ui/container';\r\n\r\n/** A Flow is a set of Nodes, Connectors and Groups, it can also contain SubFlowNodes thereby creating a tree of Flows.\r\n *  ![](media://example.png)\r\n */\r\nexport class Flow extends Hooks implements Serializable {\r\n  sortedNodes: AVLTree<Node>;\r\n  nodes: Map<string, Node>;\r\n  groups: Group[];\r\n  connectors: Map<string, Connector>;\r\n  inputs: TunnelNode[];\r\n  outputs: TunnelNode[];\r\n  get state(): FlowState { return this.executionGraph.state; }\r\n  globalEvents: Hooks = new Hooks();\r\n  parentFlow: Flow = null;\r\n\r\n  nodeHitColors: Map<string, Node>;\r\n  groupHitColors: Map<string, Group>;\r\n  listeners: Record<string, number> = {};\r\n\r\n  executionGraph: Graph;\r\n\r\n  readonly renderResolver: {\r\n    connector?: RenderResolver<Connector, ConnectorRenderParams>,\r\n    node?: RenderResolver<Node, NodeRenderParams>,\r\n    nodeButton?: RenderResolver<NodeButton, NodeButtonRenderParams>,\r\n    uiContainer?: RenderResolver<Container, ContainerRenderParams>\r\n    group?: RenderResolver<Group, GroupRenderParams>,\r\n    terminal?: RenderResolver<Terminal, TerminalRenderParams>,\r\n  } = {};\r\n\r\n  constructor(\r\n    public flowConnect: FlowConnect,\r\n    public name: string,\r\n    public rules: Rules,\r\n    public terminalColors: Record<string, string>,\r\n    public id: string = getNewUUID()\r\n  ) {\r\n\r\n    super();\r\n    this.nodes = new Map();\r\n    this.groups = [];\r\n    this.connectors = new Map();\r\n    this.nodeHitColors = new Map();\r\n    this.groupHitColors = new Map();\r\n    this.sortedNodes = new AVLTree((a: Node, b: Node) => (a.zIndex - b.zIndex), (node: Node) => node.id);\r\n    this.inputs = [];\r\n    this.outputs = [];\r\n    this.executionGraph = new Graph();\r\n\r\n    this.registerListeners();\r\n\r\n    this.flowConnect.on('tick', () => {\r\n      if (this.state === FlowState.Running) this.call('tick', this);\r\n    });\r\n  }\r\n\r\n  private registerListeners() {\r\n    let id = this.flowConnect.on('transform', () => this.call('transform', this));\r\n    this.listeners['transform'] = id;\r\n  }\r\n  deregisterListeners() {\r\n    this.flowConnect.off('transform', this.listeners['transform']);\r\n    delete this.listeners['transform'];\r\n  }\r\n\r\n  existsInFlow(flow: Flow): boolean {\r\n    for (let node of [...this.nodes.values()]) {\r\n      if ((node as SubFlowNode).subFlow === flow) return true;\r\n      else if ((node as SubFlowNode).subFlow) {\r\n        return (node as SubFlowNode).subFlow.existsInFlow(flow);\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  addInput(name: string, dataType: string, position: Vector): TunnelNode {\r\n    let flowInput = new TunnelNode(this, 'Input', position, 100, [], [{ name: name, dataType: dataType }]);\r\n    flowInput.on('process', () => {\r\n      flowInput.outputs[0].setData(flowInput.proxyTerminal.getData());\r\n    });\r\n\r\n    this.inputs.push(flowInput);\r\n    this.nodes.set(flowInput.id, flowInput);\r\n    this.sortedNodes.add(flowInput);\r\n    this.executionGraph.add(flowInput);\r\n\r\n    this.call('add-input', this, flowInput);\r\n    return flowInput;\r\n  }\r\n  addOutput(name: string, dataType: string, position: Vector): TunnelNode {\r\n    let flowOutput = new TunnelNode(this, 'Output', position, 100, [{ name: name, dataType: dataType }], []);\r\n\r\n    this.outputs.push(flowOutput);\r\n    this.nodes.set(flowOutput.id, flowOutput);\r\n    this.sortedNodes.add(flowOutput);\r\n    this.executionGraph.add(flowOutput);\r\n\r\n    this.call('add-output', this, flowOutput);\r\n    return flowOutput;\r\n  }\r\n  addSubFlow(flow: Flow, position: Vector = Vector.Zero()): SubFlowNode {\r\n    if (flow.parentFlow) {\r\n      Log.error('Provided flow is already a sub-flow, a sub-flow cannot have multiple parent flows');\r\n      return null;\r\n    }\r\n    let subFlowNode = new SubFlowNode(this, flow, position, 150,\r\n      flow.inputs.map(inputNode => { return { name: inputNode.outputs[0].name, dataType: inputNode.outputs[0].dataType } }),\r\n      flow.outputs.map(outputNode => { return { name: outputNode.inputs[0].name, dataType: outputNode.inputs[0].dataType } }),\r\n      { name: flow.name }\r\n    );\r\n    flow.parentFlow = this;\r\n\r\n    return subFlowNode;\r\n  }\r\n  createNode(name: string, position: Vector, width: number, options?: NodeOptions): Node {\r\n    options = options ? { ...DefaultNodeOptions(), ...options } : DefaultNodeOptions();\r\n\r\n    let inTerminals: any[] = [], outTerminals: any[] = [];\r\n    if (typeof options.inputs !== 'undefined') inTerminals = options.inputs;\r\n    if (typeof options.outputs !== 'undefined') outTerminals = options.outputs;\r\n\r\n    return new Node(this, name, position, width, inTerminals, outTerminals, {\r\n      style: options.style,\r\n      terminalStyle: options.terminalStyle,\r\n      state: options.state\r\n    });\r\n  }\r\n  removeNode(nodeOrID: Node | string) {\r\n    let node = typeof nodeOrID === 'string' ? this.nodes.get(nodeOrID) : nodeOrID;\r\n\r\n    [...node.inputs, ...node.outputs, ...node.inputsUI, ...node.outputsUI]\r\n      .filter(terminal => terminal.isConnected())\r\n      .forEach(terminal => terminal.disconnect());\r\n\r\n    if (node.group) {\r\n      node.group.nodes\r\n        .splice(node.group.nodes.findIndex(currNode => currNode.id === node.id), 1);\r\n    }\r\n\r\n    this.nodes.delete(node.id);\r\n    this.sortedNodes.remove(node);\r\n    this.executionGraph.remove(node);\r\n  }\r\n  removeConnector(id: string) {\r\n    if (this.connectors.get(id) === this.flowConnect.floatingConnector) this.flowConnect.floatingConnector = null;\r\n    this.connectors.delete(id);\r\n  }\r\n  removeAllFocus() {\r\n    this.nodes.forEach(node => node.focused = false);\r\n  }\r\n  render() {\r\n    this.groups.forEach(group => group.render());\r\n    this.connectors.forEach(connector => connector.render());\r\n    this.sortedNodes.forEach(node => node.render());\r\n\r\n    this.call('render', this);\r\n  }\r\n  start() {\r\n    if (this.state !== FlowState.Stopped) return;\r\n    this.executionGraph.start();\r\n    this.call('start', this);\r\n  }\r\n  stop() {\r\n    // Bottom-up, all child sub-flows gets stopped first before parent\r\n    // What if FlowState is Running ?\r\n    if (this.state === FlowState.Stopped) return;\r\n\r\n    // Bottom-up, sub-flows are stopped from highest order to lowest (order = depth of node in the tree)\r\n    for (let order = this.executionGraph.nodes.length - 1; order >= 0; order -= 1) {\r\n      this.executionGraph.nodes[order]\r\n        .filter(graphNode => graphNode.flowNode instanceof SubFlowNode)\r\n        .map(graphNode => graphNode.flowNode)\r\n        .forEach((subFlowNode: SubFlowNode) => subFlowNode.subFlow.stop());\r\n    }\r\n    this.executionGraph.stop();\r\n    this.call('stop', this);\r\n  }\r\n\r\n  serialize(): SerializedFlow {\r\n    return {\r\n      id: this.id,\r\n      name: this.name,\r\n      rules: this.rules,\r\n      terminalColors: this.terminalColors,\r\n      nodes: [...this.nodes.values()].map(node => node.serialize()),\r\n      groups: this.groups.map(group => group.serialize()),\r\n      connectors: [...this.connectors.values()].map(connector => connector.serialize()),\r\n      inputs: this.inputs.map(input => input.serialize()),\r\n      outputs: this.outputs.map(output => output.serialize()),\r\n      executionGraph: this.executionGraph.serialize()\r\n    }\r\n  }\r\n  static deSerialize(flowConnect: FlowConnect, data: SerializedFlow): Flow {\r\n    let flow = new Flow(flowConnect, data.name, data.rules, data.terminalColors, data.id);\r\n\r\n    data.nodes.forEach(serializedNode => {\r\n      let node;\r\n      if (serializedNode.subFlow) node = SubFlowNode.deSerialize(flow, serializedNode);\r\n      else node = Node.deSerialize(flow, serializedNode);\r\n      flow.nodes.set(node.id, node);\r\n      flow.sortedNodes.add(node);\r\n    });\r\n    data.groups.forEach(serializedGroup => {\r\n      let group = Group.deSerialize(flow, serializedGroup);\r\n      flow.groups.push(group);\r\n      group.nodes.forEach(node => node.group = group);\r\n    });\r\n    data.inputs.forEach(serializedInput => {\r\n      let input = TunnelNode.deSerialize(flow, serializedInput);\r\n      flow.inputs.push(input);\r\n      flow.nodes.set(input.id, input);\r\n      flow.sortedNodes.add(input);\r\n    });\r\n    data.outputs.forEach(serializedOutput => {\r\n      let output = TunnelNode.deSerialize(flow, serializedOutput);\r\n      flow.outputs.push(output);\r\n      flow.nodes.set(output.id, output);\r\n      flow.sortedNodes.add(output);\r\n    });\r\n    data.connectors.forEach(serializedConnector => {\r\n      let startNode = flow.nodes.get(serializedConnector.startNodeId);\r\n      let startTerminal = startNode.outputs.concat(startNode.outputsUI).find(terminal => terminal.id === serializedConnector.startId);\r\n      let endNode = flow.nodes.get(serializedConnector.endNodeId);\r\n      let endTerminal = endNode.inputs.concat(endNode.inputsUI).find(terminal => terminal.id === serializedConnector.endId);\r\n      let connector = Connector.deSerialize(flow, startTerminal, endTerminal, serializedConnector);\r\n      flow.connectors.set(serializedConnector.id, connector);\r\n    });\r\n\r\n    flow.executionGraph = Graph.deSerialize(flow, data.executionGraph);\r\n\r\n    return flow;\r\n  }\r\n}\r\n\r\nexport enum FlowState {\r\n  Running = 'Running',\r\n  Idle = 'Idle',\r\n  Stopped = 'Stopped'\r\n}\r\n\r\nexport interface FlowOptions {\r\n  name: string,\r\n  rules: Rules,\r\n  terminalColors: Record<string, string>\r\n}\r\n\r\nexport interface SerializedFlow {\r\n  id: string,\r\n  name: string,\r\n  rules: Rules,\r\n  terminalColors: Record<string, string>,\r\n  nodes: SerializedNode[],\r\n  groups: SerializedGroup[],\r\n  connectors: SerializedConnector[],\r\n  inputs: SerializedTunnelNode[],\r\n  outputs: SerializedTunnelNode[],\r\n  executionGraph: SerializedGraph\r\n}\r\n\r\nexport interface NodeOptions {\r\n  inputs?: any[],\r\n  outputs?: any[],\r\n  style: NodeStyle,\r\n  terminalStyle: TerminalStyle,\r\n  state?: Record<string, any>\r\n}\r\nlet DefaultNodeOptions = (): NodeOptions => {\r\n  return {\r\n    style: {},\r\n    terminalStyle: {}\r\n  }\r\n}\r\n","import { Log } from \"../utils/logger\";\nimport { getNewUUID } from \"../utils/utils\";\nimport { Flow, FlowState } from \"./flow\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Node } from \"./node\";\nimport { List } from \"../utils/linked-list\";\n\n// A directed acyclic graph\nexport class Graph implements Serializable {\n  state: FlowState = FlowState.Stopped;\n  nodes: GraphNode[][];\n  graphNodes: Map<string, GraphNode>;\n  dirtyNodes: Map<string, GraphNode>;\n\n  constructor() {\n    this.nodes = [];\n    this.graphNodes = new Map();\n    this.dirtyNodes = new Map();\n  }\n\n  add(data: Node) {\n    if (!this.nodes[0]) this.nodes.push([]);\n    let graphNode = new GraphNode(data);\n    this.nodes[0].push(graphNode);\n    this.graphNodes.set(data.id, graphNode);\n  }\n  remove(data: Node) {\n    let graphNode = this.graphNodes.get(data.id);\n    this.dirtyNodes.delete(graphNode.id);\n    this.graphNodes.delete(data.id);\n    this.nodes[0].splice(this.nodes[0].findIndex(node => node.id === graphNode.id), 1);\n  }\n  connect(sourceNode: Node, destinationNode: Node) {\n    let startGraphNode = this.graphNodes.get(sourceNode.id);\n    let endGraphNode = this.graphNodes.get(destinationNode.id);\n\n    if (!startGraphNode.childs.includes(endGraphNode)) {\n      startGraphNode.childs.push(endGraphNode);\n\n      if (endGraphNode.order <= startGraphNode.order) {\n        this.updateOrder(endGraphNode, startGraphNode.order + 1);\n      }\n    }\n  }\n  disconnect(sourceNode: Node, destinationNode: Node) {\n    let sourceGraphNode = this.graphNodes.get(sourceNode.id);\n    let destinationGraphNode = this.graphNodes.get(destinationNode.id);\n\n    let connectedEndNodes = new Set<Node>();\n    sourceNode.outputs\n      .forEach(terminal => terminal.connectors\n        .forEach(connector => connector.endNode && connectedEndNodes.add(connector.endNode))\n      );\n\n    if (connectedEndNodes.has(destinationNode)) return;\n    sourceGraphNode.childs.splice(sourceGraphNode.childs.indexOf(destinationGraphNode), 1);\n\n    let maxOrderOfConnectedStartNodes = destinationNode.inputs\n      .filter(terminal => terminal.connectors.length > 0)\n      .map(terminal => this.graphNodes.get(terminal.connectors[0].startNode.id).order)\n      .reduce((acc, curr) => Math.max(acc, curr), 0);\n\n    this.updateOrder(destinationGraphNode, maxOrderOfConnectedStartNodes);\n  }\n  updateOrder(root: GraphNode, order: number) {\n    this._updateOrder(root, order);\n    let queue: GraphNode[] = [];\n    queue.push(root);\n    while (queue.length !== 0) {\n      let currNode = queue.shift();\n      currNode.childs.forEach(child => {\n        if (child.order <= currNode.order) {\n          this._updateOrder(child, currNode.order + 1);\n        }\n        if (!queue.includes(child)) queue.push(child);\n      });\n    }\n  }\n  private _updateOrder(graphNode: GraphNode, order: number) {\n    this.nodes[graphNode.order].splice(this.nodes[graphNode.order].indexOf(graphNode), 1);\n    if (!this.nodes[order]) this.nodes[order] = [];\n    graphNode.order = order;\n    this.nodes[order].push(graphNode);\n  }\n  canConnect(sourceNode: Node, destinationNode: Node) {\n    if (this.graphNodes.get(destinationNode.id).childs.includes(this.graphNodes.get(sourceNode.id))) return false;\n    return true;\n  }\n\n  async start() {\n    if (this.state === FlowState.Stopped) {       // Full Run\n      this.state = FlowState.Running;\n      if (this.nodes[0]) {\n        try {\n          await this.runAll(this.nodes[0]);\n\n          while (this.dirtyNodes.size !== 0) {\n            await this.runAll(this.lowestDirty([...this.dirtyNodes.values()]));\n          }\n        } catch (error) {\n          Log.error('Error while executing graph', error);\n          this.state = FlowState.Stopped;\n          return;\n        }\n      }\n    } else if (this.state === FlowState.Idle) {   // Partial Run\n      this.state = FlowState.Running;\n      try {\n        while (this.dirtyNodes.size !== 0) {\n          await this.runAll(this.lowestDirty([...this.dirtyNodes.values()]));\n        }\n      } catch (error) {\n        Log.error('Error while executing graph', error);\n        this.state = FlowState.Stopped;\n        return;\n      }\n    }\n\n    this.state = FlowState.Idle;\n  }\n  stop() {\n    this.state = FlowState.Stopped;\n  }\n  // Runs selective nodes within the >same order< in async\n  async runAll(graphNodes: GraphNode[]) {\n    await Promise.all(\n      graphNodes.map(\n        graphNode => new Promise<void>(resolve => {\n          graphNode.flowNode.run();\n          this.clearDirty(graphNode);\n          resolve();\n        })\n      )\n    );\n  }\n  setDirty(node: Node | GraphNode) {\n    let graphNode = node instanceof Node ? this.graphNodes.get(node.id) : node;\n    if (!graphNode) return;\n\n    this.dirtyNodes.set(graphNode.id, graphNode);\n  }\n  clearDirty(node: Node | GraphNode) {\n    let graphNode = node instanceof Node ? this.graphNodes.get(node.id) : node;\n    this.dirtyNodes.delete(graphNode.id);\n  }\n  // Returns all dirty nodes with lowest order\n  lowestDirty(graphNodes: GraphNode[]) {\n    let lowestOrder = Math.min(...graphNodes.map(graphNode => graphNode.order));\n    return graphNodes.filter(graphNode => graphNode.order === lowestOrder);\n  }\n  // Generic graph traversing function that can be used to do some stuff with nodes starting with provided root\n  propagate(root: Node | GraphNode, callback: (node: Node) => void) {\n    let start = root instanceof Node ? this.graphNodes.get(root.id) : root;\n    let queue = new List<GraphNode>();\n    queue.append(start);\n    while (queue.length !== 0) {\n      let currGNode = queue.removeFirst();\n      callback(currGNode.flowNode);\n      currGNode.childs.forEach(child => queue.append(child));\n    }\n  }\n  debugNode(node: GraphNode, indent: string) {\n    console.log(`${indent}[${node.flowNode.name}, ${node.order}]`);\n    node.childs.forEach(child => this.debugNode(child, indent + '  '));\n  }\n  debugGraph() {\n    this.nodes[0].forEach(graphNode => {\n      this.debugNode(graphNode, '');\n    });\n  }\n\n  serialize(): SerializedGraph {\n    let nodeToGraphNodeIds: Record<string, string> = {};\n    this.graphNodes.forEach((_graphNode, id) => nodeToGraphNodeIds[id] = this.graphNodes.get(id).id);\n\n    return {\n      nodes: this.nodes.map(groupedNodes => groupedNodes.map(graphNode => graphNode.serialize())),\n      nodeToGraphNode: nodeToGraphNodeIds\n    };\n  }\n  static deSerialize(flow: Flow, data: SerializedGraph): Graph {\n    let graph = new Graph();\n\n    let serializedGraphNodes: Record<string, SerializedGraphNode> = {};\n    let deSerializedGraphNodes: Record<string, GraphNode> = {};\n\n    data.nodes.forEach((serializedGroupedNodes, index) => {\n      graph.nodes[index] = serializedGroupedNodes.map(serializedGraphNode => {\n        let graphNode = GraphNode.deSerialize(flow.nodes.get(serializedGraphNode.nodeId), serializedGraphNode);\n        deSerializedGraphNodes[graphNode.id] = graphNode;\n        serializedGraphNodes[graphNode.id] = serializedGraphNode;\n        return graphNode;\n      });\n    });\n\n    Object.keys(deSerializedGraphNodes).forEach(key => {\n      deSerializedGraphNodes[key].childs = serializedGraphNodes[key].childs.map(childId => deSerializedGraphNodes[childId]);\n    });\n    Object.keys(data.nodeToGraphNode).forEach(nodeId => {\n      graph.graphNodes.set(nodeId, deSerializedGraphNodes[data.nodeToGraphNode[nodeId]]);\n    })\n\n    return graph;\n  }\n}\nexport interface SerializedGraph {\n  nodes: SerializedGraphNode[][],\n  nodeToGraphNode: Record<string, string>\n}\n\nexport class GraphNode implements Serializable {\n  id: string;\n  childs: GraphNode[] = [];\n  order: number;\n\n  constructor(public flowNode: Node, order?: number, id?: string) {\n    this.order = order ? order : 0;\n    this.id = id ? id : getNewUUID();\n  }\n\n  serialize(): SerializedGraphNode {\n    return {\n      id: this.id,\n      nodeId: this.flowNode.id,\n      order: this.order,\n      childs: this.childs.map(child => child.id)\n    };\n  }\n  static deSerialize(node: Node, data: SerializedGraphNode): GraphNode {\n    return new GraphNode(node, data.order, data.id);\n  }\n}\nexport interface SerializedGraphNode {\n  id: string,\n  nodeId: string,\n  order: number,\n  childs: string[]\n}\n","import { SerializedVector, Vector } from \"./vector\";\nimport { get, getNewUUID, intersects } from \"../utils/utils\";\nimport { Color, SerializedColor } from \"./color\";\nimport { Flow } from './flow';\nimport { Hooks } from './hooks';\nimport { Node } from './node';\nimport { Renderable, RenderResolver, Serializable } from \"../common/interfaces\";\nimport { ViewPort } from \"../common/enums\";\n\nexport class Group extends Hooks implements Serializable, Renderable {\n  renderResolver: RenderResolver<Group, GroupRenderParams> = () => null;\n\n  nodes: Node[] = [];\n  get name(): string { return this._name; }\n  set name(name: string) {\n    if (!name || name.trim() === '') this._name = 'No Name';\n    else this._name = name;\n    this.computeTextMetrics();\n  }\n  get position(): Vector { return this._position; }\n  set position(position: Vector) {\n    this._position = position;\n    this.updateRenderState();\n    this.recomputeNodePositions();\n  }\n\n  nodeDeltas: Vector[] = [];\n\n  hitColor: Color;\n  private textWidth: number;\n  private textHeight: number;\n  private _name: string;\n  private renderState: ViewPort = ViewPort.INSIDE;\n  private _position: Vector;\n\n  width: number;\n  height: number\n  style: GroupStyle;\n  id: string;\n\n  constructor(\n    public flow: Flow,\n    position: Vector,\n    options: GroupOptions = DefaultGroupOptions()\n  ) {\n\n    super();\n\n    this.width = get(options.width, 0);\n    this.height = get(options.height, 0);\n    this.style = get(options.style, {});\n    this.id = get(options.id, getNewUUID());\n\n    this.hitColor = options.hitColor;\n    this.style = { ...DefaultGroupStyle(), ...options.style };\n    this.id = getNewUUID();\n    this._position = position;\n    if (!this.style.color || !this.style.borderColor) {\n      let colors = DefaultGroupColors.Random();\n      this.style.borderColor = colors[0];\n      this.style.color = colors[1];\n    }\n    this.name = options.name;\n    this.setHitColor(options.hitColor);\n    this.computeTextMetrics();\n\n    this.flow.on('transform', () => this.updateRenderState());\n  }\n\n  private setHitColor(hitColor: Color) {\n    if (!hitColor) {\n      hitColor = Color.Random();\n      while (this.flow.groupHitColors.get(hitColor.rgbaString)) hitColor = Color.Random();\n    }\n    this.hitColor = hitColor;\n    this.flow.groupHitColors.set(this.hitColor.rgbaString, this);\n  }\n  private computeTextMetrics() {\n    let context = this.flow.flowConnect.context;\n    context.font = this.style.fontSize + ' ' + this.style.font;\n    let metrics = context.measureText(this.name);\n    this.textWidth = metrics.width;\n    metrics = context.measureText('M');\n    context.font = null;\n    this.textHeight = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;\n\n    if (typeof this.textHeight === 'undefined') {\n      let d = document.createElement(\"span\");\n      d.textContent = \"M\";\n      d.style.font = this.style.fontSize + ' ' + this.style.font;\n      document.body.appendChild(d);\n      this.textHeight = d.offsetHeight;\n      document.body.removeChild(d);\n    }\n  }\n  private updateRenderState() {\n    let realPos = this.position.transform(this.flow.flowConnect.transform);\n    this.renderState = intersects(\n      0, 0,\n      this.flow.flowConnect.canvasDimensions.width, this.flow.flowConnect.canvasDimensions.height,\n      realPos.x, realPos.y,\n      realPos.x + this.width * this.flow.flowConnect.scale,\n      realPos.y + this.height * this.flow.flowConnect.scale\n    );\n  }\n  setContainedNodes() {\n    let groupRealPos = this.position.transform(this.flow.flowConnect.transform);\n\n    this.nodes = [...this.flow.nodes.values()]\n      .filter(node => !node.group && node.renderState.viewport === ViewPort.INSIDE)\n      .filter(node => {\n        let nodeRealPos = node.position.transform(this.flow.flowConnect.transform);\n\n        return intersects(groupRealPos.x, groupRealPos.y,\n          groupRealPos.x + this.width * this.flow.flowConnect.scale,\n          groupRealPos.y + this.height * this.flow.flowConnect.scale,\n          nodeRealPos.x, nodeRealPos.y,\n          nodeRealPos.x + node.width * this.flow.flowConnect.scale,\n          nodeRealPos.y + node.ui.height * this.flow.flowConnect.scale\n        ) === ViewPort.INSIDE;\n      });\n\n    this.nodes.forEach((node, index) => {\n      node.group = this;\n      this.nodeDeltas[index] = node.position.subtract(this.position);\n    });\n  }\n  private recomputeNodePositions() {\n    this.nodes.forEach((node, index) => {\n      node.position = this.position.add(this.nodeDeltas[index]);\n    });\n  }\n\n  render() {\n    if (this.renderState === ViewPort.OUTSIDE) return;\n\n    let context = this.flow.flowConnect.context;\n    context.save();\n    let flowRenderResolver = this.flow.renderResolver.group;\n    let flowConnectRenderResolver = this.flow.flowConnect.renderResolver.group;\n    ((this.renderResolver && this.renderResolver(this))\n      || (flowRenderResolver && flowRenderResolver(this))\n      || (flowConnectRenderResolver && flowConnectRenderResolver(this))\n      || this._render\n    )(context, this.getRenderParams(), this);\n    context.restore();\n\n    this.flow.flowConnect.offGroupContext.save();\n    this._offRender();\n    this.flow.flowConnect.offGroupContext.restore();\n\n    this.call('render', this);\n  }\n  private _render(context: CanvasRenderingContext2D, params: GroupRenderParams, group: Group) {\n    context.strokeStyle = group.style.borderColor;\n    context.lineWidth = 2;\n    context.fillStyle = group.style.color;\n    context.strokeRect(params.position.x, params.position.y, params.width, params.height);\n    context.fillRect(params.position.x, params.position.y, params.width, params.height);\n    context.fillStyle = group.style.titleColor;\n    context.textBaseline = 'bottom';\n    context.font = group.style.fontSize + ' ' + group.style.font;\n    context.fillText(group.name, params.position.x, params.position.y - 10);\n  }\n  private _offRender() {\n    this.flow.flowConnect.offGroupContext.fillStyle = this.hitColor.rgbaCSSString;\n    this.flow.flowConnect.offGroupContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n    this.flow.flowConnect.offGroupContext.fillRect(this.position.x, this.position.y - this.textHeight - 10, this.textWidth, this.textHeight + 10);\n  }\n  private getRenderParams(): GroupRenderParams {\n    return {\n      position: this.position.serialize(),\n      width: this.width,\n      height: this.height\n    };\n  }\n\n  onClick(screenPosition: Vector, realPosition: Vector) {\n    this.call('click', this, screenPosition, realPosition);\n\n    let thisRealPosition = this.position.transform(this.flow.flowConnect.transform);\n    if (screenPosition.y < thisRealPosition.y) {\n      this.flow.flowConnect.showGenericInput(thisRealPosition.subtract(0, (10 + this.textHeight) * this.flow.flowConnect.scale), this.name, {\n        width: Math.max(this.textWidth, 50) * this.flow.flowConnect.scale + 'px',\n        height: this.textHeight * this.flow.flowConnect.scale + 'px',\n        fontSize: parseInt(this.style.fontSize.replace('px', '')) * this.flow.flowConnect.scale + 'px',\n        fontFamily: this.style.font\n      }, {\n        type: 'text'\n      }, (value) => {\n        this.name = value;\n      });\n    }\n  }\n\n  serialize(): SerializedGroup {\n    return {\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      position: this.position.serialize(),\n      name: this.name,\n      width: this.width,\n      height: this.height,\n      style: this.style,\n      nodes: this.nodes.map(node => node.id),\n      nodeDeltas: this.nodeDeltas.map(nodeDelata => nodeDelata.serialize())\n    };\n  }\n  static deSerialize(flow: Flow, data: SerializedGroup): Group {\n    let group = new Group(flow, Vector.deSerialize(data.position), {\n      width: data.width,\n      height: data.height,\n      name: data.name,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n\n    data.nodes.forEach(nodeId => {\n      group.nodes.push(flow.nodes.get(nodeId));\n    });\n    data.nodeDeltas.forEach(serializedVector => {\n      group.nodeDeltas.push(Vector.deSerialize(serializedVector));\n    });\n\n    return group;\n  }\n}\n\nexport interface SerializedGroup {\n  position: SerializedVector,\n  width: number,\n  height: number,\n  name: string,\n  style: GroupStyle,\n  id: string,\n  hitColor: SerializedColor,\n  nodes: string[],\n  nodeDeltas: SerializedVector[]\n}\n\nlet DefaultGroupColors = {\n  colors: [\n    ['rgba(239, 134, 119, 1)', 'rgba(239, 134, 119, .5)'],\n    ['rgba(160, 231, 125, 1)', 'rgba(160, 231, 125, .5)'],\n    ['rgba(130, 182, 217, 1)', 'rgba(130, 182, 217, .5)']\n  ],\n  RED: () => DefaultGroupColors.colors[0],\n  GREEN: () => DefaultGroupColors.colors[1],\n  BLUE: () => DefaultGroupColors.colors[2],\n  Random: () => DefaultGroupColors.colors[Math.floor(Math.random() * DefaultGroupColors.colors.length)]\n};\n\nexport interface GroupStyle {\n  color?: string;\n  borderColor?: string;\n  titleColor?: string;\n  fontSize?: string;\n  font?: string;\n}\nlet DefaultGroupStyle = () => {\n  return {\n    titleColor: '#000',\n    fontSize: '16px',\n    font: 'arial'\n  };\n}\n\nexport interface GroupOptions {\n  width?: number,\n  height?: number,\n  name?: string,\n  style?: GroupStyle,\n  id?: string,\n  hitColor?: Color\n}\n\nlet DefaultGroupOptions = (): GroupOptions => {\n  return {\n    width: 0,\n    height: 0,\n    style: {},\n    id: getNewUUID()\n  }\n}\n\nexport interface GroupRenderParams {\n  position: SerializedVector,\n  width: number,\n  height: number\n}\n","/** \n * Hooks is a general purpose class used by FlowConnect, Flow, Node, UINode, Terminal, Group... classes\n * for making their normal processes available as events to listen to when they happen.\n * For e.g you can listen to any Terminal's 'connect'/'disconnect' event to do some custom stuff\n */\nexport class Hooks {\n  registeredEvents: Record<string, Record<number, (...args: any) => void>>;\n  lastId: number;\n\n  constructor() {\n    this.registeredEvents = {};\n    this.lastId = 0;\n  }\n\n  /** \n   * Register a callback to an event\n   * \n   * @param eventKey name of the event to listen to\n   * @param callback reference to a callback that will be triggered when this event happens\n   * @returns a numbered ID that can be used later to de-register this hook\n   */\n  on(eventKey: string, callback: (...args: any) => void): number {\n    if (!this.registeredEvents[eventKey]) this.registeredEvents[eventKey] = {};\n\n    let id = this.lastId;\n    this.registeredEvents[eventKey][id] = callback;\n    this.lastId += 1;\n    return id;\n  }\n  call(eventKey: string, ...args: any) {\n    if (this.registeredEvents[eventKey]) {\n      if (!args) args = [];\n      Object.values(this.registeredEvents[eventKey]).forEach(callback => callback(...args));\n    }\n  }\n  /** \n   * De-register a callback to an event\n   * \n   * @param eventKey name of the event to de-register\n   * @param id a numbered id that was generated at the time of event registration\n   */\n  off(eventKey: string, id: number) {\n    if (this.registeredEvents[eventKey]) delete this.registeredEvents[eventKey][id];\n  }\n  offAll() {\n    this.registeredEvents = {};\n  }\n}\n","export * from './color';\r\nexport * from './connector';\r\nexport * from './flow';\r\nexport * from './graph';\r\nexport * from './group';\r\nexport * from './hooks';\r\nexport * from './node';\r\nexport * from './subflow-node';\r\nexport * from './terminal';\r\nexport * from './tunnel-node';\r\nexport * from './vector';\r\n","import { SerializedVector, Vector } from \"./vector\";\r\nimport { ViewPort, LOD, Align } from '../common/enums';\r\nimport {\r\n  VSlider, VSliderStyle, Slider2D, Slider2DStyle, RadioGroup, RadioGroupStyle, Envelope, EnvelopeStyle,\r\n  Dial, DialStyle, Container, ContainerRenderParams, SerializedContainer, Label, LabelStyle,\r\n  Button, ButtonStyle, Image, ImageStyle, HorizontalLayout, HorizontalLayoutStyle, Toggle, ToggleStyle,\r\n  Select, SelectStyle, Source, SourceStyle, Display, DisplayStyle, CustomRendererConfig, Input, InputStyle,\r\n  Stack, StackStyle, Slider, SliderStyle, UINode\r\n} from \"../ui/index\";\r\nimport { get, getNewUUID, intersects } from \"../utils/utils\";\r\nimport { Color, SerializedColor } from \"./color\";\r\nimport { Flow, FlowState, SerializedFlow } from './flow';\r\nimport { Group } from './group';\r\nimport { Terminal, TerminalType, TerminalStyle, SerializedTerminal, TerminalRenderParams } from './terminal';\r\nimport { Hooks } from './hooks';\r\nimport { Events, Renderable, RenderFunction, RenderResolver, RenderState, Serializable } from \"../common/interfaces\";\r\nimport { Connector } from \"./connector\";\r\nimport { Log } from \"../utils/logger\";\r\n\r\nexport class Node extends Hooks implements Events, Serializable, Renderable {\r\n  //#region Properties\r\n  renderResolver: {\r\n    node?: RenderResolver<Node, NodeRenderParams>,\r\n    nodeButton?: RenderResolver<NodeButton, NodeButtonRenderParams>,\r\n    terminal?: RenderResolver<Terminal, TerminalRenderParams>,\r\n    uiContainer?: RenderResolver<Container, ContainerRenderParams>,\r\n  } = {};\r\n  hitColor: Color;\r\n  private _width: number;\r\n\r\n  uiNodes: Map<string, UINode>;\r\n  terminals: Map<string, Terminal>;\r\n  nodeButtons: Map<string, NodeButton>;\r\n  private _zIndex: number;\r\n  private _position: Vector;\r\n  private stateObserver = new Hooks();\r\n\r\n  renderState: RenderState = { viewport: ViewPort.INSIDE, nodeState: NodeState.MAXIMIZED, lod: LOD.LOD2 };\r\n\r\n  currHitTerminal: Terminal;\r\n  prevHitTerminal: Terminal;\r\n  currHitUINode: UINode;\r\n  prevHitUINode: UINode;\r\n\r\n  focused: boolean = false;\r\n  inputs: Terminal[] = [];\r\n  outputs: Terminal[] = [];\r\n  inputsUI: Terminal[] = [];\r\n  outputsUI: Terminal[] = [];\r\n  ui: Container;\r\n  state: Record<string, any>;\r\n  group: Group = null;\r\n  //#endregion\r\n\r\n  //#region Accessors\r\n  get height(): number { return this.ui.height }\r\n  get context(): CanvasRenderingContext2D { return this.flow.flowConnect.context }\r\n  get offContext(): OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D { return this.flow.flowConnect.offContext }\r\n  get offUIContext(): OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D { return this.flow.flowConnect.offUIContext }\r\n  get position(): Vector { return this._position }\r\n  set position(position: Vector) {\r\n    this._position = position;\r\n    this.reflow();\r\n    this.ui.update();\r\n    this.updateRenderState();\r\n  }\r\n  get zIndex(): number { return this._zIndex }\r\n  set zIndex(zIndex: number) {\r\n    if (this.flow.sortedNodes.remove(this)) {\r\n      this._zIndex = zIndex;\r\n      this.flow.sortedNodes.add(this);\r\n    } else {\r\n      this._zIndex = zIndex;\r\n    }\r\n  }\r\n  get width(): number { return this._width }\r\n  set width(width: number) {\r\n    this._width = width;\r\n    this.ui.width = width;\r\n    this.ui.update();\r\n  }\r\n  //#endregion\r\n\r\n  style: NodeStyle;\r\n  terminalStyle: TerminalStyle;\r\n  id: string;\r\n\r\n  constructor(\r\n    public flow: Flow,\r\n    public name: string,\r\n    position: Vector,\r\n    width: number,\r\n    inputs: SerializedTerminal[], outputs: SerializedTerminal[],\r\n    options: NodeConstructorOptions = DefaultNodeConstructorOptions()\r\n  ) {\r\n\r\n    super();\r\n\r\n    this.style = get(options.style, {});\r\n    this.terminalStyle = get(options.terminalStyle, {});\r\n    this.id = get(options.id, getNewUUID());\r\n    options.state = get(options.state, {});\r\n\r\n    this.hitColor = options.hitColor;\r\n    this._width = width;\r\n    this.style = { ...DefaultNodeStyle(), ...options.style }\r\n    this._position = position;\r\n    this.setupState(options.state);\r\n    this.uiNodes = new Map();\r\n    this.terminals = new Map();\r\n    this.nodeButtons = new Map();\r\n    this._zIndex = 0;\r\n    this.setHitColor(options.hitColor);\r\n\r\n    this.setupTerminals(options, inputs, outputs);\r\n\r\n    if (options.ui) {\r\n      this.ui = options.ui instanceof Container ? options.ui : Container.deSerialize(this, options.ui)\r\n    } else {\r\n      this.ui = new Container(this, width);\r\n    }\r\n\r\n    this.addNodeButton(() => this.toggleNodeState(), this._renderNodeButton, Align.Left);\r\n\r\n    this.reflow();\r\n    this.ui.update();\r\n\r\n    this.flow.on('transform', () => this.updateRenderState());\r\n\r\n    this.flow.nodes.set(this.id, this);\r\n    this.flow.sortedNodes.add(this);\r\n    this.flow.executionGraph.add(this);\r\n  }\r\n\r\n  //#region Methods\r\n  setupTerminals(options: NodeConstructorOptions, inputs: SerializedTerminal[], outputs: SerializedTerminal[]) {\r\n    this.inputs.push(...inputs.map(input =>\r\n      new Terminal(this, TerminalType.IN, input.dataType, input.name, {\r\n        style: input.style ? input.style : { ...options.terminalStyle },\r\n        id: input.id ? input.id : null,\r\n        hitColor: input.hitColor ? Color.deSerialize(input.hitColor) : null\r\n      })\r\n    ));\r\n    this.outputs.push(...outputs.map(output =>\r\n      new Terminal(this, TerminalType.OUT, output.dataType, output.name, {\r\n        style: output.style ? output.style : { ...options.terminalStyle },\r\n        id: output.id ? output.id : null,\r\n        hitColor: output.hitColor ? Color.deSerialize(output.hitColor) : null\r\n      })\r\n    ));\r\n  }\r\n  private setupState(state: any) {\r\n    this.state = new Proxy<any>({}, {\r\n      set: (target, prop, value) => {\r\n        let oldValue = target[prop];\r\n        target[prop] = value;\r\n        this.stateObserver.call(prop as string, oldValue, value);\r\n        return true;\r\n      }\r\n    });\r\n\r\n    Object.keys(state).forEach(key => this.state[key] = state[key]);\r\n  }\r\n  watch(propName: string, callback: (oldVal: any, newVal: any) => void): number {\r\n    if (typeof this.state[propName] !== 'undefined') {\r\n      return this.stateObserver.on(propName, callback);\r\n    } else {\r\n      Log.error(`Cannot watch prop '${propName}', prop not found`);\r\n    }\r\n  }\r\n  unwatch(propName: string, id: number) {\r\n    if (typeof this.state[propName] !== 'undefined') {\r\n      this.stateObserver.off(propName, id);\r\n    } else {\r\n      Log.error(`Cannot unwatch prop '${propName}', prop not found`);\r\n    }\r\n  }\r\n  private setHitColor(hitColor: Color) {\r\n    if (!hitColor) {\r\n      hitColor = Color.Random();\r\n      while (this.flow.nodeHitColors.get(hitColor.rgbaString)) hitColor = Color.Random();\r\n    }\r\n    this.hitColor = hitColor;\r\n    this.flow.nodeHitColors.set(this.hitColor.rgbaString, this);\r\n  }\r\n  addNodeButton(callback: () => void, render: RenderFunction<NodeButton, NodeButtonRenderParams>, align: Align): NodeButton {\r\n    let newNodeButton = new NodeButton(this, callback, render, align);\r\n\r\n    let noOfButtons = [...this.nodeButtons.values()].filter(nodeButton => nodeButton.align === newNodeButton.align).length - 1;\r\n    let deltaX;\r\n    if (align === Align.Left) deltaX = noOfButtons * (this.style.nodeButtonSize + this.style.nodeButtonSpacing);\r\n    else deltaX = this.width - noOfButtons * (this.style.nodeButtonSize + this.style.nodeButtonSpacing) - this.style.nodeButtonSize;\r\n    newNodeButton.deltaX = deltaX;\r\n\r\n    return newNodeButton;\r\n  }\r\n  private reflow(): void {\r\n    let y = this.position.y + this.style.terminalRowHeight / 2 + this.style.padding / 2 + this.style.titleHeight;\r\n    if (this.inputs.length > this.outputs.length) {\r\n      this.recalculateInputTerminals(y);\r\n      y = this.position.y + (this.inputs.length * this.style.terminalRowHeight) / 2 - (this.outputs.length * this.style.terminalRowHeight) / 2 + this.style.terminalRowHeight / 2 + this.style.padding / 2 + this.style.titleHeight;\r\n      this.recalculateOutputTerminals(y);\r\n    } else {\r\n      this.recalculateOutputTerminals(y);\r\n      y = this.position.y + (this.outputs.length * this.style.terminalRowHeight) / 2 - (this.inputs.length * this.style.terminalRowHeight) / 2 + this.style.terminalRowHeight / 2 + this.style.padding / 2 + this.style.titleHeight;\r\n      this.recalculateInputTerminals(y);\r\n    }\r\n  }\r\n  private updateRenderState() {\r\n    let realPos = this.position.transform(this.flow.flowConnect.transform);\r\n    this.renderState.viewport = intersects(\r\n      0, 0,\r\n      this.flow.flowConnect.canvasDimensions.width, this.flow.flowConnect.canvasDimensions.height,\r\n      realPos.x, realPos.y,\r\n      realPos.x + this.width * this.flow.flowConnect.scale,\r\n      realPos.y + (this.renderState.nodeState === NodeState.MAXIMIZED ? this.ui.height : this.style.titleHeight) * this.flow.flowConnect.scale\r\n    );\r\n\r\n    if (this.flow.flowConnect.scale > 0.6) this.renderState.lod = LOD.LOD2;\r\n    else if (this.flow.flowConnect.scale <= 0.6 && this.flow.flowConnect.scale > .3) this.renderState.lod = LOD.LOD1;\r\n    else this.renderState.lod = LOD.LOD0;\r\n\r\n    if (this.renderState.viewport === ViewPort.INTERSECT) {\r\n      this.ui.updateRenderState();\r\n    }\r\n  }\r\n  private recalculateInputTerminals(y: number) {\r\n    this.inputs.forEach(terminal => {\r\n      terminal.position.x = this.position.x - this.style.terminalStripMargin - terminal.style.radius;\r\n      terminal.position.y = y;\r\n      y += this.style.terminalRowHeight;\r\n    });\r\n  }\r\n  private recalculateOutputTerminals(y: number) {\r\n    this.outputs.forEach(terminal => {\r\n      terminal.position.x = this.position.x + this.ui.width + this.style.terminalStripMargin + terminal.style.radius;\r\n      terminal.position.y = y;\r\n      y += this.style.terminalRowHeight;\r\n    });\r\n  }\r\n  getHitTerminal(hitColor: string, screenPosition: Vector, realPosition: Vector) {\r\n    let hitTerminal = null;\r\n\r\n    realPosition = realPosition.transform(this.flow.flowConnect.transform);\r\n    let thisRealPosition = this.position.transform(this.flow.flowConnect.transform);\r\n    if (\r\n      (this.inputs.length + this.inputsUI.length > 0 && realPosition.x < thisRealPosition.x) ||\r\n      (this.outputs.length + this.outputsUI.length > 0 && realPosition.x > thisRealPosition.x + this.ui.width * this.flow.flowConnect.scale)\r\n    ) {\r\n      hitTerminal = this.terminals.get(hitColor);\r\n    }\r\n\r\n    if (this.currHitTerminal && this.currHitTerminal !== hitTerminal) {\r\n      this.currHitTerminal.onExit(screenPosition, realPosition);\r\n      hitTerminal && hitTerminal.onEnter(screenPosition, realPosition);\r\n    }\r\n\r\n    return hitTerminal;\r\n  }\r\n  getHitUINode(hitColor: string): UINode {\r\n    let uiNode = this.uiNodes.get(hitColor);\r\n    if (uiNode instanceof Container) return null;\r\n    return uiNode;\r\n  }\r\n  private getHitNodeButton(hitColor: string): NodeButton {\r\n    return this.nodeButtons.get(hitColor);\r\n  }\r\n  run() {\r\n    if (this.flow.state === FlowState.Stopped) return;\r\n\r\n    this.call('process', this, this.inputs.map(terminal => terminal.connectors.length > 0 ? terminal.connectors[0].data : null));\r\n  }\r\n\r\n  render(): void {\r\n    if (this.renderState.viewport === ViewPort.OUTSIDE) return;\r\n    if (this.renderState.nodeState === NodeState.MAXIMIZED) this.ui.render();\r\n\r\n    let context = this.context;\r\n    context.save();\r\n    this.renderTerminals(context);\r\n    this.renderName(context);\r\n    this.renderFocused(context);\r\n    let flowRenderResolver = this.flow.renderResolver.node;\r\n    let flowConnectRenderResolver = this.flow.flowConnect.renderResolver.node;\r\n    ((this.renderResolver.node && this.renderResolver.node(this))\r\n      || (flowRenderResolver && flowRenderResolver(this))\r\n      || (flowConnectRenderResolver && flowConnectRenderResolver(this))\r\n      || this._render\r\n    )(context, this.getRenderParams(), this);\r\n    context.restore();\r\n\r\n    this.nodeButtons.forEach(nodeButton => nodeButton.render());\r\n\r\n    this.offContext.save();\r\n    this._offRender();\r\n    this.offContext.restore();\r\n\r\n    this.call('render', this);\r\n  }\r\n  private renderTerminals(context: CanvasRenderingContext2D) {\r\n    if (this.renderState.nodeState === NodeState.MAXIMIZED) {\r\n      if (this.renderState.lod > 0) {\r\n        this.inputs.forEach(terminal => terminal.render());\r\n        this.outputs.forEach(terminal => terminal.render());\r\n      }\r\n\r\n      context.fillStyle = this.style.color;\r\n      context.font = this.style.fontSize + ' ' + this.style.font;\r\n      context.textBaseline = 'middle';\r\n      this.inputs.forEach(terminal => {\r\n        context.fillText(terminal.name, terminal.position.x + terminal.style.radius + this.style.terminalStripMargin + this.style.padding, terminal.position.y);\r\n      });\r\n      this.outputs.forEach(terminal => {\r\n        context.fillText(terminal.name, terminal.position.x - terminal.style.radius - this.style.terminalStripMargin - this.style.padding - context.measureText(terminal.name).width, terminal.position.y);\r\n      });\r\n    } else {\r\n      context.fillStyle = this.style.minimizedTerminalColor;\r\n      if ((this.inputs.length + this.inputsUI.length) > 0) {\r\n        let radius = this.inputs.length > 0 ? this.inputs[0].style.radius : this.inputsUI[0].style.radius;\r\n        context.fillRect(this.position.x - this.style.terminalStripMargin - radius * 2, this.position.y + this.style.titleHeight / 2 - radius, radius * 2, radius * 2);\r\n      }\r\n      if ((this.outputs.length + this.outputsUI.length) > 0) {\r\n        let radius = this.outputs.length > 0 ? this.outputs[0].style.radius : this.outputsUI[0].style.radius;\r\n        context.fillRect(this.position.x + this.width + this.style.terminalStripMargin, this.position.y + this.style.titleHeight / 2 - radius, radius * 2, radius * 2);\r\n      }\r\n    }\r\n  }\r\n  private renderName(context: CanvasRenderingContext2D) {\r\n    context.fillStyle = this.style.titleColor;\r\n    context.font = this.style.titleFontSize + ' ' + this.style.titleFont;\r\n    context.textBaseline = 'middle';\r\n    context.fillText(this.name, this.position.x + this.ui.width / 2 - context.measureText(this.name).width / 2, this.position.y + this.style.titleHeight / 2);\r\n  }\r\n  private renderFocused(context: CanvasRenderingContext2D) {\r\n    if (this.focused) {\r\n      context.strokeStyle = this.style.outlineColor;\r\n      context.lineWidth = 2;\r\n\r\n      let inputTerminalsWidth;\r\n      if (this.inputs.length === 0) {\r\n        inputTerminalsWidth = this.inputsUI.length === 0 ? 0 : this.inputsUI[0].style.radius * 2;\r\n      } else {\r\n        inputTerminalsWidth = this.inputs[0].style.radius * 2;\r\n      }\r\n      inputTerminalsWidth += this.style.terminalStripMargin * 2;\r\n\r\n      let outputTerminalsWidth;\r\n      if (this.outputs.length === 0) {\r\n        outputTerminalsWidth = this.outputsUI.length === 0 ? 0 : this.outputsUI[0].style.radius * 2;\r\n      } else {\r\n        outputTerminalsWidth = this.outputs[0].style.radius * 2;\r\n      }\r\n      outputTerminalsWidth += this.style.terminalStripMargin * 2;\r\n\r\n      context.strokeRoundRect(\r\n        this.position.x - inputTerminalsWidth,\r\n        this.position.y,\r\n        this.width + inputTerminalsWidth + outputTerminalsWidth,\r\n        this.renderState.nodeState === NodeState.MAXIMIZED ? (this.ui.height + this.style.padding) : this.style.titleHeight,\r\n        4\r\n      );\r\n    }\r\n  }\r\n  private _render() { /**/ }\r\n  private _offRender() {\r\n    this.offContext.fillStyle = this.hitColor.rgbaCSSString;\r\n    let x = this.position.x;\r\n    let y = this.position.y;\r\n    let inputTerminalsStripWidth = 0, outputTerminalsStripWidth = 0;\r\n    if ((this.inputs.length + this.inputsUI.length) !== 0) {\r\n      let radius = this.inputs.length > 0 ? this.inputs[0].style.radius : this.inputsUI[0].style.radius;\r\n      x -= this.style.terminalStripMargin + radius * 2;\r\n      inputTerminalsStripWidth = radius * 2 + this.style.terminalStripMargin;\r\n    }\r\n    if ((this.outputs.length + this.outputsUI.length) !== 0) {\r\n      let radius = this.outputs.length > 0 ? this.outputs[0].style.radius : this.outputsUI[0].style.radius;\r\n      outputTerminalsStripWidth = radius * 2 + this.style.terminalStripMargin;\r\n    }\r\n    this.offContext.fillRect(x, y,\r\n      this.ui.width + inputTerminalsStripWidth + outputTerminalsStripWidth,\r\n      this.renderState.nodeState === NodeState.MAXIMIZED ? this.ui.height : this.style.titleHeight\r\n    );\r\n  }\r\n  private _renderNodeButton(context: CanvasRenderingContext2D, params: NodeButtonRenderParams, nodeButton: NodeButton) {\r\n    let style = nodeButton.node.style;\r\n    context.fillStyle = style.maximizeButtonColor;\r\n    context.fillRect(params.position.x, params.position.y, style.nodeButtonSize, style.nodeButtonSize);\r\n  }\r\n  private getRenderParams(): NodeRenderParams {\r\n    return {\r\n      position: this.position.serialize(),\r\n      width: this.width,\r\n      height: this.ui.height,\r\n      focus: this.focused\r\n    }\r\n  }\r\n  addTerminal(terminal: Terminal | SerializedTerminal) {\r\n    if (!(terminal instanceof Terminal)) {\r\n      terminal = Terminal.deSerialize(this, terminal);\r\n    }\r\n    if (terminal.type === TerminalType.IN) this.inputs.push(terminal);\r\n    else this.outputs.push(terminal);\r\n    this.ui.update();\r\n    this.reflow();\r\n  }\r\n  removeTerminal(terminal: Terminal) {\r\n    let type = terminal.type;\r\n    let index = type === TerminalType.IN ? this.inputs.indexOf(terminal) : this.outputs.indexOf(terminal);\r\n    if (index < 0) {\r\n      Log.error('Cannot remove terminal, terminal not found');\r\n      return;\r\n    }\r\n    terminal.disconnect();\r\n    if (type === TerminalType.IN) this.inputs.splice(index, 1);\r\n    else this.outputs.splice(index, 1);\r\n    terminal.offAll();\r\n\r\n    this.ui.update();\r\n    this.reflow();\r\n  }\r\n  getInput(terminal: string | number): any {\r\n    if (typeof terminal === 'string') {\r\n      let inputTerminal = this.inputs.find(currTerm => (currTerm.name === terminal));\r\n      if (inputTerminal) return inputTerminal.getData();\r\n    } else {\r\n      if (this.inputs[terminal]) return this.inputs[terminal].getData();\r\n    }\r\n    return null;\r\n  }\r\n  getInputs(): any[] {\r\n    return this.inputs.map(terminal => terminal.getData());\r\n  }\r\n  setOutputs(outputs: string | number | Record<string, any>, data?: any) {\r\n    if (typeof outputs === 'string') {\r\n      let outputTerminal = this.outputs.find(term => (term.name === outputs));\r\n      if (outputTerminal) outputTerminal.setData(data);\r\n    } else if (typeof outputs === 'number') {\r\n      if (this.outputs[outputs]) this.outputs[outputs].setData(data);\r\n    } else {\r\n      let outputData = new Map<Terminal, any>();\r\n      Object.entries(outputs).forEach(entry => {\r\n        let terminal = this.outputs.find(term => term.name === entry[0]);\r\n        if (terminal) outputData.set(terminal, entry[1]);\r\n        else throw Log.error(\"Terminal '\" + entry[0] + \"' not found\");\r\n      });\r\n      let groupedConnectors = new Map<Node, Connector[]>();\r\n      let outputDataIterator = outputData.keys();\r\n\r\n      let curr: Terminal = outputDataIterator.next().value;\r\n      while (curr) {\r\n        curr.connectors.forEach(connector => {\r\n          if (groupedConnectors.has(connector.endNode)) groupedConnectors.get(connector.endNode).push(connector);\r\n          else groupedConnectors.set(connector.endNode, [connector]);\r\n        });\r\n        curr = outputDataIterator.next().value;\r\n      }\r\n      let gCntrsIterator = groupedConnectors.values();\r\n\r\n      let connectors: Connector[] = gCntrsIterator.next().value;\r\n      while (connectors) {\r\n        for (let i = 1; i < connectors.length; i++) connectors[i].setData(outputData.get(connectors[i].start));\r\n        connectors[0].data = outputData.get(connectors[0].start);\r\n        connectors = gCntrsIterator.next().value;\r\n      }\r\n    }\r\n\r\n    // If FlowState is Idle, start a partial run of all the dirty nodes this method has created\r\n    if (this.flow.state === FlowState.Idle) {\r\n      this.flow.executionGraph.start();\r\n    }\r\n  }\r\n  toggleNodeState() {\r\n    this.renderState.nodeState = this.renderState.nodeState === NodeState.MAXIMIZED ? NodeState.MINIMIZED : NodeState.MAXIMIZED;\r\n  }\r\n  dispose(): void {\r\n    this.flow.removeNode(this.id);\r\n  }\r\n  //#endregion\r\n\r\n  //#region Events\r\n  onDown(screenPosition: Vector, realPosition: Vector): void {\r\n    this.call('down', this, screenPosition, realPosition);\r\n\r\n    let hitColor = Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data);\r\n\r\n    this.currHitUINode = this.getHitUINode(hitColor);\r\n    this.currHitUINode && this.currHitUINode.onDown(screenPosition, realPosition);\r\n\r\n    let hitTerminal = this.getHitTerminal(hitColor, screenPosition, realPosition);\r\n    if (hitTerminal) {\r\n      this.currHitTerminal = hitTerminal;\r\n      this.currHitTerminal.onDown(screenPosition, realPosition);\r\n    }\r\n  }\r\n  onOver(screenPosition: Vector, realPosition: Vector): void {\r\n    this.call('over', this, screenPosition, realPosition);\r\n\r\n    let hitColor = Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data);\r\n\r\n    let hitTerminal = this.getHitTerminal(hitColor, screenPosition, realPosition);\r\n\r\n    if (hitTerminal !== this.prevHitTerminal) {\r\n      this.prevHitTerminal && this.prevHitTerminal.onExit(screenPosition, realPosition);\r\n      hitTerminal && hitTerminal.onEnter(screenPosition, realPosition);\r\n    } else {\r\n      hitTerminal && (!this.currHitTerminal) && hitTerminal.onOver(screenPosition, realPosition);\r\n    }\r\n    this.prevHitTerminal = hitTerminal;\r\n\r\n    let hitUINode = this.getHitUINode(hitColor);\r\n    if (hitUINode !== this.prevHitUINode) {\r\n      this.prevHitUINode && this.prevHitUINode.onExit(screenPosition, realPosition);\r\n      hitUINode && hitUINode.onEnter(screenPosition, realPosition);\r\n    } else {\r\n      hitUINode && (!this.currHitUINode) && hitUINode.onOver(screenPosition, realPosition);\r\n    }\r\n    this.prevHitUINode = hitUINode;\r\n  }\r\n  onEnter(screenPosition: Vector, realPosition: Vector): void {\r\n    this.call('enter', this, screenPosition, realPosition);\r\n  }\r\n  onExit(screenPosition: Vector, realPosition: Vector): void {\r\n    this.call('exit', this, screenPosition, realPosition);\r\n\r\n    let hitColor = Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data);\r\n\r\n    let hitTerminal = this.getHitTerminal(hitColor, screenPosition, realPosition);\r\n    hitTerminal && hitTerminal.onExit(screenPosition, realPosition);\r\n    this.prevHitTerminal && this.prevHitTerminal.onExit(screenPosition, realPosition);\r\n    this.prevHitTerminal = null;\r\n    this.currHitTerminal && this.currHitTerminal.onExit(screenPosition, realPosition);\r\n  }\r\n  onUp(screenPosition: Vector, realPosition: Vector): void {\r\n    this.call('up', this, screenPosition, realPosition);\r\n\r\n    let hitColor = Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data);\r\n\r\n    this.currHitUINode = null;\r\n    let hitUINode = this.getHitUINode(hitColor);\r\n    hitUINode && hitUINode.onUp(screenPosition.clone(), realPosition.clone());\r\n\r\n    let hitTerminal = this.getHitTerminal(hitColor, screenPosition, realPosition);\r\n    hitTerminal && hitTerminal.onUp(screenPosition, realPosition);\r\n  }\r\n  onClick(screenPosition: Vector, realPosition: Vector): void {\r\n    this.call('click', this, screenPosition, realPosition);\r\n\r\n    let hitColor = Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data);\r\n    if (realPosition.y < this.position.y + this.style.titleHeight * this.flow.flowConnect.scale) {\r\n      let hitNodeButton = this.getHitNodeButton(hitColor);\r\n      hitNodeButton && hitNodeButton.callback();\r\n    } else {\r\n      this.currHitTerminal && this.currHitTerminal.onClick(screenPosition, realPosition);\r\n\r\n      let hitUINode = this.getHitUINode(hitColor);\r\n      hitUINode && hitUINode.onClick(screenPosition.clone(), realPosition.clone());\r\n    }\r\n  }\r\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\r\n    this.call('drag', this, screenPosition, realPosition);\r\n\r\n    let hitColor = Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data);\r\n    let hitUINodeWhileDragging = this.getHitUINode(hitColor);\r\n\r\n    if (this.currHitUINode && this.currHitUINode.draggable) {\r\n      if (hitUINodeWhileDragging === this.currHitUINode) {\r\n        this.currHitUINode.onDrag(screenPosition, realPosition);\r\n      } else {\r\n        this.currHitUINode.onExit(screenPosition, realPosition);\r\n        this.currHitUINode = null;\r\n        this.flow.flowConnect.currHitNode = null;\r\n        this.flow.flowConnect.pointers = [];\r\n      }\r\n    }\r\n  }\r\n  onContextMenu(): void {\r\n    this.call('rightclick', this);\r\n  }\r\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector): void {\r\n    this.call('wheel', this, direction, screenPosition, realPosition);\r\n\r\n    let hitColor = Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data);\r\n    let hitUINode = this.getHitUINode(hitColor);\r\n\r\n    hitUINode && hitUINode.zoomable && hitUINode.onWheel(direction, screenPosition, realPosition);\r\n  }\r\n  //#endregion\r\n\r\n  //#region UICreators\r\n  createLabel(text: string | number, options?: LabelCreatorOptions): Label {\r\n    return new Label(this, text, options);\r\n  }\r\n  createImage(source: string, options?: ImageCreatorOptions): Image {\r\n    return new Image(this, source, options);\r\n  }\r\n  createSlider(min: number, max: number, options?: SliderCreatorOptions) {\r\n    return new Slider(this, min, max, options);\r\n  }\r\n  createSlider2D(options?: Slider2DCreatorOptions) {\r\n    return new Slider2D(this, options);\r\n  }\r\n  createVSlider(min: number, max: number, options?: VSliderCreatorOptions) {\r\n    return new VSlider(this, min, max, options);\r\n  }\r\n  createDial(min: number, max: number, size: number, options?: DialCreatorOptions) {\r\n    return new Dial(this, min, max, size, options);\r\n  }\r\n  createHozLayout(childs: UINode[] = [], options?: HorizontalLayoutCreatorOptions) {\r\n    return new HorizontalLayout(this, childs, options);\r\n  }\r\n  createStack(options?: StackCreatorOptions) {\r\n    return new Stack(this, options);\r\n  }\r\n  createButton(text: string, options?: ButtonCreatorOptions) {\r\n    return new Button(this, text, options);\r\n  }\r\n  createToggle(options?: ToggleCreatorOptions) {\r\n    return new Toggle(this, options);\r\n  }\r\n  createRadioGroup(values?: string[], selected?: string, options?: RadioGroupCreatorOptions) {\r\n    return new RadioGroup(this, values, selected, options);\r\n  }\r\n  createSelect(values: string[], options?: SelectCreatorOptions) {\r\n    return new Select(this, values, options);\r\n  }\r\n  createSource(options?: SourceCreatorOptions) {\r\n    return new Source(this, options);\r\n  }\r\n  createDisplay(height: number, renderers: CustomRendererConfig[], options?: DisplayCreatorOptions) {\r\n    return new Display(this, height, renderers, options);\r\n  }\r\n  createInput(options?: InputCreatorOptions) {\r\n    return new Input(this, options);\r\n  }\r\n  createEnvelope(height: number, values?: Vector[], options?: EnvelopeCreatorOptions): Envelope {\r\n    return new Envelope(this, height, values, options);\r\n  }\r\n  //#endregion\r\n\r\n  serialize(): SerializedNode {\r\n    return {\r\n      id: this.id,\r\n      name: this.name,\r\n      position: this.position.serialize(),\r\n      width: this.width,\r\n      state: this.state,\r\n      inputs: this.inputs.map(terminal => terminal.serialize()),\r\n      outputs: this.outputs.map(terminal => terminal.serialize()),\r\n      style: this.style,\r\n      terminalStyle: this.terminalStyle,\r\n      hitColor: this.hitColor.serialize(),\r\n      zIndex: this.zIndex,\r\n      focused: this.focused,\r\n      renderState: this.renderState,\r\n      ui: this.ui.serialize()\r\n    };\r\n  }\r\n  static deSerialize(flow: Flow, data: SerializedNode): Node {\r\n    return new Node(flow, data.name, Vector.deSerialize(data.position), data.width, data.inputs, data.outputs, {\r\n      style: data.style,\r\n      terminalStyle: data.terminalStyle,\r\n      state: data.state,\r\n      id: data.id,\r\n      hitColor: Color.deSerialize(data.hitColor),\r\n      ui: data.ui\r\n    });\r\n  }\r\n}\r\n\r\nexport interface NodeRenderParams {\r\n  position: SerializedVector,\r\n  width: number,\r\n  height: number,\r\n  focus: boolean\r\n}\r\nexport enum NodeState {\r\n  MAXIMIZED = 'Maximized',\r\n  MINIMIZED = 'Minimized'\r\n}\r\n\r\nexport interface NodeStyle {\r\n  font?: string,\r\n  fontSize?: string,\r\n  titleFont?: string,\r\n  titleFontSize?: string,\r\n  padding?: number,\r\n  spacing?: number,\r\n  rowHeight?: number,\r\n  color?: string,\r\n  titleColor?: string,\r\n  titleHeight?: number,\r\n  terminalRowHeight?: number,\r\n  terminalStripMargin?: number,\r\n  maximizeButtonColor?: string,\r\n  expandButtonColor?: string;\r\n  minimizedTerminalColor?: string,\r\n  nodeButtonSize?: number,\r\n  nodeButtonSpacing?: number,\r\n  outlineColor?: string\r\n}\r\nlet DefaultNodeStyle = () => {\r\n  return {\r\n    font: 'arial',\r\n    fontSize: '.75rem',\r\n    titleFont: 'arial',\r\n    titleFontSize: '.85rem',\r\n    color: '#000',\r\n    titleColor: '#000',\r\n    maximizeButtonColor: 'darkgrey',\r\n    nodeButtonSize: 10,\r\n    nodeButtonSpacing: 5,\r\n    expandButtonColor: '#000',\r\n    minimizedTerminalColor: 'green',\r\n    outlineColor: '#000',\r\n    padding: 10,\r\n    spacing: 10,\r\n    rowHeight: 20,\r\n    titleHeight: 29,\r\n    terminalRowHeight: 24,\r\n    terminalStripMargin: 8\r\n  };\r\n};\r\n\r\nexport interface SerializedNode {\r\n  hitColor: SerializedColor,\r\n  zIndex: number,\r\n  focused: boolean,\r\n  id: string,\r\n  position: SerializedVector,\r\n  state: Record<string, any>,\r\n  renderState: RenderState,\r\n  inputs: SerializedTerminal[],\r\n  outputs: SerializedTerminal[],\r\n  name: string,\r\n  style: NodeStyle,\r\n  terminalStyle: TerminalStyle,\r\n  ui: SerializedContainer,\r\n  width: number,\r\n  subFlow?: SerializedFlow\r\n}\r\n\r\nexport interface NodeConstructorOptions {\r\n  style?: NodeStyle,\r\n  terminalStyle?: TerminalStyle,\r\n  state?: Object,\r\n  id?: string,\r\n  hitColor?: Color,\r\n  ui?: Container | SerializedContainer\r\n}\r\nlet DefaultNodeConstructorOptions = (): NodeConstructorOptions => {\r\n  return {\r\n    style: {},\r\n    terminalStyle: {},\r\n    state: {},\r\n    id: getNewUUID(),\r\n  }\r\n}\r\n\r\ninterface ToggleCreatorOptions {\r\n  propName?: string,\r\n  input?: boolean,\r\n  output?: boolean,\r\n  height?: number,\r\n  style?: ToggleStyle\r\n}\r\ninterface StackCreatorOptions {\r\n  childs?: UINode[],\r\n  style?: StackStyle\r\n}\r\ninterface SourceCreatorOptions {\r\n  accept?: string,\r\n  propName?: string,\r\n  input?: boolean,\r\n  output?: boolean,\r\n  height?: number,\r\n  style?: SourceStyle\r\n}\r\ninterface SliderCreatorOptions {\r\n  value?: number,\r\n  propName?: string,\r\n  input?: boolean,\r\n  output?: boolean,\r\n  height?: number,\r\n  style?: SliderStyle\r\n}\r\ninterface VSliderCreatorOptions {\r\n  value?: number,\r\n  propName?: string,\r\n  input?: boolean,\r\n  output?: boolean,\r\n  height?: number,\r\n  width?: number,\r\n  style?: VSliderStyle\r\n}\r\ninterface Slider2DCreatorOptions {\r\n  value?: Vector,\r\n  propName?: string,\r\n  input?: boolean,\r\n  output?: boolean,\r\n  height?: number,\r\n  style?: Slider2DStyle\r\n}\r\ninterface SelectCreatorOptions {\r\n  height?: number,\r\n  propName?: string,\r\n  input?: boolean,\r\n  output?: boolean,\r\n  style?: SelectStyle\r\n}\r\ninterface RadioGroupCreatorOptions {\r\n  propName?: string,\r\n  input?: boolean,\r\n  output?: boolean,\r\n  height?: number,\r\n  style?: RadioGroupStyle\r\n}\r\ninterface LabelCreatorOptions {\r\n  propName?: string,\r\n  input?: boolean,\r\n  output?: boolean,\r\n  style?: LabelStyle,\r\n  height?: number\r\n}\r\ninterface InputCreatorOptions {\r\n  value?: string | number,\r\n  propName?: string,\r\n  input?: boolean,\r\n  output?: boolean,\r\n  height?: number,\r\n  style?: InputStyle\r\n}\r\ninterface ImageCreatorOptions {\r\n  propName?: string,\r\n  style?: ImageStyle\r\n}\r\ninterface HorizontalLayoutCreatorOptions {\r\n  style?: HorizontalLayoutStyle,\r\n  input?: boolean,\r\n  output?: boolean\r\n}\r\ninterface ButtonCreatorOptions {\r\n  input?: boolean,\r\n  output?: boolean,\r\n  height?: number,\r\n  style?: ButtonStyle\r\n}\r\ninterface DialCreatorOptions {\r\n  value?: number\r\n  propName?: string,\r\n  input?: boolean,\r\n  output?: boolean,\r\n  style?: DialStyle,\r\n}\r\ninterface DisplayCreatorOptions {\r\n  style?: DisplayStyle\r\n}\r\ninterface EnvelopeCreatorOptions {\r\n  input?: boolean,\r\n  output?: boolean,\r\n  style?: EnvelopeStyle\r\n}\r\n\r\nexport class NodeButton extends Hooks implements Renderable {\r\n  renderResolver: RenderResolver<NodeButton, NodeButtonRenderParams> = () => null;\r\n  defaultRenderFn: RenderFunction<NodeButton, NodeButtonRenderParams>;\r\n  style: Record<string, any> = {};\r\n\r\n  hitColor: Color;\r\n  deltaX: number = 0;\r\n\r\n  constructor(\r\n    public node: Node,\r\n    public callback: () => void,\r\n    render: RenderFunction<NodeButton, NodeButtonRenderParams>,\r\n    public align: Align,\r\n    style?: Record<string, any>\r\n  ) {\r\n    super();\r\n\r\n    this.style = get(style, {});\r\n    this.setHitColor();\r\n    this.defaultRenderFn = render;\r\n  }\r\n\r\n  private setHitColor() {\r\n    let color = Color.Random();\r\n    while (this.node.nodeButtons.get(color.rgbaString)) color = Color.Random();\r\n    this.hitColor = color;\r\n    this.node.nodeButtons.set(this.hitColor.rgbaString, this);\r\n  }\r\n  render() {\r\n    this.node.context.save();\r\n    let nodeRenderResolver = this.node.renderResolver.nodeButton;\r\n    let flowRenderResolver = this.node.flow.renderResolver.nodeButton;\r\n    let flowConnectRenderResolver = this.node.flow.flowConnect.renderResolver.nodeButton;\r\n    ((this.renderResolver && this.renderResolver(this))\r\n      || (nodeRenderResolver && nodeRenderResolver(this))\r\n      || (flowRenderResolver && flowRenderResolver(this))\r\n      || (flowConnectRenderResolver && flowConnectRenderResolver(this))\r\n      || this.defaultRenderFn\r\n    )(this.node.context, this.getRenderParams(), this);\r\n    this.node.context.restore();\r\n\r\n    this.node.offUIContext.save();\r\n    this._offUIRender();\r\n    this.node.offUIContext.restore();\r\n\r\n    this.call('render', this);\r\n  }\r\n  private getRenderParams(): NodeButtonRenderParams {\r\n    let position = this.node.position.serialize();\r\n    position.x += this.deltaX;\r\n    position.y += (this.node.style.titleHeight / 2 - this.node.style.nodeButtonSize / 2);\r\n    return { position }\r\n  }\r\n  private _offUIRender() {\r\n    this.node.offUIContext.fillStyle = this.hitColor.rgbaCSSString;\r\n    this.node.offUIContext.fillRect(\r\n      this.node.position.x + this.deltaX,\r\n      this.node.position.y + this.node.style.titleHeight / 2 - this.node.style.nodeButtonSize / 2,\r\n      this.node.style.nodeButtonSize,\r\n      this.node.style.nodeButtonSize\r\n    );\r\n  }\r\n}\r\nexport interface NodeButtonRenderParams {\r\n  position: SerializedVector\r\n}\r\n","import { Vector } from './vector';\nimport { Color } from './color';\nimport { Flow, FlowState } from './flow';\nimport { Node, NodeButton, NodeStyle, SerializedNode, NodeButtonRenderParams } from './node';\nimport { Terminal, TerminalType, TerminalStyle } from './terminal';\nimport { TunnelNode } from './tunnel-node';\nimport { Align } from '../common/enums';\n\nexport class SubFlowNode extends Node {\n  subFlow: Flow;\n\n  constructor(\n    flow: Flow,\n    subFlow: Flow,\n    position: Vector,\n    width: number,\n    inputs: any[],\n    outputs: any[],\n    options: SubFlowOptions = DefaultSubFlowOptions()\n  ) {\n\n    super(flow, options.name || 'New SubFlow', position, width, inputs ? inputs : [], outputs ? outputs : [], {\n      style: options.style,\n      terminalStyle: options.terminalStyle,\n      state: options.state,\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.subFlow = subFlow;\n\n    this.subFlow.on('add-input', (_, tunnel: TunnelNode) => {\n      let proxyTerminal = new Terminal(this, TerminalType.IN, tunnel.outputs[0].dataType, tunnel.outputs[0].name);\n      tunnel.proxyTerminal = proxyTerminal;\n      this.addTerminal(proxyTerminal);\n    });\n    this.subFlow.on('add-output', (_, tunnel: TunnelNode) => {\n      let proxyTerminal = new Terminal(this, TerminalType.OUT, tunnel.inputs[0].dataType, tunnel.inputs[0].name);\n      tunnel.proxyTerminal = proxyTerminal;\n      this.addTerminal(proxyTerminal);\n    });\n\n    this.subFlow.inputs.forEach((inputNode, index) => inputNode.proxyTerminal = this.inputs[index]);\n    this.subFlow.outputs.forEach((outputNode, index) => outputNode.proxyTerminal = this.outputs[index]);\n\n    this.addNodeButton(\n      () => this.flow.flowConnect.render(this.subFlow),\n      (context: CanvasRenderingContext2D, params: NodeButtonRenderParams, nodeButton: NodeButton) => {\n        let style = nodeButton.node.style;\n\n        context.strokeStyle = style.expandButtonColor;\n        context.beginPath();\n        context.moveTo(params.position.x, params.position.y + style.nodeButtonSize / 2);\n        context.lineTo(params.position.x, params.position.y + style.nodeButtonSize);\n        context.lineTo(params.position.x + style.nodeButtonSize, params.position.y);\n        context.lineTo(params.position.x + style.nodeButtonSize, params.position.y + style.nodeButtonSize / 2);\n        context.moveTo(params.position.x + style.nodeButtonSize, params.position.y);\n        context.lineTo(params.position.x + style.nodeButtonSize / 2, params.position.y);\n        context.moveTo(params.position.x, params.position.y + style.nodeButtonSize);\n        context.lineTo(params.position.x + style.nodeButtonSize / 2, params.position.y + style.nodeButtonSize);\n        context.closePath();\n\n        context.stroke();\n      }, Align.Right\n    );\n  }\n\n  run() {\n    if (this.flow.state === FlowState.Stopped) return;\n    this.subFlow.start();\n  }\n  serialize(): SerializedNode {\n    return {\n      id: this.id,\n      name: this.name,\n      position: this.position.serialize(),\n      width: this.width,\n      state: this.state,\n      inputs: this.inputs.map(terminal => terminal.serialize()),\n      outputs: this.outputs.map(terminal => terminal.serialize()),\n      style: this.style,\n      terminalStyle: this.terminalStyle,\n      hitColor: this.hitColor.serialize(),\n      zIndex: this.zIndex,\n      focused: this.focused,\n      renderState: this.renderState,\n      ui: this.ui.serialize(),\n      subFlow: this.subFlow.serialize()\n    };\n  }\n  static deSerialize(flow: Flow, data: SerializedNode): SubFlowNode {\n    let subFlow = Flow.deSerialize(flow.flowConnect, data.subFlow);\n    return new SubFlowNode(flow, subFlow, Vector.deSerialize(data.position), data.width, data.inputs, data.outputs, {\n      name: data.name,\n      style: data.style,\n      terminalStyle: data.terminalStyle,\n      state: data.state,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface SubFlowOptions {\n  name?: string,\n  style?: NodeStyle,\n  terminalStyle?: TerminalStyle,\n  state?: Object,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultSubFlowOptions = (): SubFlowOptions => {\n  return {\n    style: {},\n    terminalStyle: {},\n    state: {}\n  }\n}\n","import { Vector, SerializedVector } from \"./vector\";\r\nimport { getNewUUID, canConnect, get, exists } from \"../utils/utils\";\r\nimport { Color, SerializedColor } from \"./color\";\r\nimport { Connector, ConnectorStyle } from './connector';\r\nimport { Hooks } from './hooks';\r\nimport { Node } from './node';\r\nimport { Events, Renderable, RenderResolver, Serializable } from \"../common/interfaces\";\r\nimport { Log } from \"../utils/logger\";\r\nimport { Constant } from \"../resource/constants\";\r\n\r\nexport class Terminal extends Hooks implements Events, Serializable, Renderable {\r\n  /**\r\n   * Terminals can hold any user-defined reference, using this variable to store a reference to something (and thereby binding it to this terminal) is helpful in special applications\r\n   * for e.g audio connections - terminal can hold a reference to WebAudio Node which can be used to connect said AudioNodes when two terminals are connected,\r\n   * almost all StandardNodes.Audio nodes uses this variable.\r\n   * This can be ignored for other applications where such pattern is not useful or doesn't make sense.\r\n  **/\r\n  ref: any;\r\n  connectors: Connector[];\r\n  focus: boolean;\r\n  position: Vector;\r\n  hitColor: Color;\r\n  style: TerminalStyle;\r\n  id: string;\r\n  private _propName: string;\r\n  private watcherId: number;\r\n\r\n  get propName(): string { return this._propName; }\r\n  set propName(propName: string) {\r\n    if (!propName || propName === '') {\r\n      Log.error('Failed to set prop name \\'' + propName + '\\', prop name is invalid');\r\n      return;\r\n    }\r\n\r\n    let oldPropName = this._propName;\r\n    let newPropName = propName;\r\n    if (exists(this.watcherId)) { this.node.unwatch(oldPropName, this.watcherId); }\r\n    this._propName = newPropName;\r\n    this.watcherId = this.node.watch(newPropName, (_oldVal: any, newVal: any) => {\r\n      if (this.type === TerminalType.OUT) this.setData(newVal);\r\n    });\r\n  }\r\n\r\n  renderResolver: RenderResolver<Terminal, TerminalRenderParams> = () => null;\r\n\r\n  constructor(\r\n    public node: Node,\r\n    public type: TerminalType,\r\n    public dataType: string,\r\n    public name: string,\r\n    public options = DefaultTerminalOptions()\r\n  ) {\r\n\r\n    super();\r\n    this.hitColor = options.hitColor;\r\n    if (options.propName) this.propName = options.propName;\r\n    this.style = options.style ? { ...DefaultTerminalStyle(), ...options.style } : DefaultTerminalStyle();\r\n    this.id = get(options.id, getNewUUID());\r\n    this.setHitColor(this.hitColor);\r\n    this.connectors = [];\r\n    this.position = Vector.Zero();\r\n    this.focus = false;\r\n\r\n    if (this.type === TerminalType.IN) {\r\n      this.on('data', (_inst, data) => {\r\n        if (this.propName) this.node.state[this.propName] = data;\r\n      });\r\n    }\r\n  }\r\n\r\n  getData(): any {\r\n    if (this.type === TerminalType.OUT) { Log.error(\"Cannot call 'getData' on output terminal\"); return; }\r\n    if (this.connectors.length > 0) return this.connectors[0].data;\r\n    return null;\r\n  }\r\n  setData(data: any) {\r\n    if (this.type === TerminalType.IN) { Log.error(\"Cannot call 'setData' on input terminal\"); return; }\r\n    this.connectors.forEach(connector => connector.data = data);\r\n  }\r\n  private setHitColor(hitColor: Color) {\r\n    if (!hitColor) {\r\n      hitColor = Color.Random();\r\n      while (this.node.terminals.get(hitColor.rgbaString) || this.node.uiNodes.get(hitColor.rgbaString)) hitColor = Color.Random();\r\n    }\r\n    this.hitColor = hitColor;\r\n    this.node.terminals.set(this.hitColor.rgbaString, this);\r\n  }\r\n  render() {\r\n    let context = this.node.context;\r\n    context.save();\r\n    let nodeRenderResolver = this.node.renderResolver.terminal;\r\n    let flowRenderResolver = this.node.flow.renderResolver.terminal;\r\n    let flowConnectRenderResolver = this.node.flow.flowConnect.renderResolver.terminal;\r\n    ((this.renderResolver && this.renderResolver(this))\r\n      || (nodeRenderResolver && nodeRenderResolver(this))\r\n      || (flowRenderResolver && flowRenderResolver(this))\r\n      || (flowConnectRenderResolver && flowConnectRenderResolver(this))\r\n      || this._render\r\n    )(context, this.getRenderParams(), this);\r\n    context.restore();\r\n\r\n    this.offUIRender();\r\n\r\n    this.call('render', this);\r\n  }\r\n  _render(context: CanvasRenderingContext2D, params: TerminalRenderParams, terminal: Terminal) {\r\n    if (params.focus) {\r\n      context.beginPath();\r\n      context.arc(params.position.x, params.position.y, terminal.style.radius * 3, 0, Constant.TAU);\r\n      context.fillStyle = terminal.style.outerFocusColor;\r\n      context.fill();\r\n    }\r\n\r\n    if (terminal.dataType === 'event') {\r\n      context.beginPath();\r\n      context.moveTo(params.position.x, params.position.y - terminal.style.radius * 1.3);\r\n      context.lineTo(params.position.x + terminal.style.radius * 1.3, params.position.y);\r\n      context.lineTo(params.position.x, params.position.y + terminal.style.radius * 1.3);\r\n      context.lineTo(params.position.x - terminal.style.radius * 1.3, params.position.y);\r\n      context.lineTo(params.position.x, params.position.y - terminal.style.radius * 1.3);\r\n      context.closePath();\r\n    } else {\r\n      context.beginPath();\r\n      context.arc(params.position.x, params.position.y, terminal.style.radius, 0, Constant.TAU);\r\n    }\r\n    context.fillStyle = params.focus ? terminal.style.focusColor : (terminal.node.flow.terminalColors[terminal.dataType] || terminal.style.color);\r\n    context.strokeStyle = terminal.style.borderColor;\r\n    context.shadowBlur = terminal.style.shadowBlur;\r\n    context.shadowColor = terminal.style.shadowColor;\r\n    context.fill();\r\n    context.stroke();\r\n  }\r\n  getRenderParams(): TerminalRenderParams {\r\n    return {\r\n      focus: this.focus,\r\n      position: this.position.serialize()\r\n    };\r\n  }\r\n  connect(otherTerminal: Terminal, style?: ConnectorStyle): boolean {\r\n    // Check if already connected\r\n    if (this.type !== otherTerminal.type) {\r\n      let start = this.type === TerminalType.OUT ? this : otherTerminal;\r\n      let end = this.type === TerminalType.IN ? this : otherTerminal;\r\n      if (end.connectors.length > 0 && start.connectors.includes(end.connectors[0])) return false;\r\n    }\r\n\r\n    // Check if these terminals can be connected\r\n    if (canConnect(this, otherTerminal, this.node.flow.rules, this.node.flow.executionGraph)) {\r\n      let newConnector = new Connector(\r\n        this.node.flow,\r\n        this.type === TerminalType.OUT ? this : otherTerminal,\r\n        this.type === TerminalType.IN ? this : otherTerminal,\r\n        { style }\r\n      );\r\n      this.node.flow.connectors.set(newConnector.id, newConnector);\r\n\r\n      return true;\r\n    } else return false;\r\n  }\r\n  /**\r\n   * Disconnects terminal to terminal connections.\r\n   * If no parameters are passed and the terminal on which this method is called is an output terminal then,\r\n   * all the connections going out from this terminal will be diconnected.\r\n   * \r\n   * @param connector optional connector Id or reference, used only when the terminal on which this method is called is an Output terminal\r\n   * @returns \r\n   */\r\n  disconnect(connector?: string | Connector): boolean {\r\n    if (this.type === TerminalType.IN) {\r\n      this._disconnect(this.connectors[0]);\r\n      return true;\r\n    } else {\r\n      if (typeof connector === 'string') {\r\n        let cntr = this.connectors.find((currCntr => currCntr.id === connector));\r\n        if (!cntr) {\r\n          Log.error('Connector not found while disconnecting', connector);\r\n          return false;\r\n        }\r\n        this._disconnect(cntr);\r\n      } else if (connector instanceof Connector) {\r\n        if (!this.connectors.find(cntr => cntr.id === connector.id)) {\r\n          Log.error('Connector cannot be disconnected from the terminal because its not associated with it', connector);\r\n          return false;\r\n        }\r\n        this._disconnect(connector);\r\n      } else {\r\n        this.connectors.forEach(cntr => this._disconnect(cntr));\r\n      }\r\n      return true;\r\n    }\r\n  }\r\n  private _disconnect(connector: Connector): void {\r\n    let [startTerm, endTerm] = [connector.start, connector.end];\r\n    this.node.flow.connectors.delete(connector.id);\r\n    connector.start.connectors.splice(connector.start.connectors.findIndex(cntr => cntr.id === connector.id), 1);\r\n    connector.end.connectors.pop();\r\n    this.node.flow.executionGraph.disconnect(startTerm.node, endTerm.node);\r\n    connector.start.onDisconnect(connector, startTerm, endTerm);\r\n    connector.end.onDisconnect(connector, startTerm, endTerm);\r\n  }\r\n  private offUIRender() {\r\n    let context = this.node.offUIContext;\r\n    context.save();\r\n\r\n    context.beginPath();\r\n    context.arc(this.position.x, this.position.y, this.style.radius + this.node.style.terminalStripMargin, 0, Constant.TAU);\r\n    context.fillStyle = this.hitColor.rgbaCSSString;\r\n    context.fill();\r\n\r\n    context.restore();\r\n  }\r\n  isConnected(): boolean {\r\n    return this.connectors.length > 0;\r\n  }\r\n\r\n  onEnter(screenPosition: Vector, realPosition: Vector): void {\r\n    this.call('enter', this, screenPosition, realPosition);\r\n\r\n    this.focus = true;\r\n    this.node.flow.flowConnect.cursor = 'pointer';\r\n  }\r\n  onExit(screenPosition: Vector, realPosition: Vector): void {\r\n    this.call('exit', this, screenPosition, realPosition);\r\n\r\n    this.focus = false;\r\n    this.node.flow.flowConnect.cursor = 'unset';\r\n  }\r\n  onDown(screenPosition: Vector, realPosition: Vector): void {\r\n    this.call('down', this, screenPosition, realPosition);\r\n\r\n    if (this.connectors.length > 0) {\r\n      if (this.type === TerminalType.IN) {\r\n        let [startTerm, endTerm] = [this.connectors[0].start, this.connectors[0].end];\r\n        this.connectors[0].endNode.currHitTerminal = null;\r\n        this.connectors[0].end = null;\r\n        this.connectors[0].endNode = null;\r\n        this.connectors[0].floatingTip = realPosition;\r\n        this.node.flow.flowConnect.floatingConnector = this.connectors[0];\r\n        let removedConnector = this.connectors.pop();\r\n        this.node.flow.executionGraph.disconnect(startTerm.node, endTerm.node);\r\n        removedConnector.start.onDisconnect(removedConnector, startTerm, endTerm);\r\n        this.onDisconnect(removedConnector, startTerm, endTerm);\r\n      } else {\r\n        if (this.node.flow.flowConnect.floatingConnector) return;\r\n        let connector = new Connector(this.node.flow, this, null, { floatingTip: realPosition });\r\n        this.node.flow.connectors.set(connector.id, connector);\r\n        this.node.flow.flowConnect.floatingConnector = connector;\r\n      }\r\n    } else {\r\n      if (this.node.flow.flowConnect.floatingConnector) return;\r\n      let connector = new Connector(\r\n        this.node.flow,\r\n        this.type === TerminalType.IN ? null : this,\r\n        this.type === TerminalType.IN ? this : null,\r\n        { floatingTip: realPosition }\r\n      );\r\n      this.node.flow.connectors.set(connector.id, connector);\r\n      this.node.flow.flowConnect.floatingConnector = connector;\r\n    }\r\n  }\r\n  onUp(screenPosition: Vector, realPosition: Vector): void {\r\n    this.call('up', this, screenPosition, realPosition);\r\n  }\r\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\r\n    this.call('drag', this, screenPosition, realPosition);\r\n  }\r\n  onClick(screenPosition: Vector, realPosition: Vector): void {\r\n    this.call('click', this, screenPosition, realPosition);\r\n  }\r\n  onOver(screenPosition: Vector, realPosition: Vector): void {\r\n    this.call('over', this, screenPosition, realPosition);\r\n  }\r\n  onContextMenu(): void {\r\n    this.call('rightclick', this);\r\n  }\r\n  onConnect(connector: Connector) {\r\n    this.call('connect', this, connector);\r\n  }\r\n  onDisconnect(connector: Connector, startTerminal?: Terminal, endTerminal?: Terminal) {\r\n    this.call('disconnect', this, connector, startTerminal, endTerminal);\r\n  }\r\n\r\n  onEvent(data: any): void {\r\n    if (this.type === TerminalType.IN) {\r\n      this.call('event', this, data);\r\n    }\r\n  }\r\n  emit(data: any) {\r\n    if (this.type === TerminalType.OUT && this.connectors.length !== 0) {\r\n      this.connectors.forEach(connector => {\r\n        connector.end && connector.end.onEvent(data);\r\n      });\r\n      this.call('emit', this, data);\r\n    }\r\n  }\r\n\r\n  serialize(): SerializedTerminal {\r\n    return {\r\n      name: this.name,\r\n      type: this.type,\r\n      dataType: this.dataType,\r\n      propName: this.propName,\r\n      id: this.id,\r\n      style: this.style,\r\n      hitColor: this.hitColor.serialize()\r\n    };\r\n  }\r\n  static deSerialize(node: Node, data: SerializedTerminal): Terminal {\r\n    return new Terminal(node, data.type, data.dataType, data.name, {\r\n      propName: data.propName,\r\n      style: data.style,\r\n      id: data.id,\r\n      hitColor: Color.deSerialize(data.hitColor)\r\n    });\r\n  }\r\n}\r\n\r\nexport enum TerminalType {\r\n  IN = 1,\r\n  OUT = 2\r\n}\r\n\r\nexport interface SerializedTerminal {\r\n  name: string;\r\n  dataType: string;\r\n  type?: TerminalType;\r\n  propName?: string,\r\n  id?: string;\r\n  hitColor?: SerializedColor;\r\n  style?: TerminalStyle\r\n}\r\n\r\nexport interface TerminalStyle {\r\n  radius?: number,\r\n  color?: string,\r\n  borderColor?: string,\r\n  shadowColor?: string,\r\n  shadowBlur?: number,\r\n  focusColor?: string,\r\n  outerFocusColor?: string\r\n}\r\nlet DefaultTerminalStyle = () => {\r\n  return {\r\n    radius: 4,\r\n    color: '#888',\r\n    borderColor: '#222',\r\n    shadowBlur: 0,\r\n    shadowColor: '#ccc',\r\n    focusColor: '#00ff00',\r\n    outerFocusColor: '#bbbbbb80'\r\n  };\r\n}\r\n\r\nexport interface TerminalRenderParams {\r\n  focus: boolean,\r\n  position: SerializedVector\r\n}\r\n\r\nexport interface TerminalOptions {\r\n  propName?: string,\r\n  style?: TerminalStyle,\r\n  id?: string,\r\n  hitColor?: Color\r\n}\r\nconst DefaultTerminalOptions = (): TerminalOptions => {\r\n  return {\r\n    style: {}\r\n  };\r\n}\r\n","import { Vector } from \"./vector\";\nimport { Color } from \"./color\";\nimport { Flow } from \"./flow\";\nimport { Node, NodeStyle, SerializedNode } from \"./node\";\nimport { Terminal, TerminalStyle } from \"./terminal\";\n\nexport class TunnelNode extends Node {\n  private _proxyTerminal: Terminal;\n  \n  get proxyTerminal(): Terminal { return this._proxyTerminal; }\n  set proxyTerminal(terminal: Terminal) {\n    this._proxyTerminal = terminal;\n    this._proxyTerminal.on('data', (_, data) => this.outputs[0].setData(data));\n  }\n\n  constructor(\n    flow: Flow,\n    name: string,\n    position: Vector,\n    width: number,\n    inputs: any[],\n    outputs: any[],\n    options: TunnelNodeOptions = DefaultTunnelNodeOptions()\n  ) {\n\n    super(flow, name, position, width, inputs, outputs, {\n      style: options.style,\n      terminalStyle: options.terminalStyle,\n      state: options.state,\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    if (this.inputs.length > 0) {\n      this.inputs[0].on('data', (_, data) => this.proxyTerminal.setData(data));\n    } else {\n      this.outputs[0].on('connect', (_, connector) => {\n        if (this.proxyTerminal.connectors.length > 0) {\n          connector.data = this.proxyTerminal.connectors[0].data;\n        }\n      });\n    }\n  }\n\n  serialize(): SerializedTunnelNode {\n    return {\n      id: this.id,\n      name: this.name,\n      position: this.position.serialize(),\n      width: this.width,\n      state: this.state,\n      inputs: this.inputs.map(terminal => terminal.serialize()),\n      outputs: this.outputs.map(terminal => terminal.serialize()),\n      style: this.style,\n      terminalStyle: this.terminalStyle,\n      hitColor: this.hitColor.serialize(),\n      zIndex: this.zIndex,\n      focused: this.focused,\n      renderState: this.renderState,\n      ui: this.ui.serialize(),\n      proxyTerminalId: this.proxyTerminal.id\n    }\n  }\n  static deSerialize(flow: Flow, data: SerializedTunnelNode): TunnelNode {\n    return new TunnelNode(flow, data.name, Vector.deSerialize(data.position), data.width, data.inputs, data.outputs, {\n      style: data.style,\n      terminalStyle: data.terminalStyle,\n      state: data.state,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface SerializedTunnelNode extends SerializedNode {\n  proxyTerminalId: string\n}\n\nexport interface TunnelNodeOptions {\n  style?: NodeStyle,\n  terminalStyle?: TerminalStyle,\n  state?: Object,\n  id?: string,\n  hitColor?: Color,\n}\nlet DefaultTunnelNodeOptions = (): TunnelNodeOptions => {\n  return {\n    style: {},\n    terminalStyle: {},\n    state: {}\n  }\n}\n","import { Serializable } from '../common/interfaces';\nimport { normalize, clamp } from '../utils/utils';\n\nexport class Vector implements Serializable {\n  x: number;\n  y: number;\n\n  constructor(xOrDOMPoint: number | DOMPoint, y?: number) {\n    if (xOrDOMPoint instanceof DOMPoint)\n      [this.x, this.y] = [xOrDOMPoint.x, xOrDOMPoint.y];\n    else\n      [this.x, this.y] = [xOrDOMPoint || 0, y || 0];\n  }\n\n  addInPlace(vector: Vector): Vector;\n  addInPlace(scalar: number): Vector;\n  addInPlace(x: number, y: number): Vector;\n  addInPlace(arg1: number | Vector, arg2?: number): Vector {\n    if (arg1 instanceof Vector) {\n      this.x += arg1.x;\n      this.y += arg1.y;\n    } else if (typeof arg2 === 'undefined') {\n      this.x += arg1;\n      this.y += arg1;\n    } else {\n      this.x += arg1;\n      this.y += arg2;\n    }\n    return this;\n  }\n  multiplyInPlace(vector: Vector): Vector;\n  multiplyInPlace(scalar: number): Vector;\n  multiplyInPlace(x: number, y: number): Vector;\n  multiplyInPlace(arg1: number | Vector, arg2?: number): Vector {\n    if (arg1 instanceof Vector) {\n      this.x *= arg1.x;\n      this.y *= arg1.y;\n    } else if (typeof arg2 === 'undefined') {\n      this.x *= arg1;\n      this.y *= arg1;\n    } else {\n      this.x *= arg1;\n      this.y *= arg2;\n    }\n    return this;\n  }\n  subtractInPlace(vector: Vector): Vector;\n  subtractInPlace(scalar: number): Vector;\n  subtractInPlace(x: number, y: number): Vector;\n  subtractInPlace(arg1: number | Vector, arg2?: number): Vector {\n    if (arg1 instanceof Vector) {\n      this.x -= arg1.x;\n      this.y -= arg1.y;\n    } else if (typeof arg2 === 'undefined') {\n      this.x -= arg1;\n      this.y -= arg1;\n    } else {\n      this.x -= arg1;\n      this.y -= arg2;\n    }\n    return this;\n  }\n  normalizeInPlace(min: number, max: number): Vector;\n  normalizeInPlace(minX: number, maxX: number, minY: number, maxY: number): Vector;\n  normalizeInPlace(min: number, max: number, minY?: number, maxY?: number): Vector {\n    if (typeof minY !== 'undefined' && typeof maxY !== 'undefined') {\n      this.x = normalize(this.x, min, max);\n      this.y = normalize(this.y, minY, maxY);\n    } else {\n      this.x = normalize(this.x, min, max);\n      this.y = normalize(this.y, min, max);\n    }\n\n    return this;\n  }\n  clampInPlace(min: number, max: number): Vector;\n  clampInPlace(minX: number, maxX: number, minY: number, maxY: number): Vector;\n  clampInPlace(min: number, max: number, minY?: number, maxY?: number): Vector {\n    if (typeof minY !== 'undefined' && typeof maxY !== 'undefined') {\n      this.x = clamp(this.x, min, max);\n      this.y = clamp(this.y, minY, maxY);\n    } else {\n      this.x = clamp(this.x, min, max);\n      this.y = clamp(this.y, min, max);\n    }\n\n    return this;\n  }\n  transformInPlace(transform: DOMMatrix): Vector {\n    let transformedPoint = transform.transformPoint(this);\n    [this.x, this.y] = [transformedPoint.x, transformedPoint.y];\n    return this;\n  }\n  absInPlace(): Vector {\n    this.x = Math.abs(this.x);\n    this.y = Math.abs(this.y);\n    return this;\n  }\n\n  add(vector: Vector): Vector;\n  add(scalar: number): Vector;\n  add(x: number, y: number): Vector;\n  add(arg1: number | Vector, arg2?: number): Vector {\n    return (new Vector(this.x, this.y) as any).addInPlace(arg1, arg2);\n  }\n  multiply(vector: Vector): Vector;\n  multiply(scalar: number): Vector;\n  multiply(x: number, y: number): Vector;\n  multiply(arg1: number | Vector, arg2?: number): Vector {\n    return (new Vector(this.x, this.y) as any).multiplyInPlace(arg1, arg2);\n  }\n  subtract(vector: Vector): Vector;\n  subtract(scalar: number): Vector;\n  subtract(x: number, y: number): Vector;\n  subtract(arg1: number | Vector, arg2?: number): Vector {\n    return (new Vector(this.x, this.y) as any).subtractInPlace(arg1, arg2);\n  }\n  normalize(min: number, max: number): Vector;\n  normalize(minX: number, maxX: number, minY: number, maxY: number): Vector;\n  normalize(min: number, max: number, minY?: number, maxY?: number): Vector {\n    return new Vector(this.x, this.y).normalizeInPlace(min, max, minY, maxY);\n  }\n  clamp(min: number, max: number): Vector;\n  clamp(minX: number, maxX: number, minY: number, maxY: number): Vector;\n  clamp(min: number, max: number, minY?: number, maxY?: number): Vector {\n    return new Vector(this.x, this.y).clampInPlace(min, max, minY, maxY);\n  }\n  isInside(start: Vector, end: Vector): boolean;\n  isInside(x1: number, y1: number, x2: number, y2: number): boolean;\n  isInside(arg1: number | Vector, arg2: number | Vector, arg3?: number, arg4?: number): boolean {\n    if (arg1 instanceof Vector && arg2 instanceof Vector) {\n      if (this.x < arg1.x || this.x > arg2.x) return false;\n      if (this.y < arg1.y || this.y > arg2.y) return false;\n    } else {\n      if (this.x < arg1 || this.x > arg3) return false;\n      if (this.y < arg2 || this.y > arg4) return false;\n    }\n\n    return true;\n  }\n  assign(vector: Vector): Vector;\n  assign(scalar: number): Vector;\n  assign(x: number, y: number): Vector;\n  assign(arg1: number | Vector, arg2?: number): Vector {\n    if (arg1 instanceof Vector) {\n      this.x = arg1.x;\n      this.y = arg1.y;\n    } else if (typeof arg2 === 'undefined') {\n      this.x = arg1;\n      this.y = arg1;\n    } else {\n      this.x = arg1;\n      this.y = arg2;\n    }\n    return this;\n  }\n  transform(transform: DOMMatrix): Vector {\n    return new Vector(this.x, this.y).transformInPlace(transform);\n  }\n  abs(): Vector {\n    return new Vector(this.x, this.y).absInPlace();\n  }\n  toString() {\n    return '[' + this.x.toFixed(3) + ', ' + this.y.toFixed(3) + ']';\n  }\n  clone(): Vector {\n    return new Vector(this.x, this.y);\n  }\n  max(): number {\n    return Math.max(this.x, this.y);\n  }\n  isEqual(vector: Vector, threshold?: number): boolean {\n    if (typeof threshold !== 'undefined') {\n      return Vector.Distance(this, vector) <= threshold;\n    }\n\n    return this.x === vector.x && this.y === vector.y;\n  }\n\n  static Distance(vector1OrX1: Vector | number, vector2OrY1: Vector | number, x2?: number, y2?: number): number {\n    if (vector1OrX1 instanceof Vector && vector2OrY1 instanceof Vector) {\n      return Math.sqrt(Math.pow(vector2OrY1.x - vector1OrX1.x, 2) + Math.pow(vector2OrY1.y - vector1OrX1.y, 2));\n    } else if (typeof vector1OrX1 === 'number' && typeof vector2OrY1 === 'number') {\n      return Math.sqrt(Math.pow(x2 - vector1OrX1, 2) + Math.pow(y2 - vector2OrY1, 2));\n    }\n  }\n  static Midpoint(vector1: Vector, vector2: Vector): Vector {\n    return new Vector((vector1.x + vector2.x) / 2, (vector1.y + vector2.y) / 2);\n  }\n  static Zero(): Vector {\n    return new Vector(0, 0);\n  }\n  static Random(minX: number, maxX: number, minY: number, maxY: number): Vector {\n    return new Vector(\n      Math.random() * (maxX - minX) + minX,\n      Math.random() * (maxY - minY) + minY\n    );\n  }\n\n  serialize(): SerializedVector {\n    return { x: this.x, y: this.y };\n  }\n  static deSerialize(data: SerializedVector): Vector {\n    return new Vector(data.x, data.y);\n  }\n}\n\nexport interface SerializedVector {\n  x: number, y: number\n}\n","import { Connector, Flow, Group, Node, Color, Hooks, ConnectorRenderParams, NodeRenderParams, GroupRenderParams, NodeButton, NodeButtonRenderParams } from \"./core/index\";\r\nimport { Vector } from \"./core/vector\";\r\nimport { Dimension, Pointer, RenderResolver, Rules } from \"./common/interfaces\";\r\nimport { intersects, noop } from \"./utils/utils\";\r\nimport { Log } from './utils/logger';\r\nimport { Terminal, TerminalRenderParams, TerminalType } from './core/terminal';\r\nimport { FlowState, FlowOptions, SerializedFlow } from './core/flow';\r\nimport { ViewPort } from './common/enums';\r\nimport { generateAudioWorklets, WorkletUtils } from \"./resource/audio-worklets\";\r\nimport { Container, ContainerRenderParams } from \"./ui/container\";\r\n\r\ndeclare global {\r\n  interface CanvasRenderingContext2D {\r\n    roundRect: (x: number, y: number, width: number, height: number, radius: number) => void,\r\n    strokeRoundRect: (x: number, y: number, width: number, height: number, radius: number) => void,\r\n    fillRoundRect: (x: number, y: number, width: number, height: number, radius: number) => void\r\n  }\r\n}\r\n/**\r\n * FlowConnect is like a placeholder that contains references to all Flows created by this instance and can render one flow at a time on-screen\r\n * \r\n * One FlowConnect instance is bound to exactly one HTMLCanvasElement, this instance maintains/tracks the dimensions of HTMLCanvasElement,\r\n * it registers user-interaction events (mouse, keyboard, touch) and creates additional OffScreenCanvas's to track/act-upon these events\r\n */\r\nexport class FlowConnect extends Hooks {\r\n  static async create(mount?: HTMLCanvasElement | HTMLDivElement): Promise<FlowConnect> {\r\n    let flowConnect = new FlowConnect(mount);\r\n    await flowConnect.setupAudioContext();\r\n    return flowConnect;\r\n  }\r\n\r\n  /** Reference to the canvas element on which the flows will be rendered by FlowConnect instance */\r\n  canvas: HTMLCanvasElement;\r\n  private _context: CanvasRenderingContext2D;\r\n  get context(): CanvasRenderingContext2D { return this._context }\r\n\r\n  /** Reference to the AudioContext (one FlowConnect instance will only have one audio context) */\r\n  private _audioContext: AudioContext;\r\n  get audioContext(): AudioContext { return this._audioContext }\r\n\r\n  /** @hidden Only used for audio stuff */\r\n  audioBufferCache: Map<ArrayBuffer, AudioBuffer> = new Map();\r\n  /** @hidden Only used for audio stuff */\r\n  arrayBufferCache: Map<string, ArrayBuffer> = new Map();\r\n\r\n  /** For rendering color hit-maps for Nodes */\r\n  offCanvas: OffscreenCanvas | HTMLCanvasElement;\r\n  private _offContext: OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D;\r\n  get offContext(): OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D { return this._offContext }\r\n\r\n  /** For rendering color hit-maps for UI elements and Terminals of Nodes */\r\n  offUICanvas: OffscreenCanvas | HTMLCanvasElement;\r\n  private _offUIContext: OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D;\r\n  get offUIContext(): OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D { return this._offUIContext }\r\n\r\n  /** For rendering color hit-maps for Groups */\r\n  offGroupCanvas: OffscreenCanvas | HTMLCanvasElement;\r\n  private _offGroupContext: OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D;\r\n  get offGroupContext(): OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D { return this._offGroupContext }\r\n\r\n  /** Canvas's absolute position and dimension from viewport origin (top-left) (for e.g. if the canvas element is inside a scrollable parent) */\r\n  canvasDimensions: Dimension = { top: 0, left: 0, width: 0, height: 0 };\r\n\r\n  get cursor(): string { return this.canvas.style.cursor; }\r\n  set cursor(cursor: string) { this.canvas.style.cursor = cursor; }\r\n\r\n  state: FlowConnectState = FlowConnectState.Stopped;\r\n\r\n  /** Id recieved from *requestAnimationFrame* */\r\n  private frameId: number;\r\n\r\n  /** Root flow of the flow-tree (Flow that contains SubFlowNodes that again contains SubFlowNodes and so on...) */\r\n  private rootFlow: Flow;\r\n  /** Flow which is currently rendered on the canvas */\r\n  private currFlow: Flow;\r\n\r\n  /** All the flows created by this FlowConnect instance  */\r\n  flows: Flow[] = [];\r\n\r\n  /** Reference of the current/previous Nodes/Groups under user-interaction (mouse, touch) */\r\n  currHitNode: Node;\r\n  private prevHitNode: Node;\r\n  private currHitGroup: Group;\r\n\r\n  /** Reference to the new Group being drawn */\r\n  private currGroup: Group;\r\n  private groupStartPoint: Vector;\r\n\r\n  /** @hidden Reference to the new Connector being drawn */\r\n  floatingConnector: Connector;\r\n\r\n  /** For controlling user-interaction */\r\n  pointers: Pointer[] = [];\r\n  private keymap: Record<string, boolean> = {};\r\n  private touchControls: Record<string, boolean> = { 'CreateGroup': false };\r\n\r\n  /** @hidden HTML input overlayed on canvas when focused */\r\n  private genericInput: HTMLInputElement = document.createElement('input');\r\n  /** @hidden ResizeObservers to trigger re-render when dimensions change */\r\n  private parentResizeObserver: ResizeObserver;\r\n  private bodyResizeObserver: ResizeObserver;\r\n\r\n  minScale: number = 0.1;\r\n  maxScale: number = 5;\r\n  wheelScaleDelta: number = 1.05;\r\n  pinchScaleDelta: number = 1.02;\r\n  get scale(): number { return this._transform.a }\r\n  disableScale: boolean = false;\r\n  private _transform: DOMMatrix = new DOMMatrix();\r\n\r\n  /** Current transformation matrix */\r\n  get transform(): DOMMatrix { return this._transform }\r\n  private inverseTransform: DOMMatrix = new DOMMatrix();\r\n  private identity: DOMMatrix = new DOMMatrix();\r\n\r\n  /** Time (in ms) when one or more flows created by this FlowConnect instance was started */\r\n  startTime: number = -1;\r\n  private timerId: number;\r\n  /** No. of milliseconds passed since the start of one or more flows */\r\n  get time(): number { return (this.startTime < 0) ? this.startTime : (performance.now() - this.startTime) }\r\n\r\n  readonly renderResolver: {\r\n    connector?: RenderResolver<Connector, ConnectorRenderParams>,\r\n    node?: RenderResolver<Node, NodeRenderParams>,\r\n    nodeButton?: RenderResolver<NodeButton, NodeButtonRenderParams>,\r\n    uiContainer?: RenderResolver<Container, ContainerRenderParams>\r\n    group?: RenderResolver<Group, GroupRenderParams>,\r\n    terminal?: RenderResolver<Terminal, TerminalRenderParams>,\r\n  } = {};\r\n\r\n  /**\r\n   * @param mount HTML element (div or canvas) on which FlowConnect will render Flows, if no mount is provided, a new canvas element will be created and attached to document.body\r\n   */\r\n  constructor(mount?: HTMLCanvasElement | HTMLDivElement) {\r\n    super();\r\n    this.prepareCanvas(mount);\r\n    this.setupHitCanvas();\r\n    this.calcCanvasDimension(true);\r\n    this.registerChangeListeners();\r\n    this.attachStyles();\r\n    this.canvasUtils();\r\n    this.registerEvents();\r\n    this.setGenericInput();\r\n  }\r\n\r\n  /** Re-calculates cavnvas position/dimension when scrolling/resizing happens */\r\n  private registerChangeListeners() {\r\n    let throttle = false;\r\n    document.addEventListener('scroll', () => {\r\n      if (!throttle) {\r\n        window.requestAnimationFrame(() => {\r\n          this.calcCanvasDimension(false);\r\n          throttle = false;\r\n        });\r\n        throttle = true;\r\n      }\r\n    });\r\n    this.registerObservers(this.canvas.parentElement);\r\n  }\r\n  private registerObservers(parent: HTMLElement) {\r\n    this.parentResizeObserver && this.parentResizeObserver.disconnect();\r\n    this.bodyResizeObserver && this.bodyResizeObserver.disconnect();\r\n\r\n    this.parentResizeObserver = new ResizeObserver(() => {\r\n      this.calcCanvasDimension(true);\r\n      this.updateTransform(null, null, null);\r\n    });\r\n    this.parentResizeObserver.observe(parent);\r\n    if (parent !== document.body) {\r\n      this.bodyResizeObserver = new ResizeObserver(() => {\r\n        this.calcCanvasDimension(true);\r\n        this.updateTransform(null, null, null);\r\n      });\r\n      this.bodyResizeObserver.observe(document.body);\r\n    }\r\n  }\r\n  private prepareCanvas(mount?: HTMLCanvasElement | HTMLDivElement) {\r\n    if (!mount) {\r\n      this.canvas = document.createElement('canvas');\r\n      this.canvas.width = document.body.clientWidth;\r\n      this.canvas.height = document.body.clientHeight;\r\n      document.body.appendChild(this.canvas);\r\n    } else if (mount instanceof HTMLDivElement) {\r\n      this.canvas = document.createElement('canvas');\r\n      this.canvas.width = mount.clientWidth;\r\n      this.canvas.height = mount.clientHeight;\r\n      mount.appendChild(this.canvas);\r\n    } else if (mount instanceof HTMLCanvasElement) {\r\n      this.canvas = mount;\r\n    } else {\r\n      Log.error('mount provided is not of type HTMLDivElement or HTMLCanvasElement')\r\n    }\r\n\r\n    Object.assign(this.canvas.style, {\r\n      position: 'absolute',\r\n      width: '100%',\r\n      height: '100%'\r\n    })\r\n    this._context = this.canvas.getContext('2d');\r\n  }\r\n  /** Creates additional canvas's for rendering color hit-maps */\r\n  private setupHitCanvas() {\r\n    if (typeof OffscreenCanvas !== 'undefined' && typeof OffscreenCanvasRenderingContext2D !== 'undefined') {\r\n      this.offCanvas = new OffscreenCanvas(this.canvasDimensions.width, this.canvasDimensions.height);\r\n      this.offUICanvas = new OffscreenCanvas(this.canvasDimensions.width, this.canvasDimensions.height);\r\n      this.offGroupCanvas = new OffscreenCanvas(this.canvasDimensions.width, this.canvasDimensions.height);\r\n    } else {\r\n      this.offCanvas = document.createElement('canvas');\r\n      this.offUICanvas = document.createElement('canvas');\r\n      this.offGroupCanvas = document.createElement('canvas');\r\n    }\r\n    this._offContext = this.offCanvas.getContext('2d');\r\n    this._offUIContext = this.offUICanvas.getContext('2d');\r\n    this._offGroupContext = this.offGroupCanvas.getContext('2d');\r\n  }\r\n  private attachStyles() {\r\n    this.canvas.style.touchAction = 'none';\r\n\r\n    let inputStyle = document.createElement('style');\r\n    inputStyle.innerHTML = 'input.flow-connect-input { position: fixed; visibility: hidden; pointer-events: none; z-index: 100; border: none; border-radius: 0; box-sizing: border-box;} input.flow-connect-input:focus { outline: none; }';\r\n    document.getElementsByTagName('head')[0].appendChild(inputStyle);\r\n  }\r\n  private calcCanvasDimension(adjust: boolean) {\r\n    if (adjust && this.canvas.parentElement) {\r\n      let parentBoundingRect = this.canvas.parentElement.getBoundingClientRect();\r\n      this.canvas.width = parentBoundingRect.width;\r\n      this.canvas.height = parentBoundingRect.height;\r\n      this.call('dimension-change', this, this.canvas.width, this.canvas.height);\r\n    }\r\n\r\n    let boundingRect = this.canvas.getBoundingClientRect();\r\n    this.canvasDimensions = {\r\n      top: Math.round(boundingRect.top),\r\n      left: Math.round(boundingRect.left),\r\n      width: Math.round(boundingRect.width),\r\n      height: Math.round(boundingRect.height)\r\n    }\r\n\r\n    this.offCanvas.width = this.canvasDimensions.width;\r\n    this.offCanvas.height = this.canvasDimensions.height;\r\n    this.offUICanvas.width = this.canvasDimensions.width;\r\n    this.offUICanvas.height = this.canvasDimensions.height;\r\n    this.offGroupCanvas.width = this.canvasDimensions.width;\r\n    this.offGroupCanvas.height = this.canvasDimensions.height;\r\n  }\r\n  private canvasUtils() {\r\n    FlowConnect.prototype.canvasUtils = noop;\r\n    CanvasRenderingContext2D.prototype.roundRect = function (x: number, y: number, width: number, height: number, radius: number) {\r\n      this.beginPath();\r\n      this.moveTo(x + radius, y);\r\n      this.lineTo(x + width - radius, y);\r\n      this.quadraticCurveTo(x + width, y, x + width, y + radius);\r\n      this.lineTo(x + width, y + height - radius);\r\n      this.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\r\n      this.lineTo(x + radius, y + height);\r\n      this.quadraticCurveTo(x, y + height, x, y + height - radius);\r\n      this.lineTo(x, y + radius);\r\n      this.quadraticCurveTo(x, y, x + radius, y);\r\n      this.closePath();\r\n    }\r\n    CanvasRenderingContext2D.prototype.strokeRoundRect = function (x: number, y: number, width: number, height: number, radius: number) {\r\n      if (typeof radius === 'undefined') radius = 5;\r\n      this.roundRect(x, y, width, height, radius);\r\n      this.stroke();\r\n    }\r\n    CanvasRenderingContext2D.prototype.fillRoundRect = function (x: number, y: number, width: number, height: number, radius: number) {\r\n      if (typeof radius === 'undefined') radius = 5;\r\n      this.roundRect(x, y, width, height, radius);\r\n      this.fill();\r\n    }\r\n  }\r\n  private registerEvents(): void {\r\n    let dragDelta: Vector;\r\n    let prevPanPosition: Vector = Vector.Zero();\r\n    let prevPinchDistance: number = -1;\r\n\r\n    window.onkeydown = (ev: KeyboardEvent) => {\r\n      !this.keymap[ev.key] && (this.keymap[ev.key] = true);\r\n    }\r\n    window.onkeyup = (ev: KeyboardEvent) => {\r\n      this.keymap[ev.key] = false;\r\n    }\r\n\r\n    this.canvas.onpointerdown = (ev: PointerEvent) => {\r\n      if (!this.currFlow) return;\r\n\r\n      this.addPointer(ev.pointerId, this.getRelativePosition(ev));\r\n      if (this.pointers.length === 1) {\r\n        prevPanPosition = this.pointers[0].screenPosition;\r\n        this.currHitNode = this.getHitNode(this.pointers[0].screenPosition);\r\n        if (this.currHitNode) {\r\n          this.currHitNode.zIndex = Number.MAX_SAFE_INTEGER;\r\n          if (this.keymap['Control']) {\r\n            this.currHitNode.focused = !this.currHitNode.focused;\r\n          } else {\r\n            this.currFlow.removeAllFocus();\r\n            this.currHitNode.focused = true;\r\n          }\r\n          this.currHitNode.onDown(this.pointers[0].screenPosition.clone(), this.pointers[0].realPosition.clone());\r\n          dragDelta = this.currHitNode.position.subtract(this.pointers[0].realPosition);\r\n        } else {\r\n          if (!this.keymap['Control']) {\r\n            this.currFlow.removeAllFocus();\r\n\r\n            this.currHitGroup = this.getHitGroup(this.pointers[0].screenPosition);\r\n            this.currHitGroup && (dragDelta = this.currHitGroup.position.subtract(this.pointers[0].realPosition));\r\n          }\r\n          else if (this.keymap['Control'] || this.touchControls['CreateGroup']) {\r\n            this.groupStartPoint = this.pointers[0].realPosition.clone();\r\n            this.currGroup = new Group(this.currFlow, this.groupStartPoint.clone(), { name: 'New Group' });\r\n          }\r\n        }\r\n      } else {\r\n        this.currHitNode = null;\r\n        this.currHitGroup = null;\r\n        this.currFlow.removeAllFocus();\r\n        if (this.floatingConnector) {\r\n          this.floatingConnector.removeConnection();\r\n        }\r\n      }\r\n    }\r\n    this.canvas.onpointerup = (ev) => {\r\n      if (!this.currFlow) return;\r\n\r\n      this.removePointer(this.pointers, ev);\r\n\r\n      if (this.pointers.length < 2) prevPinchDistance = -1;\r\n\r\n      let screenPosition = this.getRelativePosition(ev);\r\n      let realPosition = screenPosition.transform(this.inverseTransform);\r\n\r\n      if (this.currHitNode) this.handleGrouping(screenPosition);\r\n\r\n      this.currHitNode = null;\r\n      this.currHitGroup = null;\r\n\r\n      let hitNode = this.getHitNode(screenPosition);\r\n      hitNode && hitNode.onUp(screenPosition.clone(), realPosition.clone());\r\n\r\n      if (this.currGroup) {\r\n        let newGroup = this.currGroup;\r\n        this.currGroup = null;\r\n        if (newGroup.width > 10 && newGroup.height > 10) {\r\n          this.currFlow.groups.push(newGroup);\r\n          newGroup.setContainedNodes();\r\n        }\r\n      }\r\n      if (this.floatingConnector) this.handleConnection(hitNode, screenPosition, realPosition);\r\n    }\r\n    this.canvas.onpointerout = (ev) => {\r\n      if (!this.currFlow) return;\r\n\r\n      this.removePointer(this.pointers, ev);\r\n      if (this.pointers.length === 0) {\r\n        if (this.currHitNode) {\r\n          let screenPosition = this.getRelativePosition(ev);\r\n          this.handleGrouping(screenPosition);\r\n        }\r\n        this.currHitNode = null;\r\n        this.currHitGroup = null;\r\n      }\r\n\r\n      if (this.currGroup) {\r\n        let newGroup = this.currGroup;\r\n        this.currGroup = null;\r\n        if (newGroup.width > 10 && newGroup.height > 10) {\r\n          this.currFlow.groups.push(newGroup);\r\n          newGroup.setContainedNodes();\r\n        }\r\n      }\r\n\r\n      if (this.floatingConnector) this.floatingConnector.removeConnection();\r\n\r\n      if (this.prevHitNode) {\r\n        let screenPosition = this.getRelativePosition(ev);\r\n        let realPosition = screenPosition.transform(this.inverseTransform);\r\n        this.prevHitNode.onExit(screenPosition, realPosition);\r\n        this.prevHitNode = null;\r\n      }\r\n    }\r\n    this.canvas.onpointermove = (ev) => {\r\n      if (!this.currFlow) return;\r\n\r\n      let screenPosition = this.getRelativePosition(ev);\r\n      let realPosition = screenPosition.transform(this.inverseTransform);\r\n\r\n      this.updatePointer(ev.pointerId, screenPosition, realPosition);\r\n\r\n      if (this.pointers.length === 2) {\r\n        let currPinchDistance = Vector.Distance(this.pointers[0].screenPosition, this.pointers[1].screenPosition);\r\n        if (prevPinchDistance > 0) {\r\n          if (currPinchDistance !== prevPinchDistance) {\r\n            this.handleZoom(currPinchDistance > prevPinchDistance, Vector.Midpoint(this.pointers[0].screenPosition, this.pointers[1].screenPosition), this.pinchScaleDelta);\r\n          }\r\n        }\r\n        prevPinchDistance = currPinchDistance;\r\n      }\r\n\r\n      if (this.currGroup) {\r\n        if (realPosition.x < this.groupStartPoint.x) this.currGroup.position.x = realPosition.x;\r\n        this.currGroup.width = Math.abs(this.groupStartPoint.x - realPosition.x);\r\n\r\n        if (realPosition.y < this.groupStartPoint.y) this.currGroup.position.y = realPosition.y;\r\n        this.currGroup.height = Math.abs(this.groupStartPoint.y - realPosition.y);\r\n      }\r\n\r\n      if (this.currHitNode) {\r\n        // If dragging UINode outside its bounds, Node can pre-empt currHitNode\r\n        this.currHitNode.onDrag(screenPosition.clone(), realPosition.clone());\r\n        if (this.currHitNode) {\r\n          if ((!this.currHitNode.currHitUINode || !this.currHitNode.currHitUINode.draggable) && !this.currHitNode.currHitTerminal && !this.floatingConnector) {\r\n            this.currHitNode.position = realPosition.add(dragDelta);\r\n\r\n            let hitGroup = this.getHitGroup(screenPosition);\r\n            if (hitGroup && hitGroup === this.currHitNode.group) {\r\n              let groupRealPos = hitGroup.position.transform(this._transform);\r\n              let nodeRealPos = this.currHitNode.position.transform(this._transform);\r\n\r\n              let intersection = intersects(groupRealPos.x, groupRealPos.y,\r\n                groupRealPos.x + hitGroup.width * this.scale,\r\n                groupRealPos.y + hitGroup.height * this.scale,\r\n                nodeRealPos.x, nodeRealPos.y,\r\n                nodeRealPos.x + this.currHitNode.width * this.scale,\r\n                nodeRealPos.y + this.currHitNode.ui.height * this.scale\r\n              );\r\n\r\n              if (intersection === ViewPort.INSIDE) {\r\n                let nodeIndex = hitGroup.nodes.findIndex(node => node.id === this.currHitNode.id);\r\n                hitGroup.nodeDeltas[nodeIndex] = this.currHitNode.position.subtract(hitGroup.position);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      } else {\r\n        if (this.currHitGroup) {\r\n          this.currHitGroup.position = realPosition.add(dragDelta);\r\n        } else if (this.pointers.length === 1 && !this.keymap['Control'] && !this.touchControls['CreateGroup']) {\r\n          let delta = screenPosition.subtract(prevPanPosition).multiplyInPlace(1 / this.scale);\r\n          prevPanPosition = screenPosition;\r\n          this.updateTransform(null, null, delta);\r\n        }\r\n      }\r\n      if (this.floatingConnector) this.floatingConnector.floatingTip = realPosition;\r\n\r\n      if (ev.pointerType === 'mouse' && !this.currHitNode) {\r\n        let hitNode = this.getHitNode(screenPosition);\r\n        if (hitNode !== this.prevHitNode) {\r\n          this.prevHitNode && this.prevHitNode.onExit(screenPosition, realPosition);\r\n          hitNode && hitNode.onEnter(screenPosition, realPosition);\r\n        } else {\r\n          hitNode && (!this.currHitNode) && hitNode.onOver(screenPosition, realPosition);\r\n        }\r\n        this.prevHitNode = hitNode;\r\n      }\r\n    }\r\n    this.canvas.onclick = (ev) => {\r\n      if (!this.currFlow) return;\r\n\r\n      let screenPosition = this.getRelativePosition(ev);\r\n      let realPosition = screenPosition.transform(this.inverseTransform);\r\n      let hitNode = this.getHitNode(screenPosition);\r\n      hitNode && hitNode.onClick(screenPosition.clone(), realPosition.clone());\r\n\r\n      if (!hitNode) {\r\n        let hitGroup = this.getHitGroup(screenPosition);\r\n        hitGroup && hitGroup.onClick(screenPosition.clone(), realPosition.clone());\r\n      }\r\n    };\r\n    this.canvas.oncontextmenu = (ev) => {\r\n      if (!this.currFlow) return;\r\n\r\n      ev.preventDefault();\r\n\r\n      let screenPosition = this.getRelativePosition(ev);\r\n      let hitNode = this.getHitNode(screenPosition);\r\n      hitNode && hitNode.onContextMenu();\r\n      if (!this.keymap['Control']) this.currFlow.removeAllFocus();\r\n      hitNode && (hitNode.focused = true);\r\n    }\r\n    this.canvas.onwheel = (ev: WheelEvent) => {\r\n      if (!this.currFlow) return;\r\n\r\n      let screenPosition = this.getRelativePosition(ev);\r\n      let hitNode = this.getHitNode(screenPosition);\r\n      if (hitNode) {\r\n        let hitColor = Color.rgbaToString(this.offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data);\r\n        let hitUINode = hitNode.getHitUINode(hitColor);\r\n\r\n        // Need to add touch compability for pinch on UINodes\r\n        if (hitUINode && hitUINode.zoomable) {\r\n          hitNode.onWheel(ev.deltaY < 0, screenPosition, screenPosition.transform(this.inverseTransform));\r\n          return;\r\n        }\r\n      }\r\n\r\n      if (!this.disableScale) {\r\n        ev.preventDefault();\r\n        this.handleZoom(ev.deltaY < 0, screenPosition, this.wheelScaleDelta);\r\n      }\r\n    }\r\n  }\r\n  private setGenericInput() {\r\n    this.genericInput.className = 'flow-connect-input';\r\n    this.genericInput.style.visibility = 'hidden';\r\n    this.genericInput.style.pointerEvents = 'none';\r\n    this.genericInput.style.padding = '0';\r\n\r\n    this.genericInput.onblur = () => {\r\n      this.genericInput.style.visibility = 'hidden';\r\n      this.genericInput.style.pointerEvents = 'none';\r\n\r\n      this.genericInput.onchange = null;\r\n    }\r\n\r\n    document.body.appendChild(this.genericInput);\r\n  }\r\n  async setupAudioContext() {\r\n    if ((window as any).__FLOWCONNECT_AUDIO_CTX__) {\r\n      this._audioContext = (window as any).__FLOWCONNECT_AUDIO_CTX__;\r\n    } else {\r\n      this._audioContext = new AudioContext();\r\n      (window as any).__FLOWCONNECT_AUDIO_CTX__ = this._audioContext;\r\n    }\r\n\r\n    // This one-time setup is not at all related to FlowConnect, couldn't find any place to do this\r\n    // Might be a better idea to do this somewhere in StandardNodes.Audio package\r\n\r\n    let audioWorklets = generateAudioWorklets(WorkletUtils.CircularBuffer);\r\n    await this.audioContext.audioWorklet.addModule(WorkletUtils.CircularBuffer);\r\n    return Promise.all(Object.keys(audioWorklets).map(key => this.audioContext.audioWorklet.addModule(audioWorklets[key])));\r\n  }\r\n\r\n  showGenericInput(position: Vector | DOMPoint, value: string, styles: Record<string, any>, attributes: Record<string, any>, callback: (value: string) => void) {\r\n    if (document.activeElement === this.genericInput) return;\r\n\r\n    Object.assign(this.genericInput.style, styles);\r\n    Object.assign(this.genericInput, attributes);\r\n\r\n    Object.assign(this.genericInput.style, {\r\n      left: (position.x + this.canvasDimensions.left) + 'px',\r\n      top: (position.y + this.canvasDimensions.top - 3) + 'px',\r\n      visibility: 'visible',\r\n      pointerEvents: 'all'\r\n    });\r\n    this.genericInput.value = value;\r\n    this.genericInput.onchange = () => callback(this.genericInput.value);\r\n    this.genericInput.focus();\r\n  }\r\n  changeParent(newParent: HTMLElement) {\r\n    this.registerObservers(newParent);\r\n  }\r\n  private updatePointer(id: number, screenPosition: Vector, realPosition: Vector) {\r\n    let pointer = this.pointers.find(pntr => pntr.id === id);\r\n    if (pointer) {\r\n      pointer.screenPosition = screenPosition;\r\n      pointer.realPosition = realPosition;\r\n    }\r\n  }\r\n  private handleZoom(zoomIn: boolean, origin: Vector, scaleDelta: number) {\r\n    if ((this._transform.a >= this.maxScale && zoomIn) || (this._transform.a <= this.minScale && !zoomIn)) return;\r\n    this.updateTransform(zoomIn ? scaleDelta : (1 / scaleDelta), origin, null);\r\n    this.call('scale', this.scale);\r\n  }\r\n  private handleGrouping(screenPosition: Vector) {\r\n    let hitGroup = this.getHitGroup(screenPosition);\r\n\r\n    let intersection;\r\n    if (hitGroup) {\r\n      let groupRealPos = hitGroup.position.transform(this._transform);\r\n      let nodeRealPos = this.currHitNode.position.transform(this._transform);\r\n\r\n      intersection = intersects(groupRealPos.x, groupRealPos.y,\r\n        groupRealPos.x + hitGroup.width * this.scale,\r\n        groupRealPos.y + hitGroup.height * this.scale,\r\n        nodeRealPos.x, nodeRealPos.y,\r\n        nodeRealPos.x + this.currHitNode.width * this.scale,\r\n        nodeRealPos.y + this.currHitNode.ui.height * this.scale\r\n      );\r\n    }\r\n\r\n    if (this.currHitNode.group) {\r\n      if (this.currHitNode.group !== hitGroup) {\r\n        let nodeIndex = this.currHitNode.group.nodes.findIndex(node => node.id === this.currHitNode.id);\r\n        this.currHitNode.group.nodes.splice(nodeIndex, 1);\r\n        this.currHitNode.group.nodeDeltas.splice(nodeIndex, 1);\r\n        this.currHitNode.group = null;\r\n      } else {\r\n        if (intersection !== ViewPort.INSIDE) {\r\n          let nodeIndex = this.currHitNode.group.nodes.findIndex(node => node.id === this.currHitNode.id);\r\n          this.currHitNode.group.nodes.splice(nodeIndex, 1);\r\n          this.currHitNode.group.nodeDeltas.splice(nodeIndex, 1);\r\n          this.currHitNode.group = null;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (hitGroup) {\r\n      if (intersection === ViewPort.INSIDE) {\r\n        this.currHitNode.group = hitGroup;\r\n        hitGroup.nodes.push(this.currHitNode);\r\n        hitGroup.nodeDeltas.push(this.currHitNode.position.subtract(hitGroup.position));\r\n      }\r\n    }\r\n  }\r\n  private handleConnection(hitNode: Node, screenPosition: Vector, realPosition: Vector) {\r\n    if (!hitNode) {\r\n      this.floatingConnector.removeConnection();\r\n      return;\r\n    }\r\n    let hitTerminal = hitNode.getHitTerminal(\r\n      Color.rgbaToString(this._offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data),\r\n      screenPosition.clone(),\r\n      realPosition.clone()\r\n    );\r\n    if (hitTerminal) hitNode.currHitTerminal = hitTerminal;\r\n    if (!hitTerminal) {\r\n      this.floatingConnector.removeConnection();\r\n      return;\r\n    }\r\n\r\n    let destination = hitNode.currHitTerminal;\r\n    if (!this.floatingConnector.canConnect(destination)) {\r\n      this.floatingConnector.removeConnection();\r\n      hitNode.currHitTerminal = null;\r\n    } else {\r\n      if (destination.type === TerminalType.OUT) {\r\n        this.floatingConnector.completeConnection(destination);\r\n        hitNode.currHitTerminal = null;\r\n      } else {\r\n        if (destination.connectors.length > 0) {\r\n          if (destination.connectors[0].start === this.floatingConnector.start) {\r\n            this.floatingConnector.removeConnection();\r\n            hitNode.currHitTerminal = null;\r\n            return;\r\n          }\r\n          let index = destination.connectors[0].start.connectors.indexOf(destination.connectors[0]);\r\n          let [oldConnector] = destination.connectors[0].start.connectors.splice(index, 1);\r\n          let [startTerm, endTerm] = [oldConnector.start, oldConnector.end];\r\n          this.currFlow.connectors.delete(oldConnector.id);\r\n          this.currFlow.executionGraph.disconnect(startTerm.node, endTerm.node);\r\n          oldConnector.start.onDisconnect(oldConnector, startTerm, endTerm);\r\n          oldConnector.end.onDisconnect(oldConnector, startTerm, endTerm);\r\n\r\n          this.floatingConnector.completeConnection(destination);\r\n          hitNode.currHitTerminal = null;\r\n        } else {\r\n          this.floatingConnector.completeConnection(destination);\r\n          hitNode.currHitTerminal = null;\r\n        }\r\n      }\r\n      this.floatingConnector = null;\r\n    }\r\n  }\r\n  private getRelativePosition(ev: PointerEvent | WheelEvent | MouseEvent) {\r\n    return new Vector(ev.clientX - this.canvasDimensions.left, ev.clientY - this.canvasDimensions.top);\r\n  }\r\n  private updateTransform(scale?: number, scaleOrigin?: Vector, translate?: Vector) {\r\n    if (scale) {\r\n      let realSpaceOrigin = scaleOrigin.transform(this.inverseTransform);\r\n      this._transform\r\n        .translateSelf(realSpaceOrigin.x, realSpaceOrigin.y)\r\n        .scaleSelf(scale, scale)\r\n        .translateSelf(-realSpaceOrigin.x, -realSpaceOrigin.y);\r\n    }\r\n    if (translate) {\r\n      this._transform.translateSelf(translate.x, translate.y);\r\n    }\r\n\r\n    this.inverseTransform = this._transform.inverse();\r\n\r\n    this._context.setTransform(this._transform);\r\n    this._offContext.setTransform(this._transform);\r\n    this._offUIContext.setTransform(this._transform);\r\n    this._offGroupContext.setTransform(this._transform);\r\n\r\n    this.call('transform', this);\r\n  }\r\n  translateBy(delta: Vector) {\r\n    this.updateTransform(null, null, delta);\r\n  }\r\n  scaleBy(scale: number, scaleOrigin: Vector) {\r\n    this.updateTransform(scale, scaleOrigin);\r\n  }\r\n  private addPointer(pointerId: number, position: Vector) {\r\n    this.pointers.push({\r\n      id: pointerId,\r\n      screenPosition: position,\r\n      realPosition: position.transform(this.inverseTransform)\r\n    });\r\n  }\r\n  private removePointer(pointers: Pointer[], ev: PointerEvent) {\r\n    pointers.splice(pointers.findIndex(pointer => pointer.id === ev.pointerId), 1);\r\n  }\r\n  private getHitNode(position: Vector): Node {\r\n    let rgbaString = Color.rgbaToString(this._offContext.getImageData(position.x, position.y, 1, 1).data);\r\n    return this.currFlow.nodeHitColors.get(rgbaString);\r\n  }\r\n  private getHitGroup(position: Vector): Group {\r\n    let rgbaString = Color.rgbaToString(this._offGroupContext.getImageData(position.x, position.y, 1, 1).data);\r\n    return this.currFlow.groupHitColors.get(rgbaString);\r\n  }\r\n  private clear() {\r\n    this._context.save();\r\n    this._context.setTransform(this.identity);\r\n    this._context.clearRect(0, 0, this.canvasDimensions.width, this.canvasDimensions.height);\r\n    this._context.restore();\r\n\r\n    this._offContext.save();\r\n    this._offContext.setTransform(this.identity);\r\n    this._offContext.clearRect(0, 0, this.canvasDimensions.width, this.canvasDimensions.height);\r\n    this._offContext.restore();\r\n\r\n    this._offUIContext.save();\r\n    this._offUIContext.setTransform(this.identity);\r\n    this._offUIContext.clearRect(0, 0, this.canvasDimensions.width, this.canvasDimensions.height);\r\n    this._offUIContext.restore();\r\n\r\n    this._offGroupContext.save();\r\n    this._offGroupContext.setTransform(this.identity);\r\n    this._offGroupContext.clearRect(0, 0, this.canvasDimensions.width, this.canvasDimensions.height);\r\n    this._offGroupContext.restore();\r\n  }\r\n\r\n  startGlobalTime() {\r\n    if (this.startTime < 0) {\r\n      this.startTime = performance.now();\r\n      this._startGlobalTime();\r\n      this.state = FlowConnectState.Running;\r\n      this.call('start', this);\r\n    }\r\n  }\r\n  private _startGlobalTime() {\r\n    this.call('tick', this);\r\n    this.timerId = window.requestAnimationFrame(this._startGlobalTime.bind(this));\r\n  }\r\n\r\n  stopGlobalTime() {\r\n    if (this.isRootFlowStopped()) {\r\n      cancelAnimationFrame(this.timerId);\r\n      this.startTime = -1;\r\n      this.state = FlowConnectState.Stopped;\r\n      this.call('tickreset', this);\r\n      this.call('stop', this);\r\n    }\r\n  }\r\n  private isRootFlowStopped(): boolean {\r\n    let root = this.currFlow;\r\n    while (true) {\r\n      if (root.parentFlow) root = root.parentFlow;\r\n      else return root.state === FlowState.Stopped;\r\n    }\r\n  }\r\n  private _render() {\r\n    this.clear();\r\n\r\n    this.currGroup && this.currGroup.render();\r\n    this.currFlow.render();\r\n    this.call('render', this);\r\n\r\n    this.frameId = window.requestAnimationFrame(this._render.bind(this));\r\n  }\r\n\r\n  createFlow(options: FlowOptions = { name: 'New Flow', rules: {}, terminalColors: {} }): Flow {\r\n    if (!options.rules) options.rules = {};\r\n    if (!options.terminalColors) options.terminalColors = {};\r\n\r\n    options.rules = { ...options.rules, ...DefaultRules() };\r\n    let flow = new Flow(this, options.name, options.rules, options.terminalColors);\r\n    this.flows.push(flow);\r\n\r\n    flow.on('start', () => this.startGlobalTime());\r\n    flow.on('stop', () => this.stopGlobalTime());\r\n\r\n    return flow;\r\n  }\r\n  render(flow: Flow) {\r\n    if (flow === this.currFlow) return;\r\n    if (this.currFlow) {\r\n      window.cancelAnimationFrame(this.frameId);\r\n      this.currFlow.deregisterListeners();\r\n    }\r\n    if (!this.rootFlow || !this.rootFlow.existsInFlow(flow)) {\r\n      this.rootFlow = flow;\r\n    }\r\n    this.currFlow = flow;\r\n    this._render();\r\n  }\r\n  /** Render the root flow of the flow-tree */\r\n  top() {\r\n    this.render(this.rootFlow);\r\n  }\r\n  /** Creates a flow from json\r\n   * @param json Json string with schema SerializedFlow\r\n   */\r\n  fromJson(json: string): Flow {\r\n    let data: SerializedFlow;\r\n    let flow: Flow = null;\r\n\r\n    try {\r\n      data = JSON.parse(json);\r\n      flow = Flow.deSerialize(this, data);\r\n    } catch (error) {\r\n      Log.error(error);\r\n    }\r\n    return flow;\r\n  }\r\n  toJson(flow: Flow): string {\r\n    let serializedFlow: SerializedFlow = flow.serialize();\r\n    try {\r\n      return JSON.stringify(serializedFlow, null);\r\n    } catch (error) {\r\n      Log.error(error);\r\n    }\r\n  }\r\n}\r\n\r\nexport enum FlowConnectState {\r\n  Stopped = 'Stopped',\r\n  Running = 'Running'\r\n}\r\n\r\n/** Default rules every Flow will have, for e.g. a string output can only be connected to string inputs.\r\n   *  ```javascript\r\n   *  {\r\n   *    'string': ['string'],\r\n   *    'number': ['number'],\r\n   *    'boolean': ['boolean'],\r\n   *    'file': ['file'],\r\n   *    'event': ['event'], ...\r\n   *  }\r\n   *  ```\r\n   */\r\nlet DefaultRules: () => Rules = () => ({\r\n  'string': ['string', 'any'],\r\n  'number': ['number', 'audioparam', 'any'],\r\n  'boolean': ['boolean', 'any'],\r\n  'array': ['array', 'any'],\r\n  'file': ['file', 'any'],\r\n  'event': ['event', 'any'],\r\n  'vector': ['vector', 'any'],\r\n  'array-buffer': ['array-buffer', 'any'],\r\n  'audio': ['audio', 'audioparam'],\r\n  'audioparam': ['audioparam'],\r\n  'audio-buffer': ['audio-buffer', 'any'],\r\n  'any': ['any']\r\n});\r\n\r\nexport * from './common/index';\r\nexport * from './core/index';\r\nexport { Constant } from './resource/constants';\r\nexport * from './ui/index';\r\nexport * from './utils/index';\r\n","export const WorkletUtils = {\n  CircularBuffer: URL.createObjectURL(new Blob([\n    `export default class CircularBuffer {\n      constructor(bufferLength, noOfChannels) {\n        this.noOfChannels = noOfChannels;\n        this.bufferLength = bufferLength;\n\n        this.read = this.write = this.frames = 0;\n        this.channels = [];\n        for (let i = 0; i < this.noOfChannels; ++i) this.channels[i] = new Float32Array(bufferLength);\n      }\n      pushBlock(buffer) {\n        let sourceLength = buffer[0].length;\n        for (let i = 0; i < sourceLength; ++i) {\n          let write = (this.write + i) % this.bufferLength;\n          for (let c = 0; c < this.noOfChannels; ++c) {\n            this.channels[c][write] = buffer[c][i];\n          }\n        }\n        this.write += sourceLength;\n        if (this.write >= this.bufferLength) this.write = 0;\n        this.frames += sourceLength;\n        if (this.frames > this.bufferLength) this.frames = this.bufferLength;\n      }\n      popBlock(buffer) {\n        if (this.frames === 0) return;\n        let destinationLength = buffer[0].length;\n        for (let i = 0; i < destinationLength; ++i) {\n          let read = (this.read + i) % this.bufferLength;\n          for (let c = 0; c < this.noOfChannels; ++c) {\n            buffer[c][i] = this.channels[c][read];\n          }\n        }\n        this.read += destinationLength;\n        if (this.read >= this.bufferLength) this.read = 0;\n        this.frames -= destinationLength;\n        if (this.frames < 0) this.frames = 0;\n      }\n    }`\n  ], { type: 'application/javascript' })),\n}\nexport const generateAudioWorklets = (utilsFileName: string) => {\n  let audioWorklets: Record<string, string> = {\n    // Creates a AudioWorkletProcessor to setup custom AudioParams for AudioBufferSourceNode's automation (because of their fire-forget-destroy behaviour)\n    Worklet_ProxyParamForSource: URL.createObjectURL(new Blob([\n      `registerProcessor('proxy-param-for-source', class ProxyParamForSource extends AudioWorkletProcessor {\n          static get parameterDescriptors() {\n            return [{\n              name: 'detune',\n              defaultValue: 0,\n              minValue: -2400,\n              maxValue: 2400,\n              automationRate: 'k-rate'\n            }, {\n              name: 'playbackRate',\n              defaultValue: 1,\n              minValue: 0.25,\n              maxValue: 3,\n              automationRate: 'k-rate'\n            }]\n          }\n          process(inputs, outputs, parameters) {\n            outputs[0].forEach(channel => {\n              for (let i = 0; i < channel.length; i++) {\n                // wierd bug, the detune is off by 1200 cents, have to offset this anomaly\n                channel[i] = (parameters['detune'].length > 1 ? parameters['detune'][i] : parameters['detune'][0]) - 1200;\n              }\n            });\n            outputs[1].forEach(channel => {\n              for (let i = 0; i < channel.length; i++) {\n                channel[i] = (parameters['playbackRate'].length > 1 ? parameters['playbackRate'][i] : parameters['playbackRate'][0]);\n              }\n            });\n            return true;\n          }\n        })`\n    ], { type: 'application/javascript' })),\n\n    // Same as above, but not specifically for AudioBufferSourceNodes, this is more general purpose\n    Worklet_ProxyParam: URL.createObjectURL(new Blob([\n      `registerProcessor('proxy-param', class ProxyParam extends AudioWorkletProcessor {\n          static get parameterDescriptors() {\n            return [{\n              name: 'param',\n              defaultValue: 0,\n              minValue: -340282346638528859811704183484516925439,\n              maxValue: 340282346638528859811704183484516925439,\n              automationRate: 'k-rate'\n            }]\n          }\n\n          min = -340282346638528859811704183484516925439;\n          max =  340282346638528859811704183484516925439;\n          offset = 0;\n          constructor(...args) {\n            super(...args);\n            this.port.onmessage = (e) => {\n              switch(e.data.type) {\n                case 'set-range': {\n                  this.min = e.data.value.min;\n                  this.max = e.data.value.max;\n                  break;\n                }\n                case 'set-offset': {\n                  this.offset = -e.data.value\n                  break;\n                }\n                default: break;\n              }\n            }\n          }\n          clamp(value) { return Math.min(Math.max(value, this.min), this.max); }\n          process(inputs, outputs, parameters) {\n            outputs[0].forEach(channel => {\n              for (let i = 0; i < channel.length; i++) {\n                channel[i] = this.clamp((parameters['param'].length > 1 ? parameters['param'][i] : parameters['param'][0]) + this.offset);\n              }\n            });\n            return true;\n          }\n        })`\n    ], { type: 'application/javascript' })),\n\n    // This one is used to only peak at the audio data flowing through this node, mainly for debugging purposes\n    Worklet_Debug: URL.createObjectURL(new Blob([\n      `registerProcessor('debug', class Debug extends AudioWorkletProcessor {\n          throttle = 1000;\n          lastPeak = -Infinity;\n          constructor(...args) {\n            super(...args);\n            this.port.onmessage = (e) => {\n              this.throttle = e.data;\n            }\n          }\n          process(inputs, outputs, parameters) {\n            if (Date.now() - this.lastPeak > this.throttle) {\n              let data = {\n                inputs: inputs.map(input => input.length),\n                outputs: outputs.map(output => output.length)\n              };\n              this.port.postMessage(data);\n              this.lastPeak = Date.now();\n            }\n            let input = inputs[0];\n            let output = outputs[0]\n            for (let i = 0 ; i < input.length ; i+=1) {\n              for(let c = 0 ; c < input[i].length ; c+=1) {\n                output[i][c] = input[i][c];\n              }\n            }\n            return true;\n          }\n        })`\n    ], { type: 'application/javascript' })),\n\n    Worklet_MoogEffect: URL.createObjectURL(new Blob([\n      `import CircularBuffer from '${utilsFileName}'\n      registerProcessor('moog-effect', class MoogEffect extends AudioWorkletProcessor {\n      cutoff = 0.065;\n      resonance = 3.5;\n      f = 0; inputFactor = 0; fb = 0;\n\n      constructor(options) {\n        super();\n        this.bufferSize = options.processorOptions.bufferSize;\n\n        this.setParams();\n        this.port.onmessage = (e) => {\n          this.cutoff = e.data.cutoff;\n          this.resonance = e.data.resonance;\n          this.setParams();\n        }\n      }\n      setParams() {\n        this.f = this.cutoff * 1.16;\n        this.inputFactor = 0.35013 * (this.f * this.f) * (this.f * this.f);\n        this.fb = this.resonance * (1.0 - 0.15 * this.f * this.f);\n      }\n      channelsChanged(newNoOfChannels) {\n        this.channelCount = newNoOfChannels;\n        this.inputBuffer = new CircularBuffer(this.bufferSize, this.channelCount);\n        this.outputBuffer = new CircularBuffer(this.bufferSize, this.channelCount);\n        this.in1 = new Array(this.channelCount).fill(0);\n        this.in2 = new Array(this.channelCount).fill(0);\n        this.in3 = new Array(this.channelCount).fill(0);\n        this.in4 = new Array(this.channelCount).fill(0);\n        this.out1 = new Array(this.channelCount).fill(0);\n        this.out2 = new Array(this.channelCount).fill(0);\n        this.out3 = new Array(this.channelCount).fill(0);\n        this.out4 = new Array(this.channelCount).fill(0);\n      }\n\n      _process(input, output) {\n        for (let c = 0; c < input.length; ++c) {\n          for (let i = 0; i < input[c].length; ++i) {\n            input[c][i] -= this.out4[c] * this.fb;\n            input[c][i] *= this.inputFactor;\n            this.out1[c] = input[c][i] + 0.3 * this.in1[c] + (1 - this.f) * this.out1[c];\n            this.in1[c] = input[c][i];\n            this.out2[c] = this.out1[c] + 0.3 * this.in2[c] + (1 - this.f) * this.out2[c];\n            this.in2[c] = this.out1[c];\n            this.out3[c] = this.out2[c] + 0.3 * this.in3[c] + (1 - this.f) * this.out3[c];\n            this.in3[c] = this.out2[c];\n            this.out4[c] = this.out3[c] + 0.3 * this.in4[c] + (1 - this.f) * this.out4[c];\n            this.in4[c] = this.out3[c];\n            output[c][i] = this.out4[c];\n          }\n        }\n      }\n      process(inputs, outputs, parameters) {\n        let input = inputs[0], output = outputs[0];\n        if (input.length === 0) return true;\n\n        if (!this.prevChannelCount || this.prevChannelCount !== inputs[0].length) {\n          this.channelsChanged(inputs[0].length);\n          this.prevChannelCount = inputs[0].length;\n        }\n\n        this.inputBuffer.pushBlock(input);\n        if (this.inputBuffer.frames >= this.bufferSize) {\n          let tmpInBuffer = [], tmpOutBuffer = [];\n          for (let i = 0; i < this.channelCount; ++i) {\n            tmpInBuffer[i] = new Float32Array(this.bufferSize);\n            tmpOutBuffer[i] = new Float32Array(this.bufferSize);\n          }\n\n          this.inputBuffer.popBlock(tmpInBuffer);\n          this._process(tmpInBuffer, tmpOutBuffer);\n          this.outputBuffer.pushBlock(tmpOutBuffer);\n        }\n        this.outputBuffer.popBlock(output);\n        return true;\n      }\n    })`\n    ], { type: 'application/javascript' })),\n\n    Worklet_BitcrusherEffect: URL.createObjectURL(new Blob([\n      `import CircularBuffer from '${utilsFileName}'\n      registerProcessor('bitcrusher-effect', class BitcrusherEffect extends AudioWorkletProcessor {\n      bits = 4;\n      normFreq = 0.1;\n      step = 0;\n\n      constructor(options) {\n        super();\n        this.bufferSize = options.processorOptions.bufferSize;\n\n        this.setParams();\n        this.port.onmessage = (e) => {\n          this.bits = e.data.bits;\n          this.normFreq = e.data.normFreq;\n          this.setParams();\n        }\n      }\n      setParams() {\n        this.step = Math.pow(1 / 2, this.bits);\n      }\n      channelsChanged(newNoOfChannels) {\n        this.channelCount = newNoOfChannels;\n        this.inputBuffer = new CircularBuffer(this.bufferSize, this.channelCount);\n        this.outputBuffer = new CircularBuffer(this.bufferSize, this.channelCount);\n        this.phaser = new Array(this.channelCount).fill(0);\n        this.last = new Array(this.channelCount).fill(0);\n      }\n\n      _process(input, output) {\n        for (let c = 0; c < input.length; ++c) {\n          for (let i = 0; i < input[c].length; ++i) {\n            this.phaser[c] += this.normFreq;\n            if (this.phaser[c] >= 1.0) {\n              this.phaser[c] -= 1.0;\n              this.last[c] = this.step * Math.floor(input[c][i] / this.step + 0.5);\n            }\n            output[c][i] = this.last[c];\n          }\n        }\n      }\n      process(inputs, outputs, parameters) {\n        let input = inputs[0], output = outputs[0];\n        if (input.length === 0) return true;\n        if (!this.prevChannelCount || this.prevChannelCount !== inputs[0].length) {\n          this.channelsChanged(inputs[0].length);\n          this.prevChannelCount = inputs[0].length;\n        }\n        this.inputBuffer.pushBlock(input);\n        if (this.inputBuffer.frames >= this.bufferSize) {\n          let tmpInBuffer = [], tmpOutBuffer = [];\n          for (let i = 0; i < this.channelCount; ++i) {\n            tmpInBuffer[i] = new Float32Array(this.bufferSize);\n            tmpOutBuffer[i] = new Float32Array(this.bufferSize);\n          }\n          this.inputBuffer.popBlock(tmpInBuffer);\n          this._process(tmpInBuffer, tmpOutBuffer);\n          this.outputBuffer.pushBlock(tmpOutBuffer);\n        }\n        this.outputBuffer.popBlock(output);\n        return true;\n      }\n    })`\n    ], { type: 'application/javascript' })),\n\n    Worklet_LFO: URL.createObjectURL(new Blob([\n      `registerProcessor('lfo', class LFO extends AudioWorkletProcessor {\n      oscillation = 0.3;\n      offset = 0.85;\n      phaseInc = 0;\n      phase = 0;\n\n      constructor(options) {\n        super();\n        this.sampleRate = options.processorOptions.sampleRate;\n\n        this.port.onmessage = (e) => {\n          switch(e.data.type) {\n            case 'set-oscillation': { this.oscillation = e.data.value; break; }\n            case 'set-offset': { this.offset = e.data.value; break; }\n            case 'set-phase': { this.phase = e.data.value; break; }\n            case 'set-frequency': { this.phaseInc = 2 * Math.PI * e.data.value * 128 / this.sampleRate; break; }\n            case 'set-all': {\n              this.oscillation = e.data.value.oscillation;\n              this.offset = e.data.value.offset;\n              this.phase = e.data.value.phase;\n              this.phaseInc = 2 * Math.PI * e.data.value.frequency * 128 / this.sampleRate;\n              break;\n            }\n            default: return;\n          }\n        }\n      }\n      process(inputs, outputs, parameters) {\n        let output = outputs[0][0];\n\n        for (let i = 0; i < output.length; ++i) {\n          this.phase += this.phaseInc;\n          if (this.phase > 2 * Math.PI) this.phase = 0;\n          output[i] = this.offset + this.oscillation * Math.sin(this.phase);\n        }\n\n        return true;\n      }\n    })`\n    ], { type: 'application/javascript' })),\n\n    Worklet_Noise: URL.createObjectURL(new Blob([\n      `registerProcessor('noise', class Noise extends AudioWorkletProcessor {\n      type = 'white';\n      types = ['white', 'pink', 'brownian'];\n\n      constructor(options) {\n        super();\n        this.port.onmessage = (e) => {\n          if (!this.types.includes(e.data)) this.type = 'white';\n          else this.type = e.data;\n        }\n\n        this.generate = {\n          'white': (output) => {\n            for (let i = 0; i < output.length; ++i) output[i] = Math.random() * 2 - 1;\n          },\n          'pink': (output) => {\n            let b0, b1, b2, b3, b4, b5, b6;\n            b0 = b1 = b2 = b3 = b4 = b5 = b6 = 0.0;\n\n            for (let i = 0; i < output.length; ++i) {\n              let white = Math.random() * 2 - 1;\n              b0 = 0.99886 * b0 + white * 0.0555179;\n              b1 = 0.99332 * b1 + white * 0.0750759;\n              b2 = 0.96900 * b2 + white * 0.1538520;\n              b3 = 0.86650 * b3 + white * 0.3104856;\n              b4 = 0.55000 * b4 + white * 0.5329522;\n              b5 = -0.7616 * b5 - white * 0.0168980;\n              output[i] = b0 + b1 + b2 + b3 + b4 + b5 + b6 + white * 0.5362;\n              output[i] *= 0.11;\n              b6 = white * 0.115926;\n            }\n          },\n          'brownian': (output) => {\n            let lastOut = 0.0;\n            for (let i = 0; i < output.length; i++) {\n              let white = Math.random() * 2 - 1;\n              output[i] = (lastOut + (0.02 * white)) / 1.02;\n              lastOut = output[i];\n              output[i] *= 3.5;\n            }\n          }\n        }\n      }\n      process(inputs, outputs, parameters) {\n        this.generate[this.type](outputs[0][0]);\n        return true;\n      }\n    })`\n    ], { type: 'application/javascript' })),\n\n    // Just a normal proxy, outputs the inputs as it is, used for seamless connections of SourceNodes\n    Worklet_Proxy: URL.createObjectURL(new Blob([\n      `registerProcessor('proxy', class Proxy extends AudioWorkletProcessor {\n\n      constructor() { super(); }\n      process(inputs, outputs, parameters) {\n        inputs.forEach((input, index) => input.forEach((channel, cIndex) => {\n          outputs[index][cIndex].set(channel);\n        }));\n        return true;\n      }\n    })`\n    ], { type: 'application/javascript' })),\n  }\n\n  return audioWorklets;\n}\n","export class Constant {\n  static TAU = 2 * Math.PI;\n  static SIN_60 = 0.866;\n  static PHI = 1.6180339887498948;\n}\n","export const fileIcon = \"data:image/svg+xml;charset=UTF-8,%3c?xml version='1.0' encoding='iso-8859-1'?%3e%3c!-- --%3e%3csvg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 477.867 477.867' style='enable-background:new 0 0 477.867 477.867;' xml:space='preserve'%3e%3cg%3e%3cg%3e%3cpath d='M324.267,119.467c-9.426,0-17.067-7.641-17.067-17.067V0H102.4C74.123,0,51.2,22.923,51.2,51.2v375.467 c0,28.277,22.923,51.2,51.2,51.2h273.067c28.277,0,51.2-22.923,51.2-51.2v-307.2H324.267z'/%3e%3c/g%3e%3c/g%3e%3cg%3e%3cg%3e%3cpolygon points='341.333,10.001 341.333,85.333 416.666,85.333 '/%3e%3c/g%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3c/svg%3e\";\nexport const imageIcon = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAQAAAAAYLlVAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAHdElNRQfjDAMLKTYM6GTwAAACaElEQVRo3u2ZP2gUQRSHv90zGKMY/IPxBBGSEGKUixGsFFSQnAZEbUQrEXuvCIiIiKWCbbQXLBRsgpVgockhIhYJGg0oJEWwuNOYYJI7E29scufuZndvNjs30+yb5vbd2/l9Ozvv7cyuRdU6ybATPVZknK9Ox2FGEZrbCH1V+dMsapcXCBbJgkWaL2zVNPRem6M7xV1OGpKHZrCYpMsYAExalNhYO8yzpEF0E0drv8u4pkW7lqtud2raWiRDLAEwDrBBOrKFixxnFwXe8JQFdQhyWZBlxhH3nYEYiq4skAMYYMVTx1c4pw+glaLPo+Qn21UAyEzCq+zw8W7jWozbUDMZgFMR/coBdgf407oAZiP6lQPkA/yjKgBksmAfJZ8sKNOxTsXIWTDNLR/vHb6FnJOihzZVIwBwk2VXGbqNFdLn+dW6+ZYD9UZAfkGynyE+UuQTj3y7/W/9Dth5TqgCkLW9FFx9lrigE6CJ/JrpuswVfQBDvluQCtf1AFwO3AVVuNF4gIP8Dt2K3WsswBYm6u4GH2I3CsDiWV15geAJTY0BGJSSFwiG6YkCkJYqqMf4Iw0gGJMDaOEBPxAIZsiFrp7bXAvWqC0AYA/vXf+8C7w9KV7GkA8AyDC9JnCOS74A92PJ+wKcYT4g+DGbPfJnqagGyPE3JHyCjEO+k9mY8h6AroBa7mxL5Fblm/kQW94DMCZ50nMOcYRXCuSFhVh38VFixrfnCUACkAAkAAlAApAA2JSN6pdtpowCTNm8MAowbJHmM62G5H/RDZA19Ol2gf4qSR8j2uVf0ws43vZ10Kvt832B8eprzn/ptwK4iL9QVQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOS0xMi0wM1QxMTo0MTo1NCswMDowME8knnIAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTktMTItMDNUMTE6NDE6NTQrMDA6MDA+eSbOAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAABJRU5ErkJggg==\";\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { SerializedVector, Vector } from \"../core/vector\";\nimport { get } from \"../utils/utils\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Constant } from \"../resource/constants\";\n\nexport class Slider2D extends UINode implements Serializable {\n  private _value: Vector;\n  private thumbHitColor: string;\n  offThumbCanvas: OffscreenCanvas | HTMLCanvasElement;\n  private offThumbContext: OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D;\n  private pointDiameter: number = 20;\n\n  get value(): Vector {\n    if (this.propName) return this.getProp();\n    return this._value;\n  }\n  set value(value: Vector) {\n    value = value.clamp(0, 1);\n\n    let oldVal = this.value;\n    let newVal = value;\n\n    if (this.propName) this.setProp(newVal);\n    else {\n      this._value = newVal;\n    }\n    this.renderOffThumb();\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node,\n    options: Slider2DOptions = DefaultSlider2DOptions(node)\n  ) {\n    super(node, Vector.Zero(), UIType.Slider2D, {\n      draggable: true,\n      style: options.style ? { ...DefaultSlider2DStyle(), ...options.style } : DefaultSlider2DStyle(),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'vector', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'vector', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.height = get(options.height, this.node.style.rowHeight * 4);\n    this._value = this.propName ? this.getProp() : get(options.value, new Vector(.5, .5));\n    this._value.clampInPlace(0, 1);\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this.value = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (data) this.value = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.value);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.value);\n    });\n\n    this.thumbHitColor = Color.Random().hexValue;\n    if (typeof OffscreenCanvas !== 'undefined') {\n      this.offThumbCanvas = new OffscreenCanvas(this.width, this.height);\n    } else {\n      this.offThumbCanvas = document.createElement('canvas');\n      this.offThumbCanvas.width = this.width;\n      this.offThumbCanvas.height = this.height;\n    }\n    this.offThumbContext = this.offThumbCanvas.getContext('2d');\n    this.renderOffThumb();\n  }\n\n  renderOffThumb() {\n    let [width, height] = [this.width - this.pointDiameter, this.height - this.pointDiameter];\n    this.offThumbContext.clearRect(0, 0, width, height);\n\n    let coord = new Vector(this.value.x, 1 - this.value.y).multiply(width, height).add(this.pointDiameter / 2);\n    this.offThumbContext.fillStyle = this.thumbHitColor;\n    this.offThumbContext.beginPath();\n    this.offThumbContext.arc(coord.x, coord.y, this.pointDiameter / 2, 0, Constant.TAU);\n    this.offThumbContext.fill();\n  }\n\n  paint(): void {\n    let context = this.node.context;\n\n    context.fillStyle = this.style.backgroundColor;\n    context.strokeStyle = this.style.borderColor;\n    context.lineWidth = this.style.borderWidth;\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n\n    let [width, height] = [this.width - this.pointDiameter, this.height - this.pointDiameter];\n    let point = new Vector(this.value.x, 1 - this.value.y)\n      .multiplyInPlace(width, height)\n      .addInPlace(this.position)\n      .addInPlace(this.pointDiameter / 2);\n\n    context.fillStyle = this.style.thumbColor;\n    context.beginPath();\n    context.arc(point.x, point.y, this.pointDiameter / 2, 0, Constant.TAU);\n    context.fill();\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = '#000';\n    context.fillStyle = this.style.backgroundColor;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    let [newWidth, newHeight] = [this.width, this.height];\n\n    if (\n      Math.floor(this.offThumbCanvas.width) !== Math.floor(newWidth)\n      || Math.floor(this.offThumbCanvas.height) !== Math.floor(newHeight)\n    ) {\n\n      this.offThumbCanvas.width = newWidth;\n      this.offThumbCanvas.height = newHeight;\n      this.renderOffThumb();\n    }\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n  getHitPoint(realPosition: Vector): boolean {\n    let coord = realPosition.subtract(this.position);\n    let hitColor = Color.rgbaToHex(this.offThumbContext.getImageData(coord.x, coord.y, 1, 1).data);\n    return this.thumbHitColor === hitColor;\n  }\n  movePoint(realPosition: Vector) {\n    let [width, height] = [this.width - this.pointDiameter, this.height - this.pointDiameter];\n\n    this._value = realPosition\n      .clamp(\n        this.position.x + this.pointDiameter / 2, this.position.x + this.width - this.pointDiameter / 2,\n        this.position.y + this.pointDiameter / 2, this.position.y + this.height - this.pointDiameter / 2\n      )\n      .subtractInPlace(this.position.add(this.pointDiameter / 2))\n      .clampInPlace(0, width, 0, height)\n      .normalizeInPlace(0, width, 0, height);\n\n    this.value = new Vector(this._value.x, 1 - this._value.y);\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    this._value = newVal;\n    this.renderOffThumb();\n\n    this.output && this.output.setData(this.value);\n  }\n  onOver(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n\n  private isHit: boolean;\n  onDown(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, null, this._value);\n    this.isHit = false;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.movePoint(realPosition);\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    if (this.isHit) {\n      this.movePoint(realPosition);\n      if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, null, this._value);\n    }\n    this.isHit = false;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedSlider2D {\n    return {\n      value: this.value.serialize(),\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedSlider2D) {\n    return new Slider2D(node, {\n      value: Vector.deSerialize(data.value),\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface Slider2DStyle extends UINodeStyle {\n  backgroundColor?: string,\n  thumbColor?: string\n  borderColor?: string,\n  borderWidth?: number\n}\nlet DefaultSlider2DStyle = () => {\n  return {\n    backgroundColor: '#666',\n    thumbColor: '#fff',\n    borderColor: '#000',\n    borderWidth: 1\n  }\n}\n\nexport interface SerializedSlider2D extends SerializedUINode {\n  value: SerializedVector,\n  height: number\n}\n\ninterface Slider2DOptions {\n  value?: Vector,\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: Slider2DStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultSlider2DOptions = (node: Node): Slider2DOptions => {\n  return {\n    height: node.style.rowHeight * 4\n  }\n};\n","import { Node } from \"../core/node\";\nimport { Terminal, TerminalType, SerializedTerminal } from '../core/terminal';\nimport { Vector } from \"../core/vector\";\nimport { Label } from \"./label\";\nimport { SerializedUINode, UINode, UIType, UINodeStyle } from './ui-node';\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { Align } from \"../common/enums\";\nimport { get } from \"../utils/utils\";\n\nexport class Button extends UINode implements Serializable {\n  label: Label;\n\n  constructor(\n    node: Node,\n    public text: string,\n    options: ButtonOptions = DefaultButtonOptions(node)\n  ) {\n    super(node, Vector.Zero(), UIType.Button, {\n      style: options.style ? { ...DefaultButtonStyle(), ...options.style } : DefaultButtonStyle(),\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'event', '', {})\n        : new Terminal(node, options.input.type, options.input.dataType, options.input.name, {\n          style: options.input.style, id: options.input.id, hitColor: Color.deSerialize(options.input.hitColor)\n        })),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'event', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    if (this.input) this.input.on('event', () => this.call('click', this));\n    this.height = get(options.height, this.node.style.rowHeight + 2 * this.style.padding);\n\n    this.label = new Label(this.node, text, {\n      style: {\n        fontSize: this.style.fontSize,\n        font: this.style.font,\n        align: Align.Center,\n        color: this.style.color\n      },\n      height: this.height\n    });\n    this.label.on('click', (_node: Node, position: Vector) => this.call('click', this, position));\n    /* this.label.on('enter', () => this.node.flow.flowConnect.cursor = 'pointer');\n    this.label.on('exit', () => this.node.flow.flowConnect.cursor = 'unset'); */\n    this.children.push(this.label);\n  }\n\n  paint(): void {\n    Object.assign(this.context, {\n      fillStyle: this.style.backgroundColor,\n      shadowColor: this.style.shadowColor,\n      shadowBlur: this.style.shadowBlur,\n      shadowOffsetX: this.style.shadowOffset.x,\n      shadowOffsetY: this.style.shadowOffset.y\n    })\n    this.context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    this.context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  paintLOD1() {\n    this.context.strokeStyle = '#000';\n    this.paint();\n    this.context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    this.label.position = this.position;\n    this.label.height = this.height;\n    this.label.width = this.width;\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange() { /**/ }\n  onOver(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n\n    this.call('rightclick', this);\n  }\n\n  serialize(): SerializedButton {\n    return {\n      text: this.text,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      id: this.id,\n      style: this.style,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedButton): Button {\n    return new Button(node, data.text, {\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface ButtonStyle extends UINodeStyle {\n  backgroundColor?: string,\n  color?: string,\n  fontSize?: string,\n  font?: string,\n  padding?: number,\n  shadowColor?: string,\n  shadowBlur?: number,\n  shadowOffset?: Vector\n}\nlet DefaultButtonStyle = () => {\n  return {\n    backgroundColor: '#666',\n    padding: 5,\n    color: '#fff',\n    font: 'arial',\n    fontSize: '11px',\n    shadowColor: '#555',\n    shadowBlur: 3,\n    shadowOffset: new Vector(3, 3)\n  };\n};\n\nexport interface SerializedButton extends SerializedUINode {\n  text: string,\n  height: number\n}\n\ninterface ButtonOptions {\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: ButtonStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultButtonOptions = (node: Node): ButtonOptions => {\n  return {\n    height: node.style.rowHeight * 1.5\n  };\n};\n","import { Color } from \"../core/color\";\r\nimport { RenderResolver, Serializable } from \"../common/interfaces\";\r\nimport { Node } from \"../core/node\";\r\nimport { Vector } from \"../core/vector\";\r\nimport { Button, Display, HorizontalLayout, Stack, Image, Input, Label, Select, Slider, Source, Toggle } from \"./index\";\r\nimport { SerializedUINode, UINode, UINodeStyle, UIType, UINodeRenderParams } from \"./ui-node\";\r\nimport { Align } from \"../common/enums\";\r\n\r\nexport class Container extends UINode implements Serializable {\r\n  renderResolver: RenderResolver<Container, ContainerRenderParams> = () => null;\r\n  contentWidth: number;\r\n\r\n  constructor(\r\n    node: Node,\r\n    width: number,\r\n    options: ContainerOptions = DefaultContainerOptions()\r\n  ) {\r\n    super(node, node.position, UIType.Container, {\r\n      style: options.style ? { ...DefaultContainerStyle(), ...options.style } : DefaultContainerStyle(),\r\n      id: options.id,\r\n      hitColor: options.hitColor\r\n    });\r\n\r\n    this.width = width;\r\n    this.height = this.node.style.padding * 2;\r\n    this.contentWidth = this.width - 2 * this.node.style.padding;\r\n  }\r\n\r\n  paint(): void {\r\n    let context = this.context;\r\n    let nodeRenderResolver = this.node.renderResolver.uiContainer;\r\n    let flowRenderResolver = this.node.flow.renderResolver.uiContainer;\r\n    let flowConnectRenderResolver = this.node.flow.flowConnect.renderResolver.uiContainer;\r\n    ((this.renderResolver && this.renderResolver(this))\r\n      || (nodeRenderResolver && nodeRenderResolver(this))\r\n      || (flowRenderResolver && flowRenderResolver(this))\r\n      || (flowConnectRenderResolver && flowConnectRenderResolver(this))\r\n      || this._paint\r\n    )(context, this.getRenderParams(), this);\r\n  }\r\n  private _paint(context: CanvasRenderingContext2D, params: ContainerRenderParams, container: Container) {\r\n    context.shadowColor = container.style.shadowColor;\r\n    context.shadowBlur = container.style.shadowBlur;\r\n    context.shadowOffsetX = container.style.shadowOffset.x;\r\n    context.shadowOffsetY = container.style.shadowOffset.y;\r\n    context.fillStyle = container.style.backgroundColor;\r\n    context.strokeStyle = container.style.borderColor;\r\n    context.lineWidth = container.style.borderWidth;\r\n    context.roundRect(params.position.x, params.position.y, params.width, params.height, 5);\r\n    context.stroke();\r\n    context.fill();\r\n  }\r\n  paintLOD1() {\r\n    let context = this.context;\r\n    context.fillStyle = this.style.backgroundColor;\r\n    context.strokeStyle = this.style.borderColor;\r\n    context.lineWidth = this.style.borderWidth;\r\n    context.roundRect(\r\n      this.position.x, this.position.y + this.node.style.titleHeight,\r\n      this.width, this.height - this.node.style.titleHeight, 5\r\n    );\r\n    context.stroke();\r\n    context.fill();\r\n  }\r\n  offPaint(): void {\r\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\r\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\r\n  }\r\n  getRenderParams(): ContainerRenderParams {\r\n    let position = this.position.serialize();\r\n    position.y += this.node.style.titleHeight\r\n    return {\r\n      position: position,\r\n      width: this.width,\r\n      height: this.height - this.node.style.titleHeight\r\n    }\r\n  }\r\n\r\n  reflow(): void {\r\n    this.position = this.node.position;\r\n    let terminalsDisplayHeight = Math.max(this.node.inputs.length, this.node.outputs.length) * this.node.style.terminalRowHeight + this.node.style.titleHeight;\r\n    let x = this.position.x + this.node.style.padding;\r\n    let y = this.position.y + terminalsDisplayHeight;\r\n    this.children.filter(child => child.visible).forEach(child => {\r\n      y += this.node.style.spacing;\r\n      let availableWidth = this.width - this.node.style.padding * 2;\r\n      child.width = (child.width > availableWidth ? availableWidth : child.width) || availableWidth;\r\n      if (child.width < availableWidth) {\r\n        let childX;\r\n        if (child.style.align === Align.Center) {\r\n          childX = this.position.x + this.width / 2 - child.width / 2;\r\n        } else if (child.style.align === Align.Right) {\r\n          childX = this.position.x + this.width - this.node.style.padding - child.width;\r\n        } else {\r\n          childX = x;\r\n        }\r\n        child.position = new Vector(childX, y);\r\n      } else {\r\n        child.position = new Vector(x, y);\r\n      }\r\n      y += child.height;\r\n    });\r\n    this.height = y + this.node.style.padding - this.position.y;\r\n  }\r\n\r\n  onPropChange() { /**/ }\r\n  onOver(screenPosition: Vector, realPosition: Vector): void {\r\n    if (this.disabled) return;\r\n\r\n    this.call('over', this, screenPosition, realPosition);\r\n  }\r\n  onDown(screenPosition: Vector, realPosition: Vector): void {\r\n    if (this.disabled) return;\r\n\r\n    this.call('down', this, screenPosition, realPosition);\r\n  }\r\n  onUp(screenPosition: Vector, realPosition: Vector): void {\r\n    if (this.disabled) return;\r\n\r\n    this.call('up', this, screenPosition, realPosition);\r\n  }\r\n  onClick(screenPosition: Vector, realPosition: Vector): void {\r\n    if (this.disabled) return;\r\n\r\n    this.call('click', this, screenPosition, realPosition);\r\n  }\r\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\r\n    if (this.disabled) return;\r\n\r\n    this.call('drag', this, screenPosition, realPosition);\r\n  }\r\n  onEnter(screenPosition: Vector, realPosition: Vector) {\r\n    if (this.disabled) return;\r\n\r\n    this.call('enter', this, screenPosition, realPosition);\r\n  }\r\n  onExit(screenPosition: Vector, realPosition: Vector) {\r\n    if (this.disabled) return;\r\n\r\n    this.call('exit', this, screenPosition, realPosition);\r\n  }\r\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\r\n    if (this.disabled) return;\r\n\r\n    this.call('wheel', this, direction, screenPosition, realPosition);\r\n  }\r\n  onContextMenu(): void { /**/ }\r\n\r\n  serialize(): SerializedContainer {\r\n    return {\r\n      width: this.width,\r\n      propName: this.propName,\r\n      input: this.input ? this.input.serialize() : null,\r\n      output: this.output ? this.output.serialize() : null,\r\n      id: this.id,\r\n      style: {\r\n        backgroundColor: this.style.backgroundColor,\r\n        shadowColor: this.style.shadowColor,\r\n        shadowBlur: this.style.shadowBlur,\r\n        shadowOffset: this.style.shadowOffset.serialize(),\r\n        borderWidth: this.style.borderWidth,\r\n        borderColor: this.style.borderColor\r\n      },\r\n      hitColor: this.hitColor.serialize(),\r\n      type: this.type,\r\n      childs: this.children.map(child => (child as any).serialize())\r\n    }\r\n  }\r\n  static deSerialize(node: Node, data: SerializedContainer): Container {\r\n    let uiContainer = new Container(node, data.width, {\r\n      style: data.style,\r\n      id: data.id,\r\n      hitColor: Color.deSerialize(data.hitColor)\r\n    });\r\n\r\n    uiContainer.children.push(...data.childs.map(serializedChild => {\r\n      switch (serializedChild.type) {\r\n        case UIType.Button: return Button.deSerialize(node, serializedChild);\r\n        case UIType.Container: return Container.deSerialize(node, serializedChild);\r\n        case UIType.Display: return Display.deSerialize(node, serializedChild);\r\n        case UIType.HorizontalLayout: return HorizontalLayout.deSerialize(node, serializedChild);\r\n        case UIType.Stack: return Stack.deSerialize(node, serializedChild);\r\n        case UIType.Image: return Image.deSerialize(node, serializedChild);\r\n        case UIType.Input: return Input.deSerialize(node, serializedChild);\r\n        case UIType.Label: return Label.deSerialize(node, serializedChild);\r\n        case UIType.Select: return Select.deSerialize(node, serializedChild);\r\n        case UIType.Slider: return Slider.deSerialize(node, serializedChild);\r\n        case UIType.Source: return Source.deSerialize(node, serializedChild);\r\n        case UIType.Toggle: return Toggle.deSerialize(node, serializedChild);\r\n        default: return;\r\n      }\r\n    }));\r\n    return uiContainer;\r\n  }\r\n}\r\n\r\nexport interface ContainerStyle extends UINodeStyle {\r\n  backgroundColor?: string,\r\n  shadowColor?: string,\r\n  shadowBlur?: number,\r\n  shadowOffset?: Vector,\r\n  borderColor?: string,\r\n  borderWidth?: number\r\n}\r\nlet DefaultContainerStyle = () => {\r\n  return {\r\n    backgroundColor: '#ddd',\r\n    shadowColor: '#666',\r\n    shadowBlur: 3,\r\n    shadowOffset: new Vector(3, 3),\r\n    borderWidth: 1,\r\n    borderColor: '#444'\r\n  };\r\n};\r\n\r\nexport interface SerializedContainer extends SerializedUINode {\r\n  width: number\r\n}\r\n\r\ninterface ContainerOptions {\r\n  style?: ContainerStyle,\r\n  id?: string,\r\n  hitColor?: Color\r\n}\r\nlet DefaultContainerOptions = () => {\r\n  return {};\r\n};\r\n\r\nexport interface ContainerRenderParams extends UINodeRenderParams { }\r\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { Vector } from \"../core/vector\";\nimport { clamp, denormalize, get, normalize } from \"../utils/utils\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Constant } from \"../resource/constants\";\n\nexport class Dial extends UINode implements Serializable {\n  private _value: number;\n  private thumbStart: Vector = Vector.Zero();\n  private thumbEnd: Vector = Vector.Zero();\n  private lastAngle: number;\n  private deltaValue: number;\n  private temp: number;\n\n  get value(): number {\n    if (this.propName) return this.getProp();\n    return this._value;\n  }\n  set value(value: number) {\n    let oldVal = this.value;\n    let newVal = clamp(value, this.min, this.max);\n\n    if (this.propName) this.setProp(newVal);\n    else this._value = newVal;\n    this.temp = normalize(newVal, this.min, this.max);\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node,\n    public min: number, public max: number,\n    height: number,\n    options: DialOptions = DefaultDialOptions(min)\n  ) {\n    super(node, Vector.Zero(), UIType.Dial, {\n      draggable: true,\n      style: options.style ? { ...DefaultDialStyle(height), ...options.style } : DefaultDialStyle(height),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'number', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'number', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.height = height;\n    this._value = get(options.value, min);\n    this.temp = normalize(this._value, this.min, this.max);\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this.value = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (data) this.value = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.value);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.value);\n    });\n  }\n\n  paint(): void {\n    let context = this.context;\n    let size = Math.min(this.width, this.height);\n\n    context.fillStyle = this.style.color;\n    context.strokeStyle = this.style.borderColor;\n    context.lineWidth = this.style.borderWidth;\n    context.shadowColor = this.style.shadowColor;\n    context.shadowBlur = this.style.shadowBlur;\n    context.shadowOffsetX = 3;\n    context.shadowOffsetY = 3;\n    context.beginPath();\n    context.arc(this.position.x + this.width / 2, this.position.y + this.height / 2, size / 2, 0, Constant.TAU);\n    context.stroke();\n    context.fill();\n\n    context.lineCap = 'round';\n    context.lineWidth = 10;\n    context.strokeStyle = this.style.thumbColor;\n    context.shadowColor = this.style.thumbShadowColor;\n    context.shadowBlur = this.style.thumbShadowBlur;\n    context.beginPath();\n    context.moveTo(this.thumbStart.x, this.thumbStart.y);\n    context.lineTo(this.thumbEnd.x, this.thumbEnd.y);\n    context.stroke();\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = '#000';\n    context.fillStyle = this.style.color;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    let context = this.offUIContext;\n    let size = Math.min(this.width, this.height);\n\n    context.fillStyle = this.hitColor.hexValue;\n    context.beginPath();\n    context.arc(this.position.x + this.width / 2, this.position.y + this.height / 2, size / 2, 0, Constant.TAU);\n    context.fill();\n  }\n\n  reflow(): void {\n    let center = this.position.add(this.width / 2, this.height / 2);\n    let angle = normalize(this.value, this.min, this.max) * Constant.TAU + (Math.PI / 2);\n    let size = Math.min(this.width, this.height);\n    this.thumbStart.assign(center.x + Math.cos(angle) * (size / 5), center.y + Math.sin(angle) * (size / 5));\n    this.thumbEnd.assign(center.x + Math.cos(angle) * (size / 2 - 10), center.y + Math.sin(angle) * (size / 2 - 10));\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n  private pointToValue(position: Vector): number {\n    let diff = position.subtract(this.position.add(this.width / 2, this.height / 2));\n    let angle = Math.atan2(diff.y, diff.x);\n    if (angle < 0) angle += Constant.TAU;\n    return (((angle / Constant.TAU) - 0.25) + 1) % 1;\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    this._value = newVal;\n    this.temp = normalize(newVal, this.min, this.max);\n    this.reflow();\n\n    this.output && this.output.setData(this._value);\n  }\n  onOver(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.lastAngle = undefined;\n    this.deltaValue = this.pointToValue(realPosition);\n    this.temp = normalize(this.value, this.min, this.max);\n    this.onDrag(screenPosition, realPosition);\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    let currValue = this.pointToValue(realPosition);\n    let diffValue = currValue - this.deltaValue;\n    diffValue = (Math.abs(diffValue) > 0.5) ? 0 : diffValue;\n    this.deltaValue = currValue;\n    this.temp = this.temp + diffValue;\n    this.temp = clamp(this.temp, 0, 1);\n\n    let angle = this.temp * Constant.TAU;\n    if (angle < 0) angle += Constant.TAU;\n    if (typeof this.lastAngle !== 'undefined' && Math.abs(this.lastAngle - angle) > 2) {\n      angle = this.lastAngle > 3 ? Constant.TAU : 0;\n    }\n    this.lastAngle = angle;\n    let normalizedValue = angle / Constant.TAU;\n    this.value = denormalize(clamp(normalizedValue, 0, 1), this.min, this.max);\n    this.temp = normalizedValue;\n    this.reflow();\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.lastAngle = undefined;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedDial {\n    return {\n      min: this.min,\n      max: this.max,\n      value: this.value,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      size: this.height,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      style: this.style,\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedDial) {\n    return new Dial(node, data.min, data.max, data.size, {\n      value: data.value,\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface DialStyle extends UINodeStyle {\n  color?: string,\n  borderColor?: string,\n  borderWidth?: number,\n  shadowColor?: string,\n  shadowBlur?: number,\n  thumbColor?: string,\n  thumbBorderColor?: string,\n  thumbBorderWidth?: number,\n  thumbShadowColor?: string,\n  thumbShadowBlur?: number\n}\nlet DefaultDialStyle = (size: number) => {\n  return {\n    color: '#e3e3e3',\n    borderColor: '#000',\n    borderWidth: 1,\n    shadowColor: 'grey',\n    shadowBlur: 5,\n    thumbColor: '#c9c9c9',\n    thumbShadowColor: '#858585',\n    thumbShadowBlur: 5,\n    size,\n    visible: true\n  }\n}\n\nexport interface SerializedDial extends SerializedUINode {\n  min: number,\n  max: number,\n  value: number,\n  size: number\n}\n\ninterface DialOptions {\n  value?: number,\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  style?: DialStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultDialOptions = (min: number) => {\n  return {\n    value: min\n  };\n};\n","import { Color } from \"../core/color\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Node } from \"../core/node\";\nimport { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Vector } from \"../core/vector\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\n\nexport class Display extends UINode implements Serializable {\n  displayConfigs: CustomOffCanvasConfig[] = [];\n\n  constructor(\n    node: Node,\n    height: number,\n    customRenderers: CustomRendererConfig[],\n    options: DisplayOptions = DefaultDisplayOptions()\n  ) {\n    super(node, Vector.Zero(), UIType.Display, {\n      draggable: true,\n      zoomable: true,\n      style: options.style ? { ...DefaultDisplayStyle(), ...options.style } : DefaultDisplayStyle(),\n      input: options.clear && typeof options.clear !== 'boolean'\n        ? Terminal.deSerialize(node, options.clear)\n        : new Terminal(node, TerminalType.IN, 'event', '', {}),\n      id: options.id, hitColor: options.hitColor\n    });\n\n    this.height = height;\n\n    if (typeof OffscreenCanvas !== 'undefined') {\n      customRenderers.forEach(rendererConfig => {\n        let offCanvas, offContext, newOffCanvasConfig;\n        if (rendererConfig.canvasType === CanvasType.HTMLCanvasElement) {\n          offCanvas = document.createElement('canvas');\n          offCanvas.width = this.node.width - 2 * this.node.style.padding;\n          offCanvas.height = this.height;\n        } else {\n          offCanvas = new OffscreenCanvas(this.node.width - 2 * this.node.style.padding, this.height);\n        }\n        offContext = offCanvas.getContext('2d');\n        newOffCanvasConfig = { canvas: offCanvas, context: offContext, rendererConfig, shouldRender: true }\n        this.displayConfigs.push(newOffCanvasConfig);\n      });\n    } else {\n      customRenderers.forEach(rendererConfig => {\n        let offCanvas = document.createElement('canvas');\n        offCanvas.width = this.node.width - 2 * this.node.style.padding;\n        offCanvas.height = this.height;\n        let offContext = offCanvas.getContext('2d');\n        let newOffCanvasConfig = { canvas: offCanvas, context: offContext, rendererConfig, shouldRender: true }\n        this.displayConfigs.push(newOffCanvasConfig);\n      });\n    }\n\n    this.input.on('event', () => {\n      this.displayConfigs.filter(config => !config.rendererConfig.auto).forEach(config => {\n        config.context.clearRect(0, 0, config.canvas.width, config.canvas.height);\n      });\n    });\n\n    this.node.flow.flowConnect.on('scale', () => this.reflow());\n  }\n\n  private customRender(canvasConfigs: CustomOffCanvasConfig[]) {\n    return Promise.all(canvasConfigs.map(config => {\n      return new Promise<boolean>(resolve => {\n        if (config.shouldRender) {\n          if (config.rendererConfig.clear)\n            config.context.clearRect(0, 0, config.canvas.width, config.canvas.height);\n          if (this.style.backgroundColor) {\n            config.context.fillStyle = this.style.backgroundColor;\n            config.context.fillRect(0, 0, config.canvas.width, config.canvas.height);\n          }\n          resolve(\n            config.rendererConfig.renderer(config.context, config.canvas.width, config.canvas.height)\n          );\n        } else resolve(false);\n      });\n    }));\n  }\n\n  paint(): void {\n    let context = this.context;\n    context.strokeStyle = this.style.borderColor;\n    context.lineWidth = 1;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n\n    let autoOffCanvasConfigs = this.displayConfigs.filter(config => config.rendererConfig.auto);\n    this.customRender(autoOffCanvasConfigs).then((results: boolean[]) => {\n      results.forEach((result, index) => autoOffCanvasConfigs[index].shouldRender = result);\n    });\n\n    this.displayConfigs.forEach(offCanvas => {\n      context.drawImage(\n        offCanvas.canvas, 0, 0,\n        offCanvas.canvas.width, offCanvas.canvas.height,\n        this.position.x, this.position.y,\n        this.node.width - 2 * this.node.style.padding, this.height\n      );\n    });\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = this.style.borderColor;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillStyle = 'lightgrey';\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    let newWidth = (this.node.width - 2 * this.node.style.padding) * this.node.flow.flowConnect.scale;\n    let newHeight = this.height * this.node.flow.flowConnect.scale;\n\n    this.displayConfigs.forEach(offCanvas => {\n      // Optimization: Do not trigger re-render if width/height is same\n      if (Math.floor(offCanvas.canvas.width) !== Math.floor(newWidth) || Math.floor(offCanvas.canvas.height) !== Math.floor(newHeight)) {\n        offCanvas.canvas.width = newWidth;\n        offCanvas.canvas.height = newHeight;\n\n        if (!offCanvas.shouldRender) {\n          offCanvas.rendererConfig.renderer(offCanvas.context, offCanvas.canvas.width, offCanvas.canvas.height);\n          offCanvas.shouldRender = false;\n        }\n      }\n    });\n\n    this.input.position.assign(\n      this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n      this.position.y + this.height / 2\n    );\n  }\n\n  onPropChange() { /**/ }\n  onOver(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n\n    this.call('rightclick', this);\n  }\n\n  serialize(): SerializedDisplay {\n    return {\n      height: this.height,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      style: this.style,\n      type: this.type,\n      childs: []\n    };\n  }\n  static deSerialize(node: Node, data: SerializedDisplay): Display {\n    return new Display(node, data.height, null, {\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor),\n      clear: data.input\n    });\n  }\n}\n\nexport enum CanvasType {\n  OffscreenCanvas = 'OffscreenCanvas',\n  HTMLCanvasElement = 'HTMLCanvasElement'\n}\n\nexport interface CustomOffCanvasConfig {\n  canvas: OffscreenCanvas | HTMLCanvasElement;\n  context: OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D;\n  rendererConfig: CustomRendererConfig,\n  shouldRender: boolean\n}\n\nexport interface CustomRendererConfig {\n  auto?: boolean,\n  clear?: boolean,\n  canvasType?: CanvasType,\n  renderer?: (context: CanvasRenderingContext2D | OffscreenCanvasRenderingContext2D, width: number, height: number) => boolean,\n}\n\nexport interface DisplayStyle extends UINodeStyle {\n  borderColor?: string,\n  backgroundColor?: string\n}\nlet DefaultDisplayStyle = () => {\n  return {\n    borderColor: '#000',\n    visible: true\n  };\n};\n\nexport interface SerializedDisplay extends SerializedUINode {\n  height: number\n}\n\ninterface DisplayOptions {\n  style?: DisplayStyle,\n  id?: string,\n  hitColor?: Color,\n  clear?: boolean | SerializedTerminal\n}\nlet DefaultDisplayOptions = () => {\n  return {}\n};\n","import { SerializedVector, Vector } from \"../core/vector\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Node } from '../core/node';\nimport { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Constant } from \"../resource/constants\";\nimport { List, ListNode } from \"../utils/linked-list\";\nimport { BiMap } from \"../utils/bidirectional-map\";\n\nexport class Envelope extends UINode implements Serializable {\n  private _value: List<Vector>;\n  private pointHitColorPoint: BiMap<string, ListNode<Vector>> = new BiMap();\n  offPointsCanvas: OffscreenCanvas | HTMLCanvasElement;\n  private offPointsContext: OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D;\n  private pointDiameter: number = 10;\n\n  get value(): Vector[] {\n    return this._value.toArray().map(vec => vec.clone());\n  }\n  set value(value: Vector[]) {\n    let oldVal = this.value;\n    value.forEach(vector => vector.clampInPlace(0, 1, 0, 1));\n    value.sort((a, b) => a.x - b.x);\n    this._value = new List((a, b) => a.x - b.x, value);\n    this.pointHitColorPoint.clear();\n    this._value.forEach(node => this.pointHitColorPoint.set(Color.Random().hexValue, node));\n    this.renderOffPoints();\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, this._value.toArray());\n  }\n\n  constructor(\n    node: Node,\n    height: number,\n    values: Vector[] = [],\n    options: EnvelopeOptions = DefaultEnvelopeOptions()\n  ) {\n    super(node, Vector.Zero(), UIType.Envelope, {\n      draggable: true,\n      style: options.style ? { ...DefaultEnvelopeStyle(), ...options.style } : DefaultEnvelopeStyle(),\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'array', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'array', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.height = height;\n    values.forEach(vector => vector.clampInPlace(0, 1, 0, 1));\n    values.sort((a, b) => a.x - b.x);\n    this._value = new List((a, b) => a.x - b.x, values);\n    this.pointHitColorPoint.clear();\n    this._value.forEach(pointNode => this.pointHitColorPoint.set(Color.Random().hexValue, pointNode));\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this.value = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (data) this.value = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.value);\n\n    if (typeof OffscreenCanvas !== 'undefined') {\n      this.offPointsCanvas = new OffscreenCanvas(this.width, this.height);\n    } else {\n      this.offPointsCanvas = document.createElement('canvas');\n      this.offPointsCanvas.width = this.width;\n      this.offPointsCanvas.height = this.height;\n    }\n    this.offPointsContext = this.offPointsCanvas.getContext('2d');\n    this.renderOffPoints();\n  }\n\n  renderOffPoints() {\n    let [width, height] = [this.width - this.pointDiameter, this.height - this.pointDiameter];\n    this.offPointsContext.clearRect(0, 0, width, height);\n\n    this._value.forEach(node => {\n      let coord = new Vector(node.data.x, 1 - node.data.y).multiply(width, height).add(this.pointDiameter / 2);\n      this.offPointsContext.fillStyle = this.pointHitColorPoint.get(node) as string;\n      this.offPointsContext.beginPath();\n      this.offPointsContext.arc(coord.x, coord.y, this.pointDiameter / 2, 0, Constant.TAU);\n      this.offPointsContext.fill();\n    });\n  }\n\n  paint(): void {\n    let context = this.node.context;\n\n    context.fillStyle = this.style.backgroundColor;\n    context.strokeStyle = this.style.borderColor;\n    context.lineWidth = this.style.borderWidth;\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n\n    let [width, height] = [this.width - this.pointDiameter, this.height - this.pointDiameter];\n    let points: Vector[] = this._value.map(node =>\n      new Vector(node.data.x, 1 - node.data.y)\n        .multiplyInPlace(width, height)\n        .addInPlace(this.position)\n        .addInPlace(this.pointDiameter / 2)\n    );\n\n    if (points.length > 0) {\n      context.strokeStyle = this.style.lineColor;\n      context.lineWidth = 2;\n      context.beginPath();\n      context.moveTo(this.position.x, points[0].y);\n      points.forEach(point => context.lineTo(point.x, point.y));\n      context.lineTo(this.position.x + this.width, points[points.length - 1].y);\n      context.stroke();\n    }\n\n    context.fillStyle = this.style.pointColor;\n    points.forEach(point => {\n      context.beginPath();\n      context.arc(point.x, point.y, this.pointDiameter / 2, 0, Constant.TAU);\n      context.fill();\n    });\n  }\n  paintLOD1() {\n    this.context.fillStyle = this.style.backgroundColor;\n    this.context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    let [newWidth, newHeight] = [this.width, this.height];\n\n    if (\n      Math.floor(this.offPointsCanvas.width) !== Math.floor(newWidth)\n      || Math.floor(this.offPointsCanvas.height) !== Math.floor(newHeight)\n    ) {\n\n      this.offPointsCanvas.width = newWidth;\n      this.offPointsCanvas.height = newHeight;\n      this.renderOffPoints();\n    }\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  getHitPoint(realPosition: Vector): ListNode<Vector> {\n    let coord = realPosition.subtract(this.position);\n    let hitColor = Color.rgbaToHex(this.offPointsContext.getImageData(coord.x, coord.y, 1, 1).data);\n    let hitPointNode = this.pointHitColorPoint.get(hitColor);\n    return hitPointNode as ListNode<Vector>;\n  }\n  movePoint(realPosition: Vector) {\n    let [width, height] = [this.width - this.pointDiameter, this.height - this.pointDiameter];\n\n    this.currHitPoint.data = realPosition\n      .clamp(\n        this.position.x + this.pointDiameter / 2, this.position.x + this.width - this.pointDiameter / 2,\n        this.position.y + this.pointDiameter / 2, this.position.y + this.height - this.pointDiameter / 2\n      )\n      .subtractInPlace(this.position.add(this.pointDiameter / 2))\n      .clampInPlace(0, width, 0, height)\n      .normalizeInPlace(0, width, 0, height)\n      .clampInPlace(\n        this.currHitPoint.prev?.data.x || 0, this.currHitPoint.next?.data.x || 1,\n        -Infinity, Infinity\n      );\n    this.currHitPoint.data = new Vector(this.currHitPoint.data.x, 1 - this.currHitPoint.data.y);\n\n    this.renderOffPoints();\n  }\n  newPoint(realPosition: Vector, width: number, height: number) {\n    let oldVal = this._value.toArray();\n\n    let newPoint = realPosition\n      .subtract(this.position.add(this.pointDiameter / 2))\n      .normalizeInPlace(0, width, 0, height);\n    newPoint = new Vector(newPoint.x, 1 - newPoint.y);\n\n    let newPointNode;\n    let anchor = this._value.searchTail(node => node.data.x <= newPoint.x);\n\n    if (anchor === null) newPointNode = this._value.prepend(newPoint);\n    else newPointNode = this._value.addAfter(newPoint, anchor);\n\n    this.pointHitColorPoint.set(Color.Random().hexValue, newPointNode);\n    this.renderOffPoints();\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, this._value.toArray());\n  }\n  deletePoint() {\n    let oldVal = this._value.toArray();\n    this._value.delete(this.currHitPoint);\n    this.pointHitColorPoint.delete(this.currHitPoint);\n    this.renderOffPoints();\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, this._value.toArray());\n  }\n\n  onPropChange() { /**/ }\n  onOver(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n\n  private currHitPoint: ListNode<Vector>;\n  private lastDownPosition: Vector;\n  onDown(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.currHitPoint = this.getHitPoint(realPosition);\n    this.lastDownPosition = realPosition;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    let [width, height] = [this.width - this.pointDiameter, this.height - this.pointDiameter];\n    if (!this.currHitPoint && this.lastDownPosition) {\n      if (Vector.Distance(this.lastDownPosition, realPosition) <= 2) {\n        this.newPoint(realPosition, width, height);\n      }\n    } else if (\n      this.currHitPoint && this.currHitPoint === this.getHitPoint(realPosition)\n      && this.lastDownPosition && this.lastDownPosition.isEqual(realPosition, 0.5)\n    ) {\n      this.deletePoint();\n    } else if (this.currHitPoint) {\n      // Point has finished moving\n      if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, null, this._value.toArray());\n    }\n\n    this.currHitPoint = null;\n    this.lastDownPosition = null;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    if (this.currHitPoint) this.movePoint(realPosition);\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    if (this.currHitPoint) {\n      this.movePoint(realPosition);\n      if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, null, this._value.toArray());\n    }\n    this.currHitPoint = null;\n    this.lastDownPosition = null;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedEnvelope {\n    return {\n      values: this.value.map(vector => vector.serialize()),\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      style: this.style,\n      height: this.height,\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedEnvelope): Envelope {\n    return new Envelope(node, data.height, data.values.map(serialVec => Vector.deSerialize(serialVec)), {\n      input: data.input,\n      output: data.output,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface EnvelopeStyle extends UINodeStyle {\n  backgroundColor?: string,\n  pointColor?: string,\n  lineColor?: string,\n  borderColor?: string,\n  borderWidth?: number\n}\nlet DefaultEnvelopeStyle = () => {\n  return {\n    backgroundColor: '#4a4a4a',\n    pointColor: '#9cffee',\n    lineColor: '#9cd6ff',\n    borderColor: '#000',\n    borderWidth: 1,\n    visible: true\n  };\n};\n\nexport interface SerializedEnvelope extends SerializedUINode {\n  values: SerializedVector[],\n  height: number\n}\n\ninterface EnvelopeOptions {\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  style?: EnvelopeStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultEnvelopeOptions = () => {\n  return {};\n};\n","import { Color } from \"../core/color\";\r\nimport { Serializable } from \"../common/interfaces\";\r\nimport { Node } from \"../core/node\";\r\nimport { Vector } from \"../core/vector\";\r\nimport { Button, Container, Display, Image, Input, Label, Select, Slider, Source, Stack, Toggle, } from \"./index\";\r\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\r\nimport { clamp } from \"../utils/utils\";\r\nimport { SerializedTerminal, Terminal, TerminalType } from \"../core/terminal\";\r\n\r\nexport class HorizontalLayout extends UINode implements Serializable {\r\n\r\n  constructor(\r\n    node: Node,\r\n    childs: UINode[] = [],\r\n    options: HorizontalLayoutOptions = DefaultHorizontalLayoutOptions()\r\n  ) {\r\n    super(node, Vector.Zero(), UIType.HorizontalLayout, {\r\n      style: options.style ? { ...DefaultHorizontalLayoutStyle(), ...options.style } : DefaultHorizontalLayoutStyle(),\r\n      input: options.input && (typeof options.input === 'boolean'\r\n        ? new Terminal(node, TerminalType.IN, 'any', '', {})\r\n        : Terminal.deSerialize(node, options.input)),\r\n      output: options.output && (typeof options.output === 'boolean'\r\n        ? new Terminal(node, TerminalType.OUT, 'any', '', {})\r\n        : Terminal.deSerialize(node, options.output)),\r\n      id: options.id,\r\n      hitColor: options.hitColor\r\n    });\r\n\r\n    if (childs && childs.length > 0) this.children.push(...childs);\r\n  }\r\n\r\n  paint(): void { /**/ }\r\n  paintLOD1() { /**/ }\r\n  offPaint(): void {\r\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\r\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\r\n  }\r\n\r\n  reflow(): void {\r\n    let children = this.children.filter(child => child.visible);\r\n\r\n    let availableWidth = this.width - (children.length > 0 ? (children.length - 1) : 0) * this.style.spacing;\r\n    let originalWidth = availableWidth;\r\n\r\n    let maxHeight = 0;\r\n    children.forEach(child => maxHeight = Math.max(maxHeight, child.height));\r\n    this.height = maxHeight;\r\n\r\n    let fixedWidthChilds = this.children.filter(child => !!child.width);\r\n    fixedWidthChilds.forEach(child => child.width = clamp(child.width, 0, availableWidth));\r\n    let fixedWidth = fixedWidthChilds.reduce((acc, curr) => acc + curr.width, 0);\r\n\r\n    let remainingWidth = originalWidth;\r\n    fixedWidth = clamp(fixedWidth, 0, remainingWidth);\r\n    remainingWidth -= fixedWidth;\r\n    let flexWidth = remainingWidth;\r\n\r\n    let x = this.position.x;\r\n    children.forEach(child => {\r\n      let childWidth;\r\n      if (!!child.width) childWidth = child.width;\r\n      else if (typeof child.style.grow === 'number') {\r\n        childWidth = child.style.grow * flexWidth;\r\n      } else {\r\n        childWidth = 0;\r\n      }\r\n\r\n      childWidth = clamp(childWidth, 0, availableWidth);\r\n      child.width = childWidth;\r\n\r\n      let y;\r\n      if (child.height < this.height) {\r\n        y = this.position.y + this.height / 2 - child.height / 2;\r\n      } else {\r\n        child.height = this.height\r\n        y = this.position.y;\r\n      }\r\n      child.position.assign(x, y);\r\n\r\n      availableWidth -= childWidth;\r\n      x += childWidth + this.style.spacing;\r\n    });\r\n\r\n    if (this.input) {\r\n      this.input.position.assign(\r\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\r\n        this.position.y + this.height / 2\r\n      );\r\n    }\r\n    if (this.output) {\r\n      this.output.position.assign(\r\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\r\n        this.position.y + this.height / 2\r\n      );\r\n    }\r\n\r\n    // To fix a bug, when creating HozLayout with childs argument, UI container's height won't update\r\n    this.node.ui.reflow();\r\n  }\r\n\r\n  onPropChange() { /**/ }\r\n  onOver(screenPosition: Vector, realPosition: Vector): void {\r\n    if (this.disabled) return;\r\n\r\n    this.call('over', this, screenPosition, realPosition);\r\n  }\r\n  onDown(screenPosition: Vector, realPosition: Vector): void {\r\n    if (this.disabled) return;\r\n\r\n    this.call('down', this, screenPosition, realPosition);\r\n  }\r\n  onUp(screenPosition: Vector, realPosition: Vector): void {\r\n    if (this.disabled) return;\r\n\r\n    this.call('up', this, screenPosition, realPosition);\r\n  }\r\n  onClick(screenPosition: Vector, realPosition: Vector): void {\r\n    if (this.disabled) return;\r\n\r\n    this.call('click', this, screenPosition, realPosition);\r\n  }\r\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\r\n    if (this.disabled) return;\r\n\r\n    this.call('drag', this, screenPosition, realPosition);\r\n  }\r\n  onEnter(screenPosition: Vector, realPosition: Vector) {\r\n    if (this.disabled) return;\r\n\r\n    this.call('enter', this, screenPosition, realPosition);\r\n  }\r\n  onExit(screenPosition: Vector, realPosition: Vector) {\r\n    if (this.disabled) return;\r\n\r\n    this.call('exit', this, screenPosition, realPosition);\r\n  }\r\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\r\n    if (this.disabled) return;\r\n\r\n    this.call('wheel', this, direction, screenPosition, realPosition);\r\n  }\r\n  onContextMenu(): void { /**/ }\r\n\r\n  serialize(): SerializedHorizontalLayout {\r\n    return {\r\n      propName: this.propName,\r\n      input: this.input ? this.input.serialize() : null,\r\n      output: this.output ? this.output.serialize() : null,\r\n      id: this.id,\r\n      style: this.style,\r\n      hitColor: this.hitColor.serialize(),\r\n      type: this.type,\r\n      childs: this.children.map(child => (child as any).serialize())\r\n    }\r\n  }\r\n  static deSerialize(node: Node, data: SerializedHorizontalLayout): HorizontalLayout {\r\n    let hozLayout = new HorizontalLayout(node, [], {\r\n      style: data.style,\r\n      input: data.input,\r\n      output: data.output,\r\n      id: data.id,\r\n      hitColor: Color.deSerialize(data.hitColor)\r\n    });\r\n\r\n    hozLayout.children.push(...data.childs.map(serializedChild => {\r\n      switch (serializedChild.type) {\r\n        case UIType.Button: return Button.deSerialize(node, serializedChild);\r\n        case UIType.Container: return Container.deSerialize(node, serializedChild);\r\n        case UIType.Display: return Display.deSerialize(node, serializedChild);\r\n        case UIType.HorizontalLayout: return HorizontalLayout.deSerialize(node, serializedChild);\r\n        case UIType.Stack: return Stack.deSerialize(node, serializedChild);\r\n        case UIType.Image: return Image.deSerialize(node, serializedChild);\r\n        case UIType.Input: return Input.deSerialize(node, serializedChild);\r\n        case UIType.Label: return Label.deSerialize(node, serializedChild);\r\n        case UIType.Select: return Select.deSerialize(node, serializedChild);\r\n        case UIType.Slider: return Slider.deSerialize(node, serializedChild);\r\n        case UIType.Source: return Source.deSerialize(node, serializedChild);\r\n        case UIType.Toggle: return Toggle.deSerialize(node, serializedChild);\r\n        default: return;\r\n      }\r\n    }));\r\n    return hozLayout;\r\n  }\r\n}\r\n\r\nexport interface HorizontalLayoutStyle extends UINodeStyle {\r\n  spacing?: number\r\n}\r\nlet DefaultHorizontalLayoutStyle = () => {\r\n  return {\r\n    spacing: 0,\r\n    visible: true\r\n  };\r\n};\r\n\r\nexport interface SerializedHorizontalLayout extends SerializedUINode { }\r\n\r\ninterface HorizontalLayoutOptions {\r\n  style?: HorizontalLayoutStyle,\r\n  input?: boolean | SerializedTerminal,\r\n  output?: boolean | SerializedTerminal,\r\n  id?: string,\r\n  hitColor?: Color\r\n}\r\nlet DefaultHorizontalLayoutOptions = (): HorizontalLayoutOptions => {\r\n  return {};\r\n};\r\n","import { Color } from \"../core/color\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Node } from \"../core/node\";\nimport { Vector } from \"../core/vector\";\nimport { imageIcon } from \"../resource/icons\";\nimport { Log } from \"../utils/logger\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Align } from \"../common/enums\";\nimport { SerializedTerminal, Terminal, TerminalType } from \"../core/terminal\";\nimport { FlowState } from '../core/flow';\nimport { get } from \"../utils/utils\";\n\nexport class Image extends UINode implements Serializable {\n  private imageCanvas: OffscreenCanvas | HTMLCanvasElement;\n  private imageContext: OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D;\n  private source: HTMLImageElement;\n  private ratio: number;\n  private _src: string;\n\n  get src(): string {\n    if (this.propName) return this.getProp();\n    return this._src;\n  }\n  set src(src: string) {\n    let oldVal = this._src;\n    let newVal = src;\n\n    if (this.propName) this.setProp(newVal);\n    else this._src = newVal;\n    this.setupImage();\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node,\n    sourceString: string,\n    options: ImageOptions = DefaultImageOptions()\n  ) {\n    super(node, Vector.Zero(), UIType.Image, {\n      style: options.style ? { ...DefaultImageStyle(), ...options.style } : DefaultImageStyle(),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'string', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'string', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this._src = get(sourceString, imageIcon);\n    this.setupImage();\n  }\n\n  setupImage() {\n    if (!this.source) {\n      this.source = document.createElement('img');\n      this.source.onerror = (error) => Log.error(error);\n      this.source.onload = () => {\n        this.imageCanvas.width = this.source.width;\n        this.imageCanvas.height = this.source.height;\n\n        this.imageContext.drawImage(this.source, 0, 0);\n        this.ratio = this.source.width / this.source.height;\n        this.reflow();\n        this.node.ui.update();\n      };\n    }\n    if (!this.imageCanvas) {\n      if (typeof OffscreenCanvas !== 'undefined') this.imageCanvas = new OffscreenCanvas(0, 0);\n      else {\n        this.imageCanvas = document.createElement('canvas');\n        this.imageCanvas.width = 0;\n        this.imageCanvas.height = 0;\n      }\n      this.imageContext = this.imageCanvas.getContext('2d');\n    }\n\n    this.source.src = this._src;\n  }\n\n  paint(): void {\n    if (this.imageCanvas && this.imageCanvas.width > 0 && this.imageCanvas.height > 0) {\n      let x = this.position.x;\n      if (this.source.width < this.node.ui.contentWidth) {\n        if (this.style.align === Align.Center) x += this.node.ui.contentWidth / 2 - this.source.width / 2;\n        else if (this.style.align === Align.Right) x += + (this.node.ui.contentWidth - this.source.width);\n      }\n      this.context.drawImage(\n        this.imageCanvas, 0, 0, this.source.width, this.source.height,\n        x, this.position.y, this.source.width < this.width ? this.source.width : this.width, this.height\n      );\n    }\n  }\n  paintLOD1() {\n    if (this.imageCanvas) {\n      let x = this.position.x;\n      if (this.source.width < this.node.ui.contentWidth) {\n        if (this.style.align === Align.Center) x += this.node.ui.contentWidth / 2 - this.source.width / 2;\n        else if (this.style.align === Align.Right) x += + (this.node.ui.contentWidth - this.source.width);\n      }\n      let context = this.context;\n      context.fillStyle = 'lightgrey';\n      context.strokeStyle = '#000';\n      context.fillRect(x, this.position.y, this.source.width < this.width ? this.source.width : this.width, this.height);\n      context.strokeRect(x, this.position.y, this.source.width < this.width ? this.source.width : this.width, this.height)\n    }\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n\n    let x = this.position.x;\n    if (this.source.width < this.node.ui.contentWidth) {\n      if (this.style.align === Align.Center) x += this.node.ui.contentWidth / 2 - this.source.width / 2;\n      else if (this.style.align === Align.Right) x += + (this.node.ui.contentWidth - this.source.width);\n    }\n    this.offUIContext.fillRect(x, this.position.y, this.source.width < this.width ? this.source.width : this.width, this.height);\n  }\n\n  reflow(): void {\n    if (!this.source.width || !this.source.height) return;\n\n    if (this.source.width > this.width) {\n      this.height = this.width / this.ratio;\n    } else {\n      this.width = this.source.width;\n      this.height = this.source.height;\n    }\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    this._src = newVal;\n    this.setupImage();\n\n    this.output && this.output.setData(newVal);\n  }\n  onOver(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void { /**/ }\n\n  serialize(): SerializedImage {\n    return {\n      source: this._src,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedImage): Image {\n    return new Image(node, data.source, {\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface ImageStyle extends UINodeStyle {\n  align?: Align\n}\nlet DefaultImageStyle = () => {\n  return {\n    align: Align.Left,\n    visible: true\n  };\n};\n\nexport interface SerializedImage extends SerializedUINode {\n  source: string\n}\n\ninterface ImageOptions {\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  style?: ImageStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultImageOptions = (): ImageOptions => {\n  return {};\n};\n","export * from './2d-slider';\r\nexport * from './button';\r\nexport * from './container';\r\nexport * from './dial';\r\nexport * from './display';\r\nexport * from './envelope';\r\nexport * from './horizontal-layout';\r\nexport * from './image';\r\nexport * from './input';\r\nexport * from './label';\r\nexport * from './radio-group';\r\nexport * from './select';\r\nexport * from './slider';\r\nexport * from './source';\r\nexport * from './stack';\r\nexport * from './toggle';\r\nexport * from './ui-node';\r\nexport * from './v-slider';\r\n","import { Vector } from \"../core/vector\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Node } from '../core/node';\nimport { Label } from './label';\nimport { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Align } from \"../common/enums\";\nimport { exists, get } from \"../utils/utils\";\n\nexport class Input extends UINode implements Serializable {\n  label: Label;\n  inputEl: HTMLInputElement;\n  private _value: string | number;\n\n  get value(): string | number {\n    if (this.propName) return this.getProp();\n    return this._value;\n  }\n  set value(value: string | number) {\n    let val: string | number;\n    if (this.style.type === InputType.Number && typeof value === 'string') val = parseFloat(value);\n    else val = value;\n\n    let oldVal = this.value;\n    let newVal = val;\n\n    if (this.propName) this.setProp(newVal);\n    else {\n      this._value = newVal;\n      this.setLabelText(this._value);\n      this.inputEl.value = this._value.toString();\n    }\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, newVal, oldVal);\n  }\n\n  constructor(\n    node: Node,\n    options: InputOptions = DefaultInputOptions(node)\n  ) {\n    super(\n      node, Vector.Zero(), UIType.Input, {\n      style: options.style ? { ...DefaultInputStyle(), ...options.style } : DefaultInputStyle(),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, options.style.type, '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, options.style.type, '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.height = get(options.height, this.node.style.rowHeight);\n\n    if (this.style.type === InputType.Number && typeof options.value === 'string') options.value = parseFloat(options.value);\n    this._value = options.value;\n\n    this.setupLabel();\n    this.setupInputElement();\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this.value = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (data) this.value = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.value);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.value);\n    });\n  }\n\n  setupLabel() {\n    this.label = new Label(this.node, this.value.toString(), {\n      style: {\n        fontSize: this.style.fontSize,\n        font: this.style.font,\n        align: this.style.align,\n        color: this.style.color,\n        padding: 5,\n        precision: this.style.precision || null\n      }, height: this.height\n    });\n    this.label.on('click', () => {\n      if (document.activeElement !== this.inputEl) {\n        let realPosition = this.position.transform(this.node.flow.flowConnect.transform);\n        Object.assign(this.inputEl.style, {\n          'visibility': 'visible',\n          'pointer-events': 'all',\n          'top': (realPosition.y + this.node.flow.flowConnect.canvasDimensions.top + 1) + 'px',\n          'left': (realPosition.x + this.node.flow.flowConnect.canvasDimensions.left + 1) + 'px',\n          'width': (this.width - 1) * this.node.flow.flowConnect.scale + 'px',\n          'height': (this.height - 1) * this.node.flow.flowConnect.scale + 'px',\n          'font-family': this.style.font,\n          'font-size': parseInt(this.style.fontSize.replace('px', '')) * this.node.flow.flowConnect.scale + 'px',\n          'color': this.style.color,\n          'background-color': this.inputEl.validity.patternMismatch ? 'red' : this.style.backgroundColor,\n          'text-align': this.style.align\n        });\n        if (this.style.type === InputType.Number) this.inputEl.step = this.style.step;\n        this.inputEl.focus();\n      }\n    });\n    this.children.push(this.label);\n  }\n  setupInputElement() {\n    this.inputEl = document.createElement('input');\n    this.inputEl.className = 'flow-connect-input';\n    this.inputEl.spellcheck = false;\n    let inputType = this.style.type === 'string' ? 'text' : this.style.type\n    this.inputEl.type = this.style.pattern ? 'text' : inputType;\n    this.inputEl.value = this.value.toString();\n    if (this.style.pattern) this.inputEl.pattern = this.style.pattern;\n    if (this.style.type === InputType.Number && this.style.step) this.inputEl.step = this.style.step;\n    if (this.style.maxLength) this.inputEl.maxLength = this.style.maxLength;\n\n    this.inputEl.addEventListener('blur', () => {\n      this.inputEl.style.visibility = 'hidden';\n      this.inputEl.style.pointerEvents = 'none';\n      this.value = this.inputEl.value;\n\n      this.setLabelText(this.style.type === InputType.Number ? parseFloat(this.value) : this.value.toString());\n\n      this.call('blur', this);\n    });\n    this.inputEl.oninput = () => {\n      if (this.style.pattern) {\n        this.inputEl.style.backgroundColor = this.inputEl.validity.patternMismatch ? 'orange' : this.style.backgroundColor;\n        this.label.style.color = this.inputEl.validity.patternMismatch ? 'orange' : this.style.color;\n      }\n      this.call('input', this);\n    }\n    document.body.appendChild(this.inputEl);\n  }\n  setLabelText(value: any) {\n    this.label.text = typeof value === 'number' && exists(this.style.precision) ? value.toFixed(this.style.precision) : value;\n  }\n\n  paint(): void {\n    this.context.strokeStyle = this.style.border;\n    this.context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = this.style.border;\n    context.fillStyle = this.style.backgroundColor;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    this.label.position = this.position;\n    this.label.height = this.height;\n    this.label.width = this.width;\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    if (this.style.type === InputType.Number && typeof newVal === 'string') newVal = parseFloat(newVal);\n\n    this._value = newVal;\n    this.setLabelText(this._value);\n    this.inputEl.value = this._value.toString();\n\n    this.output && this.output.setData(this._value);\n  }\n  onOver(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedInput {\n    return {\n      value: this.value,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedInput): Input {\n    return new Input(node, {\n      value: data.value,\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport enum InputType {\n  Text = 'string',\n  Number = 'number'\n}\n\nexport interface InputStyle extends UINodeStyle {\n  backgroundColor?: string,\n  color?: string,\n  fontSize?: string,\n  font?: string,\n  border?: string,\n  type?: InputType,\n  align?: Align,\n  precision?: number,\n  pattern?: string,\n  step?: string,\n  maxLength?: number,\n}\nlet DefaultInputStyle = (): InputStyle => {\n  return {\n    backgroundColor: '#eee',\n    color: '#000',\n    fontSize: '11px',\n    font: 'arial',\n    border: '1px solid black',\n    align: Align.Left,\n    type: InputType.Text\n  };\n};\n\nexport interface SerializedInput extends SerializedUINode {\n  value: string | number,\n  height: number\n}\n\ninterface InputOptions {\n  value?: string | number,\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: InputStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultInputOptions = (node: Node): InputOptions => {\n  return {\n    height: node.style.rowHeight * 1.5\n  };\n}\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { Vector } from \"../core/vector\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { binarySearch, exists, get } from \"../utils/utils\";\nimport { FlowState } from \"../core/flow\";\nimport { Align } from \"../common/enums\";\n\nexport class Label extends UINode implements Serializable {\n  private displayText: string;\n  private _text: string | number;\n  private textWidth: number;    // This may be smaller due to surrounding width constraints (this is som...)\n  private orgTextWidth: number; // While this is the actual width                           (this is some text)\n  private textHeight: number;\n\n  get text(): string {\n    let value;\n    if (this.propName) value = this.getProp();\n    else value = this._text;\n\n    if (typeof value === 'number') value = this.format(value);\n    return value;\n  }\n  set text(text: string | number) {\n    let oldVal = this._text;\n    let newVal = text;\n\n    if (this.propName) {\n      this.setProp(newVal);\n    } else {\n      this._text = newVal;\n      this.reflow();\n    }\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node,\n    text: string | number,\n    options: LabelOptions = DefaultLabelOptions(node)\n  ) {\n    super(node, Vector.Zero(), UIType.Label, {\n      style: options.style ? { ...DefaultLabelStyle(), ...options.style } : DefaultLabelStyle(),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'any', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'string', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this._text = this.propName ? this.getProp() : text;\n    this.reflow();\n\n    this.height = get(options.height, this.textHeight + 5);\n    if (!this.style.grow) this.width = this.orgTextWidth;\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (exists(connector.data)) this.text = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (exists(data)) this.text = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.text);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.text);\n    });\n  }\n\n  paint(): void {\n    let context = this.context;\n\n    context.fillStyle = this.style.backgroundColor;\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n\n    context.fillStyle = this.style.color;\n    context.font = this.style.fontSize + ' ' + this.style.font;\n    context.textBaseline = 'middle';\n    let y = this.position.y + this.height / 2;\n    let x = this.position.x;\n    if (this.style.align === Align.Center) {\n      x += this.width / 2 - this.textWidth / 2;\n    } else if (this.style.align === Align.Right) {\n      x += this.width - this.textWidth - this.style.padding;\n    } else {\n      x += this.style.padding\n    }\n\n    context.fillText(this.displayText, x, y);\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = '#000';\n    context.fillStyle = this.style.color;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    let context = this.context;\n    context.font = this.style.fontSize + ' ' + this.style.font;\n    this.orgTextWidth = context.measureText(this.text).width;\n    this.displayText = this.getBestFitString();\n    let metrics = context.measureText(this.displayText);\n    context.font = null;\n    this.textWidth = metrics.width;\n\n    this.textHeight = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent + 5;\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n  getBestFitString(): string {\n    let text = this.text;\n    if (typeof (text as any) !== 'string') text = text.toString();\n\n    let width = this.context.measureText(text).width;\n    const ellipsis = '…';\n    const ellipsisWidth = this.context.measureText(ellipsis).width;\n    if (width <= this.width || width <= ellipsisWidth) return text;\n\n    const index = binarySearch({\n      max: text.length,\n      getValue: (idx: number) => this.context.measureText(text.substring(0, idx)).width,\n      match: this.width - ellipsisWidth,\n    });\n\n    return text.substring(0, index) + ellipsis;\n  }\n  format(value: number): string {\n    return exists(this.style.precision) ? value.toFixed(this.style.precision) : value.toString();\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    this._text = newVal;\n    this.reflow();\n\n    this.output && this.output.setData(this._text);\n  }\n  onOver(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedLabel {\n    return {\n      text: this.text,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedLabel): Label {\n    return new Label(node, data.text, {\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface LabelStyle extends UINodeStyle {\n  color?: string,\n  backgroundColor?: string,\n  fontSize?: string,\n  font?: string,\n  align?: Align,\n  precision?: number,\n  padding?: number\n}\nlet DefaultLabelStyle = () => {\n  return {\n    color: '#000',\n    backgroundColor: 'transparent',\n    fontSize: '11px',\n    font: 'arial',\n    align: Align.Left,\n    padding: 0,\n    visible: true\n  };\n};\n\nexport interface SerializedLabel extends SerializedUINode {\n  text: string,\n  height: number\n}\n\ninterface LabelOptions {\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: LabelStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultLabelOptions = (node: Node): LabelOptions => {\n  return {\n    height: node.style.rowHeight * 1.5\n  }\n};\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { Vector } from \"../core/vector\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Label } from \"./label\";\nimport { Align } from \"../common/enums\";\nimport { get } from \"../utils/utils\";\n\nexport class RadioGroup extends UINode implements Serializable {\n  private _values: string[];\n  private _selected: string;\n\n  get selected(): string {\n    if (this.propName) return this.getProp();\n    return this._selected;\n  }\n  set selected(selected: string) {\n    if (!this._values.includes(selected)) selected = this._values[0];\n\n    let oldVal = this.selected;\n    let newVal = selected;\n\n    if (this.propName) this.setProp(newVal);\n    else this._selected = newVal;\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node,\n    values: string[] = ['default'],\n    selected: string = 'default',\n    options: RadioGroupOptions = DefaultRadioGroupOptions(node)\n  ) {\n    super(node, Vector.Zero(), UIType.RadioGroup, {\n      style: options.style ? { ...DefaultRadioGroupStyle(), ...options.style } : DefaultRadioGroupStyle(),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'boolean', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'boolean', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    if (values.length === 0) values = ['default'];\n    this._values = values;\n    let selectedValue = this.propName ? this.getProp() : selected;\n    this._selected = this._values.includes(selectedValue) ? selectedValue : this._values[0];\n    this.height = get(options.height, this.node.style.rowHeight);\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this._selected = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (typeof data !== 'undefined') this._selected = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this._selected);\n\n    this.setupLabels();\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this._selected);\n    });\n  }\n\n  setupLabels() {\n    this.children.push(...this._values.map(option => {\n      let label = new Label(this.node, option, {\n        style: { align: Align.Center, backgroundColor: this.style.backgroundColor, color: this.style.color }\n      });\n\n      label.on('click', (selectedLabel: Label) => {\n        if (selectedLabel.text === this.selected) return;\n        let lastSelectedLabel = this.children[this._values.indexOf(this.selected)];\n        Object.assign(lastSelectedLabel.style, {\n          backgroundColor: this.style.backgroundColor,\n          color: this.style.color\n        });\n        Object.assign(selectedLabel.style, {\n          backgroundColor: this.style.selectedBackgroundColor,\n          color: this.style.selectedColor\n        });\n        this.selected = selectedLabel.text;\n      });\n\n      return label;\n    }));\n    Object.assign(this.children[this._values.indexOf(this._selected)].style, {\n      backgroundColor: this.style.selectedBackgroundColor,\n      color: this.style.selectedColor\n    });\n  }\n\n  paint(): void {\n    let context = this.context;\n    context.strokeStyle = this.style.borderColor;\n    context.lineWidth = this.style.borderWidth\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n\n    let commonWidth = this.width / this.children.length;\n    let x = this.position.x + commonWidth;\n    for (let i = 0; i < this.children.length - 1; i += 1) {\n      context.beginPath();\n      context.moveTo(x, this.position.y);\n      context.lineTo(x, this.position.y + this.height);\n      context.stroke();\n      x += commonWidth;\n    }\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = this.style.borderColor;\n    context.fillStyle = this.style.backgroundColor;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    let x = this.position.x;\n    this.children.forEach(child => {\n      child.height = this.height;\n      child.width = this.width / this.children.length;\n      child.position.assign(x, this.position.y);\n      x += child.width;\n    });\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    if (!this._values.includes(newVal)) newVal = this._values[0];\n    this._selected = newVal;\n\n    this.output && this.output.setData(this._selected);\n  }\n  onOver(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedRadioGroup {\n    return {\n      values: this._values,\n      selected: this.selected,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedRadioGroup): RadioGroup {\n    return new RadioGroup(node, data.values, data.selected, {\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface RadioGroupStyle extends UINodeStyle {\n  color?: string,\n  selectedColor?: string,\n  backgroundColor?: string,\n  selectedBackgroundColor?: string,\n  borderColor?: string,\n  borderWidth?: number,\n}\nlet DefaultRadioGroupStyle = () => {\n  return {\n    color: '#000',\n    selectedColor: '#fff',\n    backgroundColor: 'transparent',\n    selectedBackgroundColor: '#555',\n    borderColor: '#000',\n    borderWidth: 1,\n    visible: true\n  };\n};\n\nexport interface SerializedRadioGroup extends SerializedUINode {\n  values: string[],\n  selected: string,\n  height: number\n}\n\ninterface RadioGroupOptions {\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: RadioGroupStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultRadioGroupOptions = (node: Node): RadioGroupOptions => {\n  return {\n    height: node.style.rowHeight * 1.5\n  }\n};\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { Vector } from \"../core/vector\";\nimport { Label } from \"./label\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Constant } from \"../resource/constants\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Align } from \"../common/enums\";\nimport { get } from \"../utils/utils\";\n\nexport class Select extends UINode implements Serializable {\n  label: Label;\n  private _selected: string;\n\n  get selected(): string {\n    if (this.propName) {\n      let value = this.getProp();\n      let slctdVal = this.values.includes(value) ? value : this.values[0];\n      value = this.values.length === 0 ? 'None' : slctdVal;\n      return value;\n    }\n    return this._selected;\n  }\n  set selected(selected: string) {\n    let slctdVal = this.values.includes(selected) ? selected : this.values[0];\n\n    let oldVal = this.selected;\n    let newVal = this.values.length === 0 ? 'None' : slctdVal;\n\n    if (this.propName) this.setProp(newVal);\n    else {\n      this._selected = newVal;\n      this.label.text = newVal;\n    }\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node,\n    public values: string[] = [],\n    options: SelectOptions = DefaultSelectOptions(node)\n  ) {\n    super(node, Vector.Zero(), UIType.Select, {\n      style: options.style ? { ...DefaultSelectStyle(), ...options.style } : DefaultSelectStyle(),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'any', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'string', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.height = get(options.height, this.node.style.rowHeight);\n    this._selected = this.values.length === 0 ? 'None' : this.values[0];\n\n    this.label = new Label(this.node, this.selected, { style: { align: Align.Center, ...this.style }, height: this.height });\n    this.children.push(this.label);\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (typeof connector.data === 'number') this.selected = this.values[connector.data];\n        else if (typeof connector.data === 'string') this.selected = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (typeof data === 'number') this.selected = this.values[data];\n        else if (typeof data === 'string') this.selected = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.selected);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.selected);\n    });\n  }\n\n  paint(): void {\n    let context = this.context;\n    context.fillStyle = this.style.arrowColor;\n    context.beginPath();\n    context.moveTo(this.position.x, this.position.y + this.height / 2);\n    context.lineTo(this.position.x + this.height * Constant.SIN_60, this.position.y);\n    context.lineTo(this.position.x + this.height * Constant.SIN_60, this.position.y + this.height);\n    context.lineTo(this.position.x, this.position.y + this.height / 2);\n    context.closePath();\n    context.fill();\n\n    context.fillStyle = this.style.arrowColor;\n    context.beginPath();\n    context.moveTo(this.position.x + this.width, this.position.y + this.height / 2);\n    context.lineTo(this.position.x + this.width - (this.height * Constant.SIN_60), this.position.y);\n    context.lineTo(this.position.x + this.width - (this.height * Constant.SIN_60), this.position.y + this.height);\n    context.lineTo(this.position.x + this.width, this.position.y + this.height / 2);\n    context.closePath();\n    context.fill();\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.fillStyle = this.style.arrowColor;\n    context.strokeStyle = '#000';\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    this.label.width = this.width * .7;\n    this.label.position.assign(\n      this.position.x + this.width * .15,\n      this.position.y + this.height / 2 - this.label.height / 2\n    );\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange(_oldVal: any, newValue: any) {\n    let slctdVal = this.values.includes(newValue) ? newValue : this.values[0];\n    let value = this.values.length === 0 ? 'None' : slctdVal;\n    this._selected = value;\n    this.label.text = this._selected;\n\n    this.output && this.output.setData(this.selected);\n  }\n  onOver(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    if (this.values.length === 0) return;\n    let direction;\n    if (realPosition.x < this.position.x + this.width * .15) {\n      direction = -1;\n    } else if (realPosition.x > this.position.x + this.width * .85) {\n      direction = 1;\n    } else return;\n\n    let length = this.values.length;\n    this.selected = this.values[(((this.values.indexOf(this.selected) + direction) % length) + length) % length];\n    this.label.text = this.selected;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedSelect {\n    return {\n      values: this.values,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedSelect): Select {\n    return new Select(node, data.values, {\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface SelectStyle extends UINodeStyle {\n  font?: string,\n  fontSize?: string,\n  color?: string,\n  arrowColor?: string\n}\nlet DefaultSelectStyle = () => {\n  return {\n    arrowColor: '#000',\n    visible: true\n  };\n};\n\nexport interface SerializedSelect extends SerializedUINode {\n  values: string[],\n  height: number\n}\n\ninterface SelectOptions {\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: SelectStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultSelectOptions = (node: Node): SelectOptions => {\n  return {\n    height: node.style.rowHeight * 1.5\n  }\n}\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { Vector } from \"../core/vector\";\nimport { clamp, denormalize, exists, get, normalize } from \"../utils/utils\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Constant } from \"../resource/constants\";\n\nexport class Slider extends UINode implements Serializable {\n  private thumbFill: number;\n  private _value: number;\n\n  get value(): number {\n    if (this.propName) return this.getProp();\n    return this._value;\n  }\n  set value(value: number) {\n    value = clamp(value, this.min, this.max);\n\n    let oldVal = this.value;\n    let newVal = value;\n    newVal = exists(this.style.precision) ? parseFloat(newVal.toFixed(this.style.precision)) : newVal;\n\n    if (this.propName) this.setProp(newVal);\n    else {\n      this._value = newVal;\n      this.reflow();\n    }\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node, public min: number, public max: number,\n    options: SliderOptions = DefaultSliderOptions(node)\n  ) {\n    super(node, Vector.Zero(), UIType.Slider, {\n      draggable: true,\n      style: options.style ? { ...DefaultSliderStyle(node, options.height), ...options.style } : DefaultSliderStyle(node, options.height),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'number', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'number', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.height = get(options.height, this.node.style.rowHeight);\n    this._value = this.propName ? this.getProp() : get(options.value, min);\n    this._value = clamp(this._value, this.min, this.max);\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this.value = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (data) this.value = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.value);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.value);\n    });\n  }\n\n  paint(): void {\n    let context = this.context;\n    context.lineWidth = this.style.railHeight;\n    context.strokeStyle = this.style.color;\n    context.lineCap = 'butt';\n\n    let start = Math.max(this.position.x, this.position.x + this.thumbFill - 3);\n    if (start !== this.position.x) {\n      context.beginPath();\n      context.moveTo(this.position.x, this.position.y + this.height / 2);\n      context.lineTo(start, this.position.y + this.height / 2);\n      context.stroke();\n    }\n    start = Math.min(this.position.x + 2 * this.style.thumbRadius + this.thumbFill + 3, this.position.x + this.width);\n    if (start !== (this.position.x + this.width)) {\n      context.beginPath();\n      context.moveTo(start, this.position.y + this.height / 2);\n      context.lineTo(this.position.x + this.width, this.position.y + this.height / 2);\n      context.stroke();\n    }\n\n    context.fillStyle = this.style.thumbColor;\n    context.beginPath();\n    context.arc(\n      this.position.x + this.style.thumbRadius + this.thumbFill,\n      this.position.y + this.height / 2, this.style.thumbRadius, 0, Constant.TAU\n    );\n    context.fill();\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = '#000';\n    context.fillStyle = this.style.color;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    this.thumbFill = denormalize(normalize(this.value, this.min, this.max), 0, this.width - 2 * this.style.thumbRadius);\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    this._value = newVal;\n    this.reflow();\n\n    this.output && this.output.setData(this.value);\n  }\n  onOver(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    let y = this.position.y + this.height / 2 - this.style.railHeight / 2;\n    this.thumbFill = realPosition\n      .clamp(this.position.x + this.style.thumbRadius, this.position.x + this.width - this.style.thumbRadius, y, y)\n      .subtractInPlace(this.position.x + this.style.thumbRadius, 0)\n      .x;\n\n    this.value = denormalize(normalize(this.thumbFill, 0, this.width - 2 * this.style.thumbRadius), this.min, this.max);\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedSlider {\n    return {\n      min: this.min,\n      max: this.max,\n      value: this.value,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedSlider) {\n    return new Slider(node, data.min, data.max, {\n      value: data.value,\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface SliderStyle extends UINodeStyle {\n  railHeight?: number,\n  thumbRadius?: number,\n  color?: string,\n  thumbColor?: string,\n  precision?: number\n}\nlet DefaultSliderStyle = (node: Node, height: number) => {\n  return {\n    color: '#444',\n    thumbColor: '#000',\n    railHeight: 3,\n    thumbRadius: typeof height !== 'undefined' ? height / 2 : (node.style.rowHeight * 1.5) / 2\n  }\n}\n\nexport interface SerializedSlider extends SerializedUINode {\n  min: number,\n  max: number,\n  value: number,\n  height: number\n}\n\ninterface SliderOptions {\n  value?: number,\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: SliderStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultSliderOptions = (node: Node): SliderOptions => {\n  return {\n    height: node.style.rowHeight * 1.5\n  }\n};\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { Vector } from \"../core/vector\";\nimport { fileIcon } from \"../resource/icons\";\nimport { Image } from \"./image\";\nimport { Label } from \"./label\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Align } from \"../common/enums\";\nimport { get } from \"../utils/utils\";\n\nexport class Source extends UINode implements Serializable {\n  private htmlInput: HTMLInputElement;\n  private fileIcon: Image;\n  private _file: File;\n\n  label: Label;\n  accept: string;\n\n  get file(): File {\n    if (this.propName) return this.getProp();\n    return this._file;\n  }\n  set file(file: File) {\n    let oldVal = this.file;\n    let newVal = file;\n\n    if (this.propName) this.setProp(newVal);\n    else {\n      this._file = newVal;\n      this.label.text = newVal.name.substring(0, this._file.name.toString().lastIndexOf('.'));\n    }\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node,\n    options: SourceOptions = DefaultSourceOptions(node)\n  ) {\n\n    super(node, Vector.Zero(), UIType.Source, {\n      style: options.style ? { ...DefaultSourceStyle(), ...options.style } : DefaultSourceStyle(),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'file', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'file', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.accept = options.accept;\n    this.height = get(options.height, this.node.style.rowHeight);\n\n    this.setupInputElement(options);\n\n    this.label = new Label(this.node, 'Select', { style: { align: Align.Center, ...this.style }, height: this.height });\n    this.fileIcon = new Image(this.node, fileIcon);\n    this.label.on('click', () => this.htmlInput.click());\n    this.children.push(this.label, this.fileIcon);\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this.file = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (data) this.file = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.file);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.file);\n    });\n  }\n\n  setupInputElement(options: SourceOptions) {\n    this.htmlInput = document.createElement('input');\n    this.htmlInput.type = 'file';\n    if (options.accept) this.htmlInput.accept = options.accept;\n    this.htmlInput.onchange = () => {\n      if (this.htmlInput.files.length > 0) {\n        let oldVal = this.file;\n        this.file = this.htmlInput.files[0];\n        if (this.node.flow.state === FlowState.Stopped) this.call('upload', this, oldVal, this.file);\n      }\n    };\n  }\n\n  paint(): void {\n    this.context.strokeStyle = this.style.borderColor;\n    this.context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = this.style.borderColor;\n    context.fillStyle = this.style.color;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    this.label.width = this.width;\n    this.label.height = this.height;\n    this.label.position = this.position;\n\n    this.fileIcon.width = this.width * .1;\n    this.fileIcon.position.assign(this.position.x + 5, this.position.y + this.height / 2 - this.fileIcon.height / 2);\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    this._file = newVal;\n    this.label.text = this._file.name.substring(0, this._file.name.toString().lastIndexOf('.'));\n\n    this.output && this.output.setData(this._file);\n  }\n  onOver(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedSource {\n    return {\n      accept: this.accept,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedSource) {\n    return new Source(node, {\n      accept: data.accept,\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface SourceStyle extends UINodeStyle {\n  borderColor?: string,\n  font?: string,\n  fontSize?: string,\n  color?: string\n}\nlet DefaultSourceStyle = () => {\n  return {\n    borderColor: '#000',\n    visible: true\n  };\n};\n\nexport interface SerializedSource extends SerializedUINode {\n  accept: string,\n  height: number\n}\n\ninterface SourceOptions {\n  accept?: string,\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: SourceStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultSourceOptions = (node: Node): SourceOptions => {\n  return {\n    height: node.style.rowHeight * 1.5\n  }\n};\n","import { Color } from \"../core/color\";\r\nimport { Serializable } from \"../common/interfaces\";\r\nimport { Node } from \"../core/node\";\r\nimport { Vector } from \"../core/vector\";\r\nimport { Button, Container, Display, Image, Input, Label, Select, Slider, Source, Toggle } from \"./index\";\r\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\r\n\r\nexport class Stack extends UINode implements Serializable {\r\n\r\n  constructor(\r\n    node: Node,\r\n    options: StackOptions = DefaultStackOptions()\r\n  ) {\r\n    super(node, Vector.Zero(), UIType.Stack, {\r\n      style: options.style ? { ...DefaultStackStyle(), ...options.style } : DefaultStackStyle(),\r\n      id: options.id,\r\n      hitColor: options.hitColor\r\n    });\r\n\r\n    if (options.childs) this.children.push(...options.childs);\r\n  }\r\n\r\n  paint(): void { /**/ }\r\n  paintLOD1() { /**/ }\r\n  offPaint(): void {\r\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\r\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\r\n  }\r\n\r\n  reflow(): void {\r\n    let children = this.children.filter(child => child.visible);\r\n    let actualTotalHeight = children.reduce((acc, curr) => (acc + curr.height), 0);\r\n    let effectiveSpacing = (children.length - 1) * this.style.spacing;\r\n    this.height = actualTotalHeight + effectiveSpacing;\r\n\r\n    let y = this.position.y;\r\n    children.forEach(child => {\r\n      child.position.assign(this.position.x, y);\r\n      child.width = this.width;\r\n      y += child.height + this.style.spacing;\r\n    });\r\n  }\r\n\r\n  onPropChange() { /**/ }\r\n  onOver(screenPosition: Vector, realPosition: Vector): void {\r\n    if (this.disabled) return;\r\n\r\n    this.call('over', this, screenPosition, realPosition);\r\n  }\r\n  onDown(screenPosition: Vector, realPosition: Vector): void {\r\n    if (this.disabled) return;\r\n\r\n    this.call('down', this, screenPosition, realPosition);\r\n  }\r\n  onUp(screenPosition: Vector, realPosition: Vector): void {\r\n    if (this.disabled) return;\r\n\r\n    this.call('up', this, screenPosition, realPosition);\r\n  }\r\n  onClick(screenPosition: Vector, realPosition: Vector): void {\r\n    if (this.disabled) return;\r\n\r\n    this.call('click', this, screenPosition, realPosition);\r\n  }\r\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\r\n    if (this.disabled) return;\r\n\r\n    this.call('drag', this, screenPosition, realPosition);\r\n  }\r\n  onEnter(screenPosition: Vector, realPosition: Vector) {\r\n    if (this.disabled) return;\r\n\r\n    this.call('enter', this, screenPosition, realPosition);\r\n  }\r\n  onExit(screenPosition: Vector, realPosition: Vector) {\r\n    if (this.disabled) return;\r\n\r\n    this.call('exit', this, screenPosition, realPosition);\r\n  }\r\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\r\n    if (this.disabled) return;\r\n\r\n    this.call('wheel', this, direction, screenPosition, realPosition);\r\n  }\r\n  onContextMenu(): void { /**/ }\r\n\r\n  serialize(): SerializedStackLayout {\r\n    return {\r\n      style: this.style,\r\n      id: this.id,\r\n      hitColor: this.hitColor.serialize(),\r\n      type: this.type,\r\n      propName: null,\r\n      input: null,\r\n      output: null,\r\n      childs: this.children.map(child => (child as any).serialize())\r\n    }\r\n  }\r\n  static deSerialize(node: Node, data: SerializedStackLayout): Stack {\r\n    let stack = new Stack(node, { style: data.style, id: data.id, hitColor: Color.deSerialize(data.hitColor), childs: [] });\r\n\r\n    stack.children.push(...data.childs.map(serializedChild => {\r\n      switch (serializedChild.type) {\r\n        case UIType.Button: return Button.deSerialize(node, serializedChild);\r\n        case UIType.Container: return Container.deSerialize(node, serializedChild);\r\n        case UIType.Display: return Display.deSerialize(node, serializedChild);\r\n        case UIType.HorizontalLayout: return Stack.deSerialize(node, serializedChild);\r\n        case UIType.Stack: return Stack.deSerialize(node, serializedChild);\r\n        case UIType.Image: return Image.deSerialize(node, serializedChild);\r\n        case UIType.Input: return Input.deSerialize(node, serializedChild);\r\n        case UIType.Label: return Label.deSerialize(node, serializedChild);\r\n        case UIType.Select: return Select.deSerialize(node, serializedChild);\r\n        case UIType.Slider: return Slider.deSerialize(node, serializedChild);\r\n        case UIType.Source: return Source.deSerialize(node, serializedChild);\r\n        case UIType.Toggle: return Toggle.deSerialize(node, serializedChild);\r\n        default: return;\r\n      }\r\n    }));\r\n    return stack;\r\n  }\r\n}\r\n\r\nexport interface StackStyle extends UINodeStyle {\r\n  spacing?: number\r\n}\r\nlet DefaultStackStyle = () => {\r\n  return {\r\n    spacing: 0,\r\n    visible: true\r\n  };\r\n};\r\n\r\nexport interface SerializedStackLayout extends SerializedUINode { }\r\n\r\ninterface StackOptions {\r\n  childs?: UINode[],\r\n  style?: StackStyle,\r\n  id?: string,\r\n  hitColor?: Color\r\n}\r\nlet DefaultStackOptions = () => {\r\n  return {}\r\n};\r\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { Vector } from \"../core/vector\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { get } from \"../utils/utils\";\nimport { Constant } from \"../resource/constants\";\n\nexport class Toggle extends UINode implements Serializable {\n  private _checked: boolean = false;\n\n  get checked(): boolean {\n    if (this.propName) return this.getProp();\n    return this._checked;\n  }\n  set checked(checked: boolean) {\n    let oldVal = this.checked;\n    let newVal = checked;\n\n    if (this.propName)\n      this.setProp(newVal);\n    else\n      this._checked = newVal;\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node,\n    options: ToggleOptions = DefaultToggleOptions(node)\n  ) {\n    super(node, Vector.Zero(), UIType.Toggle, {\n      style: options.style\n        ? { ...DefaultToggleStyle(), ...options.style }\n        : DefaultToggleStyle(),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'boolean', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'boolean', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this._checked = this.propName ? this.getProp() : options.value\n    this.height = get(options.height, this.node.style.rowHeight);\n    if (!this.style.grow) this.width = this.height * 2.5;\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this.checked = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (typeof data !== 'undefined') this.checked = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.checked);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.checked);\n    });\n  }\n\n  paint(): void {\n    let context = this.context;\n    context.strokeStyle = this.style.backgroundColor;\n    context.lineWidth = this.height * .75;\n    context.lineCap = 'round';\n    context.beginPath();\n    context.moveTo(this.position.x + this.context.lineWidth / 2, this.position.y + this.height / 2);\n    context.lineTo(this.position.x + this.width - this.context.lineWidth / 2, this.position.y + this.height / 2);\n    context.stroke();\n\n    context.fillStyle = this.style.color;\n    context.beginPath();\n    context.arc(\n      this.checked ? this.position.x + this.width - this.height / 2 : this.position.x + this.height / 2,\n      this.position.y + this.height / 2, this.height / 2, 0, Constant.TAU\n    );\n    context.fill();\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = this.style.color;\n    context.fillStyle = this.style.backgroundColor;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    this._checked = newVal;\n\n    this.output && this.output.setData(this.checked);\n  }\n  onOver(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.checked = !this.checked;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedToggle {\n    return {\n      checked: this.checked,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedToggle): Toggle {\n    return new Toggle(node, {\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface ToggleOptions {\n  value?: boolean,\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: ToggleStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultToggleOptions = (node: Node): ToggleOptions => {\n  return {\n    value: false,\n    height: node.style.rowHeight * 1.5,\n  }\n};\n\nexport interface ToggleStyle extends UINodeStyle {\n  backgroundColor?: string,\n  color?: string\n}\nlet DefaultToggleStyle = () => {\n  return {\n    backgroundColor: '#999',\n    color: '#000',\n    visible: true\n  };\n};\n\nexport interface SerializedToggle extends SerializedUINode {\n  checked: boolean,\n  height: number\n}\n","import { Color, SerializedColor } from \"../core/color\";\r\nimport { Hooks } from \"../core/hooks\";\r\nimport { Node, NodeState } from \"../core/node\";\r\nimport { SerializedTerminal, Terminal } from \"../core/terminal\";\r\nimport { SerializedVector, Vector } from \"../core/vector\";\r\nimport { LOD, ViewPort } from '../common/enums';\r\nimport { get, getNewUUID, intersects } from \"../utils/utils\";\r\nimport { Events, Renderable } from \"../common/interfaces\";\r\n\r\nexport abstract class UINode extends Hooks implements Events, Renderable {\r\n  private _disabled: boolean;\r\n  private _visible: boolean;\r\n\r\n  renderState: ViewPort;\r\n  hitColor: Color;\r\n  style: any;\r\n  propName: string;\r\n  input: Terminal;\r\n  output: Terminal;\r\n  id: string;\r\n  draggable: boolean;\r\n  zoomable: boolean;\r\n  width: number = 0;\r\n  height: number = 0;\r\n  children: UINode[];\r\n  get context(): CanvasRenderingContext2D { return this.node.context }\r\n  get offUIContext(): OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D { return this.node.offUIContext }\r\n  position: Vector;\r\n\r\n  get disabled(): boolean { return this._disabled }\r\n  set disabled(disabled: boolean) {\r\n    this._disabled = disabled;\r\n    this.children.forEach(child => child.disabled = disabled);\r\n  }\r\n  get visible(): boolean { return this._visible }\r\n  set visible(value: boolean) { this._visible = value; this.node.ui.update(); }\r\n\r\n  constructor(public node: Node, position: Vector, public type: UIType, options: UINodeOptions = DefaultUINodeOptions()) {\r\n    super();\r\n\r\n    this.setHitColor(options.hitColor);\r\n    this.id = get(options.id, getNewUUID());\r\n    this.draggable = get(options.draggable, false);\r\n    this.zoomable = get(options.zoomable, false);\r\n    this._visible = get(options.visible, true);\r\n    this.style = get(options.style, {});\r\n    this.children = [];\r\n    this.position = position;\r\n    this.disabled = false;\r\n    this.propName = options.propName;\r\n    if (this.propName) {\r\n      this.node.watch(this.propName, (oldVal, newVal) => this.onPropChange(oldVal, newVal));\r\n    }\r\n    this.input = options.input;\r\n    this.output = options.output;\r\n\r\n    if (this.input) {\r\n      this.node.inputsUI.push(this.input);\r\n      this.input.on('connect', () => this.disabled = true);\r\n      this.input.on('disconnect', () => this.disabled = false);\r\n    }\r\n    if (this.output) this.node.outputsUI.push(this.output);\r\n  }\r\n\r\n  append(childs: UINode | UINode[]) {\r\n    if (Array.isArray(childs))\r\n      this.children.push(...childs);\r\n    else\r\n      this.children.push(childs);\r\n\r\n    this.update();\r\n\r\n    // To fix a bug, when appending childs to UINodes in-between the tree, UI container's height won't update\r\n    this.node.ui.update();\r\n  }\r\n  update(): void {\r\n    this.reflow();\r\n    this.call('update', this);\r\n    this.children.forEach(child => child.update());\r\n  }\r\n  updateRenderState() {\r\n    if (this.node.renderState.nodeState === NodeState.MINIMIZED) return;\r\n\r\n    let realPos = this.position.transform(this.node.flow.flowConnect.transform);\r\n    this.renderState = intersects(\r\n      0, 0,\r\n      this.node.flow.flowConnect.canvasDimensions.width, this.node.flow.flowConnect.canvasDimensions.height,\r\n      realPos.x, realPos.y,\r\n      realPos.x + this.width * this.node.flow.flowConnect.scale, realPos.y + this.height * this.node.flow.flowConnect.scale\r\n    );\r\n\r\n    this.children.forEach(child => child.updateRenderState());\r\n  }\r\n  private setHitColor(hitColor: Color) {\r\n    if (!hitColor) {\r\n      hitColor = Color.Random();\r\n      while (this.node.uiNodes.get(hitColor.rgbaString) || this.node.terminals.get(hitColor.rgbaString)) hitColor = Color.Random();\r\n    }\r\n    this.hitColor = hitColor;\r\n    this.node.uiNodes.set(this.hitColor.rgbaString, this);\r\n  }\r\n  render() {\r\n    if (!this.visible) return;\r\n    if (this.renderState === ViewPort.OUTSIDE) return;\r\n\r\n    let context = this.context;\r\n    if (this.node.renderState.lod === LOD.LOD1) {\r\n      context.save();\r\n      this.paintLOD1();\r\n      context.restore();\r\n    } else if (this.node.renderState.lod === LOD.LOD2) {\r\n      context.save();\r\n      this.paint();\r\n      context.restore();\r\n\r\n      this.offUIContext.save();\r\n      this.offPaint();\r\n      this.offUIContext.restore();\r\n    } else {\r\n      if (this.type === UIType.Container) {\r\n        context.save();\r\n        this.paintLOD1();\r\n        context.restore();\r\n      }\r\n    }\r\n\r\n    if (this.node.renderState.lod > 0) {\r\n      if (this.input) this.input.render();\r\n      if (this.output) this.output.render();\r\n    }\r\n\r\n    this.call('render', this);\r\n    this.children.forEach(child => child.render());\r\n  }\r\n\r\n  getProp() {\r\n    return this.node.state[this.propName];\r\n  }\r\n  setProp(propValue: any) {\r\n    this.node.state[this.propName] = propValue;\r\n  }\r\n\r\n  query(query: string): Array<UINode> {\r\n    let result = [];\r\n    query = query.trim();\r\n    let queue: UINode[] = [this];\r\n    while (queue.length !== 0) {\r\n      let curr = queue.shift();\r\n      if (curr.type === query) result.push(curr);\r\n      curr.children.forEach(child => queue.push(child));\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  abstract reflow(): void;\r\n  abstract paint(): void;\r\n  abstract paintLOD1(): void;\r\n  abstract offPaint(): void;\r\n\r\n  abstract onOver(screenPosition: Vector, realPosition: Vector): void;\r\n  abstract onDown(screenPosition: Vector, realPosition: Vector): void;\r\n  abstract onUp(screenPosition: Vector, realPosition: Vector): void;\r\n  abstract onClick(screenPosition: Vector, realPosition: Vector): void;\r\n  abstract onDrag(screenPosition: Vector, realPosition: Vector): void;\r\n  abstract onEnter(screenPosition: Vector, realPosition: Vector): void;\r\n  abstract onExit(screenPosition: Vector, realPosition: Vector): void;\r\n  abstract onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector): void;\r\n  abstract onContextMenu(): void;\r\n  abstract onPropChange(oldValue: any, newValue: any): void;\r\n}\r\n\r\nexport interface UINodeStyle {\r\n  grow?: number\r\n}\r\n\r\nexport interface SerializedUINode {\r\n  id: string,\r\n  type: UIType,\r\n  hitColor: SerializedColor,\r\n  style: any,\r\n  propName: string,\r\n  input: SerializedTerminal,\r\n  output: SerializedTerminal,\r\n  childs: any[]\r\n}\r\n\r\nexport enum UIType {\r\n  Button = 'button',\r\n  Container = 'container',\r\n  Display = 'display',\r\n  HorizontalLayout = 'horizontal-layout',\r\n  Stack = 'stack',\r\n  Image = 'image',\r\n  Input = 'input',\r\n  Label = 'label',\r\n  Select = 'select',\r\n  Slider = 'slider',\r\n  Dial = 'dial',\r\n  Source = 'source',\r\n  Toggle = 'toggle',\r\n  Envelope = 'envelope',\r\n  RadioGroup = 'radiogroup',\r\n  Slider2D = 'slider2d',\r\n  VSlider = 'vslider'\r\n}\r\n\r\ninterface UINodeOptions {\r\n  draggable?: boolean,\r\n  zoomable?: boolean,\r\n  visible?: boolean,\r\n  style?: any,\r\n  propName?: string,\r\n  input?: Terminal,\r\n  output?: Terminal,\r\n  id?: string,\r\n  hitColor?: Color\r\n}\r\nlet DefaultUINodeOptions = (): UINodeOptions => {\r\n  return {\r\n    draggable: false,\r\n    zoomable: false,\r\n    visible: true,\r\n    style: {},\r\n    propName: null,\r\n    input: null,\r\n    output: null,\r\n    id: getNewUUID(),\r\n    hitColor: null\r\n  };\r\n};\r\n\r\nexport interface UINodeRenderParams {\r\n  position: SerializedVector,\r\n  width: number,\r\n  height: number\r\n}\r\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { Vector } from \"../core/vector\";\nimport { clamp, denormalize, get, normalize } from \"../utils/utils\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Constant } from \"../resource/constants\";\n\nexport class VSlider extends UINode implements Serializable {\n  private thumbFill: number;\n  private _value: number;\n\n  get value(): number {\n    if (this.propName) return this.getProp();\n    return this._value;\n  }\n  set value(value: number) {\n    value = clamp(value, this.min, this.max);\n\n    let oldVal = this.value;\n    let newVal = value;\n\n    if (this.propName) this.setProp(newVal);\n    else {\n      this._value = newVal;\n      this.reflow();\n    }\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node, public min: number, public max: number,\n    options: VSliderOptions = DefaultVSliderOptions(node)\n  ) {\n    super(node, Vector.Zero(), UIType.VSlider, {\n      draggable: true,\n      style: options.style ? { ...DefaultVSliderStyle(node, options.width), ...options.style } : DefaultVSliderStyle(node, options.width),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'number', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'number', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.height = get(options.height, this.node.style.rowHeight * 5);\n    this.width = get(options.width, this.node.style.rowHeight);\n    this._value = this.propName ? this.getProp() : get(options.value, min);\n    this._value = clamp(this._value, this.min, this.max);\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this.value = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (data) this.value = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.value);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.value);\n    });\n  }\n\n  paint(): void {\n    let context = this.context;\n    context.lineWidth = this.style.railWidth;\n    context.strokeStyle = this.style.color;\n    context.lineCap = 'butt';\n\n    let start = Math.max(this.position.y, this.position.y + this.thumbFill - 3);\n    if (start !== this.position.y) {\n      context.beginPath();\n      context.moveTo(this.position.x + this.width / 2, this.position.y);\n      context.lineTo(this.position.x + this.width / 2, start);\n      context.stroke();\n    }\n    start = Math.min(this.position.y + 2 * this.style.thumbRadius + this.thumbFill + 3, this.position.y + this.height);\n    if (start !== (this.position.y + this.height)) {\n      context.beginPath();\n      context.moveTo(this.position.x + this.width / 2, start);\n      context.lineTo(this.position.x + this.width / 2, this.position.y + this.height);\n      context.stroke();\n    }\n\n    context.fillStyle = this.style.thumbColor;\n    context.beginPath();\n    context.arc(\n      this.position.x + this.width / 2,\n      this.position.y + this.style.thumbRadius + this.thumbFill, this.style.thumbRadius, 0, Constant.TAU\n    );\n    context.fill();\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = '#000';\n    context.fillStyle = this.style.color;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    this.thumbFill = denormalize(1 - normalize(this.value, this.min, this.max), 0, this.height - 2 * this.style.thumbRadius);\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    this._value = newVal;\n    this.reflow();\n\n    this.output && this.output.setData(this.value);\n  }\n  onOver(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector, realPosition: Vector): void {\n    if (this.disabled) return;\n\n    let x = this.position.x + this.width / 2 - this.style.railWidth / 2;\n    this.thumbFill = realPosition\n      .clamp(x, x, this.position.y + this.style.thumbRadius, this.position.y + this.height - this.style.thumbRadius)\n      .subtractInPlace(0, this.position.y + this.style.thumbRadius)\n      .y;\n\n    this.value = denormalize(1 - normalize(this.thumbFill, 0, this.height - 2 * this.style.thumbRadius), this.min, this.max);\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector, realPosition: Vector) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedVSlider {\n    return {\n      min: this.min,\n      max: this.max,\n      value: this.value,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      width: this.width,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedVSlider) {\n    return new VSlider(node, data.min, data.max, {\n      value: data.value,\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      width: data.width,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface VSliderStyle extends UINodeStyle {\n  railWidth?: number,\n  thumbRadius?: number,\n  color?: string,\n  thumbColor?: string\n}\nlet DefaultVSliderStyle = (node: Node, width: number) => {\n  return {\n    color: '#444',\n    thumbColor: '#000',\n    railWidth: 4,\n    thumbRadius: typeof width !== 'undefined' ? width / 2 : (node.style.rowHeight * 1.5) / 2\n  }\n}\n\nexport interface SerializedVSlider extends SerializedUINode {\n  min: number,\n  max: number,\n  value: number,\n  height: number,\n  width: number\n}\n\ninterface VSliderOptions {\n  value?: number,\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  width?: number,\n  style?: VSliderStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultVSliderOptions = (node: Node): VSliderOptions => {\n  return {\n    height: node.style.rowHeight * 5,\n    width: node.style.rowHeight\n  }\n};\n","export class AVLTree<T> {\n  root: AVLTreeNode<T>;\n  dataRefToTreeNode: Record<string, AVLTreeNode<T>>;\n  size: number;\n\n  constructor(public comparator: (a: T, b: T) => number, public dataToTreeNodeMapper: (data: T) => string) {\n    this.root = null;\n    this.dataRefToTreeNode = {};\n    this.size = 0;\n  }\n\n  height(node: AVLTreeNode<T>) {\n    if (!node) return 0;\n    return node.height;\n  }\n  rightRotate(node: AVLTreeNode<T>) {\n    let newRoot = node.left;\n    node.left = newRoot.right;\n    newRoot.right = node;\n\n    node.height = Math.max(node.left ? node.left.height : 0, node.right ? node.right.height : 0) + 1;\n    newRoot.height = Math.max(newRoot.left ? newRoot.left.height : 0, newRoot.right ? newRoot.right.height : 0) + 1;\n\n    return newRoot;\n  }\n  leftRotate(node: AVLTreeNode<T>) {\n    let newRoot = node.right;\n    node.right = newRoot.left;\n    newRoot.left = node;\n\n    node.height = Math.max(node.left ? node.left.height : 0, node.right ? node.right.height : 0) + 1;\n    newRoot.height = Math.max(newRoot.left ? newRoot.left.height : 0, newRoot.right ? newRoot.right.height : 0) + 1;\n\n    return newRoot;\n  }\n  getBalance(node: AVLTreeNode<T>) {\n    if (!node) return 0;\n    return (node.left ? node.left.height : 0) - (node.right ? node.right.height : 0);\n  }\n\n  add(data: T): AVLTreeNode<T> {\n    let res: { node: AVLTreeNode<T> } = { node: null };\n    this.root = this._insert(this.root, data, res);\n    this.dataRefToTreeNode[this.dataToTreeNodeMapper(data)] = res.node;\n    this.size += 1;\n    return res.node;\n  }\n  private _insert(node: AVLTreeNode<T>, data: T, res: { node: AVLTreeNode<T> }): AVLTreeNode<T> {\n    if (!node) {\n      let newNode = new AVLTreeNode([data]);\n      res.node = newNode;\n      return newNode;\n    }\n\n    // Duplicate Keys\n    if (this.comparator(data, node.data[0]) === 0) {\n      node.data.push(data);\n      res.node = node;\n      return node;\n    }\n\n    if (this.comparator(data, node.data[0]) < 0) node.left = this._insert(node.left, data, res);\n    else node.right = this._insert(node.right, data, res);\n\n    node.height = 1 + Math.max(node.left ? node.left.height : 0, node.right ? node.right.height : 0);\n    let balance = this.getBalance(node);\n\n    if (balance > 1 && this.comparator(data, node.left.data[0]) < 0) return this.rightRotate(node);\n    if (balance > 1 && this.comparator(data, node.left.data[0]) > 0) {\n      node.left = this.leftRotate(node.left);\n      return this.rightRotate(node);\n    }\n    if (balance < -1 && this.comparator(data, node.right.data[0]) > 0) return this.leftRotate(node);\n    if (balance < -1 && this.comparator(data, node.right.data[0]) < 0) {\n      node.right = this.rightRotate(node.right);\n      return this.leftRotate(node);\n    }\n\n    return node;\n  }\n\n  remove(data: T): boolean {\n    let res: { deleted: boolean } = { deleted: false };\n    this.root = this._delete(this.root, data, res);\n    delete this.dataRefToTreeNode[this.dataToTreeNodeMapper(data)];\n    this.size -= 1;\n    return res.deleted;\n  }\n  private _delete(node: AVLTreeNode<T>, data: T, res: { deleted: boolean }): AVLTreeNode<T> {\n    if (!node) return node;\n\n    if (this.comparator(data, node.data[0]) < 0) node.left = this._delete(node.left, data, res);\n    else if (this.comparator(data, node.data[0]) > 0) node.right = this._delete(node.right, data, res);\n    else {\n      // Duplicate Keys\n      if (node.data.length > 1) {\n        let index = node.data.findIndex(currData => this.dataToTreeNodeMapper(currData) === this.dataToTreeNodeMapper(data));\n        if (index > -1) {\n          node.data.splice(index, 1);\n          res.deleted = true;\n        } else {\n          res.deleted = false;\n        }\n        return node;\n      } else {\n        if (!node.left || !node.right) {\n          let temp = null;\n          if (!node.left) temp = node.right;\n          else temp = node.left;\n\n          if (!temp) {\n            // temp = node;\n            node = null;\n          } else node = temp;\n          res.deleted = true;\n        } else {\n          let temp = this.minValue(node.right);\n          node.data = temp.data;\n          node.right = this._delete(node.right, temp.data[0], res);\n          res.deleted = true;\n        }\n      }\n    }\n    if (!node) return node;\n\n    node.height = Math.max(node.left ? node.left.height : 0, node.right ? node.right.height : 0) + 1;\n    let balance = this.getBalance(node);\n\n    if (balance > 1 && this.getBalance(node.left) >= 0) return this.rightRotate(node);\n    if (balance > 1 && this.getBalance(node.left) < 0) {\n      node.left = this.leftRotate(node.left);\n      return this.rightRotate(node);\n    }\n    if (balance < -1 && this.getBalance(node.right) <= 0) return this.leftRotate(node);\n    if (balance < -1 && this.getBalance(node.right) > 0) {\n      node.right = this.rightRotate(node.right);\n      return this.leftRotate(node);\n    }\n    return node;\n  }\n\n  minValue(node: AVLTreeNode<T>) {\n    let curr = node;\n    while (curr.left) curr = curr.left;\n    return curr;\n  }\n  forEach(action: (item: T) => void) {\n    this._inorder(this.root, action);\n  }\n\n  private _inorder(node: AVLTreeNode<T>, action: (item: T) => void) {\n    if (node !== null) {\n      this._inorder(node.left, action);\n      node.data.forEach(data => action(data));\n      this._inorder(node.right, action);\n    }\n  }\n  private _reverseInorder(node: AVLTreeNode<T>, action: (item: T) => void) {\n    if (node !== null) {\n      this._inorder(node.right, action);\n      node.data.forEach(data => action(data));\n      this._inorder(node.left, action);\n    }\n  }\n}\n\n\nexport class AVLTreeNode<T> {\n  height: number;\n  left: AVLTreeNode<T>;\n  right: AVLTreeNode<T>;\n\n  constructor(public data: T[]) {\n    this.height = 1;\n    this.left = null;\n    this.right = null;\n  }\n}\n","// This is strictly for one-to-one mapping, many-to-one mapping will not work\nexport class BiMap<K, V> {\n  map: Map<K | V, V | K>;\n  reverseMap: Map<V | K, K | V>;\n\n  constructor() {\n    this.map = new Map();\n    this.reverseMap = new Map();\n  }\n\n  get(keyOrVal: K | V): V | K {\n    return this.map.get(keyOrVal) || this.reverseMap.get(keyOrVal);\n  }\n  set(key: K | V, value: V | K) {\n    this.map.set(key, value);\n    this.reverseMap.set(value, key);\n  }\n  has(keyOrVal: K | V): boolean {\n    return this.map.has(keyOrVal) || this.reverseMap.has(keyOrVal);\n  }\n  delete(keyOrVal: K | V) {\n    let temp1 = this.map.get(keyOrVal);\n    let temp2 = this.reverseMap.get(keyOrVal);\n    if (typeof temp1 !== 'undefined') { this.map.delete(keyOrVal); }\n    if (typeof temp2 !== 'undefined') { this.reverseMap.delete(keyOrVal); }\n\n    // I have a gut feeling that this is required, for some edge case that I cannot grab from my subconscious mind\n    this.map.delete(temp1);\n    this.reverseMap.delete(temp1);\n    this.map.delete(temp2);\n    this.reverseMap.delete(temp2);\n  }\n  clear() {\n    this.map.clear();\n    this.reverseMap.clear();\n  }\n}\n","import { Token, TokenType } from \"./lexer\";\nimport { Constant } from \"../resource/constants\";\nimport { Parser } from \"./parser\";\n\nexport class Evaluator {\n  parser: Parser;\n  static constants = {\n    tau: Constant.TAU,\n    pi: Math.PI,\n    phi: Constant.PHI,\n    ln2: Math.LN2,\n    ln10: Math.LN10,\n    log2e: Math.LOG2E,\n    log10e: Math.LOG10E,\n  };\n  static functions = {\n    cos: Math.cos,\n    acos: Math.acos,\n    acosh: Math.acosh,\n    sin: Math.sin,\n    asin: Math.asin,\n    asinh: Math.asinh,\n    tan: Math.tan,\n    atan: Math.atan,\n    atanh: Math.atanh,\n    atan2: Math.atan2,\n    abs: Math.abs,\n    ceil: Math.ceil,\n    round: Math.round,\n    floor: Math.floor,\n    exp: Math.exp,\n    random: Math.random,\n    sqrt: Math.sqrt,\n    cbrt: Math.cbrt,\n    log10: Math.log10,\n    log2: Math.log2,\n    log: (value: number, base?: number) => { return base ? (Math.log(value) / Math.log(base)) : Math.log(value); },\n    dist: (x1: number, y1: number, x2: number, y2: number) => { return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)); },\n    gcd: (a: number, b: number) => { while (b !== 0) { const r = a % b; a = b; b = r; } return a < 0 ? -a : a; },\n    max: (...args: any[]) => { return Array.isArray(args[0]) ? Math.max(...args[0]) : Math.max(...args) },\n    min: (...args: any[]) => { return Array.isArray(args[0]) ? Math.min(...args[0]) : Math.min(...args) },\n    hypot: (...args: number[]) => {\n      let result = 0;\n      let largest = 0;\n      let input = Array.isArray(args[0]) ? args[0] : args;\n      input.forEach(x => {\n        const value = Math.abs(x);\n        if (largest < value) {\n          result = result * (largest / value) * (largest / value);\n          result += 1;\n          largest = value;\n        } else {\n          result = result + (value > 0 ? ((value / largest) * (value / largest)) : value);\n        }\n      });\n      return largest * Math.sqrt(result);\n    },\n    lcm: (a: number, b: number) => {\n      if (a === 0) return a;\n      if (b === 0) return b;\n      const prod = a * b;\n      while (b !== 0) { const t = b; b = a % t; a = t; }\n      return Math.abs(prod / a);\n    },\n    sum: (...args: any[]) => {\n      let input = Array.isArray(args[0]) ? args[0] : args;\n      return input.reduce((acc, curr) => acc + curr, 0);\n    },\n    mean: (...args: any[]) => {\n      let input = Array.isArray(args[0]) ? args[0] : args;\n      return Evaluator.functions.sum(input) / input.length\n    },\n    median: (...args: any[]) => {\n      let input = Array.isArray(args[0]) ? args[0] : args;\n      input.sort((a, b) => a - b);\n      return input.length % 2 === 0 ? (input[input.length / 2 - 1] + input[input.length / 2]) / 2 : input[Math.floor(input.length / 2)];\n    },\n    std: (...args: any[]) => {\n      let input = Array.isArray(args[0]) ? args[0] : args;\n      return Math.sqrt(Evaluator.functions.var(input));\n    },\n    var: (...args: any[]) => {\n      let input = Array.isArray(args[0]) ? args[0] : args;\n      let mean = Evaluator.functions.mean(input);\n      return input.reduce((acc, curr) => acc + Math.pow(curr - mean, 2), 0) / input.length;\n    },\n    fact: (n: number) => {\n      let res = 1;\n      for (let i = n; i > 1; i -= 1) res *= i;\n      return res;\n    }\n  };\n  static multiargFunctions = ['max', 'min', 'hypot', 'sum', 'mean', 'median', 'std', 'var'];\n\n  // Optimization: If the curr expr is present in history\n  // no need to invoke lexer and parser, get postfix tokens array from here\n  history: Record<string, Token[]> = {};\n  orderedExprs: string[] = [];\n  historyLimit: number = 3;\n\n  constructor(public variables: Record<string, any>) { this.parser = new Parser(); }\n\n  evaluate(expr: string, index?: number) {\n    let postFix;\n    if (this.history[expr]) postFix = this.history[expr];\n    else {\n      if (this.orderedExprs.length === this.historyLimit) {\n        let oldestExpr = this.orderedExprs.shift();\n        delete this.history[oldestExpr];\n      }\n      this.orderedExprs.push(expr);\n      this.history[expr] = this.parser.parse(expr);\n      postFix = this.history[expr];\n    }\n    let result: number[] = [];\n\n    for (let token of postFix) {\n      switch (token.type) {\n        case TokenType.Literal: {\n          result.push(token.value as number);\n          break;\n        }\n        case TokenType.Variable: {\n          // Character is uppercase = expression contained spread operator e.g ...a => A (this is done in lexical analysis)\n          if (token.value !== (token.value as string).toLowerCase()) {\n            if (!Array.isArray(this.variables[token.value])) {\n              throw new Error('Spread operator only allowed for array variables: ' + (token.value as string).toLowerCase());\n            } else result.push(this.variables[token.value]);\n          } else {\n            if (Array.isArray(this.variables[token.value]) && typeof index !== 'undefined') {\n              result.push(this.variables[token.value][index]);\n            } else {\n              result.push(this.variables[token.value]);\n            }\n          }\n          break;\n        }\n        case TokenType.Operator: {\n          let [left, right] = [result.pop(), result.pop()];\n          if (typeof left !== 'number' || typeof right !== 'number') throw new Error('Only numbers are allowed for operators');\n\n          switch (token.value) {\n            case '+': { result.push(left + right); break; }\n            case '*': { result.push(left * right); break; }\n            case '-': { result.push(right - left); break; }\n            case '/': { result.push(right / left); break; }\n            case '%': { result.push(right % left); break; }\n            case '^': { result.push(Math.pow(right, left)); break; }\n            case '&': { result.push(right & left); break; }\n            case '|': { result.push(right | left); break; }\n            default: throw new Error('Unknow operator: ' + token.value);\n          }\n          break;\n        }\n        case TokenType.Function: {\n          let args = [];\n          for (let i = 0; i < token.count; i += 1) args.push(result.pop());\n          result.push((Evaluator.functions as any)[token.value](...args));\n          break;\n        }\n        default: throw new Error('Unknown token type: ' + token.type);\n      }\n    }\n\n    return result[0];\n  }\n}\n","export * from './avl-tree';\nexport * from './evaluator';\nexport * from './lexer';\nexport * from './linked-list';\nexport * from './logger';\nexport * from './parser';\nexport * from './utils';\nexport * from './bidirectional-map';\n","import { Evaluator } from \"./evaluator\";\n\nexport class Lexer {\n  static operators = ['+', '-', '*', '/', '^', '%', '&', '|'];\n  private result: Token[] = [];\n  private numberBuffer: string[] = [];\n  private letterBuffer: string[] = [];\n\n  constructor() { /**/ }\n\n  tokenize(expr: string) {\n    this.result = [];\n    this.numberBuffer = [];\n    this.letterBuffer = [];\n\n    // Replace all variable spread operators with their equivalent capital letter\n    let index;\n    while ((index = expr.indexOf('...')) !== -1) {\n      expr = expr.substring(0, index) + expr.charAt(index + 3).toUpperCase() + expr.substring(index + 4);\n    }\n\n    expr = this.replaceConstants(expr);\n    let chars = expr.replace(/\\s+/g, \"\").split(\"\");\n\n    chars.forEach(char => {\n      if (this.isDigit(char)) {\n        this.numberBuffer.push(char);\n      } else if (this.isDecimalPoint(char)) {\n        this.numberBuffer.push(char);\n      } else if (this.isLetter(char)) {\n        if (this.numberBuffer.length) {\n          this.processNumberBuffer();\n          this.result.push(new Token(TokenType.Operator, '*'));\n        }\n\n        this.letterBuffer.push(char);\n      } else if (this.isOperator(char)) {\n        if (this.numberBuffer.length) this.processNumberBuffer();\n        else if (this.letterBuffer.length) this.processLetterBuffer();\n\n        this.result.push(new Token(TokenType.Operator, char));\n      } else if (this.isLeftParenthesis(char)) {\n        if (this.letterBuffer.length) {\n          this.result.push(new Token(TokenType.Function, this.letterBuffer.join('')));\n          this.letterBuffer = [];\n        } else if (this.numberBuffer.length) {\n          this.processNumberBuffer();\n          this.result.push(new Token(TokenType.Operator, '*'));\n        }\n\n        this.result.push(new Token(TokenType.LParenthesis, char));\n      } else if (this.isRightParenthesis(char)) {\n        if (this.letterBuffer.length) this.processLetterBuffer();\n        if (this.numberBuffer.length) this.processNumberBuffer();\n\n        this.result.push(new Token(TokenType.RParenthesis, char));\n      } else if (this.isComma(char)) {\n        if (this.numberBuffer.length) this.processNumberBuffer();\n        if (this.letterBuffer.length) this.processLetterBuffer();\n\n        this.result.push(new Token(TokenType.ArgSeperator, char));\n      } else throw Error('Unknown character: ' + char);\n    });\n    if (this.numberBuffer.length) this.processNumberBuffer();\n    if (this.letterBuffer.length) this.processLetterBuffer();\n\n    return this.result;\n  }\n  private replaceConstants(expr: string) {\n    return expr\n      .replace(/pi/g, Evaluator.constants.pi.toString())\n      .replace(/tau/g, Evaluator.constants.tau.toString())\n      .replace(/phi/g, Evaluator.constants.phi.toString())\n      .replace(/ln2/g, Evaluator.constants.ln2.toString())\n      .replace(/ln10/g, Evaluator.constants.ln10.toString())\n      .replace(/log2e/g, Evaluator.constants.log2e.toString())\n      .replace(/log10e/g, Evaluator.constants.log10e.toString());\n  }\n  private processNumberBuffer() {\n    let literal = parseFloat(this.numberBuffer.join(''));\n    this.numberBuffer = [];\n    if (!isNaN(literal)) { this.result.push(new Token(TokenType.Literal, literal)); }\n  }\n  private processLetterBuffer() {\n    for (var i = 0; i < this.letterBuffer.length; i++) {\n      this.result.push(new Token(TokenType.Variable, this.letterBuffer[i]));\n      if (i < this.letterBuffer.length - 1) this.result.push(new Token(TokenType.Operator, '*'));\n    }\n    this.letterBuffer = [];\n  }\n  private isComma(char: string) { return (char === \",\"); }\n  private isDigit(char: string) { return /\\d/.test(char); }\n  private isLetter(char: string) { return /[a-zA-Z]/.test(char); }\n  private isOperator(char: string) { return Lexer.operators.includes(char); }\n  private isLeftParenthesis(char: string) { return char === \"(\" }\n  private isRightParenthesis(char: string) { return char == \")\" }\n  private isDecimalPoint(char: string) { return char === '.' }\n}\n\nexport enum TokenType {\n  Literal = 'Literal',\n  Variable = 'Variable',\n  Operator = 'Operator',\n  LParenthesis = 'LParenthesis',\n  RParenthesis = 'RParenthesis',\n  Function = 'Function',\n  ArgSeperator = 'ArgSeperator'\n}\n\nexport class Token {\n  static associativity = {\n    '^': 'right',\n    '*': 'left',\n    '/': 'left',\n    '+': 'left',\n    '-': 'left',\n    '%': 'left',\n    '&': 'left',\n    '|': 'left'\n  };\n  static precedence = {\n    '|': 0,\n    '&': 1,\n    '+': 2,\n    '-': 2,\n    '*': 3,\n    '/': 3,\n    '%': 3,\n    '^': 4\n  };\n\n  count: number;\n  get precedence(): number { return (Token.precedence as any)[this.value]; }\n  get associativity(): string { return (Token.associativity as any)[this.value]; }\n\n  constructor(public type: TokenType, public value: string | number) { this.count = 0; }\n\n  toString(): string { return this.type + '(' + this.value + ')'; }\n}\n","import { Hooks } from \"../core/hooks\";\n\nexport class List<T> extends Hooks {\n  head: ListNode<T> = null;\n  tail: ListNode<T> = null;\n  length: number = 0;\n\n  constructor(public comparator?: (a: T, b: T) => number, source?: Array<T>) {\n    super();\n    if (source) source.forEach(value => this.append(value));\n  }\n\n  prepend(data: T) {\n    let newNode = new ListNode(data);\n    if (this.head === null) {\n      this.head = newNode;\n      this.tail = newNode;\n    } else {\n      this.head.prev = newNode;\n      newNode.next = this.head;\n      this.head = newNode;\n    }\n\n    this.length += 1;\n    this.call('prepend', this, newNode);\n    return newNode;\n  }\n  append(data: T | ListNode<T>) {\n    let newNode = data instanceof ListNode ? data : new ListNode(data);\n    if (this.tail === null) {\n      this.head = newNode;\n      this.tail = newNode;\n    } else {\n      this.tail.next = newNode;\n      newNode.prev = this.tail;\n      this.tail = newNode;\n    }\n\n    this.length += 1;\n    this.call('append', this, newNode);\n    return newNode;\n  }\n  removeFirst(hook: boolean = true): T {\n    let removed;\n    if (this.head === null) return null;\n    else if (this.length === 1) {\n      removed = this.head.data;\n      this.head = null;\n      this.tail = null;\n    } else {\n      removed = this.head.data;\n      this.head.next.prev = null;\n      this.head = this.head.next;\n    }\n\n    this.length -= 1;\n    if (hook) this.call('removefirst', this, removed);\n    return removed;\n  }\n  removeLast(): T {\n    let removed;\n    if (this.tail === null) return null;\n    else if (this.length === 1) {\n      removed = this.tail.data;\n      this.head = null;\n      this.tail = null;\n    } else {\n      removed = this.tail.data;\n      this.tail.prev.next = null;\n      this.tail = this.tail.prev;\n    }\n\n    this.length -= 1;\n    this.call('removelast', this, removed);\n    return removed;\n  }\n  addAfter(data: T, node: ListNode<T>): ListNode<T> {\n    let newNode = new ListNode<T>(data);\n    newNode.next = node.next;\n    newNode.prev = node;\n    node.next = newNode;\n    if (newNode.next) newNode.next.prev = newNode;\n    if (node === this.tail) this.tail = newNode;\n    this.length += 1;\n\n    return newNode;\n  }\n  addBefore(data: T, node: ListNode<T>): ListNode<T> {\n    let newNode = new ListNode<T>(data);\n    newNode.prev = node.prev;\n    newNode.next = node;\n    node.prev = newNode;\n    if (newNode.prev) newNode.prev.next = newNode;\n    if (node === this.head) this.head = newNode;\n    this.length += 1;\n\n    return newNode;\n  }\n  delete(node: ListNode<T>) {\n    if (this.length === 1) {\n      this.head = null;\n      this.tail = null;\n    }\n    else if (node === this.head)\n      this.removeFirst();\n    else if (node === this.tail)\n      this.removeLast();\n    else {\n      if (node.prev) node.prev.next = node.next;\n      if (node.next) node.next.prev = node.prev;\n      this.length -= 1;\n    }\n  }\n  searchHead(callback: (node: ListNode<T>) => boolean): ListNode<T> {\n    let curr = this.head;\n    while (curr !== null) {\n      if (callback(curr)) return curr;\n      curr = curr.next;\n    }\n    return null;\n  }\n  searchTail(callback: (node: ListNode<T>) => boolean): ListNode<T> {\n    let curr = this.tail;\n    while (curr !== null) {\n      if (callback(curr)) return curr;\n      curr = curr.prev;\n    }\n    return null;\n  }\n  get(index: number): T {\n    if (index >= this.length) return null;\n    else if (index === 0) return this.head ? this.head.data : null;\n    else if (index === (this.length - 1)) return this.tail ? this.tail.data : null;\n    else {\n      let count = 0;\n      let curr = this.head;\n      while (curr !== null) {\n        if (count === index) return curr.data;\n        count += 1;\n        curr = curr.next;\n      }\n      return null;\n    }\n  }\n\n  forEach(callback: (node: ListNode<T>) => void) {\n    let curr = this.head;\n    while (curr !== null) {\n      callback(curr);\n      curr = curr.next;\n    }\n  }\n  map(callback: (node: ListNode<T>) => any): any[] {\n    let mapped: any[] = [];\n    this.forEach(node => mapped.push(callback(node)));\n    return mapped;\n  }\n  toArray(): T[] {\n    let data: T[] = [];\n    this.forEach(node => data.push(node.data));\n    return data;\n  }\n  toString(): string {\n    return this.toArray().join(', ');\n  }\n}\n\nexport class ListNode<T> {\n  prev: ListNode<T>;\n  next: ListNode<T>;\n  data: T;\n\n  constructor(data?: T) {\n    this.prev = null;\n    this.next = null;\n    this.data = data ? data : null;\n  }\n}\n","export enum LogLevel {\n  TRACE = 1, DEBUG = 2, WARN = 3, INFO = 4, LOG = 5, ERROR = 6, DISABLED = 7\n}\n\nexport class Log {\n  static LOG_LEVEL: LogLevel = LogLevel.INFO;\n\n  static trace(...args: any): void {\n    if (this.LOG_LEVEL > LogLevel.TRACE) return;\n    console.trace.apply(this, args);\n  }\n  static debug(...args: any): void {\n    if (this.LOG_LEVEL > LogLevel.DEBUG) return;\n    console.debug.apply(this, args);\n  }\n  static warn(...args: any): void {\n    if (this.LOG_LEVEL > LogLevel.WARN) return;\n    console.warn.apply(this, args);\n  }\n  static info(...args: any): void {\n    if (this.LOG_LEVEL > LogLevel.INFO) return;\n    console.info.apply(this, args);\n  }\n  static log(...args: any): void {\n    if (this.LOG_LEVEL > LogLevel.LOG) return;\n    console.log.apply(this, args);\n  }\n  static error(...args: any): void {\n    if (this.LOG_LEVEL > LogLevel.ERROR) return;\n    console.error.apply(this, args);\n  }\n}\n","import { Lexer, Token, TokenType } from \"./lexer\";\n\nexport class Parser {\n  lexer: Lexer;\n\n  constructor() { this.lexer = new Lexer(); }\n\n  private peek(arr: any[]) { return arr.slice(-1)[0]; }\n\n  parse(expression: string) {\n    let tokens = this.lexer.tokenize(expression);\n    let stack: Token[] = [];\n    let output: Token[] = [];\n    let were: boolean[] = [];\n    let argCount: number[] = [];\n\n    tokens.forEach(token => {\n      if (token.type === TokenType.Literal || token.type === TokenType.Variable) {\n        output.push(token);\n        if (typeof this.peek(were) !== 'undefined') {\n          were.pop();\n          were.push(true);\n        }\n      } else if (token.type === TokenType.Function) {\n        stack.push(token);\n        argCount.push(0);\n        if (typeof this.peek(were) !== 'undefined') {\n          were.pop();\n          were.push(true);\n        }\n        were.push(false);\n      } else if (token.type === TokenType.ArgSeperator) {\n        while (this.peek(stack) && this.peek(stack).type !== TokenType.LParenthesis) {\n          output.push(stack.pop());\n        }\n        let w = were.pop();\n        if (w) { argCount.push(argCount.pop() + 1); }\n        were.push(false);\n      } else if (token.type == TokenType.Operator) {\n        while (this.peek(stack) && (this.peek(stack).type === TokenType.Operator)\n          && (\n            (token.associativity === \"left\" && token.precedence <= this.peek(stack).precedence)\n            || (token.associativity === \"right\" && token.precedence < this.peek(stack).precedence)\n          )\n        ) {\n          output.push(stack.pop());\n        }\n        stack.push(token);\n      } else if (token.type === TokenType.LParenthesis) {\n        stack.push(token);\n      } else if (token.type === TokenType.RParenthesis) {\n        while (this.peek(stack) && this.peek(stack).type !== TokenType.LParenthesis) {\n          output.push(stack.pop());\n        }\n        stack.pop();\n\n        if (this.peek(stack) && this.peek(stack).type === TokenType.Function) {\n          let funcToken = stack.pop();\n          let a = argCount.pop();\n          let w = were.pop();\n          if (w) { a += 1; }\n          funcToken.count = a;\n          output.push(funcToken);\n        }\n      }\n    });\n    while (this.peek(stack)) { output.push(stack.pop()); }\n\n    return output;\n  }\n}\n","import { Graph } from \"../core/graph\";\nimport { Rules } from \"../common/interfaces\";\nimport { Terminal } from \"../core/terminal\";\nimport { ViewPort } from \"../common/enums\";\n\nexport const getNewUUID = () => {\n  var S4 = () => (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\n  return (S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4());\n}\nexport const normalize = (value: number, min: number, max: number) => {\n  if (min === max) return 1;\n  return (value - min) / (max - min);\n}\nexport const denormalize = (normalized: number, min: number, max: number) => {\n  return (max - min) * normalized + min;\n}\nexport const getRandom = (min: number, max: number) => {\n  return Math.random() * (max - min) + min;\n}\nexport const intersects = (start1X: number, start1Y: number, end1X: number, end1Y: number, start2X: number, start2Y: number, end2X: number, end2Y: number): ViewPort => {\n  let res = !(start2X > end1X || end2X < start1X || start2Y > end1Y || end2Y < start1Y);\n  if (res) {\n    if (!(start2X < start1X || start2Y < start1Y || end2X > end1X || end2Y > end1Y)) return ViewPort.INSIDE;\n    else return ViewPort.INTERSECT;\n  } else return ViewPort.OUTSIDE;\n}\nexport const clamp = (value: number, min: number, max: number): number => {\n  return Math.min(Math.max(value, min), max);\n}\nexport const lerp = (a: number, b: number, t: number): number => {\n  return (1 - t) * a + t * b;\n}\nexport const canConnect = (source: Terminal, destination: Terminal, rules: Rules, executionGraph: Graph) => {\n  if (!destination) return false;\n  if (source === destination) return false;\n  if (source.node === destination.node) return false;\n  if (source.type === destination.type) return false;\n  if (!rules[source.dataType].includes(destination.dataType)) return false;\n  if (!executionGraph.canConnect(source.node, destination.node)) return false;\n  return true;\n}\nexport const isEmpty = (obj: any): boolean => {\n  for (let _ in obj) return false;\n  return true;\n}\nexport const isInRange = (value: number, min: number, max: number): boolean => {\n  return Math.min(value, min) >= min && Math.max(value, max) <= max;\n}\nexport const exists = (value: any): boolean => {\n  return typeof value !== 'undefined' && value !== null;\n}\nexport const get = <T>(value: T, defaultVal: T): T => {\n  if (!exists(value)) return defaultVal;\n  return value;\n}\nexport const binarySearch = ({ max, getValue, match }: { max: number, getValue: Function, match: number }) => {\n  let min = 0;\n  while (min <= max) {\n    let mid = Math.floor((min + max) / 2);\n    const curr = getValue(mid);\n\n    if (curr === match) return mid;\n    if (curr < match) min = mid + 1;\n    else max = mid - 1;\n  }\n  return max;\n}\nexport const noop = () => { /**/ };\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t833: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkflow_connect\"] = self[\"webpackChunkflow_connect\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(6184);\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["root","factory","exports","module","define","amd","a","i","self","deferred","ViewPort","LOD","Align","GlobalEventType","Color","constructor","rgba","this","rgbaValue","hexValue","rgbaToHex","rgbaString","rgbaToString","rgbaCSSString","rgbaToCSSString","isEqual","color","static","Uint8ClampedArray","Math","floor","getRandom","hex","parseInt","slice","c","toString","length","_componentToHex","normalize","toFixed","colors","Array","isArray","Log","error","colorObjs","forEach","push","hexToRGBA","t","clamp","index","start","end","ceil","startColor","endColor","map","component","lerp","round","serialize","data","Connector","Hooks","flow","options","DefaultConnectorOptions","super","renderResolver","style","DefaultConnectorStyle","id","get","getNewUUID","floatingTip","startNode","node","endNode","connectors","removeConnection","isDeserialization","executionGraph","connect","onConnect","_data","call","state","FlowState","Stopped","setDirty","completeConnection","destination","includes","currHitTerminal","onExit","splice","indexOf","removeConnector","setData","canConnect","other","source","firstTerminal","type","TerminalType","IN","rules","dataType","render","context","flowConnect","save","flowRenderResolver","connector","flowConnectRenderResolver","_render","getRenderParams","restore","offContext","_offRender","params","ax","x","ay","y","dx","dy","offset","Vector","Distance","bx","by","cx","cy","midx","midy","border","strokeStyle","borderColor","lineWidth","width","beginPath","moveTo","quadraticCurveTo","stroke","renderState","nodeState","NodeState","MAXIMIZED","position","terminalStripMargin","radius","titleHeight","startId","endId","startNodeId","endNodeId","Flow","name","terminalColors","globalEvents","parentFlow","listeners","nodes","Map","groups","nodeHitColors","groupHitColors","sortedNodes","AVLTree","b","zIndex","inputs","outputs","Graph","registerListeners","on","Running","deregisterListeners","off","existsInFlow","values","subFlow","addInput","flowInput","TunnelNode","proxyTerminal","getData","set","add","addOutput","flowOutput","addSubFlow","Zero","subFlowNode","SubFlowNode","inputNode","outputNode","createNode","inTerminals","outTerminals","DefaultNodeOptions","Node","terminalStyle","removeNode","nodeOrID","inputsUI","outputsUI","filter","terminal","isConnected","disconnect","group","findIndex","currNode","delete","remove","floatingConnector","removeAllFocus","focused","stop","order","graphNode","flowNode","input","output","serializedNode","deSerialize","serializedGroup","Group","serializedInput","serializedOutput","serializedConnector","startTerminal","concat","find","endTerminal","graphNodes","dirtyNodes","GraphNode","sourceNode","destinationNode","startGraphNode","endGraphNode","childs","updateOrder","sourceGraphNode","destinationGraphNode","connectedEndNodes","Set","has","maxOrderOfConnectedStartNodes","reduce","acc","curr","max","_updateOrder","queue","shift","child","async","runAll","size","lowestDirty","Idle","Promise","all","resolve","run","clearDirty","lowestOrder","min","propagate","callback","List","append","currGNode","removeFirst","debugNode","indent","console","log","debugGraph","nodeToGraphNodeIds","_graphNode","groupedNodes","nodeToGraphNode","graph","serializedGraphNodes","deSerializedGraphNodes","serializedGroupedNodes","serializedGraphNode","nodeId","Object","keys","key","childId","DefaultGroupOptions","nodeDeltas","INSIDE","height","hitColor","DefaultGroupStyle","_position","DefaultGroupColors","Random","setHitColor","computeTextMetrics","updateRenderState","_name","trim","recomputeNodePositions","font","fontSize","metrics","measureText","textWidth","textHeight","actualBoundingBoxAscent","actualBoundingBoxDescent","d","document","createElement","textContent","body","appendChild","offsetHeight","removeChild","realPos","transform","intersects","canvasDimensions","scale","setContainedNodes","groupRealPos","viewport","nodeRealPos","ui","subtract","OUTSIDE","offGroupContext","fillStyle","strokeRect","fillRect","titleColor","textBaseline","fillText","onClick","screenPosition","realPosition","thisRealPosition","showGenericInput","replace","fontFamily","value","nodeDelata","serializedVector","RED","GREEN","BLUE","random","registeredEvents","lastId","eventKey","args","offAll","DefaultNodeConstructorOptions","stateObserver","lod","LOD2","_width","DefaultNodeStyle","setupState","uiNodes","terminals","nodeButtons","_zIndex","setupTerminals","Container","addNodeButton","toggleNodeState","_renderNodeButton","Left","reflow","update","offUIContext","Terminal","OUT","Proxy","target","prop","oldValue","watch","propName","unwatch","align","deltaX","newNodeButton","NodeButton","noOfButtons","nodeButton","nodeButtonSize","nodeButtonSpacing","terminalRowHeight","padding","recalculateInputTerminals","recalculateOutputTerminals","LOD1","LOD0","INTERSECT","getHitTerminal","hitTerminal","onEnter","getHitUINode","uiNode","getHitNodeButton","renderTerminals","renderName","renderFocused","minimizedTerminalColor","titleFontSize","titleFont","inputTerminalsWidth","outputTerminalsWidth","outlineColor","strokeRoundRect","inputTerminalsStripWidth","outputTerminalsStripWidth","maximizeButtonColor","focus","addTerminal","removeTerminal","getInput","inputTerminal","currTerm","getInputs","setOutputs","outputTerminal","term","outputData","entries","entry","groupedConnectors","outputDataIterator","next","gCntrsIterator","MINIMIZED","dispose","onDown","getImageData","currHitUINode","onOver","prevHitTerminal","hitUINode","prevHitUINode","onUp","clone","hitNodeButton","onDrag","hitUINodeWhileDragging","draggable","currHitNode","pointers","onContextMenu","onWheel","direction","zoomable","createLabel","text","Label","createImage","Image","createSlider","Slider","createSlider2D","Slider2D","createVSlider","VSlider","createDial","Dial","createHozLayout","HorizontalLayout","createStack","Stack","createButton","Button","createToggle","Toggle","createRadioGroup","selected","RadioGroup","createSelect","Select","createSource","Source","createDisplay","renderers","Display","createInput","Input","createEnvelope","Envelope","expandButtonColor","spacing","rowHeight","defaultRenderFn","nodeRenderResolver","_offUIRender","DefaultSubFlowOptions","_","tunnel","lineTo","closePath","Right","DefaultTerminalOptions","DefaultTerminalStyle","_inst","_propName","oldPropName","newPropName","exists","watcherId","_oldVal","newVal","offUIRender","arc","Constant","TAU","outerFocusColor","fill","focusColor","shadowBlur","shadowColor","otherTerminal","newConnector","_disconnect","cntr","currCntr","startTerm","endTerm","pop","onDisconnect","cursor","removedConnector","onEvent","emit","DefaultTunnelNodeOptions","_proxyTerminal","proxyTerminalId","xOrDOMPoint","DOMPoint","addInPlace","arg1","arg2","multiplyInPlace","subtractInPlace","normalizeInPlace","minY","maxY","clampInPlace","transformInPlace","transformedPoint","transformPoint","absInPlace","abs","multiply","isInside","arg3","arg4","assign","vector","threshold","vector1OrX1","vector2OrY1","x2","y2","sqrt","pow","vector1","vector2","minX","maxX","FlowConnect","mount","audioBufferCache","arrayBufferCache","top","left","FlowConnectState","flows","keymap","touchControls","genericInput","minScale","maxScale","wheelScaleDelta","pinchScaleDelta","disableScale","_transform","DOMMatrix","inverseTransform","identity","startTime","prepareCanvas","setupHitCanvas","calcCanvasDimension","registerChangeListeners","attachStyles","canvasUtils","registerEvents","setGenericInput","setupAudioContext","_context","audioContext","_audioContext","_offContext","_offUIContext","_offGroupContext","canvas","time","performance","now","throttle","addEventListener","window","requestAnimationFrame","registerObservers","parentElement","parent","parentResizeObserver","bodyResizeObserver","ResizeObserver","updateTransform","observe","HTMLDivElement","clientWidth","clientHeight","HTMLCanvasElement","getContext","OffscreenCanvas","OffscreenCanvasRenderingContext2D","offCanvas","offUICanvas","offGroupCanvas","touchAction","inputStyle","innerHTML","getElementsByTagName","adjust","parentBoundingRect","getBoundingClientRect","boundingRect","prototype","noop","CanvasRenderingContext2D","roundRect","fillRoundRect","dragDelta","prevPanPosition","prevPinchDistance","onkeydown","ev","onkeyup","onpointerdown","currFlow","addPointer","pointerId","getRelativePosition","getHitNode","Number","MAX_SAFE_INTEGER","groupStartPoint","currGroup","currHitGroup","getHitGroup","onpointerup","removePointer","handleGrouping","hitNode","newGroup","handleConnection","onpointerout","prevHitNode","onpointermove","updatePointer","currPinchDistance","handleZoom","Midpoint","hitGroup","nodeIndex","delta","pointerType","onclick","oncontextmenu","preventDefault","onwheel","deltaY","className","visibility","pointerEvents","onblur","onchange","__FLOWCONNECT_AUDIO_CTX__","AudioContext","audioWorklets","generateAudioWorklets","WorkletUtils","CircularBuffer","audioWorklet","addModule","styles","attributes","activeElement","changeParent","newParent","pointer","pntr","zoomIn","origin","scaleDelta","intersection","oldConnector","clientX","clientY","scaleOrigin","translate","realSpaceOrigin","translateSelf","scaleSelf","inverse","setTransform","translateBy","scaleBy","clear","clearRect","startGlobalTime","_startGlobalTime","timerId","bind","stopGlobalTime","isRootFlowStopped","cancelAnimationFrame","frameId","createFlow","DefaultRules","rootFlow","fromJson","json","JSON","parse","toJson","serializedFlow","stringify","URL","createObjectURL","Blob","utilsFileName","Worklet_ProxyParamForSource","Worklet_ProxyParam","Worklet_Debug","Worklet_MoogEffect","Worklet_BitcrusherEffect","Worklet_LFO","Worklet_Noise","Worklet_Proxy","PI","SIN_60","PHI","fileIcon","imageIcon","UINode","DefaultSlider2DOptions","UIType","DefaultSlider2DStyle","pointDiameter","_value","getProp","thumbHitColor","offThumbCanvas","offThumbContext","renderOffThumb","oldVal","setProp","coord","paint","backgroundColor","borderWidth","point","thumbColor","paintLOD1","offPaint","newWidth","newHeight","getHitPoint","movePoint","onPropChange","disabled","isHit","DefaultButtonOptions","DefaultButtonStyle","label","Center","_node","children","shadowOffsetX","shadowOffset","shadowOffsetY","DefaultContainerOptions","DefaultContainerStyle","contentWidth","uiContainer","_paint","container","terminalsDisplayHeight","visible","availableWidth","childX","serializedChild","DefaultDialOptions","DefaultDialStyle","thumbStart","thumbEnd","temp","lineCap","thumbShadowColor","thumbShadowBlur","center","angle","cos","sin","pointToValue","diff","atan2","lastAngle","undefined","deltaValue","currValue","diffValue","normalizedValue","denormalize","customRenderers","DefaultDisplayOptions","DefaultDisplayStyle","displayConfigs","rendererConfig","newOffCanvasConfig","canvasType","CanvasType","shouldRender","config","auto","customRender","canvasConfigs","renderer","autoOffCanvasConfigs","then","results","result","drawImage","DefaultEnvelopeOptions","DefaultEnvelopeStyle","pointHitColorPoint","BiMap","sort","pointNode","offPointsCanvas","offPointsContext","renderOffPoints","toArray","vec","points","lineColor","pointColor","currHitPoint","prev","Infinity","newPoint","newPointNode","anchor","searchTail","prepend","addAfter","deletePoint","lastDownPosition","serialVec","DefaultHorizontalLayoutOptions","DefaultHorizontalLayoutStyle","originalWidth","maxHeight","fixedWidthChilds","fixedWidth","remainingWidth","flexWidth","childWidth","grow","hozLayout","sourceString","DefaultImageOptions","DefaultImageStyle","_src","setupImage","src","onerror","onload","imageCanvas","imageContext","ratio","DefaultInputOptions","DefaultInputStyle","InputType","parseFloat","setupLabel","setupInputElement","val","setLabelText","inputEl","precision","validity","patternMismatch","step","spellcheck","inputType","pattern","maxLength","oninput","Text","DefaultLabelOptions","DefaultLabelStyle","_text","orgTextWidth","format","displayText","getBestFitString","ellipsisWidth","binarySearch","getValue","idx","substring","match","DefaultRadioGroupOptions","DefaultRadioGroupStyle","_values","selectedValue","_selected","setupLabels","option","selectedLabel","lastSelectedLabel","selectedBackgroundColor","selectedColor","commonWidth","DefaultSelectOptions","DefaultSelectStyle","slctdVal","arrowColor","newValue","DefaultSliderOptions","DefaultSliderStyle","railHeight","thumbFill","thumbRadius","DefaultSourceOptions","DefaultSourceStyle","accept","htmlInput","click","file","_file","lastIndexOf","files","DefaultStackOptions","DefaultStackStyle","actualTotalHeight","effectiveSpacing","stack","DefaultToggleOptions","DefaultToggleStyle","_checked","checked","DefaultUINodeOptions","_visible","_disabled","propValue","query","DefaultVSliderOptions","DefaultVSliderStyle","railWidth","comparator","dataToTreeNodeMapper","dataRefToTreeNode","rightRotate","newRoot","right","leftRotate","getBalance","res","_insert","newNode","AVLTreeNode","balance","deleted","_delete","currData","minValue","action","_inorder","_reverseInorder","reverseMap","keyOrVal","temp1","temp2","Evaluator","variables","history","orderedExprs","historyLimit","parser","Parser","evaluate","expr","postFix","oldestExpr","token","TokenType","Literal","Variable","toLowerCase","Error","Operator","Function","count","functions","constants","tau","pi","phi","ln2","LN2","ln10","LN10","log2e","LOG2E","log10e","LOG10E","acos","acosh","asin","asinh","tan","atan","atanh","exp","cbrt","log10","log2","base","dist","x1","y1","gcd","r","hypot","largest","lcm","prod","sum","mean","median","std","var","fact","n","multiargFunctions","Lexer","numberBuffer","letterBuffer","tokenize","charAt","toUpperCase","replaceConstants","split","char","isDigit","isDecimalPoint","isLetter","processNumberBuffer","Token","isOperator","processLetterBuffer","isLeftParenthesis","join","LParenthesis","isRightParenthesis","RParenthesis","isComma","ArgSeperator","literal","isNaN","test","operators","precedence","associativity","head","tail","ListNode","hook","removed","removeLast","addBefore","searchHead","mapped","LogLevel","LOG_LEVEL","TRACE","trace","apply","DEBUG","debug","WARN","warn","INFO","info","LOG","ERROR","lexer","peek","arr","expression","tokens","were","argCount","funcToken","S4","normalized","start1X","start1Y","end1X","end1Y","start2X","start2Y","end2X","end2Y","isEmpty","obj","isInRange","defaultVal","mid","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","m","O","chunkIds","fn","priority","notFulfilled","fulfilled","j","every","o","hasOwnProperty","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","__webpack_exports__"],"sourceRoot":""}