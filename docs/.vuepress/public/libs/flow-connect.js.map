{"version":3,"file":"flow-connect.js","mappings":"CAAA,SAA2CA,EAAMC,GAChD,GAAsB,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,SACb,GAAqB,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,GAAIH,OACP,CACJ,IAAIK,EAAIL,IACR,IAAI,IAAIM,KAAKD,GAAuB,iBAAZJ,QAAuBA,QAAUF,GAAMO,GAAKD,EAAEC,IAPxE,CASGC,MAAM,WACT,M,uBCVIC,E,kHCCJ,SAAYC,GACV,kBACA,oBACA,wBAHF,CAAY,EAAAA,WAAA,EAAAA,SAAQ,KAOpB,SAAYC,GACVA,EAAAA,EAAA,eACAA,EAAAA,EAAA,eACAA,EAAAA,EAAA,eAHF,CAAY,EAAAA,MAAA,EAAAA,IAAG,KAMf,SAAYC,GACV,mBACA,uBACA,qBAHF,CAAY,EAAAA,QAAA,EAAAA,MAAK,KAMjB,SAAYC,GACV,yBACA,2BAFF,CAAY,EAAAA,kBAAA,EAAAA,gBAAe,M,6YCpB3B,YACA,c,8ICDA,eAEA,UAEA,MAAaC,EAMXC,YAAYC,GACVC,KAAKC,UAAYF,EACjBC,KAAKE,SAAWL,EAAMM,UAAUH,KAAKC,WACrCD,KAAKI,WAAaP,EAAMQ,aAAaL,KAAKC,WAC1CD,KAAKM,cAAgBT,EAAMU,gBAAgBP,KAAKC,WAElDO,QAAQC,GACN,OAAOA,EAAMR,UAAU,KAAOD,KAAKC,UAAU,IACxCQ,EAAMR,UAAU,KAAOD,KAAKC,UAAU,IACtCQ,EAAMR,UAAU,KAAOD,KAAKC,UAAU,IACtCQ,EAAMR,UAAU,KAAOD,KAAKC,UAAU,GAG7CS,gBACE,OAAO,IAAIb,EAAM,IAAIc,kBACnB,CAACC,KAAKC,OAAM,IAAAC,WAAU,EAAG,MAAOF,KAAKC,OAAM,IAAAC,WAAU,EAAG,MAAOF,KAAKC,OAAM,IAAAC,WAAU,EAAG,MAAO,OAGlGJ,iBAAiBK,GACf,OAAO,IAAIJ,kBAAkB,CAACK,SAASD,EAAIE,MAAM,EAAG,GAAI,IAAKD,SAASD,EAAIE,MAAM,EAAG,GAAI,IAAKD,SAASD,EAAIE,MAAM,EAAG,GAAI,IAAKD,SAASD,EAAIE,MAAM,EAAG,GAAI,MAE/IP,uBAAuBQ,GAC7B,IAAIH,EAAMG,EAAEC,SAAS,IACrB,OAAsB,IAAfJ,EAAIK,OAAe,IAAML,EAAMA,EAExCL,iBAAiBX,GACf,MAAO,IAAMF,EAAMwB,gBAAgBtB,EAAK,IAAMF,EAAMwB,gBAAgBtB,EAAK,IAAMF,EAAMwB,gBAAgBtB,EAAK,IAAMF,EAAMwB,gBAAgBtB,EAAK,IAE7IW,oBAAoBX,GAClB,MAAO,GAAGA,EAAK,MAAMA,EAAK,MAAMA,EAAK,MAAMA,EAAK,KAElDW,uBAAuBX,GACrB,MAAO,QAAQA,EAAK,OAAOA,EAAK,OAAOA,EAAK,QAAO,IAAAuB,WAAUvB,EAAK,GAAI,EAAG,KAAKwB,QAAQ,MAIxFb,aAAac,GACX,IAAKC,MAAMC,QAAQF,GAEjB,YADA,EAAAG,IAAIC,MAAM,gDAGZ,GAAIJ,EAAOJ,QAAU,EAEnB,YADA,EAAAO,IAAIC,MAAM,4DAIZ,IAAIC,EAAqB,GASzB,OARIL,EAAO,aAAcb,mBAAsBc,MAAMC,QAAQF,EAAO,KAA+B,iBAAjBA,EAAO,GAAG,GAC1FA,EAAOM,SAAQrB,GAASoB,EAAUE,KAAK,IAAIlC,EAAMY,MACnB,iBAAde,EAAO,GACvBA,EAAOM,SAAQrB,GAASoB,EAAUE,KAAK,IAAIlC,EAAMA,EAAMmC,UAAUvB,OAEjEoB,EAAYL,EAGNS,IACNA,GAAI,IAAAC,OAAMD,EAAG,EAAG,GAEhB,IAAIE,GAASN,EAAUT,OAAS,GAAKa,EACjCG,EAAQxB,KAAKC,MAAMsB,GACnBE,EAAMzB,KAAK0B,KAAKH,GAEpBF,EAAIE,EAAQC,EAEZ,IAAIG,EAAaV,EAAUO,GAAQI,EAAWX,EAAUQ,GAQxD,MAAO,QANME,EAAWtC,UAAUwC,KAAI,CAACC,EAAWpD,KAChDoD,GAAY,IAAAC,MAAKD,EAAWF,EAASvC,UAAUX,GAAI2C,GAC/C3C,EAAI,IAAGoD,EAAY9B,KAAKgC,MAAMF,IAC3BA,KAGiB,KAI9BG,YACE,MAAO,CACL9C,KAAM,CAACC,KAAKC,UAAU,GAAID,KAAKC,UAAU,GAAID,KAAKC,UAAU,GAAID,KAAKC,UAAU,KAGnFS,mBAAmBoC,GACjB,OAAO,IAAIjD,EAAMiD,EAAK/C,OAxF1B,W,mFCJA,gBACA,SACA,UACA,UAEA,UACA,UAEA,MAAagD,UAAkB,EAAAC,MAsB7BlD,YACSmD,EACPb,EACAC,EACAa,EAA4BC,KAE5BC,QALO,KAAAH,KAAAA,EAtBT,KAAAI,eAAmE,IAAM,KA6BvErD,KAAKsD,MAAQJ,EAAQI,MAAQ,IAAKC,OAA4BL,EAAQI,OAAUC,IAChFvD,KAAKwD,IAAK,IAAAC,KAAIP,EAAQM,IAAI,IAAAE,eAC1B1D,KAAK2D,YAAcT,EAAQS,YAE3B3D,KAAKoC,MAAQA,EACbpC,KAAKqC,IAAMA,EACPrC,KAAKoC,QAAOpC,KAAK4D,UAAY5D,KAAKoC,MAAMyB,MACxC7D,KAAKqC,MAAKrC,KAAK8D,QAAU9D,KAAKqC,IAAIwB,MAClCzB,GAASC,IACXrC,KAAK2D,YAAc,KAEnB3D,KAAKoC,MAAM2B,WAAWhC,KAAK/B,MACvBA,KAAKqC,IAAI0B,WAAW3C,OAAS,GAC/BpB,KAAKqC,IAAI0B,WAAW,GAAGC,mBACvBhE,KAAKqC,IAAI0B,WAAW,GAAK/D,MACpBA,KAAKqC,IAAI0B,WAAWhC,KAAK/B,MAE3BkD,EAAQe,mBAAmBjE,KAAKiD,KAAKiB,eAAeC,QAAQnE,KAAK4D,UAAW5D,KAAK8D,SACtF9D,KAAKoC,MAAMgC,UAAUpE,MACrBA,KAAKqC,IAAI+B,UAAUpE,OApCnB8C,WAAc,OAAO9C,KAAKqE,MAC1BvB,SAAKA,GACP9C,KAAKqE,MAAQvB,EACb9C,KAAKqC,KAAOrC,KAAKqC,IAAIiC,KAAK,OAAQtE,KAAKqC,IAAKS,GACxC9C,KAAKiD,KAAKsB,QAAU,EAAAC,UAAUC,SAChCzE,KAAKiD,KAAKiB,eAAeQ,SAAS1E,KAAK8D,SAmC3Ca,mBAAmBC,GACZ5E,KAAKoC,OAIRpC,KAAKqC,IAAMuC,EACX5E,KAAK8D,QAAU9D,KAAKqC,IAAIwB,OAJxB7D,KAAKoC,MAAQwC,EACb5E,KAAK4D,UAAY5D,KAAKoC,MAAMyB,MAMzB7D,KAAKoC,MAAM2B,WAAWc,SAAS7E,OAAOA,KAAKoC,MAAM2B,WAAWhC,KAAK/B,MACtEA,KAAKqC,IAAI0B,WAAW,GAAK/D,KACzBA,KAAK2D,YAAc,KAEnB3D,KAAK4D,UAAUkB,iBAAmB9E,KAAK4D,UAAUkB,gBAAgBC,OAAO,KAAM,MAC9E/E,KAAK4D,UAAUkB,gBAAkB,KACjC9E,KAAK8D,QAAQgB,iBAAmB9E,KAAK8D,QAAQgB,gBAAgBC,OAAO,KAAM,MAC1E/E,KAAK8D,QAAQgB,gBAAkB,KAE/B9E,KAAKiD,KAAKiB,eAAeC,QAAQnE,KAAK4D,UAAW5D,KAAK8D,SACtD9D,KAAKoC,MAAMgC,UAAUpE,MACrBA,KAAKqC,IAAI+B,UAAUpE,MAErBgE,mBACMhE,KAAKoC,QACPpC,KAAKoC,MAAM2B,WAAWc,SAAS7E,OAASA,KAAKoC,MAAM2B,WAAWiB,OAAOhF,KAAKoC,MAAM2B,WAAWkB,QAAQjF,MAAO,GACtGA,KAAK4D,UAAUkB,kBACjB9E,KAAK4D,UAAUkB,gBAAgBC,OAAO,KAAM,MAC5C/E,KAAK4D,UAAUkB,gBAAkB,OAGjC9E,KAAKqC,MACPrC,KAAKqC,IAAI0B,WAAWc,SAAS7E,OAASA,KAAKqC,IAAI0B,WAAWiB,OAAOhF,KAAKqC,IAAI0B,WAAWkB,QAAQjF,MAAO,GAChGA,KAAK8D,QAAQgB,kBACf9E,KAAK8D,QAAQgB,gBAAgBC,OAAO,KAAM,MAC1C/E,KAAK8D,QAAQgB,gBAAkB,OAIrCI,QAAQpC,GACN9C,KAAKqE,MAAQvB,EACb9C,KAAKqC,KAAOrC,KAAKqC,IAAIiC,KAAK,OAAQtE,KAAKqC,IAAKS,GAE9CqC,WAAWC,GACT,IACIC,EAAQT,EADRU,EAAiBtF,KAAKoC,MAAmBpC,KAAKoC,MAAhBpC,KAAKqC,IAUvC,OARIiD,EAAcC,OAAS,EAAAC,aAAaC,IACtCJ,EAASD,EACTR,EAAcU,IAEdD,EAASC,EACTV,EAAcQ,KAGXR,IACDS,IAAWT,IACXS,EAAOxB,OAASe,EAAYf,OAC5BwB,EAAOE,OAASX,EAAYW,SAC3BvF,KAAKiD,KAAKyC,MAAML,EAAOM,UAAUd,SAASD,EAAYe,aACtD3F,KAAKiD,KAAKiB,eAAeiB,WAAWE,EAAOxB,KAAMe,EAAYf,UAIpE+B,SACE,IAAIC,EAAU7F,KAAKiD,KAAK6C,YAAYD,QACpCA,EAAQE,OACR,IAAIC,EAAqBhG,KAAKiD,KAAKI,eAAe4C,UAC9CC,EAA4BlG,KAAKiD,KAAK6C,YAAYzC,eAAe4C,WACnEjG,KAAKqD,gBAAkBrD,KAAKqD,eAAerD,OACvCgG,GAAsBA,EAAmBhG,OACzCkG,GAA6BA,EAA0BlG,OACxDA,KAAKmG,SACRN,EAAS7F,KAAKoG,kBAAmBpG,MACnC6F,EAAQQ,UAER,IAAIC,EAAatG,KAAKiD,KAAK6C,YAAYQ,WACvCA,EAAWP,OACX/F,KAAKuG,aACLD,EAAWD,UAEXrG,KAAKsE,KAAK,SAAUtE,MAEdmG,QAAQN,EAAmCW,EAA+BP,GAChF,IAAIQ,EAAKD,EAAOpE,MAAMsE,EAAGC,EAAKH,EAAOpE,MAAMwE,EAAGC,EAAKL,EAAOnE,IAAIqE,EAAGI,EAAKN,EAAOnE,IAAIuE,EAE7EG,EAAS,EAAAC,QAAQC,SAASR,EAAIE,EAAIE,EAAIC,GAC1CC,GAAU,GAEV,IAAKG,EAAIC,GAAM,CAACV,EAAKM,EAAQJ,IACxBS,EAAIC,GAAM,CAACR,EAAKE,EAAQD,IACxBQ,EAAMC,GAAQ,EAAEL,EAAKE,GAAM,GAAID,EAAKE,GAAM,GAE3CpB,EAAU3C,MAAMkE,SAClB3B,EAAQ4B,YAAcxB,EAAU3C,MAAMoE,YACtC7B,EAAQ8B,UAAY1B,EAAU3C,MAAMsE,MAAQ,EAC5C/B,EAAQgC,YACRhC,EAAQiC,OAAOrB,EAAIE,GACnBd,EAAQkC,iBAAiBb,EAAIC,EAAIG,EAAMC,GACvC1B,EAAQiC,OAAOR,EAAMC,GACrB1B,EAAQkC,iBAAiBX,EAAIC,EAAIR,EAAIC,GACrCjB,EAAQmC,UAGVnC,EAAQ4B,YAAcxB,EAAU3C,MAAM7C,MACtCoF,EAAQ8B,UAAY1B,EAAU3C,MAAMsE,MACpC/B,EAAQgC,YACRhC,EAAQiC,OAAOrB,EAAIE,GACnBd,EAAQkC,iBAAiBb,EAAIC,EAAIG,EAAMC,GACvC1B,EAAQiC,OAAOR,EAAMC,GACrB1B,EAAQkC,iBAAiBX,EAAIC,EAAIR,EAAIC,GACrCjB,EAAQmC,SAEFzB,cACAH,kBACN,IAAIhE,EAA0BC,EAsB9B,OArBIrC,KAAKoC,MACHpC,KAAK4D,UAAUqE,YAAYC,YAAc,EAAAC,UAAUC,UACrDhG,EAAQpC,KAAKoC,MAAMiG,SAASxF,aAE5BT,EAAQpC,KAAK4D,UAAUyE,SAASxF,YAChCT,EAAMsE,GAAK1G,KAAK4D,UAAUgE,MAAQ5H,KAAK4D,UAAUN,MAAMgF,oBAAsBtI,KAAKoC,MAAMkB,MAAMiF,OAC9FnG,EAAMwE,GAAK5G,KAAK4D,UAAUN,MAAMkF,YAAc,GAGhDpG,EAAQpC,KAAK2D,YAAYd,YACvB7C,KAAKqC,IACHrC,KAAK8D,QAAQmE,YAAYC,YAAc,EAAAC,UAAUC,UACnD/F,EAAMrC,KAAKqC,IAAIgG,SAASxF,aAExBR,EAAMrC,KAAK8D,QAAQuE,SAASxF,YAC5BR,EAAIqE,GAAM1G,KAAK8D,QAAQR,MAAMgF,oBAAsBtI,KAAKqC,IAAIiB,MAAMiF,OAClElG,EAAIuE,GAAK5G,KAAK8D,QAAQR,MAAMkF,YAAc,GAG5CnG,EAAMrC,KAAK2D,YAAYd,YAElB,CAAET,MAAAA,EAAOC,IAAAA,GAGlBQ,YACE,MAAO,CACLW,GAAIxD,KAAKwD,GACTiF,QAASzI,KAAKoC,MAAMoB,GACpBkF,MAAO1I,KAAKqC,IAAImB,GAChBmF,YAAa3I,KAAK4D,UAAUJ,GAC5BoF,UAAW5I,KAAK8D,QAAQN,GACxBF,MAAOtD,KAAKsD,OAGhB5C,mBAAmBuC,EAAYb,EAAiBC,EAAeS,GAC7D,OAAO,IAAIC,EAAUE,EAAMb,EAAOC,EAAK,CACrCiB,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTS,mBAAmB,KA7MzB,cAiOA,IAAIV,EAAwB,KACnB,CACLqE,MAAO,EACPnH,MAAO,YACP+G,QAAQ,EACRE,YAAa,SAUbvE,EAA0B,KACrB,CACLG,MAAO,GACPE,IAAI,IAAAE,iB,0FCzPR,gBACA,UACA,UACA,UACA,UAEA,SACA,UACA,SACA,UAEA,UAMA,MAAamF,UAAa,EAAA7F,MA0BxBlD,YACSgG,EACAgD,EACApD,EACAqD,EACAvF,GAAa,IAAAE,eAGpBN,QAPO,KAAA0C,YAAAA,EACA,KAAAgD,KAAAA,EACA,KAAApD,MAAAA,EACA,KAAAqD,eAAAA,EACA,KAAAvF,GAAAA,EAvBT,KAAAwF,aAAsB,IAAI,EAAAhG,MAC1B,KAAAiG,WAAmB,KAInB,KAAAC,UAAoC,GAI3B,KAAA7F,eAOL,GAWFrD,KAAKmJ,MAAQ,IAAIC,IACjBpJ,KAAKqJ,OAAS,GACdrJ,KAAK+D,WAAa,IAAIqF,IACtBpJ,KAAKsJ,cAAgB,IAAIF,IACzBpJ,KAAKuJ,eAAiB,IAAIH,IAC1BpJ,KAAKwJ,YAAc,IAAI,EAAAC,SAAQ,CAACpK,EAASqK,IAAarK,EAAEsK,OAASD,EAAEC,SAAU9F,GAAeA,EAAKL,KACjGxD,KAAK4J,OAAS,GACd5J,KAAK6J,QAAU,GACf7J,KAAKkE,eAAiB,IAAI,EAAA4F,MAE1B9J,KAAK+J,oBAEL/J,KAAK8F,YAAYkE,GAAG,QAAQ,KACtBhK,KAAKuE,QAAUC,EAAUyF,SAASjK,KAAKsE,KAAK,OAAQtE,SAzCxDuE,YAAqB,OAAOvE,KAAKkE,eAAeK,MA6C5CwF,oBACN,IAAIvG,EAAKxD,KAAK8F,YAAYkE,GAAG,aAAa,IAAMhK,KAAKsE,KAAK,YAAatE,QACvEA,KAAKkJ,UAAqB,UAAI1F,EAEhC0G,sBACElK,KAAK8F,YAAYqE,IAAI,YAAanK,KAAKkJ,UAAqB,kBACrDlJ,KAAKkJ,UAAqB,UAGnCkB,aAAanH,GACX,IAAK,IAAIY,IAAQ,IAAI7D,KAAKmJ,MAAMkB,UAAW,CACzC,GAAKxG,EAAqByG,UAAYrH,EAAM,OAAO,EAC9C,GAAKY,EAAqByG,QAC7B,OAAQzG,EAAqByG,QAAQF,aAAanH,GAGtD,OAAO,EAGTsH,SAASzB,EAAcnD,EAAkB0C,GACvC,IAAImC,EAAY,IAAI,EAAAC,WAAWzK,KAAM,QAASqI,EAAU,IAAK,GAAI,CAAC,CAAES,KAAMA,EAAMnD,SAAUA,KAW1F,OAVA6E,EAAUR,GAAG,WAAW,KACtBQ,EAAUX,QAAQ,GAAG3E,QAAQsF,EAAUE,cAAcC,cAGvD3K,KAAK4J,OAAO7H,KAAKyI,GACjBxK,KAAKmJ,MAAMyB,IAAIJ,EAAUhH,GAAIgH,GAC7BxK,KAAKwJ,YAAYqB,IAAIL,GACrBxK,KAAKkE,eAAe2G,IAAIL,GAExBxK,KAAKsE,KAAK,YAAatE,KAAMwK,GACtBA,EAETM,UAAUhC,EAAcnD,EAAkB0C,GACxC,IAAI0C,EAAa,IAAI,EAAAN,WAAWzK,KAAM,SAAUqI,EAAU,IAAK,CAAC,CAAES,KAAMA,EAAMnD,SAAUA,IAAa,IAQrG,OANA3F,KAAK6J,QAAQ9H,KAAKgJ,GAClB/K,KAAKmJ,MAAMyB,IAAIG,EAAWvH,GAAIuH,GAC9B/K,KAAKwJ,YAAYqB,IAAIE,GACrB/K,KAAKkE,eAAe2G,IAAIE,GAExB/K,KAAKsE,KAAK,aAActE,KAAM+K,GACvBA,EAETC,WAAW/H,EAAYoF,GACrB,GAAIpF,EAAKgG,WAEP,OADA,EAAAtH,IAAIC,MAAM,qFACH,KAET,IAAIqJ,EAAc,IAAI,EAAAC,YAAYlL,KAAMiD,EAAMoF,EAAU,IACtDpF,EAAK2G,OAAOnH,KAAI0I,IAAsB,CAAErC,KAAMqC,EAAUtB,QAAQ,GAAGf,KAAMnD,SAAUwF,EAAUtB,QAAQ,GAAGlE,aACxG1C,EAAK4G,QAAQpH,KAAI2I,IAAuB,CAAEtC,KAAMsC,EAAWxB,OAAO,GAAGd,KAAMnD,SAAUyF,EAAWxB,OAAO,GAAGjE,aAC1G,CAAEmD,KAAM7F,EAAK6F,OAOf,OALA9I,KAAKmJ,MAAMyB,IAAIK,EAAYzH,GAAIyH,GAC/BjL,KAAKwJ,YAAYqB,IAAII,GACrBjL,KAAKkE,eAAe2G,IAAII,GACxBhI,EAAKgG,WAAajJ,KAEXiL,EAETI,WAAWvC,EAAcT,EAAmBT,EAAe1E,GAGzD,IAAIoI,EAAqB,GAAIC,EAAsB,GAInD,YAH8B,KAH9BrI,EAAUA,EAAU,IAAKsI,OAAyBtI,GAAYsI,KAG3C5B,SAAwB0B,EAAcpI,EAAQ0G,aAClC,IAApB1G,EAAQ2G,UAAyB0B,EAAerI,EAAQ2G,SAE5D,IAAI,EAAA4B,KAAKzL,KAAM8I,EAAMT,EAAUT,EAAO0D,EAAaC,EAAc,CACtEjI,MAAOJ,EAAQI,MACfoI,cAAexI,EAAQwI,cACvBnH,MAAOrB,EAAQqB,QAGnBoH,WAAWC,IAGXC,gBAAgBrI,GACVxD,KAAK+D,WAAWN,IAAID,KAAQxD,KAAK8F,YAAYgG,oBAAmB9L,KAAK8F,YAAYgG,kBAAoB,MACzG9L,KAAK+D,WAAWgI,OAAOvI,GAEzBwI,iBACEhM,KAAKmJ,MAAMrH,SAAQ+B,GAAQA,EAAKoI,SAAU,IAE5CrG,SACE5F,KAAKqJ,OAAOvH,SAAQoK,GAASA,EAAMtG,WACnC5F,KAAK+D,WAAWjC,SAAQmE,GAAaA,EAAUL,WAC/C5F,KAAKwJ,YAAY1H,SAAQ+B,GAAQA,EAAK+B,WAEtC5F,KAAKsE,KAAK,SAAUtE,MAEtBoC,QACMpC,KAAKuE,QAAUC,EAAUC,UAC7BzE,KAAKkE,eAAe9B,QACpBpC,KAAKsE,KAAK,QAAStE,OAErBmM,OAGE,GAAInM,KAAKuE,QAAUC,EAAUC,QAA7B,CAGA,IAAK,IAAI2H,EAAQpM,KAAKkE,eAAeiF,MAAM/H,OAAS,EAAGgL,GAAS,EAAGA,GAAS,EAC1EpM,KAAKkE,eAAeiF,MAAMiD,GACvBC,QAAOC,GAAaA,EAAUC,oBAAoB,EAAArB,cAClDzI,KAAI6J,GAAaA,EAAUC,WAC3BzK,SAASmJ,GAA6BA,EAAYX,QAAQ6B,SAE/DnM,KAAKkE,eAAeiI,OACpBnM,KAAKsE,KAAK,OAAQtE,OAGpB6C,YACE,MAAO,CACLW,GAAIxD,KAAKwD,GACTsF,KAAM9I,KAAK8I,KACXpD,MAAO1F,KAAK0F,MACZqD,eAAgB/I,KAAK+I,eACrBI,MAAO,IAAInJ,KAAKmJ,MAAMkB,UAAU5H,KAAIoB,GAAQA,EAAKhB,cACjDwG,OAAQrJ,KAAKqJ,OAAO5G,KAAIyJ,GAASA,EAAMrJ,cACvCkB,WAAY,IAAI/D,KAAK+D,WAAWsG,UAAU5H,KAAIwD,GAAaA,EAAUpD,cACrE+G,OAAQ5J,KAAK4J,OAAOnH,KAAI+J,GAASA,EAAM3J,cACvCgH,QAAS7J,KAAK6J,QAAQpH,KAAIgK,GAAUA,EAAO5J,cAC3CqB,eAAgBlE,KAAKkE,eAAerB,aAGxCnC,mBAAmBoF,EAA0BhD,GAC3C,IAAIG,EAAO,IAAI4F,EAAK/C,EAAahD,EAAKgG,KAAMhG,EAAK4C,MAAO5C,EAAKiG,eAAgBjG,EAAKU,IAqClF,OAnCAV,EAAKqG,MAAMrH,SAAQ4K,IACjB,IAAI7I,EACwBA,EAAxB6I,EAAepC,QAAgB,EAAAY,YAAYyB,YAAY1J,EAAMyJ,GACrD,EAAAjB,KAAKkB,YAAY1J,EAAMyJ,GACnCzJ,EAAKkG,MAAMyB,IAAI/G,EAAKL,GAAIK,GACxBZ,EAAKuG,YAAYqB,IAAIhH,MAEvBf,EAAKuG,OAAOvH,SAAQ8K,IAClB,IAAIV,EAAQ,EAAAW,MAAMF,YAAY1J,EAAM2J,GACpC3J,EAAKoG,OAAOtH,KAAKmK,GACjBA,EAAM/C,MAAMrH,SAAQ+B,GAAQA,EAAKqI,MAAQA,OAE3CpJ,EAAK8G,OAAO9H,SAAQgL,IAClB,IAAIN,EAAQ,EAAA/B,WAAWkC,YAAY1J,EAAM6J,GACzC7J,EAAK2G,OAAO7H,KAAKyK,GACjBvJ,EAAKkG,MAAMyB,IAAI4B,EAAMhJ,GAAIgJ,GACzBvJ,EAAKuG,YAAYqB,IAAI2B,MAEvB1J,EAAK+G,QAAQ/H,SAAQiL,IACnB,IAAIN,EAAS,EAAAhC,WAAWkC,YAAY1J,EAAM8J,GAC1C9J,EAAK4G,QAAQ9H,KAAK0K,GAClBxJ,EAAKkG,MAAMyB,IAAI6B,EAAOjJ,GAAIiJ,GAC1BxJ,EAAKuG,YAAYqB,IAAI4B,MAEvB3J,EAAKiB,WAAWjC,SAAQkL,IACtB,IAAIpJ,EAAYX,EAAKkG,MAAM1F,IAAIuJ,EAAoBrE,aAC/CsE,EAAgBrJ,EAAUiG,QAAQqD,OAAOtJ,EAAUuJ,WAAWC,MAAKC,GAAYA,EAAS7J,KAAOwJ,EAAoBvE,UACnH3E,EAAUb,EAAKkG,MAAM1F,IAAIuJ,EAAoBpE,WAC7C0E,EAAcxJ,EAAQ8F,OAAOsD,OAAOpJ,EAAQyJ,UAAUH,MAAKC,GAAYA,EAAS7J,KAAOwJ,EAAoBtE,QAC3GzC,EAAY,EAAAlD,UAAU4J,YAAY1J,EAAMgK,EAAeK,EAAaN,GACxE/J,EAAKc,WAAW6G,IAAIoC,EAAoBxJ,GAAIyC,MAG9ChD,EAAKiB,eAAiB,EAAA4F,MAAM6C,YAAY1J,EAAMH,EAAKoB,gBAE5CjB,GAIX,IAAYuB,EA5NZ,SA4NA,SAAYA,GACV,yBACA,mBACA,yBAHF,CAAYA,EAAA,EAAAA,YAAA,EAAAA,UAAS,KAgCrB,IAAIgH,EAAqB,KAChB,CACLlI,MAAO,GACPoI,cAAe,M,2FClRnB,gBACA,SACA,UAEA,UACA,UAIA,MAAa5B,EAMXhK,cALA,KAAAyE,MAAmB,EAAAC,UAAUC,QAM3BzE,KAAKmJ,MAAQ,GACbnJ,KAAKwN,WAAa,IAAIpE,IACtBpJ,KAAKyN,WAAa,IAAIrE,IAGxByB,IAAI/H,GACG9C,KAAKmJ,MAAM,IAAInJ,KAAKmJ,MAAMpH,KAAK,IACpC,IAAIuK,EAAY,IAAIoB,EAAU5K,GAC9B9C,KAAKmJ,MAAM,GAAGpH,KAAKuK,GACnBtM,KAAKwN,WAAW5C,IAAI9H,EAAKU,GAAI8I,GAE/BnI,QAAQwJ,EAAkBC,GACxB,IAAIC,EAAiB7N,KAAKwN,WAAW/J,IAAIkK,EAAWnK,IAChDsK,EAAe9N,KAAKwN,WAAW/J,IAAImK,EAAgBpK,IAElDqK,EAAeE,OAAOlJ,SAASiJ,KAClCD,EAAeE,OAAOhM,KAAK+L,GAEvBA,EAAa1B,OAASyB,EAAezB,OACvCpM,KAAKgO,YAAYF,EAAcD,EAAezB,MAAQ,IAI5D6B,WAAWN,EAAkBC,GAC3B,IAAIM,EAAkBlO,KAAKwN,WAAW/J,IAAIkK,EAAWnK,IACjD2K,EAAuBnO,KAAKwN,WAAW/J,IAAImK,EAAgBpK,IAE3D4K,EAAoB,IAAIC,IAM5B,GALAV,EAAW9D,QACR/H,SAAQuL,GAAYA,EAAStJ,WAC3BjC,SAAQmE,GAAaA,EAAUnC,SAAWsK,EAAkBvD,IAAI5E,EAAUnC,aAG3EsK,EAAkBE,IAAIV,GAAkB,OAC5CM,EAAgBH,OAAO/I,OAAOkJ,EAAgBH,OAAO9I,QAAQkJ,GAAuB,GAEpF,IAAII,EAAgCX,EAAgBhE,OACjDyC,QAAOgB,GAAYA,EAAStJ,WAAW3C,OAAS,IAChDqB,KAAI4K,GAAYrN,KAAKwN,WAAW/J,IAAI4J,EAAStJ,WAAW,GAAGH,UAAUJ,IAAI4I,QACzEoC,QAAO,CAACC,EAAKC,IAAS9N,KAAK+N,IAAIF,EAAKC,IAAO,GAE9C1O,KAAKgO,YAAYG,EAAsBI,GAEzCP,YAAYjP,EAAiBqN,GAC3BpM,KAAK4O,aAAa7P,EAAMqN,GACxB,IAAIyC,EAAqB,GAEzB,IADAA,EAAM9M,KAAKhD,GACa,IAAjB8P,EAAMzN,QAAc,CACzB,IAAI0N,EAAWD,EAAME,QACrBD,EAASf,OAAOjM,SAAQkN,IAClBA,EAAM5C,OAAS0C,EAAS1C,QAC1BpM,KAAK4O,aAAaI,EAAOF,EAAS1C,MAAQ,GACrCyC,EAAMhK,SAASmK,IAAQH,EAAM9M,KAAKiN,QAKvCJ,aAAatC,EAAsBF,GACzCpM,KAAKmJ,MAAMmD,EAAUF,OAAOpH,OAAOhF,KAAKmJ,MAAMmD,EAAUF,OAAOnH,QAAQqH,GAAY,GAC9EtM,KAAKmJ,MAAMiD,KAAQpM,KAAKmJ,MAAMiD,GAAS,IAC5CE,EAAUF,MAAQA,EAClBpM,KAAKmJ,MAAMiD,GAAOrK,KAAKuK,GAEzBnH,WAAWwI,EAAkBC,GAC3B,OAAI5N,KAAKwN,WAAW/J,IAAImK,EAAgBpK,IAAIuK,OAAOlJ,SAAS7E,KAAKwN,WAAW/J,IAAIkK,EAAWnK,KAI7FyL,cACE,GAAIjP,KAAKuE,QAAU,EAAAC,UAAUC,SAE3B,GADAzE,KAAKuE,MAAQ,EAAAC,UAAUyF,QACnBjK,KAAKmJ,MAAM,GACb,IAGE,UAFMnJ,KAAKkP,OAAOlP,KAAKmJ,MAAM,IAEG,IAAzBnJ,KAAKyN,WAAW0B,YACfnP,KAAKkP,OAAOlP,KAAKoP,YAAY,IAAIpP,KAAKyN,WAAWpD,YAEzD,MAAOzI,GAGP,OAFA,EAAAD,IAAIC,MAAM,8BAA+BA,QACzC5B,KAAKuE,MAAQ,EAAAC,UAAUC,eAItB,GAAIzE,KAAKuE,QAAU,EAAAC,UAAU6K,KAAM,CACxCrP,KAAKuE,MAAQ,EAAAC,UAAUyF,QACvB,IACE,KAAgC,IAAzBjK,KAAKyN,WAAW0B,YACfnP,KAAKkP,OAAOlP,KAAKoP,YAAY,IAAIpP,KAAKyN,WAAWpD,YAEzD,MAAOzI,GAGP,OAFA,EAAAD,IAAIC,MAAM,8BAA+BA,QACzC5B,KAAKuE,MAAQ,EAAAC,UAAUC,UAK3BzE,KAAKuE,MAAQ,EAAAC,UAAU6K,KAEzBlD,OACEnM,KAAKuE,MAAQ,EAAAC,UAAUC,QAGzBwK,aAAazB,SACL8B,QAAQC,IACZ/B,EAAW/K,KACT6J,GAAa,IAAIgD,SAAcE,IAC7BlD,EAAUC,SAASkD,MACnBzP,KAAK0P,WAAWpD,GAChBkD,UAKR9K,SAASb,GACP,IAAIyI,EAAYzI,aAAgB,EAAA4H,KAAOzL,KAAKwN,WAAW/J,IAAII,EAAKL,IAAMK,EACjEyI,GAELtM,KAAKyN,WAAW7C,IAAI0B,EAAU9I,GAAI8I,GAEpCoD,WAAW7L,GACT,IAAIyI,EAAYzI,aAAgB,EAAA4H,KAAOzL,KAAKwN,WAAW/J,IAAII,EAAKL,IAAMK,EACtE7D,KAAKyN,WAAW1B,OAAOO,EAAU9I,IAGnC4L,YAAY5B,GACV,IAAImC,EAAc/O,KAAKgP,OAAOpC,EAAW/K,KAAI6J,GAAaA,EAAUF,SACpE,OAAOoB,EAAWnB,QAAOC,GAAaA,EAAUF,QAAUuD,IAG5DE,UAAU9Q,EAAwB+Q,GAChC,IAAI1N,EAAQrD,aAAgB,EAAA0M,KAAOzL,KAAKwN,WAAW/J,IAAI1E,EAAKyE,IAAMzE,EAC9D8P,EAAQ,IAAI,EAAAkB,KAEhB,IADAlB,EAAMmB,OAAO5N,GACW,IAAjByM,EAAMzN,QAAc,CACzB,IAAI6O,EAAYpB,EAAMqB,cACtBJ,EAASG,EAAU1D,UACnB0D,EAAUlC,OAAOjM,SAAQkN,GAASH,EAAMmB,OAAOhB,MAGnDmB,UAAUtM,EAAiBuM,GACzBC,QAAQC,IAAI,GAAGF,KAAUvM,EAAK0I,SAASzD,SAASjF,EAAKuI,UACrDvI,EAAKkK,OAAOjM,SAAQkN,GAAShP,KAAKmQ,UAAUnB,EAAOoB,EAAS,QAE9DG,aACEvQ,KAAKmJ,MAAM,GAAGrH,SAAQwK,IACpBtM,KAAKmQ,UAAU7D,EAAW,OAI9BzJ,YACE,IAAI2N,EAA6C,GAGjD,OAFAxQ,KAAKwN,WAAW1L,SAAQ,CAAC2O,EAAYjN,IAAOgN,EAAmBhN,GAAMxD,KAAKwN,WAAW/J,IAAID,GAAIA,KAEtF,CACL2F,MAAOnJ,KAAKmJ,MAAM1G,KAAIiO,GAAgBA,EAAajO,KAAI6J,GAAaA,EAAUzJ,gBAC9E8N,gBAAiBH,GAGrB9P,mBAAmBuC,EAAYH,GAC7B,IAAI8N,EAAQ,IAAI9G,EAEZ+G,EAA4D,GAC5DC,EAAoD,GAkBxD,OAhBAhO,EAAKqG,MAAMrH,SAAQ,CAACiP,EAAwB5O,KAC1CyO,EAAMzH,MAAMhH,GAAS4O,EAAuBtO,KAAIuO,IAC9C,IAAI1E,EAAYoB,EAAUf,YAAY1J,EAAKkG,MAAM1F,IAAIuN,EAAoBC,QAASD,GAGlF,OAFAF,EAAuBxE,EAAU9I,IAAM8I,EACvCuE,EAAqBvE,EAAU9I,IAAMwN,EAC9B1E,QAIX4E,OAAOC,KAAKL,GAAwBhP,SAAQsP,IAC1CN,EAAuBM,GAAKrD,OAAS8C,EAAqBO,GAAKrD,OAAOtL,KAAI4O,GAAWP,EAAuBO,QAE9GH,OAAOC,KAAKrO,EAAK6N,iBAAiB7O,SAAQmP,IACxCL,EAAMpD,WAAW5C,IAAIqG,EAAQH,EAAuBhO,EAAK6N,gBAAgBM,QAGpEL,GA5LX,UAqMA,MAAalD,EAKX5N,YAAmByM,EAAgBH,EAAgB5I,GAAhC,KAAA+I,SAAAA,EAHnB,KAAAwB,OAAsB,GAIpB/N,KAAKoM,MAAQA,GAAgB,EAC7BpM,KAAKwD,GAAKA,IAAU,IAAAE,cAGtBb,YACE,MAAO,CACLW,GAAIxD,KAAKwD,GACTyN,OAAQjR,KAAKuM,SAAS/I,GACtB4I,MAAOpM,KAAKoM,MACZ2B,OAAQ/N,KAAK+N,OAAOtL,KAAIuM,GAASA,EAAMxL,MAG3C9C,mBAAmBmD,EAAYf,GAC7B,OAAO,IAAI4K,EAAU7J,EAAMf,EAAKsJ,MAAOtJ,EAAKU,KAnBhD,e,+EC9MA,gBACA,SACA,UAEA,UAGA,SAEA,MAAaqJ,UAAc,EAAA7J,MA+BzBlD,YACSmD,EACPoF,EACAnF,EAAwBoO,KAcxB,GAXAlO,QALO,KAAAH,KAAAA,EA/BT,KAAAI,eAA2D,IAAM,KAEjE,KAAA8F,MAAgB,GAchB,KAAAoI,WAAwB,GAMhB,KAAAtJ,YAAwB,EAAAxI,SAAS+R,OAgBvCxR,KAAK4H,OAAQ,IAAAnE,KAAIP,EAAQ0E,MAAO,GAChC5H,KAAKyR,QAAS,IAAAhO,KAAIP,EAAQuO,OAAQ,GAClCzR,KAAKsD,OAAQ,IAAAG,KAAIP,EAAQI,MAAO,IAChCtD,KAAKwD,IAAK,IAAAC,KAAIP,EAAQM,IAAI,IAAAE,eAE1B1D,KAAK0R,SAAWxO,EAAQwO,SACxB1R,KAAKsD,MAAQ,IAAKqO,OAAwBzO,EAAQI,OAClDtD,KAAKwD,IAAK,IAAAE,cACV1D,KAAK4R,UAAYvJ,GACZrI,KAAKsD,MAAM7C,QAAUT,KAAKsD,MAAMoE,YAAa,CAChD,IAAIlG,EAASqQ,EAAmBC,SAChC9R,KAAKsD,MAAMoE,YAAclG,EAAO,GAChCxB,KAAKsD,MAAM7C,MAAQe,EAAO,GAE5BxB,KAAK8I,KAAO5F,EAAQ4F,KACpB9I,KAAK+R,YAAY7O,EAAQwO,UACzB1R,KAAKgS,qBAELhS,KAAKiD,KAAK+G,GAAG,aAAa,IAAMhK,KAAKiS,sBArDnCnJ,WAAiB,OAAO9I,KAAKkS,MAC7BpJ,SAAKA,GACFA,GAAwB,KAAhBA,EAAKqJ,OACbnS,KAAKkS,MAAQpJ,EADe9I,KAAKkS,MAAQ,UAE9ClS,KAAKgS,qBAEH3J,eAAsB,OAAOrI,KAAK4R,UAClCvJ,aAASA,GACXrI,KAAK4R,UAAYvJ,EACjBrI,KAAKiS,oBACLjS,KAAKoS,yBA8CCL,YAAYL,GAClB,IAAKA,EAEH,IADAA,EAAW,EAAA7R,MAAMiS,SACV9R,KAAKiD,KAAKsG,eAAe9F,IAAIiO,EAAStR,aAAasR,EAAW,EAAA7R,MAAMiS,SAE7E9R,KAAK0R,SAAWA,EAChB1R,KAAKiD,KAAKsG,eAAeqB,IAAI5K,KAAK0R,SAAStR,WAAYJ,MAEjDgS,qBACN,IAAInM,EAAU7F,KAAKiD,KAAK6C,YAAYD,QACpCA,EAAQwM,KAAOrS,KAAKsD,MAAMgP,SAAW,IAAMtS,KAAKsD,MAAM+O,KACtD,IAAIE,EAAU1M,EAAQ2M,YAAYxS,KAAK8I,MAMvC,GALA9I,KAAKyS,UAAYF,EAAQ3K,MACzB2K,EAAU1M,EAAQ2M,YAAY,KAC9B3M,EAAQwM,KAAO,KACfrS,KAAK0S,WAAaH,EAAQI,wBAA0BJ,EAAQK,8BAE7B,IAApB5S,KAAK0S,WAA4B,CAC1C,IAAIG,EAAIC,SAASC,cAAc,QAC/BF,EAAEG,YAAc,IAChBH,EAAEvP,MAAM+O,KAAOrS,KAAKsD,MAAMgP,SAAW,IAAMtS,KAAKsD,MAAM+O,KACtDS,SAASG,KAAKC,YAAYL,GAC1B7S,KAAK0S,WAAaG,EAAEM,aACpBL,SAASG,KAAKG,YAAYP,IAGtBZ,oBACN,IAAIoB,EAAUrT,KAAKqI,SAASiL,UAAUtT,KAAKiD,KAAK6C,YAAYwN,WAC5DtT,KAAKiI,aAAc,IAAAsL,YACjB,EAAG,EACHvT,KAAKiD,KAAK6C,YAAY0N,iBAAiB5L,MAAO5H,KAAKiD,KAAK6C,YAAY0N,iBAAiB/B,OACrF4B,EAAQ3M,EAAG2M,EAAQzM,EACnByM,EAAQ3M,EAAI1G,KAAK4H,MAAQ5H,KAAKiD,KAAK6C,YAAY2N,MAC/CJ,EAAQzM,EAAI5G,KAAKyR,OAASzR,KAAKiD,KAAK6C,YAAY2N,OAGpDC,oBACE,IAAIC,EAAe3T,KAAKqI,SAASiL,UAAUtT,KAAKiD,KAAK6C,YAAYwN,WAEjEtT,KAAKmJ,MAAQ,IAAInJ,KAAKiD,KAAKkG,MAAMkB,UAC9BgC,QAAOxI,IAASA,EAAKqI,OAASrI,EAAKoE,YAAY2L,WAAa,EAAAnU,SAAS+R,SACrEnF,QAAOxI,IACN,IAAIgQ,EAAchQ,EAAKwE,SAASiL,UAAUtT,KAAKiD,KAAK6C,YAAYwN,WAEhE,OAAO,IAAAC,YAAWI,EAAajN,EAAGiN,EAAa/M,EAC7C+M,EAAajN,EAAI1G,KAAK4H,MAAQ5H,KAAKiD,KAAK6C,YAAY2N,MACpDE,EAAa/M,EAAI5G,KAAKyR,OAASzR,KAAKiD,KAAK6C,YAAY2N,MACrDI,EAAYnN,EAAGmN,EAAYjN,EAC3BiN,EAAYnN,EAAI7C,EAAK+D,MAAQ5H,KAAKiD,KAAK6C,YAAY2N,MACnDI,EAAYjN,EAAI/C,EAAKiQ,GAAGrC,OAASzR,KAAKiD,KAAK6C,YAAY2N,SACnD,EAAAhU,SAAS+R,UAGnBxR,KAAKmJ,MAAMrH,SAAQ,CAAC+B,EAAM1B,KACxB0B,EAAKqI,MAAQlM,KACbA,KAAKuR,WAAWpP,GAAS0B,EAAKwE,SAAS0L,SAAS/T,KAAKqI,aAGjD+J,yBACNpS,KAAKmJ,MAAMrH,SAAQ,CAAC+B,EAAM1B,KACxB0B,EAAKwE,SAAWrI,KAAKqI,SAASwC,IAAI7K,KAAKuR,WAAWpP,OAItDyD,SACE,GAAI5F,KAAKiI,cAAgB,EAAAxI,SAASuU,QAAS,OAE3C,IAAInO,EAAU7F,KAAKiD,KAAK6C,YAAYD,QACpCA,EAAQE,OACR,IAAIC,EAAqBhG,KAAKiD,KAAKI,eAAe6I,MAC9ChG,EAA4BlG,KAAKiD,KAAK6C,YAAYzC,eAAe6I,OACnElM,KAAKqD,gBAAkBrD,KAAKqD,eAAerD,OACvCgG,GAAsBA,EAAmBhG,OACzCkG,GAA6BA,EAA0BlG,OACxDA,KAAKmG,SACRN,EAAS7F,KAAKoG,kBAAmBpG,MACnC6F,EAAQQ,UAERrG,KAAKiD,KAAK6C,YAAYmO,gBAAgBlO,OACtC/F,KAAKuG,aACLvG,KAAKiD,KAAK6C,YAAYmO,gBAAgB5N,UAEtCrG,KAAKsE,KAAK,SAAUtE,MAEdmG,QAAQN,EAAmCW,EAA2B0F,GAC5ErG,EAAQ4B,YAAcyE,EAAM5I,MAAMoE,YAClC7B,EAAQ8B,UAAY,EACpB9B,EAAQqO,UAAYhI,EAAM5I,MAAM7C,MAChCoF,EAAQsO,WAAW3N,EAAO6B,SAAS3B,EAAGF,EAAO6B,SAASzB,EAAGJ,EAAOoB,MAAOpB,EAAOiL,QAC9E5L,EAAQuO,SAAS5N,EAAO6B,SAAS3B,EAAGF,EAAO6B,SAASzB,EAAGJ,EAAOoB,MAAOpB,EAAOiL,QAC5E5L,EAAQqO,UAAYhI,EAAM5I,MAAM+Q,WAChCxO,EAAQyO,aAAe,SACvBzO,EAAQwM,KAAOnG,EAAM5I,MAAMgP,SAAW,IAAMpG,EAAM5I,MAAM+O,KACxDxM,EAAQ0O,SAASrI,EAAMpD,KAAMtC,EAAO6B,SAAS3B,EAAGF,EAAO6B,SAASzB,EAAI,IAE9DL,aACNvG,KAAKiD,KAAK6C,YAAYmO,gBAAgBC,UAAYlU,KAAK0R,SAASpR,cAChEN,KAAKiD,KAAK6C,YAAYmO,gBAAgBG,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAClGzR,KAAKiD,KAAK6C,YAAYmO,gBAAgBG,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAI5G,KAAK0S,WAAa,GAAI1S,KAAKyS,UAAWzS,KAAK0S,WAAa,IAEpItM,kBACN,MAAO,CACLiC,SAAUrI,KAAKqI,SAASxF,YACxB+E,MAAO5H,KAAK4H,MACZ6J,OAAQzR,KAAKyR,QAIjB+C,QAAQC,EAAyBC,GAC/B1U,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAEzC,IAAIC,EAAmB3U,KAAKqI,SAASiL,UAAUtT,KAAKiD,KAAK6C,YAAYwN,WACjEmB,EAAe7N,EAAI+N,EAAiB/N,GACtC5G,KAAKiD,KAAK6C,YAAY8O,iBAAiBD,EAAiBZ,SAAS,GAAI,GAAK/T,KAAK0S,YAAc1S,KAAKiD,KAAK6C,YAAY2N,OAAQzT,KAAK8I,KAAM,CACpIlB,MAAOhH,KAAK+N,IAAI3O,KAAKyS,UAAW,IAAMzS,KAAKiD,KAAK6C,YAAY2N,MAAQ,KACpEhC,OAAQzR,KAAK0S,WAAa1S,KAAKiD,KAAK6C,YAAY2N,MAAQ,KACxDnB,SAAUtR,SAAShB,KAAKsD,MAAMgP,SAASuC,QAAQ,KAAM,KAAO7U,KAAKiD,KAAK6C,YAAY2N,MAAQ,KAC1FqB,WAAY9U,KAAKsD,MAAM+O,MACtB,CACD9M,KAAM,SACJwP,IACF/U,KAAK8I,KAAOiM,KAKlBlS,YACE,MAAO,CACLW,GAAIxD,KAAKwD,GACTkO,SAAU1R,KAAK0R,SAAS7O,YACxBwF,SAAUrI,KAAKqI,SAASxF,YACxBiG,KAAM9I,KAAK8I,KACXlB,MAAO5H,KAAK4H,MACZ6J,OAAQzR,KAAKyR,OACbnO,MAAOtD,KAAKsD,MACZ6F,MAAOnJ,KAAKmJ,MAAM1G,KAAIoB,GAAQA,EAAKL,KACnC+N,WAAYvR,KAAKuR,WAAW9O,KAAIuS,GAAcA,EAAWnS,eAG7DnC,mBAAmBuC,EAAYH,GAC7B,IAAIoJ,EAAQ,IAAIW,EAAM5J,EAAM,EAAA+D,QAAQ2F,YAAY7J,EAAKuF,UAAW,CAC9DT,MAAO9E,EAAK8E,MACZ6J,OAAQ3O,EAAK2O,OACb3I,KAAMhG,EAAKgG,KACXxF,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,YAUnC,OAPA5O,EAAKqG,MAAMrH,SAAQmP,IACjB/E,EAAM/C,MAAMpH,KAAKkB,EAAKkG,MAAM1F,IAAIwN,OAElCnO,EAAKyO,WAAWzP,SAAQmT,IACtB/I,EAAMqF,WAAWxP,KAAK,EAAAiF,QAAQ2F,YAAYsI,OAGrC/I,GAxNX,UAwOA,IAAI2F,EAAqB,CACvBrQ,OAAQ,CACN,CAAC,yBAA0B,2BAC3B,CAAC,yBAA0B,2BAC3B,CAAC,yBAA0B,4BAE7B0T,IAAK,IAAMrD,EAAmBrQ,OAAO,GACrC2T,MAAO,IAAMtD,EAAmBrQ,OAAO,GACvC4T,KAAM,IAAMvD,EAAmBrQ,OAAO,GACtCsQ,OAAQ,IAAMD,EAAmBrQ,OAAOZ,KAAKC,MAAMD,KAAKyU,SAAWxD,EAAmBrQ,OAAOJ,UAU3FuQ,EAAoB,KACf,CACL0C,WAAY,OACZ/B,SAAU,OACVD,KAAM,UAaNf,EAAsB,KACjB,CACL1J,MAAO,EACP6J,OAAQ,EACRnO,MAAO,GACPE,IAAI,IAAAE,iB,6ECrRR,cAIE5D,cACEE,KAAKsV,iBAAmB,GACxBtV,KAAKuV,OAAS,EAUhBvL,GAAGwL,EAAkB1F,GACd9P,KAAKsV,iBAAiBE,KAAWxV,KAAKsV,iBAAiBE,GAAY,IAExE,IAAIhS,EAAKxD,KAAKuV,OAGd,OAFAvV,KAAKsV,iBAAiBE,GAAUhS,GAAMsM,EACtC9P,KAAKuV,QAAU,EACR/R,EAETc,KAAKkR,KAAqBC,GACpBzV,KAAKsV,iBAAiBE,KACnBC,IAAMA,EAAO,IAClBvE,OAAO7G,OAAOrK,KAAKsV,iBAAiBE,IAAW1T,SAAQgO,GAAYA,KAAY2F,MASnFtL,IAAIqL,EAAkBhS,GAChBxD,KAAKsV,iBAAiBE,WAAkBxV,KAAKsV,iBAAiBE,GAAUhS,GAE9EkS,SACE1V,KAAKsV,iBAAmB,M,+YC7C5B,aACA,aACA,aACA,aACA,aACA,aACA,aACA,YACA,aACA,aACA,c,uGCVA,gBACA,SACA,UAOA,SACA,UACA,UAEA,UACA,UAGA,UAEA,MAAa7J,UAAa,EAAAzI,MAoExBlD,YACSmD,EACA6F,EACPT,EACAT,EACAgC,EAA8BC,EAC9B3G,EAAkCyS,KAGlCvS,QARO,KAAAH,KAAAA,EACA,KAAA6F,KAAAA,EApET,KAAAzF,eAKI,GASI,KAAAuS,cAAgB,IAAI,EAAA5S,MAE5B,KAAAiF,YAA2B,CAAE2L,SAAU,EAAAnU,SAAS+R,OAAQtJ,UAAWC,EAAUC,UAAWyN,IAAK,EAAAnW,IAAIoW,MAOjG,KAAA7J,SAAmB,EACnB,KAAArC,OAAqB,GACrB,KAAAC,QAAsB,GACtB,KAAA0D,SAAuB,GACvB,KAAAJ,UAAwB,GAGxB,KAAAjB,MAAe,KA+CblM,KAAKsD,OAAQ,IAAAG,KAAIP,EAAQI,MAAO,IAChCtD,KAAK0L,eAAgB,IAAAjI,KAAIP,EAAQwI,cAAe,IAChD1L,KAAKwD,IAAK,IAAAC,KAAIP,EAAQM,IAAI,IAAAE,eAC1BR,EAAQqB,OAAQ,IAAAd,KAAIP,EAAQqB,MAAO,IAEnCvE,KAAK0R,SAAWxO,EAAQwO,SACxB1R,KAAK+V,OAASnO,EACd5H,KAAKsD,MAAQ,IAAK0S,OAAuB9S,EAAQI,OACjDtD,KAAK4R,UAAYvJ,EACjBrI,KAAKiW,WAAW/S,EAAQqB,OACxBvE,KAAKkW,QAAU,IAAI9M,IACnBpJ,KAAKmW,UAAY,IAAI/M,IACrBpJ,KAAKoW,YAAc,IAAIhN,IACvBpJ,KAAKqW,QAAU,EACfrW,KAAK+R,YAAY7O,EAAQwO,UAEzB1R,KAAKsW,eAAepT,EAAS0G,EAAQC,GAEjC3G,EAAQ4Q,GACV9T,KAAK8T,GAAK5Q,EAAQ4Q,cAAc,EAAAyC,UAAYrT,EAAQ4Q,GAAK,EAAAyC,UAAU5J,YAAY3M,KAAMkD,EAAQ4Q,IAE7F9T,KAAK8T,GAAK,IAAI,EAAAyC,UAAUvW,KAAM4H,GAGhC5H,KAAKwW,eAAc,IAAMxW,KAAKyW,mBAAmBzW,KAAK0W,kBAAmB,EAAA/W,MAAMgX,MAE/E3W,KAAK4W,SACL5W,KAAK8T,GAAG+C,SAER7W,KAAKiD,KAAK+G,GAAG,aAAa,IAAMhK,KAAKiS,sBAErCjS,KAAKiD,KAAKkG,MAAMyB,IAAI5K,KAAKwD,GAAIxD,MAC7BA,KAAKiD,KAAKuG,YAAYqB,IAAI7K,MAC1BA,KAAKiD,KAAKiB,eAAe2G,IAAI7K,MA5E3ByR,aAAmB,OAAOzR,KAAK8T,GAAGrC,OAClC5L,cAAsC,OAAO7F,KAAKiD,KAAK6C,YAAYD,QACnES,iBAA6E,OAAOtG,KAAKiD,KAAK6C,YAAYQ,WAC1GwQ,mBAA+E,OAAO9W,KAAKiD,KAAK6C,YAAYgR,aAC5GzO,eAAsB,OAAOrI,KAAK4R,UAClCvJ,aAASA,GACXrI,KAAK4R,UAAYvJ,EACjBrI,KAAK4W,SACL5W,KAAK8T,GAAG+C,SACR7W,KAAKiS,oBAEHtI,aAAmB,OAAO3J,KAAKqW,QAC/B1M,WAAOA,GACL3J,KAAKiD,KAAKuG,YAAYuN,OAAO/W,OAC/BA,KAAKqW,QAAU1M,EACf3J,KAAKiD,KAAKuG,YAAYqB,IAAI7K,OAE1BA,KAAKqW,QAAU1M,EAGf/B,YAAkB,OAAO5H,KAAK+V,OAC9BnO,UAAMA,GACR5H,KAAK+V,OAASnO,EACd5H,KAAK8T,GAAGlM,MAAQA,EAChB5H,KAAK8T,GAAG+C,SAwDVP,eAAepT,EAAiC0G,EAA8BC,GAC5E7J,KAAK4J,OAAO7H,QAAQ6H,EAAOnH,KAAI+J,GAC7B,IAAI,EAAAwK,SAAShX,KAAM,EAAAwF,aAAaC,GAAI+G,EAAM7G,SAAU6G,EAAM1D,KAAM,CAC9DxF,MAAOkJ,EAAMlJ,MAAQkJ,EAAMlJ,MAAQ,IAAKJ,EAAQwI,eAChDlI,GAAIgJ,EAAMhJ,GAAKgJ,EAAMhJ,GAAK,KAC1BkO,SAAUlF,EAAMkF,SAAW,EAAA7R,MAAM8M,YAAYH,EAAMkF,UAAY,UAGnE1R,KAAK6J,QAAQ9H,QAAQ8H,EAAQpH,KAAIgK,GAC/B,IAAI,EAAAuK,SAAShX,KAAM,EAAAwF,aAAayR,IAAKxK,EAAO9G,SAAU8G,EAAO3D,KAAM,CACjExF,MAAOmJ,EAAOnJ,MAAQmJ,EAAOnJ,MAAQ,IAAKJ,EAAQwI,eAClDlI,GAAIiJ,EAAOjJ,GAAKiJ,EAAOjJ,GAAK,KAC5BkO,SAAUjF,EAAOiF,SAAW,EAAA7R,MAAM8M,YAAYF,EAAOiF,UAAY,UAI/DuE,WAAW1R,GACjBvE,KAAKuE,MAAQ,IAAI2S,MAAW,GAAI,CAC9BtM,IAAK,CAACuM,EAAQC,EAAMrC,KAClB,IAAIsC,EAAWF,EAAOC,GAGtB,OAFAD,EAAOC,GAAQrC,EACf/U,KAAK4V,cAActR,KAAK8S,EAAgBC,EAAUtC,IAC3C,KAIX7D,OAAOC,KAAK5M,GAAOzC,SAAQsP,GAAOpR,KAAKuE,MAAM6M,GAAO7M,EAAM6M,KAE5DkG,MAAMC,EAAkBzH,GACtB,QAAoC,IAAzB9P,KAAKuE,MAAMgT,GACpB,OAAOvX,KAAK4V,cAAc5L,GAAGuN,EAAUzH,GAEvC,EAAAnO,IAAIC,MAAM,sBAAsB2V,sBAGpCC,QAAQD,EAAkB/T,QACY,IAAzBxD,KAAKuE,MAAMgT,GACpBvX,KAAK4V,cAAczL,IAAIoN,EAAU/T,GAEjC,EAAA7B,IAAIC,MAAM,wBAAwB2V,sBAG9BxF,YAAYL,GAClB,IAAKA,EAEH,IADAA,EAAW,EAAA7R,MAAMiS,SACV9R,KAAKiD,KAAKqG,cAAc7F,IAAIiO,EAAStR,aAAasR,EAAW,EAAA7R,MAAMiS,SAE5E9R,KAAK0R,SAAWA,EAChB1R,KAAKiD,KAAKqG,cAAcsB,IAAI5K,KAAK0R,SAAStR,WAAYJ,MAExDwW,cAAc1G,EAAsBlK,EAA4D6R,GAC9F,IAGIC,EAHAC,EAAgB,IAAIC,EAAW5X,KAAM8P,EAAUlK,EAAQ6R,GAEvDI,EAAc,IAAI7X,KAAKoW,YAAY/L,UAAUgC,QAAOyL,GAAcA,EAAWL,QAAUE,EAAcF,QAAOrW,OAAS,EAMzH,OAJ0BsW,EAAtBD,IAAU,EAAA9X,MAAMgX,KAAekB,GAAe7X,KAAKsD,MAAMyU,eAAiB/X,KAAKsD,MAAM0U,mBAC3EhY,KAAK4H,MAAQiQ,GAAe7X,KAAKsD,MAAMyU,eAAiB/X,KAAKsD,MAAM0U,mBAAqBhY,KAAKsD,MAAMyU,eACjHJ,EAAcD,OAASA,EAEhBC,EAEDf,SACN,IAAIhQ,EAAI5G,KAAKqI,SAASzB,EAAI5G,KAAKsD,MAAM2U,kBAAoB,EAAIjY,KAAKsD,MAAM4U,QAAU,EAAIlY,KAAKsD,MAAMkF,YAC7FxI,KAAK4J,OAAOxI,OAASpB,KAAK6J,QAAQzI,QACpCpB,KAAKmY,0BAA0BvR,GAC/BA,EAAI5G,KAAKqI,SAASzB,EAAK5G,KAAK4J,OAAOxI,OAASpB,KAAKsD,MAAM2U,kBAAqB,EAAKjY,KAAK6J,QAAQzI,OAASpB,KAAKsD,MAAM2U,kBAAqB,EAAIjY,KAAKsD,MAAM2U,kBAAoB,EAAIjY,KAAKsD,MAAM4U,QAAU,EAAIlY,KAAKsD,MAAMkF,YAClNxI,KAAKoY,2BAA2BxR,KAEhC5G,KAAKoY,2BAA2BxR,GAChCA,EAAI5G,KAAKqI,SAASzB,EAAK5G,KAAK6J,QAAQzI,OAASpB,KAAKsD,MAAM2U,kBAAqB,EAAKjY,KAAK4J,OAAOxI,OAASpB,KAAKsD,MAAM2U,kBAAqB,EAAIjY,KAAKsD,MAAM2U,kBAAoB,EAAIjY,KAAKsD,MAAM4U,QAAU,EAAIlY,KAAKsD,MAAMkF,YAClNxI,KAAKmY,0BAA0BvR,IAG3BqL,oBACN,IAAIoB,EAAUrT,KAAKqI,SAASiL,UAAUtT,KAAKiD,KAAK6C,YAAYwN,WAC5DtT,KAAKiI,YAAY2L,UAAW,IAAAL,YAC1B,EAAG,EACHvT,KAAKiD,KAAK6C,YAAY0N,iBAAiB5L,MAAO5H,KAAKiD,KAAK6C,YAAY0N,iBAAiB/B,OACrF4B,EAAQ3M,EAAG2M,EAAQzM,EACnByM,EAAQ3M,EAAI1G,KAAK4H,MAAQ5H,KAAKiD,KAAK6C,YAAY2N,MAC/CJ,EAAQzM,GAAK5G,KAAKiI,YAAYC,YAAcC,EAAUC,UAAYpI,KAAK8T,GAAGrC,OAASzR,KAAKsD,MAAMkF,aAAexI,KAAKiD,KAAK6C,YAAY2N,OAGjIzT,KAAKiD,KAAK6C,YAAY2N,MAAQ,GAAKzT,KAAKiI,YAAY4N,IAAM,EAAAnW,IAAIoW,KACzD9V,KAAKiD,KAAK6C,YAAY2N,OAAS,IAAOzT,KAAKiD,KAAK6C,YAAY2N,MAAQ,GAAIzT,KAAKiI,YAAY4N,IAAM,EAAAnW,IAAI2Y,KACvGrY,KAAKiI,YAAY4N,IAAM,EAAAnW,IAAI4Y,KAE5BtY,KAAKiI,YAAY2L,WAAa,EAAAnU,SAAS8Y,WACzCvY,KAAK8T,GAAG7B,oBAGJkG,0BAA0BvR,GAChC5G,KAAK4J,OAAO9H,SAAQuL,IAClBA,EAAShF,SAAS3B,EAAI1G,KAAKqI,SAAS3B,EAAI1G,KAAKsD,MAAMgF,oBAAsB+E,EAAS/J,MAAMiF,OACxF8E,EAAShF,SAASzB,EAAIA,EACtBA,GAAK5G,KAAKsD,MAAM2U,qBAGZG,2BAA2BxR,GACjC5G,KAAK6J,QAAQ/H,SAAQuL,IACnBA,EAAShF,SAAS3B,EAAI1G,KAAKqI,SAAS3B,EAAI1G,KAAK8T,GAAGlM,MAAQ5H,KAAKsD,MAAMgF,oBAAsB+E,EAAS/J,MAAMiF,OACxG8E,EAAShF,SAASzB,EAAIA,EACtBA,GAAK5G,KAAKsD,MAAM2U,qBAGpBO,eAAe9G,EAAkB+C,EAAyBC,GACxD,IAAI+D,EAAc,KAElB/D,EAAeA,EAAapB,UAAUtT,KAAKiD,KAAK6C,YAAYwN,WAC5D,IAAIqB,EAAmB3U,KAAKqI,SAASiL,UAAUtT,KAAKiD,KAAK6C,YAAYwN,WAarE,OAXGtT,KAAK4J,OAAOxI,OAASpB,KAAKuN,SAASnM,OAAS,GAAKsT,EAAahO,EAAIiO,EAAiBjO,GACnF1G,KAAK6J,QAAQzI,OAASpB,KAAKmN,UAAU/L,OAAS,GAAKsT,EAAahO,EAAIiO,EAAiBjO,EAAI1G,KAAK8T,GAAGlM,MAAQ5H,KAAKiD,KAAK6C,YAAY2N,SAEhIgF,EAAczY,KAAKmW,UAAU1S,IAAIiO,IAG/B1R,KAAK8E,iBAAmB9E,KAAK8E,kBAAoB2T,IACnDzY,KAAK8E,gBAAgBC,OAAO0P,EAAgBC,GAC5C+D,GAAeA,EAAYC,QAAQjE,EAAgBC,IAG9C+D,EAETE,aAAajH,GACX,IAAIkH,EAAS5Y,KAAKkW,QAAQzS,IAAIiO,GAC9B,OAAIkH,aAAkB,EAAArC,UAAkB,KACjCqC,EAEDC,iBAAiBnH,GACvB,OAAO1R,KAAKoW,YAAY3S,IAAIiO,GAE9BjC,MACMzP,KAAKiD,KAAKsB,QAAU,EAAAC,UAAUC,SAElCzE,KAAKsE,KAAK,UAAWtE,KAAMA,KAAK4J,OAAOnH,KAAI4K,GAAYA,EAAStJ,WAAW3C,OAAS,EAAIiM,EAAStJ,WAAW,GAAGjB,KAAO,QAGxH8C,SACE,GAAI5F,KAAKiI,YAAY2L,WAAa,EAAAnU,SAASuU,QAAS,OAChDhU,KAAKiI,YAAYC,YAAcC,EAAUC,WAAWpI,KAAK8T,GAAGlO,SAEhE,IAAIC,EAAU7F,KAAK6F,QACnBA,EAAQE,OACR/F,KAAK8Y,gBAAgBjT,GACrB7F,KAAK+Y,WAAWlT,GAChB7F,KAAKgZ,cAAcnT,GACnB,IAAIG,EAAqBhG,KAAKiD,KAAKI,eAAeQ,KAC9CqC,EAA4BlG,KAAKiD,KAAK6C,YAAYzC,eAAeQ,MACnE7D,KAAKqD,eAAeQ,MAAQ7D,KAAKqD,eAAeQ,KAAK7D,OACjDgG,GAAsBA,EAAmBhG,OACzCkG,GAA6BA,EAA0BlG,OACxDA,KAAKmG,SACRN,EAAS7F,KAAKoG,kBAAmBpG,MACnC6F,EAAQQ,UAERrG,KAAKoW,YAAYtU,SAAQgW,GAAcA,EAAWlS,WAElD5F,KAAKsG,WAAWP,OAChB/F,KAAKuG,aACLvG,KAAKsG,WAAWD,UAEhBrG,KAAKsE,KAAK,SAAUtE,MAEd8Y,gBAAgBjT,GACtB,GAAI7F,KAAKiI,YAAYC,YAAcC,EAAUC,UACvCpI,KAAKiI,YAAY4N,IAAM,IACzB7V,KAAK4J,OAAO9H,SAAQuL,GAAYA,EAASzH,WACzC5F,KAAK6J,QAAQ/H,SAAQuL,GAAYA,EAASzH,YAG5CC,EAAQqO,UAAYlU,KAAKsD,MAAM7C,MAC/BoF,EAAQwM,KAAOrS,KAAKsD,MAAMgP,SAAW,IAAMtS,KAAKsD,MAAM+O,KACtDxM,EAAQyO,aAAe,SACvBtU,KAAK4J,OAAO9H,SAAQuL,IAClBxH,EAAQ0O,SAASlH,EAASvE,KAAMuE,EAAShF,SAAS3B,EAAI2G,EAAS/J,MAAMiF,OAASvI,KAAKsD,MAAMgF,oBAAsBtI,KAAKsD,MAAM4U,QAAS7K,EAAShF,SAASzB,MAEvJ5G,KAAK6J,QAAQ/H,SAAQuL,IACnBxH,EAAQ0O,SAASlH,EAASvE,KAAMuE,EAAShF,SAAS3B,EAAI2G,EAAS/J,MAAMiF,OAASvI,KAAKsD,MAAMgF,oBAAsBtI,KAAKsD,MAAM4U,QAAUrS,EAAQ2M,YAAYnF,EAASvE,MAAMlB,MAAOyF,EAAShF,SAASzB,UAE7L,CAEL,GADAf,EAAQqO,UAAYlU,KAAKsD,MAAM2V,uBAC1BjZ,KAAK4J,OAAOxI,OAASpB,KAAKuN,SAASnM,OAAU,EAAG,CACnD,IAAImH,EAASvI,KAAK4J,OAAOxI,OAAS,EAAIpB,KAAK4J,OAAO,GAAGtG,MAAMiF,OAASvI,KAAKuN,SAAS,GAAGjK,MAAMiF,OAC3F1C,EAAQuO,SAASpU,KAAKqI,SAAS3B,EAAI1G,KAAKsD,MAAMgF,oBAA+B,EAATC,EAAYvI,KAAKqI,SAASzB,EAAI5G,KAAKsD,MAAMkF,YAAc,EAAID,EAAiB,EAATA,EAAqB,EAATA,GAErJ,GAAKvI,KAAK6J,QAAQzI,OAASpB,KAAKmN,UAAU/L,OAAU,EAAG,CACrD,IAAImH,EAASvI,KAAK6J,QAAQzI,OAAS,EAAIpB,KAAK6J,QAAQ,GAAGvG,MAAMiF,OAASvI,KAAKmN,UAAU,GAAG7J,MAAMiF,OAC9F1C,EAAQuO,SAASpU,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAQ5H,KAAKsD,MAAMgF,oBAAqBtI,KAAKqI,SAASzB,EAAI5G,KAAKsD,MAAMkF,YAAc,EAAID,EAAiB,EAATA,EAAqB,EAATA,KAIjJwQ,WAAWlT,GACjBA,EAAQqO,UAAYlU,KAAKsD,MAAM+Q,WAC/BxO,EAAQwM,KAAOrS,KAAKsD,MAAM4V,cAAgB,IAAMlZ,KAAKsD,MAAM6V,UAC3DtT,EAAQyO,aAAe,SACvBzO,EAAQ0O,SAASvU,KAAK8I,KAAM9I,KAAKqI,SAAS3B,EAAI1G,KAAK8T,GAAGlM,MAAQ,EAAI/B,EAAQ2M,YAAYxS,KAAK8I,MAAMlB,MAAQ,EAAG5H,KAAKqI,SAASzB,EAAI5G,KAAKsD,MAAMkF,YAAc,GAEjJwQ,cAAcnT,GACpB,GAAI7F,KAAKiM,QAAS,CAIhB,IAAImN,EAQAC,EAXJxT,EAAQ4B,YAAczH,KAAKsD,MAAMgW,aACjCzT,EAAQ8B,UAAY,EAIlByR,EADyB,IAAvBpZ,KAAK4J,OAAOxI,OACiC,IAAzBpB,KAAKuN,SAASnM,OAAe,EAAoC,EAAhCpB,KAAKuN,SAAS,GAAGjK,MAAMiF,OAE1B,EAA9BvI,KAAK4J,OAAO,GAAGtG,MAAMiF,OAE7C6Q,GAAwD,EAAjCpZ,KAAKsD,MAAMgF,oBAIhC+Q,EAD0B,IAAxBrZ,KAAK6J,QAAQzI,OACkC,IAA1BpB,KAAKmN,UAAU/L,OAAe,EAAqC,EAAjCpB,KAAKmN,UAAU,GAAG7J,MAAMiF,OAE3B,EAA/BvI,KAAK6J,QAAQ,GAAGvG,MAAMiF,OAE/C8Q,GAAyD,EAAjCrZ,KAAKsD,MAAMgF,oBAEnCzC,EAAQ0T,gBACNvZ,KAAKqI,SAAS3B,EAAI0S,EAClBpZ,KAAKqI,SAASzB,EACd5G,KAAK4H,MAAQwR,EAAsBC,EACnCrZ,KAAKiI,YAAYC,YAAcC,EAAUC,UAAapI,KAAK8T,GAAGrC,OAASzR,KAAKsD,MAAM4U,QAAWlY,KAAKsD,MAAMkF,YACxG,IAIErC,WACAI,aACNvG,KAAKsG,WAAW4N,UAAYlU,KAAK0R,SAASpR,cAC1C,IAAIoG,EAAI1G,KAAKqI,SAAS3B,EAClBE,EAAI5G,KAAKqI,SAASzB,EAClB4S,EAA2B,EAAGC,EAA4B,EAC9D,GAAKzZ,KAAK4J,OAAOxI,OAASpB,KAAKuN,SAASnM,SAAY,EAAG,CACrD,IAAImH,EAASvI,KAAK4J,OAAOxI,OAAS,EAAIpB,KAAK4J,OAAO,GAAGtG,MAAMiF,OAASvI,KAAKuN,SAAS,GAAGjK,MAAMiF,OAC3F7B,GAAK1G,KAAKsD,MAAMgF,oBAA+B,EAATC,EACtCiR,EAAoC,EAATjR,EAAavI,KAAKsD,MAAMgF,oBAErD,GAAKtI,KAAK6J,QAAQzI,OAASpB,KAAKmN,UAAU/L,SAAY,EAAG,CAEvDqY,EAAqC,GADxBzZ,KAAK6J,QAAQzI,OAAS,EAAIpB,KAAK6J,QAAQ,GAAGvG,MAAMiF,OAASvI,KAAKmN,UAAU,GAAG7J,MAAMiF,QACrDvI,KAAKsD,MAAMgF,oBAEtDtI,KAAKsG,WAAW8N,SAAS1N,EAAGE,EAC1B5G,KAAK8T,GAAGlM,MAAQ4R,EAA2BC,EAC3CzZ,KAAKiI,YAAYC,YAAcC,EAAUC,UAAYpI,KAAK8T,GAAGrC,OAASzR,KAAKsD,MAAMkF,aAG7EkO,kBAAkB7Q,EAAmCW,EAAgCsR,GAC3F,IAAIxU,EAAQwU,EAAWjU,KAAKP,MAC5BuC,EAAQqO,UAAY5Q,EAAMoW,oBAC1B7T,EAAQuO,SAAS5N,EAAO6B,SAAS3B,EAAGF,EAAO6B,SAASzB,EAAGtD,EAAMyU,eAAgBzU,EAAMyU,gBAE7E3R,kBACN,MAAO,CACLiC,SAAUrI,KAAKqI,SAASxF,YACxB+E,MAAO5H,KAAK4H,MACZ6J,OAAQzR,KAAK8T,GAAGrC,OAChBkI,MAAO3Z,KAAKiM,SAGhB2N,YAAYvM,GACJA,aAAoB,EAAA2J,WACxB3J,EAAW,EAAA2J,SAASrK,YAAY3M,KAAMqN,IAEpCA,EAAS9H,OAAS,EAAAC,aAAaC,GAAIzF,KAAK4J,OAAO7H,KAAKsL,GACnDrN,KAAK6J,QAAQ9H,KAAKsL,GACvBrN,KAAK8T,GAAG+C,SACR7W,KAAK4W,SAEPiD,eAAexM,GACb,IAAI9H,EAAO8H,EAAS9H,KAChBpD,EAAQoD,IAAS,EAAAC,aAAaC,GAAKzF,KAAK4J,OAAO3E,QAAQoI,GAAYrN,KAAK6J,QAAQ5E,QAAQoI,GACxFlL,EAAQ,EACV,EAAAR,IAAIC,MAAM,+CAGZyL,EAASY,aACL1I,IAAS,EAAAC,aAAaC,GAAIzF,KAAK4J,OAAO5E,OAAO7C,EAAO,GACnDnC,KAAK6J,QAAQ7E,OAAO7C,EAAO,GAChCkL,EAASqI,SAET1V,KAAK8T,GAAG+C,SACR7W,KAAK4W,UAEPkD,SAASzM,GACP,GAAwB,iBAAbA,EAAuB,CAChC,IAAI0M,EAAgB/Z,KAAK4J,OAAOwD,MAAK4M,GAAaA,EAASlR,OAASuE,IACpE,GAAI0M,EAAe,OAAOA,EAAcpP,eAExC,GAAI3K,KAAK4J,OAAOyD,GAAW,OAAOrN,KAAK4J,OAAOyD,GAAU1C,UAE1D,OAAO,KAETsP,YACE,OAAOja,KAAK4J,OAAOnH,KAAI4K,GAAYA,EAAS1C,YAE9CuP,WAAWrQ,EAAgD/G,GACzD,GAAuB,iBAAZ+G,EAAsB,CAC/B,IAAIsQ,EAAiBna,KAAK6J,QAAQuD,MAAKgN,GAASA,EAAKtR,OAASe,IAC1DsQ,GAAgBA,EAAejV,QAAQpC,QACtC,GAAuB,iBAAZ+G,EACZ7J,KAAK6J,QAAQA,IAAU7J,KAAK6J,QAAQA,GAAS3E,QAAQpC,OACpD,CACL,IAAIuX,EAAa,IAAIjR,IACrB8H,OAAOoJ,QAAQzQ,GAAS/H,SAAQyY,IAC9B,IAAIlN,EAAWrN,KAAK6J,QAAQuD,MAAKgN,GAAQA,EAAKtR,OAASyR,EAAM,KAC7D,IAAIlN,EACC,MAAM,EAAA1L,IAAIC,MAAM,aAAe2Y,EAAM,GAAK,eADjCF,EAAWzP,IAAIyC,EAAUkN,EAAM,OAG/C,IAAIC,EAAoB,IAAIpR,IACxBqR,EAAqBJ,EAAWlJ,OAEhCzC,EAAiB+L,EAAmBC,OAAO3F,MAC/C,KAAOrG,GACLA,EAAK3K,WAAWjC,SAAQmE,IAClBuU,EAAkBlM,IAAIrI,EAAUnC,SAAU0W,EAAkB/W,IAAIwC,EAAUnC,SAAS/B,KAAKkE,GACvFuU,EAAkB5P,IAAI3E,EAAUnC,QAAS,CAACmC,OAEjDyI,EAAO+L,EAAmBC,OAAO3F,MAEnC,IAAI4F,EAAiBH,EAAkBnQ,SAEnCtG,EAA0B4W,EAAeD,OAAO3F,MACpD,KAAOhR,GAAY,CACjB,IAAK,IAAIzE,EAAI,EAAGA,EAAIyE,EAAW3C,OAAQ9B,IAAKyE,EAAWzE,GAAG4F,QAAQmV,EAAW5W,IAAIM,EAAWzE,GAAG8C,QAC/F2B,EAAW,GAAGjB,KAAOuX,EAAW5W,IAAIM,EAAW,GAAG3B,OAClD2B,EAAa4W,EAAeD,OAAO3F,OAKnC/U,KAAKiD,KAAKsB,QAAU,EAAAC,UAAU6K,MAChCrP,KAAKiD,KAAKiB,eAAe9B,QAG7BqU,kBACEzW,KAAKiI,YAAYC,UAAYlI,KAAKiI,YAAYC,YAAcC,EAAUC,UAAYD,EAAUyS,UAAYzS,EAAUC,UAEpHyS,UACE7a,KAAKiD,KAAK0I,WAAW3L,KAAKwD,IAK5BsX,OAAOrG,EAAyBC,GAC9B1U,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAExC,IAAIhD,EAAW,EAAA7R,MAAMQ,aAAaL,KAAKiD,KAAK6C,YAAYgR,aAAaiE,aAAatG,EAAe/N,EAAG+N,EAAe7N,EAAG,EAAG,GAAG9D,MAE5H9C,KAAKgb,cAAgBhb,KAAK2Y,aAAajH,GACvC1R,KAAKgb,eAAiBhb,KAAKgb,cAAcF,OAAOrG,EAAgBC,GAEhE,IAAI+D,EAAczY,KAAKwY,eAAe9G,EAAU+C,EAAgBC,GAC5D+D,IACFzY,KAAK8E,gBAAkB2T,EACvBzY,KAAK8E,gBAAgBgW,OAAOrG,EAAgBC,IAGhDuG,OAAOxG,EAAyBC,GAC9B1U,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAExC,IAAIhD,EAAW,EAAA7R,MAAMQ,aAAaL,KAAKiD,KAAK6C,YAAYgR,aAAaiE,aAAatG,EAAe/N,EAAG+N,EAAe7N,EAAG,EAAG,GAAG9D,MAExH2V,EAAczY,KAAKwY,eAAe9G,EAAU+C,EAAgBC,GAE5D+D,IAAgBzY,KAAKkb,iBACvBlb,KAAKkb,iBAAmBlb,KAAKkb,gBAAgBnW,OAAO0P,EAAgBC,GACpE+D,GAAeA,EAAYC,QAAQjE,EAAgBC,IAEnD+D,IAAiBzY,KAAK8E,iBAAoB2T,EAAYwC,OAAOxG,EAAgBC,GAE/E1U,KAAKkb,gBAAkBzC,EAEvB,IAAI0C,EAAYnb,KAAK2Y,aAAajH,GAC9ByJ,IAAcnb,KAAKob,eACrBpb,KAAKob,eAAiBpb,KAAKob,cAAcrW,OAAO0P,EAAgBC,GAChEyG,GAAaA,EAAUzC,QAAQjE,EAAgBC,IAE/CyG,IAAenb,KAAKgb,eAAkBG,EAAUF,OAAOxG,EAAgBC,GAEzE1U,KAAKob,cAAgBD,EAEvBzC,QAAQjE,EAAyBC,GAC/B1U,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC9B1U,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAExC,IAAIhD,EAAW,EAAA7R,MAAMQ,aAAaL,KAAKiD,KAAK6C,YAAYgR,aAAaiE,aAAatG,EAAe/N,EAAG+N,EAAe7N,EAAG,EAAG,GAAG9D,MAExH2V,EAAczY,KAAKwY,eAAe9G,EAAU+C,EAAgBC,GAChE+D,GAAeA,EAAY1T,OAAO0P,EAAgBC,GAClD1U,KAAKkb,iBAAmBlb,KAAKkb,gBAAgBnW,OAAO0P,EAAgBC,GACpE1U,KAAKkb,gBAAkB,KACvBlb,KAAK8E,iBAAmB9E,KAAK8E,gBAAgBC,OAAO0P,EAAgBC,GAEtE2G,KAAK5G,EAAyBC,GAC5B1U,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAEtC,IAAIhD,EAAW,EAAA7R,MAAMQ,aAAaL,KAAKiD,KAAK6C,YAAYgR,aAAaiE,aAAatG,EAAe/N,EAAG+N,EAAe7N,EAAG,EAAG,GAAG9D,MAE5H9C,KAAKgb,cAAgB,KACrB,IAAIG,EAAYnb,KAAK2Y,aAAajH,GAClCyJ,GAAaA,EAAUE,KAAK5G,EAAe6G,QAAS5G,EAAa4G,SAEjE,IAAI7C,EAAczY,KAAKwY,eAAe9G,EAAU+C,EAAgBC,GAChE+D,GAAeA,EAAY4C,KAAK5G,EAAgBC,GAElDF,QAAQC,EAAyBC,GAC/B1U,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAEzC,IAAIhD,EAAW,EAAA7R,MAAMQ,aAAaL,KAAKiD,KAAK6C,YAAYgR,aAAaiE,aAAatG,EAAe/N,EAAG+N,EAAe7N,EAAG,EAAG,GAAG9D,MAC5H,GAAI4R,EAAa9N,EAAI5G,KAAKqI,SAASzB,EAAI5G,KAAKsD,MAAMkF,YAAcxI,KAAKiD,KAAK6C,YAAY2N,MAAO,CAC3F,IAAI8H,EAAgBvb,KAAK6Y,iBAAiBnH,GAC1C6J,GAAiBA,EAAczL,eAC1B,CACL9P,KAAK8E,iBAAmB9E,KAAK8E,gBAAgB0P,QAAQC,EAAgBC,GAErE,IAAIyG,EAAYnb,KAAK2Y,aAAajH,GAClCyJ,GAAaA,EAAU3G,QAAQC,EAAe6G,QAAS5G,EAAa4G,UAGxEE,OAAO/G,EAAyBC,GAC9B1U,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAExC,IAAIhD,EAAW,EAAA7R,MAAMQ,aAAaL,KAAKiD,KAAK6C,YAAYgR,aAAaiE,aAAatG,EAAe/N,EAAG+N,EAAe7N,EAAG,EAAG,GAAG9D,MACxH2Y,EAAyBzb,KAAK2Y,aAAajH,GAE3C1R,KAAKgb,eAAiBhb,KAAKgb,cAAcU,YACvCD,IAA2Bzb,KAAKgb,cAClChb,KAAKgb,cAAcQ,OAAO/G,EAAgBC,IAE1C1U,KAAKgb,cAAcjW,OAAO0P,EAAgBC,GAC1C1U,KAAKgb,cAAgB,KACrBhb,KAAKiD,KAAK6C,YAAY6V,YAAc,KACpC3b,KAAKiD,KAAK6C,YAAY8V,SAAW,KAIvCC,gBACE7b,KAAKsE,KAAK,aAActE,MAE1B8b,QAAQC,EAAoBtH,EAAyBC,GACnD1U,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEpD,IAAIhD,EAAW,EAAA7R,MAAMQ,aAAaL,KAAKiD,KAAK6C,YAAYgR,aAAaiE,aAAatG,EAAe/N,EAAG+N,EAAe7N,EAAG,EAAG,GAAG9D,MACxHqY,EAAYnb,KAAK2Y,aAAajH,GAElCyJ,GAAaA,EAAUa,UAAYb,EAAUW,QAAQC,EAAWtH,EAAgBC,GAKlFuH,YAAYC,EAAuBhZ,GACjC,OAAO,IAAI,EAAAiZ,MAAMnc,KAAMkc,EAAMhZ,GAE/BkZ,YAAY/W,EAAgBnC,GAC1B,OAAO,IAAI,EAAAmZ,MAAMrc,KAAMqF,EAAQnC,GAEjCoZ,aAAa1M,EAAajB,EAAazL,GACrC,OAAO,IAAI,EAAAqZ,OAAOvc,KAAM4P,EAAKjB,EAAKzL,GAEpCsZ,eAAetZ,GACb,OAAO,IAAI,EAAAuZ,SAASzc,KAAMkD,GAE5BwZ,cAAc9M,EAAajB,EAAazL,GACtC,OAAO,IAAI,EAAAyZ,QAAQ3c,KAAM4P,EAAKjB,EAAKzL,GAErC0Z,WAAWhN,EAAajB,EAAaQ,EAAcjM,GACjD,OAAO,IAAI,EAAA2Z,KAAK7c,KAAM4P,EAAKjB,EAAKQ,EAAMjM,GAExC4Z,gBAAgB/O,EAAmB,GAAI7K,GACrC,OAAO,IAAI,EAAA6Z,iBAAiB/c,KAAM+N,EAAQ7K,GAE5C8Z,YAAY9Z,GACV,OAAO,IAAI,EAAA+Z,MAAMjd,KAAMkD,GAEzBga,aAAahB,EAAchZ,GACzB,OAAO,IAAI,EAAAia,OAAOnd,KAAMkc,EAAMhZ,GAEhCka,aAAala,GACX,OAAO,IAAI,EAAAma,OAAOrd,KAAMkD,GAE1Boa,iBAAiBjT,EAAmBkT,EAAmBra,GACrD,OAAO,IAAI,EAAAsa,WAAWxd,KAAMqK,EAAQkT,EAAUra,GAEhDua,aAAapT,EAAkBnH,GAC7B,OAAO,IAAI,EAAAwa,OAAO1d,KAAMqK,EAAQnH,GAElCya,aAAaza,GACX,OAAO,IAAI,EAAA0a,OAAO5d,KAAMkD,GAE1B2a,cAAcpM,EAAgBqM,EAAmC5a,GAC/D,OAAO,IAAI,EAAA6a,QAAQ/d,KAAMyR,EAAQqM,EAAW5a,GAE9C8a,YAAY9a,GACV,OAAO,IAAI,EAAA+a,MAAMje,KAAMkD,GAEzBgb,eAAezM,EAAgBpH,EAAoBnH,GACjD,OAAO,IAAI,EAAAib,SAASne,KAAMyR,EAAQpH,EAAQnH,GAI5CL,YACE,MAAO,CACLW,GAAIxD,KAAKwD,GACTsF,KAAM9I,KAAK8I,KACXT,SAAUrI,KAAKqI,SAASxF,YACxB+E,MAAO5H,KAAK4H,MACZrD,MAAOvE,KAAKuE,MACZqF,OAAQ5J,KAAK4J,OAAOnH,KAAI4K,GAAYA,EAASxK,cAC7CgH,QAAS7J,KAAK6J,QAAQpH,KAAI4K,GAAYA,EAASxK,cAC/CS,MAAOtD,KAAKsD,MACZoI,cAAe1L,KAAK0L,cACpBgG,SAAU1R,KAAK0R,SAAS7O,YACxB8G,OAAQ3J,KAAK2J,OACbsC,QAASjM,KAAKiM,QACdhE,YAAajI,KAAKiI,YAClB6L,GAAI9T,KAAK8T,GAAGjR,aAGhBnC,mBAAmBuC,EAAYH,GAC7B,OAAO,IAAI2I,EAAKxI,EAAMH,EAAKgG,KAAM,EAAA9B,QAAQ2F,YAAY7J,EAAKuF,UAAWvF,EAAK8E,MAAO9E,EAAK8G,OAAQ9G,EAAK+G,QAAS,CAC1GvG,MAAOR,EAAKQ,MACZoI,cAAe5I,EAAK4I,cACpBnH,MAAOzB,EAAKyB,MACZf,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,UACjCoC,GAAIhR,EAAKgR,MAWf,IAAY3L,EAhpBZ,SAgpBA,SAAYA,GACV,6BACA,6BAFF,CAAYA,EAAA,EAAAA,YAAA,EAAAA,UAAS,KAyBrB,IAAI6N,EAAmB,KACd,CACL3D,KAAM,QACNC,SAAU,SACV6G,UAAW,QACXD,cAAe,SACfzY,MAAO,OACP4T,WAAY,OACZqF,oBAAqB,WACrB3B,eAAgB,GAChBC,kBAAmB,EACnBoG,kBAAmB,OACnBnF,uBAAwB,QACxBK,aAAc,OACdpB,QAAS,GACTmG,QAAS,GACTC,UAAW,GACX9V,YAAa,GACbyP,kBAAmB,GACnB3P,oBAAqB,IA8BrBqN,EAAgC,KAC3B,CACLrS,MAAO,GACPoI,cAAe,GACfnH,MAAO,GACPf,IAAI,IAAAE,gBA4GR,MAAakU,UAAmB,EAAA5U,MAQ9BlD,YACS+D,EACAiM,EACPlK,EACO6R,EACPnU,GAEAF,QANO,KAAAS,KAAAA,EACA,KAAAiM,SAAAA,EAEA,KAAA2H,MAAAA,EAXT,KAAApU,eAAqE,IAAM,KAE3E,KAAAC,MAA6B,GAG7B,KAAAoU,OAAiB,EAWf1X,KAAKsD,OAAQ,IAAAG,KAAIH,EAAO,IACxBtD,KAAK+R,cACL/R,KAAKue,gBAAkB3Y,EAGjBmM,cACN,IAAItR,EAAQ,EAAAZ,MAAMiS,SAClB,KAAO9R,KAAK6D,KAAKuS,YAAY3S,IAAIhD,EAAML,aAAaK,EAAQ,EAAAZ,MAAMiS,SAClE9R,KAAK0R,SAAWjR,EAChBT,KAAK6D,KAAKuS,YAAYxL,IAAI5K,KAAK0R,SAAStR,WAAYJ,MAEtD4F,SACE5F,KAAK6D,KAAKgC,QAAQE,OAClB,IAAIyY,EAAqBxe,KAAK6D,KAAKR,eAAeyU,WAC9C9R,EAAqBhG,KAAK6D,KAAKZ,KAAKI,eAAeyU,WACnD5R,EAA4BlG,KAAK6D,KAAKZ,KAAK6C,YAAYzC,eAAeyU,YACxE9X,KAAKqD,gBAAkBrD,KAAKqD,eAAerD,OACvCwe,GAAsBA,EAAmBxe,OACzCgG,GAAsBA,EAAmBhG,OACzCkG,GAA6BA,EAA0BlG,OACxDA,KAAKue,iBACRve,KAAK6D,KAAKgC,QAAS7F,KAAKoG,kBAAmBpG,MAC7CA,KAAK6D,KAAKgC,QAAQQ,UAElBrG,KAAK6D,KAAKiT,aAAa/Q,OACvB/F,KAAKye,eACLze,KAAK6D,KAAKiT,aAAazQ,UAEvBrG,KAAKsE,KAAK,SAAUtE,MAEdoG,kBACN,IAAIiC,EAAWrI,KAAK6D,KAAKwE,SAASxF,YAGlC,OAFAwF,EAAS3B,GAAK1G,KAAK0X,OACnBrP,EAASzB,GAAM5G,KAAK6D,KAAKP,MAAMkF,YAAc,EAAIxI,KAAK6D,KAAKP,MAAMyU,eAAiB,EAC3E,CAAE1P,SAAAA,GAEHoW,eACNze,KAAK6D,KAAKiT,aAAa5C,UAAYlU,KAAK0R,SAASpR,cACjDN,KAAK6D,KAAKiT,aAAa1C,SACrBpU,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK0X,OAC5B1X,KAAK6D,KAAKwE,SAASzB,EAAI5G,KAAK6D,KAAKP,MAAMkF,YAAc,EAAIxI,KAAK6D,KAAKP,MAAMyU,eAAiB,EAC1F/X,KAAK6D,KAAKP,MAAMyU,eAChB/X,KAAK6D,KAAKP,MAAMyU,iBA3DtB,gB,oFC91BA,gBACA,UACA,UACA,UACA,UAEA,SAEA,MAAa7M,UAAoB,EAAAO,KAG/B3L,YACEmD,EACAqH,EACAjC,EACAT,EACAgC,EACAC,EACA3G,EAA0Bwb,KAG1Btb,MAAMH,EAAMC,EAAQ4F,MAAQ,cAAeT,EAAUT,EAAOgC,GAAkB,GAAIC,GAAoB,GAAI,CACxGvG,MAAOJ,EAAQI,MACfoI,cAAexI,EAAQwI,cACvBnH,MAAOrB,EAAQqB,MACff,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WAGpB1R,KAAKsK,QAAUA,EAEftK,KAAKsK,QAAQN,GAAG,aAAa,CAAC2U,EAAGC,KAC/B,IAAIlU,EAAgB,IAAI,EAAAsM,SAAShX,KAAM,EAAAwF,aAAaC,GAAImZ,EAAO/U,QAAQ,GAAGlE,SAAUiZ,EAAO/U,QAAQ,GAAGf,MACtG8V,EAAOlU,cAAgBA,EACvB1K,KAAK4Z,YAAYlP,MAEnB1K,KAAKsK,QAAQN,GAAG,cAAc,CAAC2U,EAAGC,KAChC,IAAIlU,EAAgB,IAAI,EAAAsM,SAAShX,KAAM,EAAAwF,aAAayR,IAAK2H,EAAOhV,OAAO,GAAGjE,SAAUiZ,EAAOhV,OAAO,GAAGd,MACrG8V,EAAOlU,cAAgBA,EACvB1K,KAAK4Z,YAAYlP,MAGnB1K,KAAKsK,QAAQV,OAAO9H,SAAQ,CAACqJ,EAAWhJ,IAAUgJ,EAAUT,cAAgB1K,KAAK4J,OAAOzH,KACxFnC,KAAKsK,QAAQT,QAAQ/H,SAAQ,CAACsJ,EAAYjJ,IAAUiJ,EAAWV,cAAgB1K,KAAK6J,QAAQ1H,KAE5FnC,KAAKwW,eACH,IAAMxW,KAAKiD,KAAK6C,YAAYF,OAAO5F,KAAKsK,WACxC,CAACzE,EAAmCW,EAAgCsR,KAClE,IAAIxU,EAAQwU,EAAWjU,KAAKP,MAE5BuC,EAAQ4B,YAAcnE,EAAM8a,kBAC5BvY,EAAQgC,YACRhC,EAAQiC,OAAOtB,EAAO6B,SAAS3B,EAAGF,EAAO6B,SAASzB,EAAItD,EAAMyU,eAAiB,GAC7ElS,EAAQgZ,OAAOrY,EAAO6B,SAAS3B,EAAGF,EAAO6B,SAASzB,EAAItD,EAAMyU,gBAC5DlS,EAAQgZ,OAAOrY,EAAO6B,SAAS3B,EAAIpD,EAAMyU,eAAgBvR,EAAO6B,SAASzB,GACzEf,EAAQgZ,OAAOrY,EAAO6B,SAAS3B,EAAIpD,EAAMyU,eAAgBvR,EAAO6B,SAASzB,EAAItD,EAAMyU,eAAiB,GACpGlS,EAAQiC,OAAOtB,EAAO6B,SAAS3B,EAAIpD,EAAMyU,eAAgBvR,EAAO6B,SAASzB,GACzEf,EAAQgZ,OAAOrY,EAAO6B,SAAS3B,EAAIpD,EAAMyU,eAAiB,EAAGvR,EAAO6B,SAASzB,GAC7Ef,EAAQiC,OAAOtB,EAAO6B,SAAS3B,EAAGF,EAAO6B,SAASzB,EAAItD,EAAMyU,gBAC5DlS,EAAQgZ,OAAOrY,EAAO6B,SAAS3B,EAAIpD,EAAMyU,eAAiB,EAAGvR,EAAO6B,SAASzB,EAAItD,EAAMyU,gBACvFlS,EAAQiZ,YAERjZ,EAAQmC,WACP,EAAArI,MAAMof,OAIbtP,MACMzP,KAAKiD,KAAKsB,QAAU,EAAAC,UAAUC,SAClCzE,KAAKsK,QAAQlI,QAEfS,YACE,MAAO,CACLW,GAAIxD,KAAKwD,GACTsF,KAAM9I,KAAK8I,KACXT,SAAUrI,KAAKqI,SAASxF,YACxB+E,MAAO5H,KAAK4H,MACZrD,MAAOvE,KAAKuE,MACZqF,OAAQ5J,KAAK4J,OAAOnH,KAAI4K,GAAYA,EAASxK,cAC7CgH,QAAS7J,KAAK6J,QAAQpH,KAAI4K,GAAYA,EAASxK,cAC/CS,MAAOtD,KAAKsD,MACZoI,cAAe1L,KAAK0L,cACpBgG,SAAU1R,KAAK0R,SAAS7O,YACxB8G,OAAQ3J,KAAK2J,OACbsC,QAASjM,KAAKiM,QACdhE,YAAajI,KAAKiI,YAClB6L,GAAI9T,KAAK8T,GAAGjR,YACZyH,QAAStK,KAAKsK,QAAQzH,aAG1BnC,mBAAmBuC,EAAYH,GAC7B,IAAIwH,EAAU,EAAAzB,KAAK8D,YAAY1J,EAAK6C,YAAahD,EAAKwH,SACtD,OAAO,IAAIY,EAAYjI,EAAMqH,EAAS,EAAAtD,QAAQ2F,YAAY7J,EAAKuF,UAAWvF,EAAK8E,MAAO9E,EAAK8G,OAAQ9G,EAAK+G,QAAS,CAC/Gf,KAAMhG,EAAKgG,KACXxF,MAAOR,EAAKQ,MACZoI,cAAe5I,EAAK4I,cACpBnH,MAAOzB,EAAKyB,MACZf,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,aA1FvC,gBAuGA,IAAIgN,EAAwB,KACnB,CACLpb,MAAO,GACPoI,cAAe,GACfnH,MAAO,M,iGCnHX,gBACA,SACA,UACA,UACA,UAGA,UACA,UAEA,MAAayS,UAAiB,EAAAhU,MAmC5BlD,YACS+D,EACA0B,EACAI,EACAmD,EACA5F,EAAU8b,KAGjB5b,QAPO,KAAAS,KAAAA,EACA,KAAA0B,KAAAA,EACA,KAAAI,SAAAA,EACA,KAAAmD,KAAAA,EACA,KAAA5F,QAAAA,EAPT,KAAAG,eAAiE,IAAM,KAWrErD,KAAK0R,SAAWxO,EAAQwO,SACpBxO,EAAQqU,WAAUvX,KAAKuX,SAAWrU,EAAQqU,UAC9CvX,KAAKsD,MAAQJ,EAAQI,MAAQ,IAAK2b,OAA2B/b,EAAQI,OAAU2b,IAC/Ejf,KAAKwD,IAAK,IAAAC,KAAIP,EAAQM,IAAI,IAAAE,eAC1B1D,KAAK+R,YAAY/R,KAAK0R,UACtB1R,KAAK+D,WAAa,GAClB/D,KAAKqI,SAAW,EAAArB,QAAQkY,OACxBlf,KAAK2Z,OAAQ,EAET3Z,KAAKuF,OAASC,EAAaC,IAC7BzF,KAAKgK,GAAG,QAAQ,CAACmV,EAAOrc,KAClB9C,KAAKuX,WAAUvX,KAAK6D,KAAKU,MAAMvE,KAAKuX,UAAYzU,MAtCtDyU,eAAqB,OAAOvX,KAAKof,UACjC7H,aAASA,GACX,IAAKA,GAAyB,KAAbA,EAEf,YADA,EAAA5V,IAAIC,MAAM,4BAA+B2V,EAAW,2BAItD,IAAI8H,EAAcrf,KAAKof,UACnBE,EAAc/H,GACd,IAAAgI,QAAOvf,KAAKwf,YAAcxf,KAAK6D,KAAK2T,QAAQ6H,EAAarf,KAAKwf,WAClExf,KAAKof,UAAYE,EACjBtf,KAAKwf,UAAYxf,KAAK6D,KAAKyT,MAAMgI,GAAa,CAACG,EAAcC,KACvD1f,KAAKuF,OAASC,EAAayR,KAAKjX,KAAKkF,QAAQwa,MA+BrD/U,UACE,GAAI3K,KAAKuF,OAASC,EAAayR,IAC/B,OAAIjX,KAAK+D,WAAW3C,OAAS,EAAUpB,KAAK+D,WAAW,GAAGjB,KACnD,KAF+B,EAAAnB,IAAIC,MAAM,4CAIlDsD,QAAQpC,GACF9C,KAAKuF,OAASC,EAAaC,GAC/BzF,KAAK+D,WAAWjC,SAAQmE,GAAaA,EAAUnD,KAAOA,IADjB,EAAAnB,IAAIC,MAAM,2CAGzCmQ,YAAYL,GAClB,IAAKA,EAEH,IADAA,EAAW,EAAA7R,MAAMiS,SACV9R,KAAK6D,KAAKsS,UAAU1S,IAAIiO,EAAStR,aAAeJ,KAAK6D,KAAKqS,QAAQzS,IAAIiO,EAAStR,aAAasR,EAAW,EAAA7R,MAAMiS,SAEtH9R,KAAK0R,SAAWA,EAChB1R,KAAK6D,KAAKsS,UAAUvL,IAAI5K,KAAK0R,SAAStR,WAAYJ,MAEpD4F,SACE,IAAIC,EAAU7F,KAAK6D,KAAKgC,QACxBA,EAAQE,OACR,IAAIyY,EAAqBxe,KAAK6D,KAAKR,eAAegK,SAC9CrH,EAAqBhG,KAAK6D,KAAKZ,KAAKI,eAAegK,SACnDnH,EAA4BlG,KAAK6D,KAAKZ,KAAK6C,YAAYzC,eAAegK,UACxErN,KAAKqD,gBAAkBrD,KAAKqD,eAAerD,OACvCwe,GAAsBA,EAAmBxe,OACzCgG,GAAsBA,EAAmBhG,OACzCkG,GAA6BA,EAA0BlG,OACxDA,KAAKmG,SACRN,EAAS7F,KAAKoG,kBAAmBpG,MACnC6F,EAAQQ,UAERrG,KAAK2f,cAEL3f,KAAKsE,KAAK,SAAUtE,MAEtBmG,QAAQN,EAAmCW,EAA8B6G,GACnE7G,EAAOmT,QACT9T,EAAQgC,YACRhC,EAAQ+Z,IAAIpZ,EAAO6B,SAAS3B,EAAGF,EAAO6B,SAASzB,EAA2B,EAAxByG,EAAS/J,MAAMiF,OAAY,EAAG,EAAAsX,SAASC,KACzFja,EAAQqO,UAAY7G,EAAS/J,MAAMyc,gBACnCla,EAAQma,QAGgB,UAAtB3S,EAAS1H,UACXE,EAAQgC,YACRhC,EAAQiC,OAAOtB,EAAO6B,SAAS3B,EAAGF,EAAO6B,SAASzB,EAA4B,IAAxByG,EAAS/J,MAAMiF,QACrE1C,EAAQgZ,OAAOrY,EAAO6B,SAAS3B,EAA4B,IAAxB2G,EAAS/J,MAAMiF,OAAc/B,EAAO6B,SAASzB,GAChFf,EAAQgZ,OAAOrY,EAAO6B,SAAS3B,EAAGF,EAAO6B,SAASzB,EAA4B,IAAxByG,EAAS/J,MAAMiF,QACrE1C,EAAQgZ,OAAOrY,EAAO6B,SAAS3B,EAA4B,IAAxB2G,EAAS/J,MAAMiF,OAAc/B,EAAO6B,SAASzB,GAChFf,EAAQgZ,OAAOrY,EAAO6B,SAAS3B,EAAGF,EAAO6B,SAASzB,EAA4B,IAAxByG,EAAS/J,MAAMiF,QACrE1C,EAAQiZ,cAERjZ,EAAQgC,YACRhC,EAAQ+Z,IAAIpZ,EAAO6B,SAAS3B,EAAGF,EAAO6B,SAASzB,EAAGyG,EAAS/J,MAAMiF,OAAQ,EAAG,EAAAsX,SAASC,MAEvFja,EAAQqO,UAAY1N,EAAOmT,MAAQtM,EAAS/J,MAAM2c,WAAc5S,EAASxJ,KAAKZ,KAAK8F,eAAesE,EAAS1H,WAAa0H,EAAS/J,MAAM7C,MACvIoF,EAAQ4B,YAAc4F,EAAS/J,MAAMoE,YACrC7B,EAAQqa,WAAa7S,EAAS/J,MAAM4c,WACpCra,EAAQsa,YAAc9S,EAAS/J,MAAM6c,YACrCta,EAAQma,OACRna,EAAQmC,SAEV5B,kBACE,MAAO,CACLuT,MAAO3Z,KAAK2Z,MACZtR,SAAUrI,KAAKqI,SAASxF,aAG5BsB,QAAQic,EAAyB9c,GAE/B,GAAItD,KAAKuF,OAAS6a,EAAc7a,KAAM,CACpC,IAAInD,EAAQpC,KAAKuF,OAASC,EAAayR,IAAMjX,KAAOogB,EAChD/d,EAAMrC,KAAKuF,OAASC,EAAaC,GAAKzF,KAAOogB,EACjD,GAAI/d,EAAI0B,WAAW3C,OAAS,GAAKgB,EAAM2B,WAAWc,SAASxC,EAAI0B,WAAW,IAAK,OAAO,EAIxF,IAAI,IAAAoB,YAAWnF,KAAMogB,EAAepgB,KAAK6D,KAAKZ,KAAKyC,MAAO1F,KAAK6D,KAAKZ,KAAKiB,gBAAiB,CACxF,IAAImc,EAAe,IAAI,EAAAtd,UACrB/C,KAAK6D,KAAKZ,KACVjD,KAAKuF,OAASC,EAAayR,IAAMjX,KAAOogB,EACxCpgB,KAAKuF,OAASC,EAAaC,GAAKzF,KAAOogB,EACvC,CAAE9c,MAAAA,IAIJ,OAFAtD,KAAK6D,KAAKZ,KAAKc,WAAW6G,IAAIyV,EAAa7c,GAAI6c,IAExC,EACF,OAAO,EAUhBpS,WAAWhI,GACT,GAAIjG,KAAKuF,OAASC,EAAaC,GAE7B,OADAzF,KAAKsgB,YAAYtgB,KAAK+D,WAAW,KAC1B,EAEP,GAAyB,iBAAdkC,EAAwB,CACjC,IAAIsa,EAAOvgB,KAAK+D,WAAWqJ,MAAMoT,GAAYA,EAAShd,KAAOyC,IAC7D,IAAKsa,EAEH,OADA,EAAA5e,IAAIC,MAAM,0CAA2CqE,IAC9C,EAETjG,KAAKsgB,YAAYC,QACZ,GAAIta,aAAqB,EAAAlD,UAAW,CACzC,IAAK/C,KAAK+D,WAAWqJ,MAAKmT,GAAQA,EAAK/c,KAAOyC,EAAUzC,KAEtD,OADA,EAAA7B,IAAIC,MAAM,wFAAyFqE,IAC5F,EAETjG,KAAKsgB,YAAYra,QAEjBjG,KAAK+D,WAAWjC,SAAQye,GAAQvgB,KAAKsgB,YAAYC,KAEnD,OAAO,EAGHD,YAAYra,GAClB,IAAKwa,EAAWC,GAAW,CAACza,EAAU7D,MAAO6D,EAAU5D,KACvDrC,KAAK6D,KAAKZ,KAAKc,WAAWgI,OAAO9F,EAAUzC,IAC3CyC,EAAU7D,MAAM2B,WAAWiB,OAAOiB,EAAU7D,MAAM2B,WAAW4c,WAAUJ,GAAQA,EAAK/c,KAAOyC,EAAUzC,KAAK,GAC1GyC,EAAU5D,IAAI0B,WAAW6c,MACzB5gB,KAAK6D,KAAKZ,KAAKiB,eAAe+J,WAAWwS,EAAU5c,KAAM6c,EAAQ7c,MACjEoC,EAAU7D,MAAMye,aAAa5a,EAAWwa,EAAWC,GACnDza,EAAU5D,IAAIwe,aAAa5a,EAAWwa,EAAWC,GAE3Cf,cACN,IAAI9Z,EAAU7F,KAAK6D,KAAKiT,aACxBjR,EAAQE,OAERF,EAAQgC,YACRhC,EAAQ+Z,IAAI5f,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAKsD,MAAMiF,OAASvI,KAAK6D,KAAKP,MAAMgF,oBAAqB,EAAG,EAAAuX,SAASC,KACnHja,EAAQqO,UAAYlU,KAAK0R,SAASpR,cAClCuF,EAAQma,OAERna,EAAQQ,UAEVya,cACE,OAAO9gB,KAAK+D,WAAW3C,OAAS,EAGlCsX,QAAQjE,EAAyBC,GAC/B1U,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAEzC1U,KAAK2Z,OAAQ,EACb3Z,KAAK6D,KAAKZ,KAAK6C,YAAYib,OAAS,UAEtChc,OAAO0P,EAAyBC,GAC9B1U,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAExC1U,KAAK2Z,OAAQ,EACb3Z,KAAK6D,KAAKZ,KAAK6C,YAAYib,OAAS,QAEtCjG,OAAOrG,EAAyBC,GAG9B,GAFA1U,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAEpC1U,KAAK+D,WAAW3C,OAAS,EAC3B,GAAIpB,KAAKuF,OAASC,EAAaC,GAAI,CACjC,IAAKgb,EAAWC,GAAW,CAAC1gB,KAAK+D,WAAW,GAAG3B,MAAOpC,KAAK+D,WAAW,GAAG1B,KACzErC,KAAK+D,WAAW,GAAGD,QAAQgB,gBAAkB,KAC7C9E,KAAK+D,WAAW,GAAG1B,IAAM,KACzBrC,KAAK+D,WAAW,GAAGD,QAAU,KAC7B9D,KAAK+D,WAAW,GAAGJ,YAAc+Q,EACjC1U,KAAK6D,KAAKZ,KAAK6C,YAAYgG,kBAAoB9L,KAAK+D,WAAW,GAC/D,IAAIid,EAAmBhhB,KAAK+D,WAAW6c,MACvC5gB,KAAK6D,KAAKZ,KAAKiB,eAAe+J,WAAWwS,EAAU5c,KAAM6c,EAAQ7c,MACjEmd,EAAiB5e,MAAMye,aAAaG,EAAkBP,EAAWC,GACjE1gB,KAAK6gB,aAAaG,EAAkBP,EAAWC,OAC1C,CACL,GAAI1gB,KAAK6D,KAAKZ,KAAK6C,YAAYgG,kBAAmB,OAClD,IAAI7F,EAAY,IAAI,EAAAlD,UAAU/C,KAAK6D,KAAKZ,KAAMjD,KAAM,KAAM,CAAE2D,YAAa+Q,IACzE1U,KAAK6D,KAAKZ,KAAKc,WAAW6G,IAAI3E,EAAUzC,GAAIyC,GAC5CjG,KAAK6D,KAAKZ,KAAK6C,YAAYgG,kBAAoB7F,MAE5C,CACL,GAAIjG,KAAK6D,KAAKZ,KAAK6C,YAAYgG,kBAAmB,OAClD,IAAI7F,EAAY,IAAI,EAAAlD,UAClB/C,KAAK6D,KAAKZ,KACVjD,KAAKuF,OAASC,EAAaC,GAAK,KAAOzF,KACvCA,KAAKuF,OAASC,EAAaC,GAAKzF,KAAO,KACvC,CAAE2D,YAAa+Q,IAEjB1U,KAAK6D,KAAKZ,KAAKc,WAAW6G,IAAI3E,EAAUzC,GAAIyC,GAC5CjG,KAAK6D,KAAKZ,KAAK6C,YAAYgG,kBAAoB7F,GAGnDoV,KAAK5G,EAAyBC,GAC5B1U,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExC8G,OAAO/G,EAAyBC,GAC9B1U,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CF,QAAQC,EAAyBC,GAC/B1U,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3CuG,OAAOxG,EAAyBC,GAC9B1U,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CmH,gBACE7b,KAAKsE,KAAK,aAActE,MAE1BoE,UAAU6B,GACRjG,KAAKsE,KAAK,UAAWtE,KAAMiG,GAE7B4a,aAAa5a,EAAsBgH,EAA0BK,GAC3DtN,KAAKsE,KAAK,aAActE,KAAMiG,EAAWgH,EAAeK,GAG1D2T,QAAQne,GACF9C,KAAKuF,OAASC,EAAaC,IAC7BzF,KAAKsE,KAAK,QAAStE,KAAM8C,GAG7Boe,KAAKpe,GACC9C,KAAKuF,OAASC,EAAayR,KAAkC,IAA3BjX,KAAK+D,WAAW3C,SACpDpB,KAAK+D,WAAWjC,SAAQmE,IACtBA,EAAU5D,KAAO4D,EAAU5D,IAAI4e,QAAQne,MAEzC9C,KAAKsE,KAAK,OAAQtE,KAAM8C,IAI5BD,YACE,MAAO,CACLiG,KAAM9I,KAAK8I,KACXvD,KAAMvF,KAAKuF,KACXI,SAAU3F,KAAK2F,SACf4R,SAAUvX,KAAKuX,SACf/T,GAAIxD,KAAKwD,GACTF,MAAOtD,KAAKsD,MACZoO,SAAU1R,KAAK0R,SAAS7O,aAG5BnC,mBAAmBmD,EAAYf,GAC7B,OAAO,IAAIkU,EAASnT,EAAMf,EAAKyC,KAAMzC,EAAK6C,SAAU7C,EAAKgG,KAAM,CAC7DyO,SAAUzU,EAAKyU,SACfjU,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,aAKvC,IAAYlM,EAnTZ,aAmTA,SAAYA,GACV,eACA,iBAFF,CAAYA,EAAA,EAAAA,eAAA,EAAAA,aAAY,KAwBxB,IAAIyZ,EAAuB,KAClB,CACL1W,OAAQ,EACR9H,MAAO,OACPiH,YAAa,OACbwY,WAAY,EACZC,YAAa,OACbF,WAAY,UACZF,gBAAiB,cAerB,MAAMf,EAAyB,KACtB,CACL1b,MAAO,M,oFC9WX,gBACA,UAEA,UAGA,MAAamH,UAAmB,EAAAgB,KAS9B3L,YACEmD,EACA6F,EACAT,EACAT,EACAgC,EACAC,EACA3G,EAA6Bie,KAG7B/d,MAAMH,EAAM6F,EAAMT,EAAUT,EAAOgC,EAAQC,EAAS,CAClDvG,MAAOJ,EAAQI,MACfoI,cAAexI,EAAQwI,cACvBnH,MAAOrB,EAAQqB,MACff,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WAGhB1R,KAAK4J,OAAOxI,OAAS,EACvBpB,KAAK4J,OAAO,GAAGI,GAAG,QAAQ,CAAC2U,EAAG7b,IAAS9C,KAAK0K,cAAcxF,QAAQpC,KAElE9C,KAAK6J,QAAQ,GAAGG,GAAG,WAAW,CAAC2U,EAAG1Y,KAC5BjG,KAAK0K,cAAc3G,WAAW3C,OAAS,IACzC6E,EAAUnD,KAAO9C,KAAK0K,cAAc3G,WAAW,GAAGjB,SA7BtD4H,oBAA4B,OAAO1K,KAAKohB,eACxC1W,kBAAc2C,GAChBrN,KAAKohB,eAAiB/T,EACtBrN,KAAKohB,eAAepX,GAAG,QAAQ,CAAC2U,EAAG7b,IAAS9C,KAAK6J,QAAQ,GAAG3E,QAAQpC,KAgCtED,YACE,MAAO,CACLW,GAAIxD,KAAKwD,GACTsF,KAAM9I,KAAK8I,KACXT,SAAUrI,KAAKqI,SAASxF,YACxB+E,MAAO5H,KAAK4H,MACZrD,MAAOvE,KAAKuE,MACZqF,OAAQ5J,KAAK4J,OAAOnH,KAAI4K,GAAYA,EAASxK,cAC7CgH,QAAS7J,KAAK6J,QAAQpH,KAAI4K,GAAYA,EAASxK,cAC/CS,MAAOtD,KAAKsD,MACZoI,cAAe1L,KAAK0L,cACpBgG,SAAU1R,KAAK0R,SAAS7O,YACxB8G,OAAQ3J,KAAK2J,OACbsC,QAASjM,KAAKiM,QACdhE,YAAajI,KAAKiI,YAClB6L,GAAI9T,KAAK8T,GAAGjR,YACZwe,gBAAiBrhB,KAAK0K,cAAclH,IAGxC9C,mBAAmBuC,EAAYH,GAC7B,OAAO,IAAI2H,EAAWxH,EAAMH,EAAKgG,KAAM,EAAA9B,QAAQ2F,YAAY7J,EAAKuF,UAAWvF,EAAK8E,MAAO9E,EAAK8G,OAAQ9G,EAAK+G,QAAS,CAChHvG,MAAOR,EAAKQ,MACZoI,cAAe5I,EAAK4I,cACpBnH,MAAOzB,EAAKyB,MACZf,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,aA/DvC,eA+EA,IAAIyP,EAA2B,KACtB,CACL7d,MAAO,GACPoI,cAAe,GACfnH,MAAO,M,iFCxFX,eAEA,MAAayC,EAIXlH,YAAYwhB,EAAgC1a,GACtC0a,aAAuBC,UACxBvhB,KAAK0G,EAAG1G,KAAK4G,GAAK,CAAC0a,EAAY5a,EAAG4a,EAAY1a,IAE9C5G,KAAK0G,EAAG1G,KAAK4G,GAAK,CAAC0a,GAAe,EAAG1a,GAAK,GAM/C4a,WAAWC,EAAwBC,GAWjC,OAVID,aAAgBza,GAClBhH,KAAK0G,GAAK+a,EAAK/a,EACf1G,KAAK4G,GAAK6a,EAAK7a,QACU,IAAT8a,GAChB1hB,KAAK0G,GAAK+a,EACVzhB,KAAK4G,GAAK6a,IAEVzhB,KAAK0G,GAAK+a,EACVzhB,KAAK4G,GAAK8a,GAEL1hB,KAKT2hB,gBAAgBF,EAAwBC,GAWtC,OAVID,aAAgBza,GAClBhH,KAAK0G,GAAK+a,EAAK/a,EACf1G,KAAK4G,GAAK6a,EAAK7a,QACU,IAAT8a,GAChB1hB,KAAK0G,GAAK+a,EACVzhB,KAAK4G,GAAK6a,IAEVzhB,KAAK0G,GAAK+a,EACVzhB,KAAK4G,GAAK8a,GAEL1hB,KAKT4hB,gBAAgBH,EAAwBC,GAWtC,OAVID,aAAgBza,GAClBhH,KAAK0G,GAAK+a,EAAK/a,EACf1G,KAAK4G,GAAK6a,EAAK7a,QACU,IAAT8a,GAChB1hB,KAAK0G,GAAK+a,EACVzhB,KAAK4G,GAAK6a,IAEVzhB,KAAK0G,GAAK+a,EACVzhB,KAAK4G,GAAK8a,GAEL1hB,KAIT6hB,iBAAiBjS,EAAajB,EAAamT,EAAeC,GASxD,YARoB,IAATD,QAAwC,IAATC,GACxC/hB,KAAK0G,GAAI,IAAApF,WAAUtB,KAAK0G,EAAGkJ,EAAKjB,GAChC3O,KAAK4G,GAAI,IAAAtF,WAAUtB,KAAK4G,EAAGkb,EAAMC,KAEjC/hB,KAAK0G,GAAI,IAAApF,WAAUtB,KAAK0G,EAAGkJ,EAAKjB,GAChC3O,KAAK4G,GAAI,IAAAtF,WAAUtB,KAAK4G,EAAGgJ,EAAKjB,IAG3B3O,KAITgiB,aAAapS,EAAajB,EAAamT,EAAeC,GASpD,YARoB,IAATD,QAAwC,IAATC,GACxC/hB,KAAK0G,GAAI,IAAAxE,OAAMlC,KAAK0G,EAAGkJ,EAAKjB,GAC5B3O,KAAK4G,GAAI,IAAA1E,OAAMlC,KAAK4G,EAAGkb,EAAMC,KAE7B/hB,KAAK0G,GAAI,IAAAxE,OAAMlC,KAAK0G,EAAGkJ,EAAKjB,GAC5B3O,KAAK4G,GAAI,IAAA1E,OAAMlC,KAAK4G,EAAGgJ,EAAKjB,IAGvB3O,KAETiiB,iBAAiB3O,GACf,IAAI4O,EAAmB5O,EAAU6O,eAAeniB,MAEhD,OADCA,KAAK0G,EAAG1G,KAAK4G,GAAK,CAACsb,EAAiBxb,EAAGwb,EAAiBtb,GAClD5G,KAEToiB,aAGE,OAFApiB,KAAK0G,EAAI9F,KAAKyhB,IAAIriB,KAAK0G,GACvB1G,KAAK4G,EAAIhG,KAAKyhB,IAAIriB,KAAK4G,GAChB5G,KAMT6K,IAAI4W,EAAwBC,GAC1B,OAAQ,IAAI1a,EAAQhH,KAAK0G,EAAG1G,KAAK4G,GAAW4a,WAAWC,EAAMC,GAK/DY,SAASb,EAAwBC,GAC/B,OAAQ,IAAI1a,EAAQhH,KAAK0G,EAAG1G,KAAK4G,GAAW+a,gBAAgBF,EAAMC,GAKpE3N,SAAS0N,EAAwBC,GAC/B,OAAQ,IAAI1a,EAAQhH,KAAK0G,EAAG1G,KAAK4G,GAAWgb,gBAAgBH,EAAMC,GAIpEpgB,UAAUsO,EAAajB,EAAamT,EAAeC,GACjD,OAAO,IAAI/a,EAAQhH,KAAK0G,EAAG1G,KAAK4G,GAAGib,iBAAiBjS,EAAKjB,EAAKmT,EAAMC,GAItE7f,MAAM0N,EAAajB,EAAamT,EAAeC,GAC7C,OAAO,IAAI/a,EAAQhH,KAAK0G,EAAG1G,KAAK4G,GAAGob,aAAapS,EAAKjB,EAAKmT,EAAMC,GAIlEQ,SAASd,EAAwBC,EAAwBc,EAAeC,GACtE,GAAIhB,aAAgBza,GAAW0a,aAAgB1a,EAAS,CACtD,GAAIhH,KAAK0G,EAAI+a,EAAK/a,GAAK1G,KAAK0G,EAAIgb,EAAKhb,EAAG,OAAO,EAC/C,GAAI1G,KAAK4G,EAAI6a,EAAK7a,GAAK5G,KAAK4G,EAAI8a,EAAK9a,EAAG,OAAO,MAC1C,CACL,GAAI5G,KAAK0G,EAAI+a,GAAQzhB,KAAK0G,EAAI8b,EAAM,OAAO,EAC3C,GAAIxiB,KAAK4G,EAAI8a,GAAQ1hB,KAAK4G,EAAI6b,EAAM,OAAO,EAG7C,OAAO,EAKTC,OAAOjB,EAAwBC,GAW7B,OAVID,aAAgBza,GAClBhH,KAAK0G,EAAI+a,EAAK/a,EACd1G,KAAK4G,EAAI6a,EAAK7a,QACW,IAAT8a,GAChB1hB,KAAK0G,EAAI+a,EACTzhB,KAAK4G,EAAI6a,IAETzhB,KAAK0G,EAAI+a,EACTzhB,KAAK4G,EAAI8a,GAEJ1hB,KAETsT,UAAUA,GACR,OAAO,IAAItM,EAAQhH,KAAK0G,EAAG1G,KAAK4G,GAAGqb,iBAAiB3O,GAEtD+O,MACE,OAAO,IAAIrb,EAAQhH,KAAK0G,EAAG1G,KAAK4G,GAAGwb,aAErCjhB,WACE,MAAO,IAAMnB,KAAK0G,EAAEnF,QAAQ,GAAK,KAAOvB,KAAK4G,EAAErF,QAAQ,GAAK,IAE9D+Z,QACE,OAAO,IAAItU,EAAQhH,KAAK0G,EAAG1G,KAAK4G,GAElC+H,MACE,OAAO/N,KAAK+N,IAAI3O,KAAK0G,EAAG1G,KAAK4G,GAE/BpG,QAAQmiB,EAAiBC,GACvB,YAAyB,IAAdA,EACF5b,EAAQC,SAASjH,KAAM2iB,IAAWC,EAGpC5iB,KAAK0G,IAAMic,EAAOjc,GAAK1G,KAAK4G,IAAM+b,EAAO/b,EAGlDlG,gBAAgBmiB,EAA+BC,EAA+BC,EAAaC,GACzF,OAAIH,aAAuB7b,GAAW8b,aAAuB9b,EACpDpG,KAAKqiB,KAAKriB,KAAKsiB,IAAIJ,EAAYpc,EAAImc,EAAYnc,EAAG,GAAK9F,KAAKsiB,IAAIJ,EAAYlc,EAAIic,EAAYjc,EAAG,IACtE,iBAAhBic,GAAmD,iBAAhBC,EAC5CliB,KAAKqiB,KAAKriB,KAAKsiB,IAAIH,EAAKF,EAAa,GAAKjiB,KAAKsiB,IAAIF,EAAKF,EAAa,SADvE,EAITpiB,gBAAgByiB,EAAkBC,GAChC,OAAO,IAAIpc,GAASmc,EAAQzc,EAAI0c,EAAQ1c,GAAK,GAAIyc,EAAQvc,EAAIwc,EAAQxc,GAAK,GAE5ElG,cACE,OAAO,IAAIsG,EAAQ,EAAG,GAExBtG,cAAc2iB,EAAcC,EAAcxB,EAAcC,GACtD,OAAO,IAAI/a,EACTpG,KAAKyU,UAAYiO,EAAOD,GAAQA,EAChCziB,KAAKyU,UAAY0M,EAAOD,GAAQA,GAIpCjf,YACE,MAAO,CAAE6D,EAAG1G,KAAK0G,EAAGE,EAAG5G,KAAK4G,GAE9BlG,mBAAmBoC,GACjB,OAAO,IAAIkE,EAAQlE,EAAK4D,EAAG5D,EAAK8D,IAxMpC,a,kcCHA,gBACA,UAEA,SACA,UACA,UACA,UACA,SACA,UAgBA,MAAa2c,UAAoB,EAAAvgB,MA6G/B,YAAoBwgB,GAClBpgB,QA7FF,KAAAqgB,iBAAkD,IAAIra,IAEtD,KAAAsa,iBAA6C,IAAIta,IAkBjD,KAAAoK,iBAA8B,CAAEmQ,IAAK,EAAGC,KAAM,EAAGhc,MAAO,EAAG6J,OAAQ,GAKnE,KAAAlN,MAA0Bsf,EAAiBpf,QAW3C,KAAAqf,MAAgB,GAehB,KAAAlI,SAAsB,GACd,KAAAmI,OAAkC,GAClC,KAAAC,cAAyC,CAAE,aAAe,GAG1D,KAAAC,aAAiCnR,SAASC,cAAc,SAKhE,KAAAmR,SAAmB,GACnB,KAAAC,SAAmB,EACnB,KAAAC,gBAA0B,KAC1B,KAAAC,gBAA0B,KAE1B,KAAAC,cAAwB,EAChB,KAAAC,WAAwB,IAAIC,UAI5B,KAAAC,iBAA8B,IAAID,UAClC,KAAAE,SAAsB,IAAIF,UAGlC,KAAAG,WAAqB,EAKZ,KAAAthB,eAOL,GAOFrD,KAAK4kB,cAAcpB,GACnBxjB,KAAK6kB,iBACL7kB,KAAK8kB,0BAAyB,GAC9B9kB,KAAK+kB,0BACL/kB,KAAKglB,eACLhlB,KAAKilB,cACLjlB,KAAKklB,iBACLllB,KAAKmlB,kBArHPzkB,oBAAoB8iB,GAClB,IAAI1d,EAAc,IAAIyd,EAAYC,GAElC,aADM1d,EAAYsf,oBACXtf,EAMLD,cAAsC,OAAO7F,KAAKqlB,SAIlDC,mBAA+B,OAAOtlB,KAAKulB,cAU3Cjf,iBAA6E,OAAOtG,KAAKwlB,YAKzF1O,mBAA+E,OAAO9W,KAAKylB,cAK3FxR,sBAAkF,OAAOjU,KAAK0lB,iBAK9F3E,aAAmB,OAAO/gB,KAAK2lB,OAAOriB,MAAMyd,OAC5CA,WAAOA,GAAkB/gB,KAAK2lB,OAAOriB,MAAMyd,OAASA,EA0CpDtN,YAAkB,OAAOzT,KAAKukB,WAAWllB,EAKzCiU,gBAAyB,OAAOtT,KAAKukB,WAQrCqB,WAAiB,OAAQ5lB,KAAK2kB,UAAY,EAAK3kB,KAAK2kB,UAAakB,YAAYC,MAAQ9lB,KAAK2kB,UA2BtFI,0BACN,IAAIgB,GAAW,EACfjT,SAASkT,iBAAiB,UAAU,KAC7BD,IACHE,OAAOC,uBAAsB,KAC3BlmB,KAAK8kB,0BAAyB,GAC9BiB,GAAW,KAEbA,GAAW,MAGf/lB,KAAKmmB,kBAAkBnmB,KAAK2lB,OAAOS,eAE7BD,kBAAkBE,GACxBrmB,KAAKsmB,sBAAwBtmB,KAAKsmB,qBAAqBrY,aACvDjO,KAAKumB,oBAAsBvmB,KAAKumB,mBAAmBtY,aAEnDjO,KAAKsmB,qBAAuB,IAAIE,gBAAe,KAC7CxmB,KAAK8kB,0BAAyB,GAC9B9kB,KAAKymB,gBAAgB,KAAM,KAAM,SAEnCzmB,KAAKsmB,qBAAqBI,QAAQL,GAC9BA,IAAWvT,SAASG,OACtBjT,KAAKumB,mBAAqB,IAAIC,gBAAe,KAC3CxmB,KAAK8kB,0BAAyB,GAC9B9kB,KAAKymB,gBAAgB,KAAM,KAAM,SAEnCzmB,KAAKumB,mBAAmBG,QAAQ5T,SAASG,OAGrC2R,cAAcpB,GACfA,EAKMA,aAAiBmD,gBAC1B3mB,KAAK2lB,OAAS7S,SAASC,cAAc,UACrC/S,KAAK2lB,OAAO/d,MAAQ4b,EAAMoD,YAC1B5mB,KAAK2lB,OAAOlU,OAAS+R,EAAMqD,aAC3BrD,EAAMtQ,YAAYlT,KAAK2lB,SACdnC,aAAiBsD,kBAC1B9mB,KAAK2lB,OAASnC,EAEd,EAAA7hB,IAAIC,MAAM,sEAZV5B,KAAK2lB,OAAS7S,SAASC,cAAc,UACrC/S,KAAK2lB,OAAO/d,MAAQkL,SAASG,KAAK2T,YAClC5mB,KAAK2lB,OAAOlU,OAASqB,SAASG,KAAK4T,aACnC/T,SAASG,KAAKC,YAAYlT,KAAK2lB,SAYjCzU,OAAOwR,OAAO1iB,KAAK2lB,OAAOriB,MAAO,CAC/B+E,SAAU,WACVT,MAAO,OACP6J,OAAQ,SAEVzR,KAAKqlB,SAAWrlB,KAAK2lB,OAAOoB,WAAW,MAGjClC,iBACyB,oBAApBmC,iBAAgF,oBAAtCC,mCACnDjnB,KAAKknB,UAAY,IAAIF,gBAAgBhnB,KAAKwT,iBAAiB5L,MAAO5H,KAAKwT,iBAAiB/B,QACxFzR,KAAKmnB,YAAc,IAAIH,gBAAgBhnB,KAAKwT,iBAAiB5L,MAAO5H,KAAKwT,iBAAiB/B,QAC1FzR,KAAKonB,eAAiB,IAAIJ,gBAAgBhnB,KAAKwT,iBAAiB5L,MAAO5H,KAAKwT,iBAAiB/B,UAE7FzR,KAAKknB,UAAYpU,SAASC,cAAc,UACxC/S,KAAKmnB,YAAcrU,SAASC,cAAc,UAC1C/S,KAAKonB,eAAiBtU,SAASC,cAAc,WAE/C/S,KAAKwlB,YAAcxlB,KAAKknB,UAAUH,WAAW,MAC7C/mB,KAAKylB,cAAgBzlB,KAAKmnB,YAAYJ,WAAW,MACjD/mB,KAAK0lB,iBAAmB1lB,KAAKonB,eAAeL,WAAW,MAEjD/B,eACNhlB,KAAK2lB,OAAOriB,MAAM+jB,YAAc,OAEhC,IAAIC,EAAaxU,SAASC,cAAc,SACxCuU,EAAWC,UAAY,iNACvBzU,SAAS0U,qBAAqB,QAAQ,GAAGtU,YAAYoU,GAE/CxC,yBAAyB2C,GAC/B,GAAIA,EAAQ,CACV,IAAIC,EAAqB1nB,KAAK2lB,OAAOS,cAAcuB,wBACnD3nB,KAAK2lB,OAAO/d,MAAQ8f,EAAmB9f,MACvC5H,KAAK2lB,OAAOlU,OAASiW,EAAmBjW,OACxCzR,KAAKsE,KAAK,mBAAoBtE,KAAMA,KAAK2lB,OAAO/d,MAAO5H,KAAK2lB,OAAOlU,QAGrE,IAAImW,EAAe5nB,KAAK2lB,OAAOgC,wBAC/B3nB,KAAKwT,iBAAmB,CACtBmQ,IAAK/iB,KAAKgC,MAAMglB,EAAajE,KAC7BC,KAAMhjB,KAAKgC,MAAMglB,EAAahE,MAC9Bhc,MAAOhH,KAAKgC,MAAMglB,EAAahgB,OAC/B6J,OAAQ7Q,KAAKgC,MAAMglB,EAAanW,SAGlCzR,KAAKknB,UAAUtf,MAAQ5H,KAAKwT,iBAAiB5L,MAC7C5H,KAAKknB,UAAUzV,OAASzR,KAAKwT,iBAAiB/B,OAC9CzR,KAAKmnB,YAAYvf,MAAQ5H,KAAKwT,iBAAiB5L,MAC/C5H,KAAKmnB,YAAY1V,OAASzR,KAAKwT,iBAAiB/B,OAChDzR,KAAKonB,eAAexf,MAAQ5H,KAAKwT,iBAAiB5L,MAClD5H,KAAKonB,eAAe3V,OAASzR,KAAKwT,iBAAiB/B,OAE7CwT,cACN1B,EAAYsE,UAAU5C,YAAc,EAAA6C,KACpCC,yBAAyBF,UAAUG,UAAY,SAAUthB,EAAWE,EAAWgB,EAAe6J,EAAgBlJ,GAC5GvI,KAAK6H,YACL7H,KAAK8H,OAAOpB,EAAI6B,EAAQ3B,GACxB5G,KAAK6e,OAAOnY,EAAIkB,EAAQW,EAAQ3B,GAChC5G,KAAK+H,iBAAiBrB,EAAIkB,EAAOhB,EAAGF,EAAIkB,EAAOhB,EAAI2B,GACnDvI,KAAK6e,OAAOnY,EAAIkB,EAAOhB,EAAI6K,EAASlJ,GACpCvI,KAAK+H,iBAAiBrB,EAAIkB,EAAOhB,EAAI6K,EAAQ/K,EAAIkB,EAAQW,EAAQ3B,EAAI6K,GACrEzR,KAAK6e,OAAOnY,EAAI6B,EAAQ3B,EAAI6K,GAC5BzR,KAAK+H,iBAAiBrB,EAAGE,EAAI6K,EAAQ/K,EAAGE,EAAI6K,EAASlJ,GACrDvI,KAAK6e,OAAOnY,EAAGE,EAAI2B,GACnBvI,KAAK+H,iBAAiBrB,EAAGE,EAAGF,EAAI6B,EAAQ3B,GACxC5G,KAAK8e,aAEPiJ,yBAAyBF,UAAUtO,gBAAkB,SAAU7S,EAAWE,EAAWgB,EAAe6J,EAAgBlJ,QAC5F,IAAXA,IAAwBA,EAAS,GAC5CvI,KAAKgoB,UAAUthB,EAAGE,EAAGgB,EAAO6J,EAAQlJ,GACpCvI,KAAKgI,UAEP+f,yBAAyBF,UAAUI,cAAgB,SAAUvhB,EAAWE,EAAWgB,EAAe6J,EAAgBlJ,QAC1F,IAAXA,IAAwBA,EAAS,GAC5CvI,KAAKgoB,UAAUthB,EAAGE,EAAGgB,EAAO6J,EAAQlJ,GACpCvI,KAAKggB,QAGDkF,iBACN,IAAIgD,EACAC,EAA2B,EAAAnhB,QAAQkY,OACnCkJ,GAA6B,EAEjCnC,OAAOoC,UAAaC,KACjBtoB,KAAK+jB,OAAOuE,EAAGlX,OAASpR,KAAK+jB,OAAOuE,EAAGlX,MAAO,IAEjD6U,OAAOsC,QAAWD,IAChBtoB,KAAK+jB,OAAOuE,EAAGlX,MAAO,GAGxBpR,KAAK2lB,OAAO6C,cAAiBF,IACtBtoB,KAAKyoB,WAEVzoB,KAAK0oB,WAAWJ,EAAGK,UAAW3oB,KAAK4oB,oBAAoBN,IAC1B,IAAzBtoB,KAAK4b,SAASxa,QAChB+mB,EAAkBnoB,KAAK4b,SAAS,GAAGnH,eACnCzU,KAAK2b,YAAc3b,KAAK6oB,WAAW7oB,KAAK4b,SAAS,GAAGnH,gBAChDzU,KAAK2b,aACP3b,KAAK2b,YAAYhS,OAASmf,OAAOC,iBAC7B/oB,KAAK+jB,OAAgB,QACvB/jB,KAAK2b,YAAY1P,SAAWjM,KAAK2b,YAAY1P,SAE7CjM,KAAKyoB,SAASzc,iBACdhM,KAAK2b,YAAY1P,SAAU,GAE7BjM,KAAK2b,YAAYb,OAAO9a,KAAK4b,SAAS,GAAGnH,eAAe6G,QAAStb,KAAK4b,SAAS,GAAGlH,aAAa4G,SAC/F4M,EAAYloB,KAAK2b,YAAYtT,SAAS0L,SAAS/T,KAAK4b,SAAS,GAAGlH,eAE3D1U,KAAK+jB,OAAgB,SAMjB/jB,KAAK+jB,OAAgB,SAAK/jB,KAAKgkB,cAA2B,eACjEhkB,KAAKgpB,gBAAkBhpB,KAAK4b,SAAS,GAAGlH,aAAa4G,QACrDtb,KAAKipB,UAAY,IAAI,EAAApc,MAAM7M,KAAKyoB,SAAUzoB,KAAKgpB,gBAAgB1N,QAAS,CAAExS,KAAM,gBAPhF9I,KAAKyoB,SAASzc,iBAEdhM,KAAKkpB,aAAelpB,KAAKmpB,YAAYnpB,KAAK4b,SAAS,GAAGnH,gBACtDzU,KAAKkpB,eAAiBhB,EAAYloB,KAAKkpB,aAAa7gB,SAAS0L,SAAS/T,KAAK4b,SAAS,GAAGlH,kBAQ3F1U,KAAK2b,YAAc,KACnB3b,KAAKkpB,aAAe,KACpBlpB,KAAKyoB,SAASzc,iBACVhM,KAAK8L,mBACP9L,KAAKopB,wBAIXppB,KAAK2lB,OAAO0D,YAAef,IACzB,IAAKtoB,KAAKyoB,SAAU,OAEpBzoB,KAAKspB,cAActpB,KAAK4b,SAAU0M,GAE9BtoB,KAAK4b,SAASxa,OAAS,IAAGgnB,GAAqB,GAEnD,IAAI3T,EAAiBzU,KAAK4oB,oBAAoBN,GAC1C5T,EAAeD,EAAenB,UAAUtT,KAAKykB,kBAE7CzkB,KAAK2b,aAAa3b,KAAKupB,eAAe9U,GAE1CzU,KAAK2b,YAAc,KACnB3b,KAAKkpB,aAAe,KAEpB,IAAIM,EAAUxpB,KAAK6oB,WAAWpU,GAG9B,GAFA+U,GAAWA,EAAQnO,KAAK5G,EAAe6G,QAAS5G,EAAa4G,SAEzDtb,KAAKipB,UAAW,CAClB,IAAIQ,EAAWzpB,KAAKipB,UACpBjpB,KAAKipB,UAAY,KACbQ,EAAS7hB,MAAQ,IAAM6hB,EAAShY,OAAS,KAC3CzR,KAAKyoB,SAASpf,OAAOtH,KAAK0nB,GAC1BA,EAAS/V,qBAGT1T,KAAK8L,mBAAmB9L,KAAK0pB,iBAAiBF,EAAS/U,EAAgBC,IAE7E1U,KAAK2lB,OAAOgE,aAAgBrB,IAC1B,GAAKtoB,KAAKyoB,SAAV,CAGA,GADAzoB,KAAKspB,cAActpB,KAAK4b,SAAU0M,GACL,IAAzBtoB,KAAK4b,SAASxa,OAAc,CAC9B,GAAIpB,KAAK2b,YAAa,CACpB,IAAIlH,EAAiBzU,KAAK4oB,oBAAoBN,GAC9CtoB,KAAKupB,eAAe9U,GAEtBzU,KAAK2b,YAAc,KACnB3b,KAAKkpB,aAAe,KAGtB,GAAIlpB,KAAKipB,UAAW,CAClB,IAAIQ,EAAWzpB,KAAKipB,UACpBjpB,KAAKipB,UAAY,KACbQ,EAAS7hB,MAAQ,IAAM6hB,EAAShY,OAAS,KAC3CzR,KAAKyoB,SAASpf,OAAOtH,KAAK0nB,GAC1BA,EAAS/V,qBAMb,GAFI1T,KAAK8L,mBAAmB9L,KAAKopB,qBAE7BppB,KAAK4pB,YAAa,CACpB,IAAInV,EAAiBzU,KAAK4oB,oBAAoBN,GAC1C5T,EAAeD,EAAenB,UAAUtT,KAAKykB,kBACjDzkB,KAAK4pB,YAAY7kB,OAAO0P,EAAgBC,GACxC1U,KAAK4pB,YAAc,QAGvB5pB,KAAK2lB,OAAOkE,cAAiBvB,IAC3B,IAAKtoB,KAAKyoB,SAAU,OAEpB,IAAIhU,EAAiBzU,KAAK4oB,oBAAoBN,GAC1C5T,EAAeD,EAAenB,UAAUtT,KAAKykB,kBAIjD,GAFAzkB,KAAK8pB,cAAcxB,EAAGK,UAAWlU,EAAgBC,GAEpB,IAAzB1U,KAAK4b,SAASxa,OAAc,CAC9B,IAAI2oB,EAAoB,EAAA/iB,QAAQC,SAASjH,KAAK4b,SAAS,GAAGnH,eAAgBzU,KAAK4b,SAAS,GAAGnH,gBACvF2T,EAAoB,GAClB2B,IAAsB3B,GACxBpoB,KAAKgqB,WAAWD,EAAoB3B,EAAmB,EAAAphB,QAAQijB,SAASjqB,KAAK4b,SAAS,GAAGnH,eAAgBzU,KAAK4b,SAAS,GAAGnH,gBAAiBzU,KAAKqkB,iBAGpJ+D,EAAoB2B,EAWtB,GARI/pB,KAAKipB,YACHvU,EAAahO,EAAI1G,KAAKgpB,gBAAgBtiB,IAAG1G,KAAKipB,UAAU5gB,SAAS3B,EAAIgO,EAAahO,GACtF1G,KAAKipB,UAAUrhB,MAAQhH,KAAKyhB,IAAIriB,KAAKgpB,gBAAgBtiB,EAAIgO,EAAahO,GAElEgO,EAAa9N,EAAI5G,KAAKgpB,gBAAgBpiB,IAAG5G,KAAKipB,UAAU5gB,SAASzB,EAAI8N,EAAa9N,GACtF5G,KAAKipB,UAAUxX,OAAS7Q,KAAKyhB,IAAIriB,KAAKgpB,gBAAgBpiB,EAAI8N,EAAa9N,IAGrE5G,KAAK2b,aAGP,GADA3b,KAAK2b,YAAYH,OAAO/G,EAAe6G,QAAS5G,EAAa4G,SACzDtb,KAAK2b,eACD3b,KAAK2b,YAAYX,eAAkBhb,KAAK2b,YAAYX,cAAcU,WAAe1b,KAAK2b,YAAY7W,iBAAoB9E,KAAK8L,mBAAmB,CAClJ9L,KAAK2b,YAAYtT,SAAWqM,EAAa7J,IAAIqd,GAE7C,IAAIgC,EAAWlqB,KAAKmpB,YAAY1U,GAChC,GAAIyV,GAAYA,IAAalqB,KAAK2b,YAAYzP,MAAO,CACnD,IAAIyH,EAAeuW,EAAS7hB,SAASiL,UAAUtT,KAAKukB,YAChD1Q,EAAc7T,KAAK2b,YAAYtT,SAASiL,UAAUtT,KAAKukB,YAU3D,IARmB,IAAAhR,YAAWI,EAAajN,EAAGiN,EAAa/M,EACzD+M,EAAajN,EAAIwjB,EAAStiB,MAAQ5H,KAAKyT,MACvCE,EAAa/M,EAAIsjB,EAASzY,OAASzR,KAAKyT,MACxCI,EAAYnN,EAAGmN,EAAYjN,EAC3BiN,EAAYnN,EAAI1G,KAAK2b,YAAY/T,MAAQ5H,KAAKyT,MAC9CI,EAAYjN,EAAI5G,KAAK2b,YAAY7H,GAAGrC,OAASzR,KAAKyT,SAG/B,EAAAhU,SAAS+R,OAAQ,CACpC,IAAI2Y,EAAYD,EAAS/gB,MAAMwX,WAAU9c,GAAQA,EAAKL,KAAOxD,KAAK2b,YAAYnY,KAC9E0mB,EAAS3Y,WAAW4Y,GAAanqB,KAAK2b,YAAYtT,SAAS0L,SAASmW,EAAS7hB,kBAMrF,GAAIrI,KAAKkpB,aACPlpB,KAAKkpB,aAAa7gB,SAAWqM,EAAa7J,IAAIqd,QACzC,GAA6B,IAAzBloB,KAAK4b,SAASxa,SAAiBpB,KAAK+jB,OAAgB,UAAM/jB,KAAKgkB,cAA2B,YAAG,CACtG,IAAIoG,EAAQ3V,EAAeV,SAASoU,GAAiBxG,gBAAgB,EAAI3hB,KAAKyT,OAC9E0U,EAAkB1T,EAClBzU,KAAKymB,gBAAgB,KAAM,KAAM2D,GAKrC,GAFIpqB,KAAK8L,oBAAmB9L,KAAK8L,kBAAkBnI,YAAc+Q,GAE1C,UAAnB4T,EAAG+B,cAA4BrqB,KAAK2b,YAAa,CACnD,IAAI6N,EAAUxpB,KAAK6oB,WAAWpU,GAC1B+U,IAAYxpB,KAAK4pB,aACnB5pB,KAAK4pB,aAAe5pB,KAAK4pB,YAAY7kB,OAAO0P,EAAgBC,GAC5D8U,GAAWA,EAAQ9Q,QAAQjE,EAAgBC,IAE3C8U,IAAaxpB,KAAK2b,aAAgB6N,EAAQvO,OAAOxG,EAAgBC,GAEnE1U,KAAK4pB,YAAcJ,IAGvBxpB,KAAK2lB,OAAO2E,QAAWhC,IACrB,IAAKtoB,KAAKyoB,SAAU,OAEpB,IAAIhU,EAAiBzU,KAAK4oB,oBAAoBN,GAC1C5T,EAAeD,EAAenB,UAAUtT,KAAKykB,kBAC7C+E,EAAUxpB,KAAK6oB,WAAWpU,GAG9B,GAFA+U,GAAWA,EAAQhV,QAAQC,EAAe6G,QAAS5G,EAAa4G,UAE3DkO,EAAS,CACZ,IAAIU,EAAWlqB,KAAKmpB,YAAY1U,GAChCyV,GAAYA,EAAS1V,QAAQC,EAAe6G,QAAS5G,EAAa4G,WAGtEtb,KAAK2lB,OAAO4E,cAAiBjC,IAC3B,IAAKtoB,KAAKyoB,SAAU,OAEpBH,EAAGkC,iBAEH,IAAI/V,EAAiBzU,KAAK4oB,oBAAoBN,GAC1CkB,EAAUxpB,KAAK6oB,WAAWpU,GAC9B+U,GAAWA,EAAQ3N,gBACd7b,KAAK+jB,OAAgB,SAAG/jB,KAAKyoB,SAASzc,iBAC3Cwd,IAAYA,EAAQvd,SAAU,IAEhCjM,KAAK2lB,OAAO8E,QAAWnC,IACrB,IAAKtoB,KAAKyoB,SAAU,OAEpB,IAAIhU,EAAiBzU,KAAK4oB,oBAAoBN,GAC1CkB,EAAUxpB,KAAK6oB,WAAWpU,GAC9B,GAAI+U,EAAS,CACX,IAAI9X,EAAW,EAAA7R,MAAMQ,aAAaL,KAAK8W,aAAaiE,aAAatG,EAAe/N,EAAG+N,EAAe7N,EAAG,EAAG,GAAG9D,MACvGqY,EAAYqO,EAAQ7Q,aAAajH,GAGrC,GAAIyJ,GAAaA,EAAUa,SAEzB,YADAwN,EAAQ1N,QAAQwM,EAAGoC,OAAS,EAAGjW,EAAgBA,EAAenB,UAAUtT,KAAKykB,mBAK5EzkB,KAAKskB,eACRgE,EAAGkC,iBACHxqB,KAAKgqB,WAAW1B,EAAGoC,OAAS,EAAGjW,EAAgBzU,KAAKokB,mBAIlDe,kBACNnlB,KAAKikB,aAAa0G,UAAY,qBAC9B3qB,KAAKikB,aAAa3gB,MAAMsnB,WAAa,SACrC5qB,KAAKikB,aAAa3gB,MAAMunB,cAAgB,OACxC7qB,KAAKikB,aAAa3gB,MAAM4U,QAAU,IAElClY,KAAKikB,aAAa6G,OAAS,KACzB9qB,KAAKikB,aAAa3gB,MAAMsnB,WAAa,SACrC5qB,KAAKikB,aAAa3gB,MAAMunB,cAAgB,OAExC7qB,KAAKikB,aAAa8G,SAAW,MAG/BjY,SAASG,KAAKC,YAAYlT,KAAKikB,cAEzBhV,0BACDgX,OAAe+E,0BAClBhrB,KAAKulB,cAAiBU,OAAe+E,2BAErChrB,KAAKulB,cAAgB,IAAI0F,aACxBhF,OAAe+E,0BAA4BhrB,KAAKulB,eAMnD,IAAI2F,GAAgB,IAAAC,uBAAsB,EAAAC,aAAaC,gBAEvD,aADMrrB,KAAKslB,aAAagG,aAAaC,UAAU,EAAAH,aAAaC,gBACrD/b,QAAQC,IAAI2B,OAAOC,KAAK+Z,GAAezoB,KAAI2O,GAAOpR,KAAKslB,aAAagG,aAAaC,UAAUL,EAAc9Z,OAGlHwD,iBAAiBvM,EAA8B0M,EAAeyW,EAA6BC,EAAiC3b,GACtHgD,SAAS4Y,gBAAkB1rB,KAAKikB,eAEpC/S,OAAOwR,OAAO1iB,KAAKikB,aAAa3gB,MAAOkoB,GACvCta,OAAOwR,OAAO1iB,KAAKikB,aAAcwH,GAEjCva,OAAOwR,OAAO1iB,KAAKikB,aAAa3gB,MAAO,CACrCsgB,KAAOvb,EAAS3B,EAAI1G,KAAKwT,iBAAiBoQ,KAAQ,KAClDD,IAAMtb,EAASzB,EAAI5G,KAAKwT,iBAAiBmQ,IAAM,EAAK,KACpDiH,WAAY,UACZC,cAAe,QAEjB7qB,KAAKikB,aAAalP,MAAQA,EAC1B/U,KAAKikB,aAAa8G,SAAW,IAAMjb,EAAS9P,KAAKikB,aAAalP,OAC9D/U,KAAKikB,aAAatK,SAEpBgS,aAAaC,GACX5rB,KAAKmmB,kBAAkByF,GAEjB9B,cAActmB,EAAYiR,EAAyBC,GACzD,IAAImX,EAAU7rB,KAAK4b,SAASxO,MAAK0e,GAAQA,EAAKtoB,KAAOA,IACjDqoB,IACFA,EAAQpX,eAAiBA,EACzBoX,EAAQnX,aAAeA,GAGnBsV,WAAW+B,EAAiBC,EAAiBC,GAC9CjsB,KAAKukB,WAAWllB,GAAKW,KAAKmkB,UAAY4H,GAAY/rB,KAAKukB,WAAWllB,GAAKW,KAAKkkB,WAAa6H,IAC9F/rB,KAAKymB,gBAAgBsF,EAASE,EAAc,EAAIA,EAAaD,EAAQ,MACrEhsB,KAAKsE,KAAK,QAAStE,KAAKyT,QAElB8V,eAAe9U,GACrB,IAEIyX,EAFAhC,EAAWlqB,KAAKmpB,YAAY1U,GAGhC,GAAIyV,EAAU,CACZ,IAAIvW,EAAeuW,EAAS7hB,SAASiL,UAAUtT,KAAKukB,YAChD1Q,EAAc7T,KAAK2b,YAAYtT,SAASiL,UAAUtT,KAAKukB,YAE3D2H,GAAe,IAAA3Y,YAAWI,EAAajN,EAAGiN,EAAa/M,EACrD+M,EAAajN,EAAIwjB,EAAStiB,MAAQ5H,KAAKyT,MACvCE,EAAa/M,EAAIsjB,EAASzY,OAASzR,KAAKyT,MACxCI,EAAYnN,EAAGmN,EAAYjN,EAC3BiN,EAAYnN,EAAI1G,KAAK2b,YAAY/T,MAAQ5H,KAAKyT,MAC9CI,EAAYjN,EAAI5G,KAAK2b,YAAY7H,GAAGrC,OAASzR,KAAKyT,OAItD,GAAIzT,KAAK2b,YAAYzP,MACnB,GAAIlM,KAAK2b,YAAYzP,QAAUge,EAAU,CACvC,IAAIC,EAAYnqB,KAAK2b,YAAYzP,MAAM/C,MAAMwX,WAAU9c,GAAQA,EAAKL,KAAOxD,KAAK2b,YAAYnY,KAC5FxD,KAAK2b,YAAYzP,MAAM/C,MAAMnE,OAAOmlB,EAAW,GAC/CnqB,KAAK2b,YAAYzP,MAAMqF,WAAWvM,OAAOmlB,EAAW,GACpDnqB,KAAK2b,YAAYzP,MAAQ,UAEzB,GAAIggB,IAAiB,EAAAzsB,SAAS+R,OAAQ,CACpC,IAAI2Y,EAAYnqB,KAAK2b,YAAYzP,MAAM/C,MAAMwX,WAAU9c,GAAQA,EAAKL,KAAOxD,KAAK2b,YAAYnY,KAC5FxD,KAAK2b,YAAYzP,MAAM/C,MAAMnE,OAAOmlB,EAAW,GAC/CnqB,KAAK2b,YAAYzP,MAAMqF,WAAWvM,OAAOmlB,EAAW,GACpDnqB,KAAK2b,YAAYzP,MAAQ,KAK3Bge,GACEgC,IAAiB,EAAAzsB,SAAS+R,SAC5BxR,KAAK2b,YAAYzP,MAAQge,EACzBA,EAAS/gB,MAAMpH,KAAK/B,KAAK2b,aACzBuO,EAAS3Y,WAAWxP,KAAK/B,KAAK2b,YAAYtT,SAAS0L,SAASmW,EAAS7hB,YAInEqhB,iBAAiBF,EAAe/U,EAAyBC,GAC/D,IAAK8U,EAEH,YADAxpB,KAAKopB,qBAGP,IAAI3Q,EAAc+Q,EAAQhR,eACxB,EAAA3Y,MAAMQ,aAAaL,KAAKylB,cAAc1K,aAAatG,EAAe/N,EAAG+N,EAAe7N,EAAG,EAAG,GAAG9D,MAC7F2R,EAAe6G,QACf5G,EAAa4G,SAGf,GADI7C,IAAa+Q,EAAQ1kB,gBAAkB2T,IACtCA,EAEH,YADAzY,KAAKopB,qBAIP,IAAIxkB,EAAc4kB,EAAQ1kB,gBAC1B,GAAK9E,KAAK8L,kBAAkB3G,WAAWP,GAGhC,CACL,GAAIA,EAAYW,OAAS,EAAAC,aAAayR,IACpCjX,KAAK8L,kBAAkBnH,mBAAmBC,GAC1C4kB,EAAQ1kB,gBAAkB,UAE1B,GAAIF,EAAYb,WAAW3C,OAAS,EAAG,CACrC,GAAIwD,EAAYb,WAAW,GAAG3B,QAAUpC,KAAK8L,kBAAkB1J,MAG7D,OAFApC,KAAKopB,0BACLI,EAAQ1kB,gBAAkB,MAG5B,IAAI3C,EAAQyC,EAAYb,WAAW,GAAG3B,MAAM2B,WAAWkB,QAAQL,EAAYb,WAAW,KACjFooB,GAAgBvnB,EAAYb,WAAW,GAAG3B,MAAM2B,WAAWiB,OAAO7C,EAAO,IACzEse,EAAWC,GAAW,CAACyL,EAAa/pB,MAAO+pB,EAAa9pB,KAC7DrC,KAAKyoB,SAAS1kB,WAAWgI,OAAOogB,EAAa3oB,IAC7CxD,KAAKyoB,SAASvkB,eAAe+J,WAAWwS,EAAU5c,KAAM6c,EAAQ7c,MAChEsoB,EAAa/pB,MAAMye,aAAasL,EAAc1L,EAAWC,GACzDyL,EAAa9pB,IAAIwe,aAAasL,EAAc1L,EAAWC,GAEvD1gB,KAAK8L,kBAAkBnH,mBAAmBC,GAC1C4kB,EAAQ1kB,gBAAkB,UAE1B9E,KAAK8L,kBAAkBnH,mBAAmBC,GAC1C4kB,EAAQ1kB,gBAAkB,KAG9B9E,KAAK8L,kBAAoB,UA5BzB9L,KAAKopB,qBACLI,EAAQ1kB,gBAAkB,KA8BtB8jB,oBAAoBN,GAC1B,OAAO,IAAI,EAAAthB,QAAQshB,EAAG8D,QAAUpsB,KAAKwT,iBAAiBoQ,KAAM0E,EAAG+D,QAAUrsB,KAAKwT,iBAAiBmQ,KAEzF8C,gBAAgBhT,EAAgB6Y,EAAuBC,GAC7D,GAAI9Y,EAAO,CACT,IAAI+Y,EAAkBF,EAAYhZ,UAAUtT,KAAKykB,kBACjDzkB,KAAKukB,WACFkI,cAAcD,EAAgB9lB,EAAG8lB,EAAgB5lB,GACjD8lB,UAAUjZ,EAAOA,GACjBgZ,eAAeD,EAAgB9lB,GAAI8lB,EAAgB5lB,GAEpD2lB,GACFvsB,KAAKukB,WAAWkI,cAAcF,EAAU7lB,EAAG6lB,EAAU3lB,GAGvD5G,KAAKykB,iBAAmBzkB,KAAKukB,WAAWoI,UAExC3sB,KAAKqlB,SAASuH,aAAa5sB,KAAKukB,YAChCvkB,KAAKwlB,YAAYoH,aAAa5sB,KAAKukB,YACnCvkB,KAAKylB,cAAcmH,aAAa5sB,KAAKukB,YACrCvkB,KAAK0lB,iBAAiBkH,aAAa5sB,KAAKukB,YAExCvkB,KAAKsE,KAAK,YAAatE,MAEzB6sB,YAAYzC,GACVpqB,KAAKymB,gBAAgB,KAAM,KAAM2D,GAEnC0C,QAAQrZ,EAAe6Y,GACrBtsB,KAAKymB,gBAAgBhT,EAAO6Y,GAEtBlD,qBACNppB,KAAK8L,kBAAkB9H,mBACvBhE,KAAKyoB,SAAS5c,gBAAgB7L,KAAK8L,kBAAkBtI,IAE/CklB,WAAWC,EAAmBtgB,GACpCrI,KAAK4b,SAAS7Z,KAAK,CACjByB,GAAImlB,EACJlU,eAAgBpM,EAChBqM,aAAcrM,EAASiL,UAAUtT,KAAKykB,oBAGlC6E,cAAc1N,EAAqB0M,GACzC1M,EAAS5W,OAAO4W,EAAS+E,WAAUkL,GAAWA,EAAQroB,KAAO8kB,EAAGK,YAAY,GAEtEE,WAAWxgB,GACjB,IAAIjI,EAAa,EAAAP,MAAMQ,aAAaL,KAAKwlB,YAAYzK,aAAa1S,EAAS3B,EAAG2B,EAASzB,EAAG,EAAG,GAAG9D,MAChG,OAAO9C,KAAKyoB,SAASnf,cAAc7F,IAAIrD,GAEjC+oB,YAAY9gB,GAClB,IAAIjI,EAAa,EAAAP,MAAMQ,aAAaL,KAAK0lB,iBAAiB3K,aAAa1S,EAAS3B,EAAG2B,EAASzB,EAAG,EAAG,GAAG9D,MACrG,OAAO9C,KAAKyoB,SAASlf,eAAe9F,IAAIrD,GAElC2sB,QACN/sB,KAAKqlB,SAAStf,OACd/F,KAAKqlB,SAASuH,aAAa5sB,KAAK0kB,UAChC1kB,KAAKqlB,SAAS2H,UAAU,EAAG,EAAGhtB,KAAKwT,iBAAiB5L,MAAO5H,KAAKwT,iBAAiB/B,QACjFzR,KAAKqlB,SAAShf,UAEdrG,KAAKwlB,YAAYzf,OACjB/F,KAAKwlB,YAAYoH,aAAa5sB,KAAK0kB,UACnC1kB,KAAKwlB,YAAYwH,UAAU,EAAG,EAAGhtB,KAAKwT,iBAAiB5L,MAAO5H,KAAKwT,iBAAiB/B,QACpFzR,KAAKwlB,YAAYnf,UAEjBrG,KAAKylB,cAAc1f,OACnB/F,KAAKylB,cAAcmH,aAAa5sB,KAAK0kB,UACrC1kB,KAAKylB,cAAcuH,UAAU,EAAG,EAAGhtB,KAAKwT,iBAAiB5L,MAAO5H,KAAKwT,iBAAiB/B,QACtFzR,KAAKylB,cAAcpf,UAEnBrG,KAAK0lB,iBAAiB3f,OACtB/F,KAAK0lB,iBAAiBkH,aAAa5sB,KAAK0kB,UACxC1kB,KAAK0lB,iBAAiBsH,UAAU,EAAG,EAAGhtB,KAAKwT,iBAAiB5L,MAAO5H,KAAKwT,iBAAiB/B,QACzFzR,KAAK0lB,iBAAiBrf,UAGxB4mB,kBACMjtB,KAAK2kB,UAAY,IACnB3kB,KAAK2kB,UAAYkB,YAAYC,MAC7B9lB,KAAKktB,mBACLltB,KAAKuE,MAAQsf,EAAiB5Z,QAC9BjK,KAAKsE,KAAK,QAAStE,OAGfktB,mBACNltB,KAAKsE,KAAK,OAAQtE,MAClBA,KAAKmtB,QAAUlH,OAAOC,sBAAsBlmB,KAAKktB,iBAAiBE,KAAKptB,OAGzEqtB,iBACMrtB,KAAKstB,sBACPC,qBAAqBvtB,KAAKmtB,SAC1BntB,KAAK2kB,WAAa,EAClB3kB,KAAKuE,MAAQsf,EAAiBpf,QAC9BzE,KAAKsE,KAAK,YAAatE,MACvBA,KAAKsE,KAAK,OAAQtE,OAGdstB,oBACN,IAAIvuB,EAAOiB,KAAKyoB,SAChB,OAAa,CACX,IAAI1pB,EAAKkK,WACJ,OAAOlK,EAAKwF,QAAU,EAAAC,UAAUC,QADhB1F,EAAOA,EAAKkK,YAI7B9C,UACNnG,KAAK+sB,QAEL/sB,KAAKipB,WAAajpB,KAAKipB,UAAUrjB,SACjC5F,KAAKyoB,SAAS7iB,SACd5F,KAAKsE,KAAK,SAAUtE,MAEpBA,KAAKwtB,QAAUvH,OAAOC,sBAAsBlmB,KAAKmG,QAAQinB,KAAKptB,OAGhEytB,WAAWvqB,EAAuB,CAAE4F,KAAM,WAAYpD,MAAO,GAAIqD,eAAgB,KAC1E7F,EAAQwC,QAAOxC,EAAQwC,MAAQ,IAC/BxC,EAAQ6F,iBAAgB7F,EAAQ6F,eAAiB,IAEtD7F,EAAQwC,MAAQ,IAAKxC,EAAQwC,SAAUgoB,KACvC,IAAIzqB,EAAO,IAAI,EAAA4F,KAAK7I,KAAMkD,EAAQ4F,KAAM5F,EAAQwC,MAAOxC,EAAQ6F,gBAM/D,OALA/I,KAAK8jB,MAAM/hB,KAAKkB,GAEhBA,EAAK+G,GAAG,SAAS,IAAMhK,KAAKitB,oBAC5BhqB,EAAK+G,GAAG,QAAQ,IAAMhK,KAAKqtB,mBAEpBpqB,EAET2C,OAAO3C,GACDA,IAASjD,KAAKyoB,WACdzoB,KAAKyoB,WACPxC,OAAOsH,qBAAqBvtB,KAAKwtB,SACjCxtB,KAAKyoB,SAASve,uBAEXlK,KAAK2tB,UAAa3tB,KAAK2tB,SAASvjB,aAAanH,KAChDjD,KAAK2tB,SAAW1qB,GAElBjD,KAAKyoB,SAAWxlB,EAChBjD,KAAKmG,WAGPwd,MACE3jB,KAAK4F,OAAO5F,KAAK2tB,UAKnBC,SAASC,GACP,IAAI/qB,EACAG,EAAa,KAEjB,IACEH,EAAOgrB,KAAKC,MAAMF,GAClB5qB,EAAO,EAAA4F,KAAK8D,YAAY3M,KAAM8C,GAC9B,MAAOlB,GACP,EAAAD,IAAIC,MAAMA,GAEZ,OAAOqB,EAET+qB,OAAO/qB,GACL,IAAIgrB,EAAiChrB,EAAKJ,YAC1C,IACE,OAAOirB,KAAKI,UAAUD,EAAgB,MACtC,MAAOrsB,GACP,EAAAD,IAAIC,MAAMA,KAKhB,IAAYiiB,EA5xBZ,gBA4xBA,SAAYA,GACV,yBACA,yBAFF,CAAYA,EAAA,EAAAA,mBAAA,EAAAA,iBAAgB,KAgB5B,IAAI6J,EAA4B,KAAM,CACpC,OAAU,CAAC,SAAU,OACrB,OAAU,CAAC,SAAU,aAAc,OACnC,QAAW,CAAC,UAAW,OACvB,MAAS,CAAC,QAAS,OACnB,KAAQ,CAAC,OAAQ,OACjB,MAAS,CAAC,QAAS,OACnB,QAAW,CAAC,UAAW,OACvB,eAAgB,CAAC,eAAgB,OACjC,MAAS,CAAC,QAAS,cACnB,WAAc,CAAC,cACf,eAAgB,CAAC,eAAgB,OACjC,IAAO,CAAC,SAGV,WACA,aACA,cAAS,0EAAA7N,YACT,aACA,c,4GCv1Ba,EAAAuL,aAAe,CAC1BC,eAAgB8C,IAAIC,gBAAgB,IAAIC,KAAK,CAC3C,68CAqCC,CAAE9oB,KAAM,6BAEA,EAAA4lB,sBAAyBmD,IACQ,CAE1CC,4BAA6BJ,IAAIC,gBAAgB,IAAIC,KAAK,CACxD,kwCA+BC,CAAE9oB,KAAM,4BAGXipB,mBAAoBL,IAAIC,gBAAgB,IAAIC,KAAK,CAC/C,ghDAyCC,CAAE9oB,KAAM,4BAGXkpB,cAAeN,IAAIC,gBAAgB,IAAIC,KAAK,CAC1C,o/BA4BC,CAAE9oB,KAAM,4BAEXmpB,mBAAoBP,IAAIC,gBAAgB,IAAIC,KAAK,CAC/C,+BAA+BC,irGA8E9B,CAAE/oB,KAAM,4BAEXopB,yBAA0BR,IAAIC,gBAAgB,IAAIC,KAAK,CACrD,+BAA+BC,gyEA8D9B,CAAE/oB,KAAM,4BAEXqpB,YAAaT,IAAIC,gBAAgB,IAAIC,KAAK,CACxC,k5CAuCC,CAAE9oB,KAAM,4BAEXspB,cAAeV,IAAIC,gBAAgB,IAAIC,KAAK,CAC1C,4sDAgDC,CAAE9oB,KAAM,4BAGXupB,cAAeX,IAAIC,gBAAgB,IAAIC,KAAK,CAC1C,gVAUC,CAAE9oB,KAAM,+B,gFCtZf,MAAasa,GAAb,aACS,EAAAC,IAAM,EAAIlf,KAAKmuB,GACf,EAAAC,OAAS,KACT,EAAAC,IAAM,mB,4FCHF,EAAAC,SAAW,43BACX,EAAAC,UAAY,0uC,kFCDzB,gBAEA,UACA,SACA,UAEA,UACA,UACA,UAEA,MAAa1S,UAAiB,EAAA2S,OA0B5BtvB,YACE+D,EACAX,EAA2BmsB,EAAuBxrB,IAElDT,MAAMS,EAAM,EAAAmD,QAAQkY,OAAQ,EAAAoQ,OAAO7S,SAAU,CAC3Cf,WAAW,EACXpY,MAAOJ,EAAQI,MAAQ,IAAKisB,OAA2BrsB,EAAQI,OAAUisB,IACzEhY,SAAUrU,EAAQqU,SAClB/K,MAAOtJ,EAAQsJ,QAAmC,kBAAlBtJ,EAAQsJ,MACpC,IAAI,EAAAwK,SAASnT,EAAM,EAAA2B,aAAaC,GAAI,UAAW,GAAI,IACnD,EAAAuR,SAASrK,YAAY9I,EAAMX,EAAQsJ,QACvCC,OAAQvJ,EAAQuJ,SAAqC,kBAAnBvJ,EAAQuJ,OACtC,IAAI,EAAAuK,SAASnT,EAAM,EAAA2B,aAAayR,IAAK,UAAW,GAAI,IACpD,EAAAD,SAASrK,YAAY9I,EAAMX,EAAQuJ,SACvCjJ,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WApCd,KAAA8d,cAAwB,GAuC9BxvB,KAAKyR,QAAS,IAAAhO,KAAIP,EAAQuO,OAAoC,EAA5BzR,KAAK6D,KAAKP,MAAMgb,WAClDte,KAAKyvB,OAASzvB,KAAKuX,SAAWvX,KAAK0vB,WAAY,IAAAjsB,KAAIP,EAAQ6R,MAAO,IAAI,EAAA/N,QAAQ,GAAI,KAClFhH,KAAKyvB,OAAOzN,aAAa,EAAG,GAExBhiB,KAAKwM,QACPxM,KAAKwM,MAAMxC,GAAG,WAAW,CAAC2U,EAAG1Y,KACvBA,EAAUnD,OAAM9C,KAAK+U,MAAQ9O,EAAUnD,SAE7C9C,KAAKwM,MAAMxC,GAAG,QAAQ,CAAC2U,EAAG7b,KACpBA,IAAM9C,KAAK+U,MAAQjS,OAGvB9C,KAAKyM,QAAQzM,KAAKyM,OAAOzC,GAAG,WAAW,CAAC2U,EAAG1Y,IAAcA,EAAUnD,KAAO9C,KAAK+U,QAEnF/U,KAAK6D,KAAKmG,GAAG,WAAW,KAClBhK,KAAKyM,QAAQzM,KAAKyM,OAAOvH,QAAQlF,KAAK+U,UAG5C/U,KAAK2vB,cAAgB,EAAA9vB,MAAMiS,SAAS5R,SACL,oBAApB8mB,gBACThnB,KAAK4vB,eAAiB,IAAI5I,gBAAgBhnB,KAAK4H,MAAO5H,KAAKyR,SAE3DzR,KAAK4vB,eAAiB9c,SAASC,cAAc,UAC7C/S,KAAK4vB,eAAehoB,MAAQ5H,KAAK4H,MACjC5H,KAAK4vB,eAAene,OAASzR,KAAKyR,QAEpCzR,KAAK6vB,gBAAkB7vB,KAAK4vB,eAAe7I,WAAW,MACtD/mB,KAAK8vB,iBAhEH/a,YACF,OAAI/U,KAAKuX,SAAiBvX,KAAK0vB,UACxB1vB,KAAKyvB,OAEV1a,UAAMA,GACRA,EAAQA,EAAM7S,MAAM,EAAG,GAEvB,IAAI6tB,EAAS/vB,KAAK+U,MACd2K,EAAS3K,EAET/U,KAAKuX,SAAUvX,KAAKgwB,QAAQtQ,GAE9B1f,KAAKyvB,OAAS/P,EAEhB1f,KAAK8vB,iBAED9vB,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM+vB,EAAQrQ,GAmDpFoQ,iBACE,IAAKloB,EAAO6J,GAAU,CAACzR,KAAK4H,MAAQ5H,KAAKwvB,cAAexvB,KAAKyR,OAASzR,KAAKwvB,eAC3ExvB,KAAK6vB,gBAAgB7C,UAAU,EAAG,EAAGplB,EAAO6J,GAE5C,IAAIwe,EAAQ,IAAI,EAAAjpB,QAAQhH,KAAK+U,MAAMrO,EAAG,EAAI1G,KAAK+U,MAAMnO,GAAG0b,SAAS1a,EAAO6J,GAAQ5G,IAAI7K,KAAKwvB,cAAgB,GACzGxvB,KAAK6vB,gBAAgB3b,UAAYlU,KAAK2vB,cACtC3vB,KAAK6vB,gBAAgBhoB,YACrB7H,KAAK6vB,gBAAgBjQ,IAAIqQ,EAAMvpB,EAAGupB,EAAMrpB,EAAG5G,KAAKwvB,cAAgB,EAAG,EAAG,EAAA3P,SAASC,KAC/E9f,KAAK6vB,gBAAgB7P,OAGvBkQ,QACE,IAAIrqB,EAAU7F,KAAK6D,KAAKgC,QAExBA,EAAQqO,UAAYlU,KAAKsD,MAAM6sB,gBAC/BtqB,EAAQ4B,YAAczH,KAAKsD,MAAMoE,YACjC7B,EAAQ8B,UAAY3H,KAAKsD,MAAM8sB,YAC/BvqB,EAAQuO,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QACpE5L,EAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAEtE,IAAK7J,EAAO6J,GAAU,CAACzR,KAAK4H,MAAQ5H,KAAKwvB,cAAexvB,KAAKyR,OAASzR,KAAKwvB,eACvEa,EAAQ,IAAI,EAAArpB,QAAQhH,KAAK+U,MAAMrO,EAAG,EAAI1G,KAAK+U,MAAMnO,GAClD+a,gBAAgB/Z,EAAO6J,GACvB+P,WAAWxhB,KAAKqI,UAChBmZ,WAAWxhB,KAAKwvB,cAAgB,GAEnC3pB,EAAQqO,UAAYlU,KAAKsD,MAAMgtB,WAC/BzqB,EAAQgC,YACRhC,EAAQ+Z,IAAIyQ,EAAM3pB,EAAG2pB,EAAMzpB,EAAG5G,KAAKwvB,cAAgB,EAAG,EAAG,EAAA3P,SAASC,KAClEja,EAAQma,OAEVuQ,YACE,IAAI1qB,EAAU7F,KAAK6F,QACnBA,EAAQ4B,YAAc,OACtB5B,EAAQqO,UAAYlU,KAAKsD,MAAM6sB,gBAC/BtqB,EAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QACtE5L,EAAQuO,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAEtE+e,WACExwB,KAAK8W,aAAa5C,UAAYlU,KAAK0R,SAASxR,SAC5CF,KAAK8W,aAAa1C,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAGhFmF,SACE,IAAK6Z,EAAUC,GAAa,CAAC1wB,KAAK4H,MAAO5H,KAAKyR,QAG5C7Q,KAAKC,MAAMb,KAAK4vB,eAAehoB,SAAWhH,KAAKC,MAAM4vB,IAClD7vB,KAAKC,MAAMb,KAAK4vB,eAAene,UAAY7Q,KAAKC,MAAM6vB,KAGzD1wB,KAAK4vB,eAAehoB,MAAQ6oB,EAC5BzwB,KAAK4vB,eAAene,OAASif,EAC7B1wB,KAAK8vB,kBAGH9vB,KAAKwM,OACPxM,KAAKwM,MAAMnE,SAASqa,OAClB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKwM,MAAMlJ,MAAMiF,OAC9EvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAGhCzR,KAAKyM,QACPzM,KAAKyM,OAAOpE,SAASqa,OACnB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAK+D,MAAQ5H,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKyM,OAAOnJ,MAAMiF,OACjGvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAItCkf,YAAYjc,GACV,IAAIub,EAAQvb,EAAaX,SAAS/T,KAAKqI,UACnCqJ,EAAW,EAAA7R,MAAMM,UAAUH,KAAK6vB,gBAAgB9U,aAAakV,EAAMvpB,EAAGupB,EAAMrpB,EAAG,EAAG,GAAG9D,MACzF,OAAO9C,KAAK2vB,gBAAkBje,EAEhCkf,UAAUlc,GACR,IAAK9M,EAAO6J,GAAU,CAACzR,KAAK4H,MAAQ5H,KAAKwvB,cAAexvB,KAAKyR,OAASzR,KAAKwvB,eAE3ExvB,KAAKyvB,OAAS/a,EACXxS,MACClC,KAAKqI,SAAS3B,EAAI1G,KAAKwvB,cAAgB,EAAGxvB,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAQ5H,KAAKwvB,cAAgB,EAC9FxvB,KAAKqI,SAASzB,EAAI5G,KAAKwvB,cAAgB,EAAGxvB,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAASzR,KAAKwvB,cAAgB,GAEhG5N,gBAAgB5hB,KAAKqI,SAASwC,IAAI7K,KAAKwvB,cAAgB,IACvDxN,aAAa,EAAGpa,EAAO,EAAG6J,GAC1BoQ,iBAAiB,EAAGja,EAAO,EAAG6J,GAEjCzR,KAAK+U,MAAQ,IAAI,EAAA/N,QAAQhH,KAAKyvB,OAAO/oB,EAAG,EAAI1G,KAAKyvB,OAAO7oB,GAG1DiqB,aAAapR,EAAcC,GACzB1f,KAAKyvB,OAAS/P,EACd1f,KAAK8vB,iBAEL9vB,KAAKyM,QAAUzM,KAAKyM,OAAOvH,QAAQlF,KAAK+U,OAE1CkG,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAI1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1C2G,KAAK5G,EAAyBC,GACxB1U,KAAK8wB,WAEL9wB,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM,KAAMA,KAAKyvB,QACrFzvB,KAAK+wB,OAAQ,EAEb/wB,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,IAExCF,QAAQC,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C8G,OAAO/G,EAAyBC,GAC1B1U,KAAK8wB,WAET9wB,KAAK4wB,UAAUlc,GAEf1U,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,IAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,WAEL9wB,KAAK+wB,QACP/wB,KAAK4wB,UAAUlc,GACX1U,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM,KAAMA,KAAKyvB,SAEvFzvB,KAAK+wB,OAAQ,EAEb/wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,IAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,gBACM7b,KAAK8wB,SAGXjuB,YACE,MAAO,CACLkS,MAAO/U,KAAK+U,MAAMlS,YAClB0U,SAAUvX,KAAKuX,SACf/K,MAAOxM,KAAKwM,MAAQxM,KAAKwM,MAAM3J,YAAc,KAC7C4J,OAAQzM,KAAKyM,OAASzM,KAAKyM,OAAO5J,YAAc,KAChD4O,OAAQzR,KAAKyR,OACbnO,MAAOtD,KAAKsD,MACZE,GAAIxD,KAAKwD,GACTkO,SAAU1R,KAAK0R,SAAS7O,YACxB0C,KAAMvF,KAAKuF,KACXwI,OAAQ,IAGZrN,mBAAmBmD,EAAYf,GAC7B,OAAO,IAAI2Z,EAAS5Y,EAAM,CACxBkR,MAAO,EAAA/N,QAAQ2F,YAAY7J,EAAKiS,OAChCwC,SAAUzU,EAAKyU,SACf/K,MAAO1J,EAAK0J,MACZC,OAAQ3J,EAAK2J,OACbgF,OAAQ3O,EAAK2O,OACbnO,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,aAzPvC,aAoQA,IAAI6d,EAAuB,KAClB,CACLY,gBAAiB,OACjBG,WAAY,OACZ5oB,YAAa,OACb0oB,YAAa,IAmBbf,EAA0BxrB,IACrB,CACL4N,OAA+B,EAAvB5N,EAAKP,MAAMgb,a,gFCvSvB,gBACA,UACA,UACA,UAEA,UACA,SACA,SAEA,MAAanB,UAAe,EAAAiS,OAG1BtvB,YACE+D,EACOqY,EACPhZ,EAAyB8tB,EAAqBntB,IAE9CT,MAAMS,EAAM,EAAAmD,QAAQkY,OAAQ,EAAAoQ,OAAOnS,OAAQ,CACzC7Z,MAAOJ,EAAQI,MAAQ,IAAK2tB,OAAyB/tB,EAAQI,OAAU2tB,IACvEzkB,MAAOtJ,EAAQsJ,QAAmC,kBAAlBtJ,EAAQsJ,MACpC,IAAI,EAAAwK,SAASnT,EAAM,EAAA2B,aAAaC,GAAI,QAAS,GAAI,IACjD,IAAI,EAAAuR,SAASnT,EAAMX,EAAQsJ,MAAMjH,KAAMrC,EAAQsJ,MAAM7G,SAAUzC,EAAQsJ,MAAM1D,KAAM,CACnFxF,MAAOJ,EAAQsJ,MAAMlJ,MAAOE,GAAIN,EAAQsJ,MAAMhJ,GAAIkO,SAAU,EAAA7R,MAAM8M,YAAYzJ,EAAQsJ,MAAMkF,aAEhGjF,OAAQvJ,EAAQuJ,SAAqC,kBAAnBvJ,EAAQuJ,OACtC,IAAI,EAAAuK,SAASnT,EAAM,EAAA2B,aAAayR,IAAK,QAAS,GAAI,IAClD,EAAAD,SAASrK,YAAY9I,EAAMX,EAAQuJ,SACvCjJ,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WAdb,KAAAwK,KAAAA,EAiBHlc,KAAKwM,OAAOxM,KAAKwM,MAAMxC,GAAG,SAAS,IAAMhK,KAAKsE,KAAK,QAAStE,QAChEA,KAAKyR,QAAS,IAAAhO,KAAIP,EAAQuO,OAAQzR,KAAK6D,KAAKP,MAAMgb,UAAY,EAAIte,KAAKsD,MAAM4U,SAE7ElY,KAAKkxB,MAAQ,IAAI,EAAA/U,MAAMnc,KAAK6D,KAAMqY,EAAM,CACtC5Y,MAAO,CACLgP,SAAUtS,KAAKsD,MAAMgP,SACrBD,KAAMrS,KAAKsD,MAAM+O,KACjBoF,MAAO,EAAA9X,MAAMwxB,OACb1wB,MAAOT,KAAKsD,MAAM7C,OAEpBgR,OAAQzR,KAAKyR,SAEfzR,KAAKkxB,MAAMlnB,GAAG,SAAS,CAAConB,EAAa/oB,IAAsBrI,KAAKsE,KAAK,QAAStE,KAAMqI,KAGpFrI,KAAKqxB,SAAStvB,KAAK/B,KAAKkxB,OAG1BhB,QACElwB,KAAK6F,QAAQqO,UAAYlU,KAAKsD,MAAM6sB,gBACpCnwB,KAAK6F,QAAQsa,YAAcngB,KAAKsD,MAAM6c,YACtCngB,KAAK6F,QAAQqa,WAAalgB,KAAKsD,MAAM4c,WACrClgB,KAAK6F,QAAQyrB,cAAgBtxB,KAAKsD,MAAMiuB,aAAa7qB,EACrD1G,KAAK6F,QAAQ2rB,cAAgBxxB,KAAKsD,MAAMiuB,aAAa3qB,EACrD5G,KAAK6F,QAAQuO,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAE3E8e,YACEvwB,KAAK6F,QAAQ4B,YAAc,OAC3BzH,KAAKkwB,QACLlwB,KAAK6F,QAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAE7E+e,WACExwB,KAAK8W,aAAa5C,UAAYlU,KAAK0R,SAASxR,SAC5CF,KAAK8W,aAAa1C,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAGhFmF,SACE5W,KAAKkxB,MAAM7oB,SAAWrI,KAAKqI,SAC3BrI,KAAKkxB,MAAMzf,OAASzR,KAAKyR,OACzBzR,KAAKkxB,MAAMtpB,MAAQ5H,KAAK4H,MAEpB5H,KAAKwM,OACPxM,KAAKwM,MAAMnE,SAASqa,OAClB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKwM,MAAMlJ,MAAMiF,OAC9EvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAGhCzR,KAAKyM,QACPzM,KAAKyM,OAAOpE,SAASqa,OACnB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAK+D,MAAQ5H,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKyM,OAAOnJ,MAAMiF,OACjGvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAKtCof,gBACA5V,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1C2G,KAAK5G,EAAyBC,GACxB1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExCF,QAAQC,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C8G,OAAO/G,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,gBACM7b,KAAK8wB,UAET9wB,KAAKsE,KAAK,aAActE,MAG1B6C,YACE,MAAO,CACLqZ,KAAMlc,KAAKkc,KACX3E,SAAUvX,KAAKuX,SACf/K,MAAOxM,KAAKwM,MAAQxM,KAAKwM,MAAM3J,YAAc,KAC7C4J,OAAQzM,KAAKyM,OAASzM,KAAKyM,OAAO5J,YAAc,KAChD4O,OAAQzR,KAAKyR,OACbjO,GAAIxD,KAAKwD,GACTF,MAAOtD,KAAKsD,MACZoO,SAAU1R,KAAK0R,SAAS7O,YACxB0C,KAAMvF,KAAKuF,KACXwI,OAAQ,IAGZrN,mBAAmBmD,EAAYf,GAC7B,OAAO,IAAIqa,EAAOtZ,EAAMf,EAAKoZ,KAAM,CACjC1P,MAAO1J,EAAK0J,MACZC,OAAQ3J,EAAK2J,OACbgF,OAAQ3O,EAAK2O,OACbnO,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,aAjJvC,WAgKA,IAAIuf,EAAqB,KAChB,CACLd,gBAAiB,OACjBjY,QAAS,EACTzX,MAAO,OACP4R,KAAM,QACNC,SAAU,OACV6N,YAAa,OACbD,WAAY,EACZqR,aAAc,IAAI,EAAAvqB,QAAQ,EAAG,KAiB7BgqB,EAAwBntB,IACnB,CACL4N,OAA+B,IAAvB5N,EAAKP,MAAMgb,a,mFCtMvB,gBAGA,UACA,UACA,UACA,SAEA,MAAa/H,UAAkB,EAAA6Y,OAI7BtvB,YACE+D,EACA+D,EACA1E,EAA4BuuB,KAE5BruB,MAAMS,EAAMA,EAAKwE,SAAU,EAAAinB,OAAO/Y,UAAW,CAC3CjT,MAAOJ,EAAQI,MAAQ,IAAKouB,OAA4BxuB,EAAQI,OAAUouB,IAC1EluB,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WAXtB,KAAArO,eAAmE,IAAM,KAcvErD,KAAK4H,MAAQA,EACb5H,KAAKyR,OAAmC,EAA1BzR,KAAK6D,KAAKP,MAAM4U,QAC9BlY,KAAK2xB,aAAe3xB,KAAK4H,MAAQ,EAAI5H,KAAK6D,KAAKP,MAAM4U,QAGvDgY,QACE,IAAIrqB,EAAU7F,KAAK6F,QACf2Y,EAAqBxe,KAAK6D,KAAKR,eAAeuuB,YAC9C5rB,EAAqBhG,KAAK6D,KAAKZ,KAAKI,eAAeuuB,YACnD1rB,EAA4BlG,KAAK6D,KAAKZ,KAAK6C,YAAYzC,eAAeuuB,aACxE5xB,KAAKqD,gBAAkBrD,KAAKqD,eAAerD,OACvCwe,GAAsBA,EAAmBxe,OACzCgG,GAAsBA,EAAmBhG,OACzCkG,GAA6BA,EAA0BlG,OACxDA,KAAK6xB,QACRhsB,EAAS7F,KAAKoG,kBAAmBpG,MAE7B6xB,OAAOhsB,EAAmCW,EAA+BsrB,GAC/EjsB,EAAQsa,YAAc2R,EAAUxuB,MAAM6c,YACtCta,EAAQqa,WAAa4R,EAAUxuB,MAAM4c,WACrCra,EAAQyrB,cAAgBQ,EAAUxuB,MAAMiuB,aAAa7qB,EACrDb,EAAQ2rB,cAAgBM,EAAUxuB,MAAMiuB,aAAa3qB,EACrDf,EAAQqO,UAAY4d,EAAUxuB,MAAM6sB,gBACpCtqB,EAAQ4B,YAAcqqB,EAAUxuB,MAAMoE,YACtC7B,EAAQ8B,UAAYmqB,EAAUxuB,MAAM8sB,YACpCvqB,EAAQmiB,UAAUxhB,EAAO6B,SAAS3B,EAAGF,EAAO6B,SAASzB,EAAGJ,EAAOoB,MAAOpB,EAAOiL,OAAQ,GACrF5L,EAAQmC,SACRnC,EAAQma,OAEVuQ,YACE,IAAI1qB,EAAU7F,KAAK6F,QACnBA,EAAQqO,UAAYlU,KAAKsD,MAAM6sB,gBAC/BtqB,EAAQ4B,YAAczH,KAAKsD,MAAMoE,YACjC7B,EAAQ8B,UAAY3H,KAAKsD,MAAM8sB,YAC/BvqB,EAAQmiB,UACNhoB,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAI5G,KAAK6D,KAAKP,MAAMkF,YACnDxI,KAAK4H,MAAO5H,KAAKyR,OAASzR,KAAK6D,KAAKP,MAAMkF,YAAa,GAEzD3C,EAAQmC,SACRnC,EAAQma,OAEVwQ,WACExwB,KAAK8W,aAAa5C,UAAYlU,KAAK0R,SAASxR,SAC5CF,KAAK8W,aAAa1C,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAEhFrL,kBACE,IAAIiC,EAAWrI,KAAKqI,SAASxF,YAE7B,OADAwF,EAASzB,GAAK5G,KAAK6D,KAAKP,MAAMkF,YACvB,CACLH,SAAUA,EACVT,MAAO5H,KAAK4H,MACZ6J,OAAQzR,KAAKyR,OAASzR,KAAK6D,KAAKP,MAAMkF,aAI1CoO,SACE5W,KAAKqI,SAAWrI,KAAK6D,KAAKwE,SAC1B,IAAI0pB,EAAyBnxB,KAAK+N,IAAI3O,KAAK6D,KAAK+F,OAAOxI,OAAQpB,KAAK6D,KAAKgG,QAAQzI,QAAUpB,KAAK6D,KAAKP,MAAM2U,kBAAoBjY,KAAK6D,KAAKP,MAAMkF,YAC3I9B,EAAI1G,KAAKqI,SAAS3B,EAAI1G,KAAK6D,KAAKP,MAAM4U,QACtCtR,EAAI5G,KAAKqI,SAASzB,EAAImrB,EAC1B/xB,KAAKqxB,SAAShlB,QAAO2C,GAASA,EAAMgjB,UAASlwB,SAAQkN,IACnDpI,GAAK5G,KAAK6D,KAAKP,MAAM+a,QACrB,IAAI4T,EAAiBjyB,KAAK4H,MAAkC,EAA1B5H,KAAK6D,KAAKP,MAAM4U,QAElD,GADAlJ,EAAMpH,OAASoH,EAAMpH,MAAQqqB,EAAiBA,EAAiBjjB,EAAMpH,QAAUqqB,EAC3EjjB,EAAMpH,MAAQqqB,EAAgB,CAChC,IAAIC,EAEFA,EADEljB,EAAM1L,MAAMmU,QAAU,EAAA9X,MAAMwxB,OACrBnxB,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAQ,EAAIoH,EAAMpH,MAAQ,EACjDoH,EAAM1L,MAAMmU,QAAU,EAAA9X,MAAMof,MAC5B/e,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAQ5H,KAAK6D,KAAKP,MAAM4U,QAAUlJ,EAAMpH,MAE/DlB,EAEXsI,EAAM3G,SAAW,IAAI,EAAArB,QAAQkrB,EAAQtrB,QAErCoI,EAAM3G,SAAW,IAAI,EAAArB,QAAQN,EAAGE,GAElCA,GAAKoI,EAAMyC,UAEbzR,KAAKyR,OAAS7K,EAAI5G,KAAK6D,KAAKP,MAAM4U,QAAUlY,KAAKqI,SAASzB,EAG5DiqB,gBACA5V,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1C2G,KAAK5G,EAAyBC,GACxB1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExCF,QAAQC,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C8G,OAAO/G,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,iBAEAhZ,YACE,MAAO,CACL+E,MAAO5H,KAAK4H,MACZ2P,SAAUvX,KAAKuX,SACf/K,MAAOxM,KAAKwM,MAAQxM,KAAKwM,MAAM3J,YAAc,KAC7C4J,OAAQzM,KAAKyM,OAASzM,KAAKyM,OAAO5J,YAAc,KAChDW,GAAIxD,KAAKwD,GACTF,MAAO,CACL6sB,gBAAiBnwB,KAAKsD,MAAM6sB,gBAC5BhQ,YAAangB,KAAKsD,MAAM6c,YACxBD,WAAYlgB,KAAKsD,MAAM4c,WACvBqR,aAAcvxB,KAAKsD,MAAMiuB,aAAa1uB,YACtCutB,YAAapwB,KAAKsD,MAAM8sB,YACxB1oB,YAAa1H,KAAKsD,MAAMoE,aAE1BgK,SAAU1R,KAAK0R,SAAS7O,YACxB0C,KAAMvF,KAAKuF,KACXwI,OAAQ/N,KAAKqxB,SAAS5uB,KAAIuM,GAAUA,EAAcnM,eAGtDnC,mBAAmBmD,EAAYf,GAC7B,IAAI8uB,EAAc,IAAIrb,EAAU1S,EAAMf,EAAK8E,MAAO,CAChDtE,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,YAoBnC,OAjBAkgB,EAAYP,SAAStvB,QAAQe,EAAKiL,OAAOtL,KAAI0vB,IAC3C,OAAQA,EAAgB5sB,MACtB,KAAK,EAAA+pB,OAAOnS,OAAQ,OAAO,EAAAA,OAAOxQ,YAAY9I,EAAMsuB,GACpD,KAAK,EAAA7C,OAAO/Y,UAAW,OAAOA,EAAU5J,YAAY9I,EAAMsuB,GAC1D,KAAK,EAAA7C,OAAOvR,QAAS,OAAO,EAAAA,QAAQpR,YAAY9I,EAAMsuB,GACtD,KAAK,EAAA7C,OAAOvS,iBAAkB,OAAO,EAAAA,iBAAiBpQ,YAAY9I,EAAMsuB,GACxE,KAAK,EAAA7C,OAAOrS,MAAO,OAAO,EAAAA,MAAMtQ,YAAY9I,EAAMsuB,GAClD,KAAK,EAAA7C,OAAOjT,MAAO,OAAO,EAAAA,MAAM1P,YAAY9I,EAAMsuB,GAClD,KAAK,EAAA7C,OAAOrR,MAAO,OAAO,EAAAA,MAAMtR,YAAY9I,EAAMsuB,GAClD,KAAK,EAAA7C,OAAOnT,MAAO,OAAO,EAAAA,MAAMxP,YAAY9I,EAAMsuB,GAClD,KAAK,EAAA7C,OAAO5R,OAAQ,OAAO,EAAAA,OAAO/Q,YAAY9I,EAAMsuB,GACpD,KAAK,EAAA7C,OAAO/S,OAAQ,OAAO,EAAAA,OAAO5P,YAAY9I,EAAMsuB,GACpD,KAAK,EAAA7C,OAAO1R,OAAQ,OAAO,EAAAA,OAAOjR,YAAY9I,EAAMsuB,GACpD,KAAK,EAAA7C,OAAOjS,OAAQ,OAAO,EAAAA,OAAO1Q,YAAY9I,EAAMsuB,GACpD,QAAS,YAGNP,GAxLX,cAoMA,IAAIF,EAAwB,KACnB,CACLvB,gBAAiB,OACjBhQ,YAAa,OACbD,WAAY,EACZqR,aAAc,IAAI,EAAAvqB,QAAQ,EAAG,GAC7BopB,YAAa,EACb1oB,YAAa,OACbsqB,SAAS,IAaTP,EAA0B,KACrB,K,8EClOT,gBAEA,UACA,SACA,UAEA,UACA,UACA,UAEA,MAAa5U,UAAa,EAAAuS,OAuBxBtvB,YACE+D,EACO+L,EAAoBjB,EAC3B8C,EACAvO,EAAuBkvB,EAAmBxiB,IAE1CxM,MAAMS,EAAM,EAAAmD,QAAQkY,OAAQ,EAAAoQ,OAAOzS,KAAM,CACvCnB,WAAW,EACXpY,MAAOJ,EAAQI,MAAQ,IAAK+uB,EAAiB5gB,MAAYvO,EAAQI,OAAU+uB,EAAiB5gB,GAC5F8F,SAAUrU,EAAQqU,SAClB/K,MAAOtJ,EAAQsJ,QAAmC,kBAAlBtJ,EAAQsJ,MACpC,IAAI,EAAAwK,SAASnT,EAAM,EAAA2B,aAAaC,GAAI,SAAU,GAAI,IAClD,EAAAuR,SAASrK,YAAY9I,EAAMX,EAAQsJ,QACvCC,OAAQvJ,EAAQuJ,SAAqC,kBAAnBvJ,EAAQuJ,OACtC,IAAI,EAAAuK,SAASnT,EAAM,EAAA2B,aAAayR,IAAK,SAAU,GAAI,IACnD,EAAAD,SAASrK,YAAY9I,EAAMX,EAAQuJ,SACvCjJ,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WAfb,KAAA9B,IAAAA,EAAoB,KAAAjB,IAAAA,EAvBrB,KAAA2jB,WAAsB,EAAAtrB,QAAQkY,OAC9B,KAAAqT,SAAoB,EAAAvrB,QAAQkY,OAwClClf,KAAKyR,OAASA,EACdzR,KAAKyvB,QAAS,IAAAhsB,KAAIP,EAAQ6R,MAAOnF,GACjC5P,KAAKwyB,MAAO,IAAAlxB,WAAUtB,KAAKyvB,OAAQzvB,KAAK4P,IAAK5P,KAAK2O,KAE9C3O,KAAKwM,QACPxM,KAAKwM,MAAMxC,GAAG,WAAW,CAAC2U,EAAG1Y,KACvBA,EAAUnD,OAAM9C,KAAK+U,MAAQ9O,EAAUnD,SAE7C9C,KAAKwM,MAAMxC,GAAG,QAAQ,CAAC2U,EAAG7b,KACpBA,IAAM9C,KAAK+U,MAAQjS,OAGvB9C,KAAKyM,QAAQzM,KAAKyM,OAAOzC,GAAG,WAAW,CAAC2U,EAAG1Y,IAAcA,EAAUnD,KAAO9C,KAAK+U,QAEnF/U,KAAK6D,KAAKmG,GAAG,WAAW,KAClBhK,KAAKyM,QAAQzM,KAAKyM,OAAOvH,QAAQlF,KAAK+U,UAlD1CA,YACF,OAAI/U,KAAKuX,SAAiBvX,KAAK0vB,UACxB1vB,KAAKyvB,OAEV1a,UAAMA,GACR,IAAIgb,EAAS/vB,KAAK+U,MACd2K,GAAS,IAAAxd,OAAM6S,EAAO/U,KAAK4P,IAAK5P,KAAK2O,KAErC3O,KAAKuX,SAAUvX,KAAKgwB,QAAQtQ,GAC3B1f,KAAKyvB,OAAS/P,EACnB1f,KAAKwyB,MAAO,IAAAlxB,WAAUoe,EAAQ1f,KAAK4P,IAAK5P,KAAK2O,KAEzC3O,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM+vB,EAAQrQ,GA0CpFwQ,QACE,IAAIrqB,EAAU7F,KAAK6F,QACfsJ,EAAOvO,KAAKgP,IAAI5P,KAAK4H,MAAO5H,KAAKyR,QAErC5L,EAAQqO,UAAYlU,KAAKsD,MAAM7C,MAC/BoF,EAAQ4B,YAAczH,KAAKsD,MAAMoE,YACjC7B,EAAQ8B,UAAY3H,KAAKsD,MAAM8sB,YAC/BvqB,EAAQsa,YAAcngB,KAAKsD,MAAM6c,YACjCta,EAAQqa,WAAalgB,KAAKsD,MAAM4c,WAChCra,EAAQyrB,cAAgB,EACxBzrB,EAAQ2rB,cAAgB,EACxB3rB,EAAQgC,YACRhC,EAAQ+Z,IAAI5f,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAQ,EAAG5H,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,EAAGtC,EAAO,EAAG,EAAG,EAAA0Q,SAASC,KACvGja,EAAQmC,SACRnC,EAAQma,OAERna,EAAQ4sB,QAAU,QAClB5sB,EAAQ8B,UAAY,GACpB9B,EAAQ4B,YAAczH,KAAKsD,MAAMgtB,WACjCzqB,EAAQsa,YAAcngB,KAAKsD,MAAMovB,iBACjC7sB,EAAQqa,WAAalgB,KAAKsD,MAAMqvB,gBAChC9sB,EAAQgC,YACRhC,EAAQiC,OAAO9H,KAAKsyB,WAAW5rB,EAAG1G,KAAKsyB,WAAW1rB,GAClDf,EAAQgZ,OAAO7e,KAAKuyB,SAAS7rB,EAAG1G,KAAKuyB,SAAS3rB,GAC9Cf,EAAQmC,SAEVuoB,YACE,IAAI1qB,EAAU7F,KAAK6F,QACnBA,EAAQ4B,YAAc,OACtB5B,EAAQqO,UAAYlU,KAAKsD,MAAM7C,MAC/BoF,EAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QACtE5L,EAAQuO,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAEtE+e,WACE,IAAI3qB,EAAU7F,KAAK8W,aACf3H,EAAOvO,KAAKgP,IAAI5P,KAAK4H,MAAO5H,KAAKyR,QAErC5L,EAAQqO,UAAYlU,KAAK0R,SAASxR,SAClC2F,EAAQgC,YACRhC,EAAQ+Z,IAAI5f,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAQ,EAAG5H,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,EAAGtC,EAAO,EAAG,EAAG,EAAA0Q,SAASC,KACvGja,EAAQma,OAGVpJ,SACE,IAAIgc,EAAS5yB,KAAKqI,SAASwC,IAAI7K,KAAK4H,MAAQ,EAAG5H,KAAKyR,OAAS,GACzDohB,GAAQ,IAAAvxB,WAAUtB,KAAK+U,MAAO/U,KAAK4P,IAAK5P,KAAK2O,KAAO,EAAAkR,SAASC,IAAOlf,KAAKmuB,GAAK,EAC9E5f,EAAOvO,KAAKgP,IAAI5P,KAAK4H,MAAO5H,KAAKyR,QACrCzR,KAAKsyB,WAAW5P,OAAOkQ,EAAOlsB,EAAI9F,KAAKkyB,IAAID,IAAU1jB,EAAO,GAAIyjB,EAAOhsB,EAAIhG,KAAKmyB,IAAIF,IAAU1jB,EAAO,IACrGnP,KAAKuyB,SAAS7P,OAAOkQ,EAAOlsB,EAAI9F,KAAKkyB,IAAID,IAAU1jB,EAAO,EAAI,IAAKyjB,EAAOhsB,EAAIhG,KAAKmyB,IAAIF,IAAU1jB,EAAO,EAAI,KAExGnP,KAAKwM,OACPxM,KAAKwM,MAAMnE,SAASqa,OAClB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKwM,MAAMlJ,MAAMiF,OAC9EvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAGhCzR,KAAKyM,QACPzM,KAAKyM,OAAOpE,SAASqa,OACnB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAK+D,MAAQ5H,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKyM,OAAOnJ,MAAMiF,OACjGvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAI9BuhB,aAAa3qB,GACnB,IAAI4qB,EAAO5qB,EAAS0L,SAAS/T,KAAKqI,SAASwC,IAAI7K,KAAK4H,MAAQ,EAAG5H,KAAKyR,OAAS,IACzEohB,EAAQjyB,KAAKsyB,MAAMD,EAAKrsB,EAAGqsB,EAAKvsB,GAEpC,OADImsB,EAAQ,IAAGA,GAAS,EAAAhT,SAASC,MACvB+S,EAAQ,EAAAhT,SAASC,IAAO,IAAQ,GAAK,EAGjD+Q,aAAapR,EAAcC,GACzB1f,KAAKyvB,OAAS/P,EACd1f,KAAKwyB,MAAO,IAAAlxB,WAAUoe,EAAQ1f,KAAK4P,IAAK5P,KAAK2O,KAC7C3O,KAAK4W,SAEL5W,KAAKyM,QAAUzM,KAAKyM,OAAOvH,QAAQlF,KAAKyvB,QAE1CxU,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,WAET9wB,KAAKmzB,eAAYC,EACjBpzB,KAAKqzB,WAAarzB,KAAKgzB,aAAate,GACpC1U,KAAKwyB,MAAO,IAAAlxB,WAAUtB,KAAK+U,MAAO/U,KAAK4P,IAAK5P,KAAK2O,KACjD3O,KAAKwb,OAAO/G,EAAgBC,GAE5B1U,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,IAE1C2G,KAAK5G,EAAyBC,GACxB1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExCF,QAAQC,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C8G,OAAO/G,EAAyBC,GAC9B,GAAI1U,KAAK8wB,SAAU,OAEnB,IAAIwC,EAAYtzB,KAAKgzB,aAAate,GAC9B6e,EAAYD,EAAYtzB,KAAKqzB,WACjCE,EAAa3yB,KAAKyhB,IAAIkR,GAAa,GAAO,EAAIA,EAC9CvzB,KAAKqzB,WAAaC,EAClBtzB,KAAKwyB,KAAOxyB,KAAKwyB,KAAOe,EACxBvzB,KAAKwyB,MAAO,IAAAtwB,OAAMlC,KAAKwyB,KAAM,EAAG,GAEhC,IAAIK,EAAQ7yB,KAAKwyB,KAAO,EAAA3S,SAASC,IAC7B+S,EAAQ,IAAGA,GAAS,EAAAhT,SAASC,UACH,IAAnB9f,KAAKmzB,WAA6BvyB,KAAKyhB,IAAIriB,KAAKmzB,UAAYN,GAAS,IAC9EA,EAAQ7yB,KAAKmzB,UAAY,EAAI,EAAAtT,SAASC,IAAM,GAE9C9f,KAAKmzB,UAAYN,EACjB,IAAIW,EAAkBX,EAAQ,EAAAhT,SAASC,IACvC9f,KAAK+U,OAAQ,IAAA0e,cAAY,IAAAvxB,OAAMsxB,EAAiB,EAAG,GAAIxzB,KAAK4P,IAAK5P,KAAK2O,KACtE3O,KAAKwyB,KAAOgB,EACZxzB,KAAK4W,SAEL5W,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,WAET9wB,KAAKmzB,eAAYC,EAEjBpzB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,IAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,gBACM7b,KAAK8wB,SAGXjuB,YACE,MAAO,CACL+M,IAAK5P,KAAK4P,IACVjB,IAAK3O,KAAK2O,IACVoG,MAAO/U,KAAK+U,MACZwC,SAAUvX,KAAKuX,SACf/K,MAAOxM,KAAKwM,MAAQxM,KAAKwM,MAAM3J,YAAc,KAC7C4J,OAAQzM,KAAKyM,OAASzM,KAAKyM,OAAO5J,YAAc,KAChDsM,KAAMnP,KAAKyR,OACXjO,GAAIxD,KAAKwD,GACTkO,SAAU1R,KAAK0R,SAAS7O,YACxBS,MAAOtD,KAAKsD,MACZiC,KAAMvF,KAAKuF,KACXwI,OAAQ,IAGZrN,mBAAmBmD,EAAYf,GAC7B,OAAO,IAAI+Z,EAAKhZ,EAAMf,EAAK8M,IAAK9M,EAAK6L,IAAK7L,EAAKqM,KAAM,CACnD4F,MAAOjS,EAAKiS,MACZwC,SAAUzU,EAAKyU,SACf/K,MAAO1J,EAAK0J,MACZC,OAAQ3J,EAAK2J,OACbnJ,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,aAxOvC,SAyPA,IAAI2gB,EAAoBljB,IACf,CACL1O,MAAO,UACPiH,YAAa,OACb0oB,YAAa,EACbjQ,YAAa,OACbD,WAAY,EACZoQ,WAAY,UACZoC,iBAAkB,UAClBC,gBAAiB,EACjBxjB,KAAAA,EACA6iB,SAAS,IAoBTI,EAAsBxiB,IACjB,CACLmF,MAAOnF,K,6FCpSX,gBAGA,UACA,UACA,UAEA,MAAamO,UAAgB,EAAAqR,OAG3BtvB,YACE+D,EACA4N,EACAiiB,EACAxwB,EAA0BywB,KAE1BvwB,MAAMS,EAAM,EAAAmD,QAAQkY,OAAQ,EAAAoQ,OAAOvR,QAAS,CAC1CrC,WAAW,EACXM,UAAU,EACV1Y,MAAOJ,EAAQI,MAAQ,IAAKswB,OAA0B1wB,EAAQI,OAAUswB,IACxEpnB,MAAOtJ,EAAQ6pB,OAAkC,kBAAlB7pB,EAAQ6pB,MACnC,EAAA/V,SAASrK,YAAY9I,EAAMX,EAAQ6pB,OACnC,IAAI,EAAA/V,SAASnT,EAAM,EAAA2B,aAAaC,GAAI,QAAS,GAAI,IACrDjC,GAAIN,EAAQM,GAAIkO,SAAUxO,EAAQwO,WAftC,KAAAmiB,iBAA4C,GAkB1C7zB,KAAKyR,OAASA,EAEiB,oBAApBuV,gBACT0M,EAAgB5xB,SAAQgyB,IACtB,IAAI5M,EAAW5gB,EAAYytB,EACvBD,EAAeE,aAAeC,EAAWnN,mBAC3CI,EAAYpU,SAASC,cAAc,UACnCmU,EAAUtf,MAAQ5H,KAAK6D,KAAK+D,MAAQ,EAAI5H,KAAK6D,KAAKP,MAAM4U,QACxDgP,EAAUzV,OAASzR,KAAKyR,QAExByV,EAAY,IAAIF,gBAAgBhnB,KAAK6D,KAAK+D,MAAQ,EAAI5H,KAAK6D,KAAKP,MAAM4U,QAASlY,KAAKyR,QAEtFnL,EAAa4gB,EAAUH,WAAW,MAClCgN,EAAqB,CAAEpO,OAAQuB,EAAWrhB,QAASS,EAAYwtB,eAAAA,EAAgBI,cAAc,GAC7Fl0B,KAAK6zB,iBAAiB9xB,KAAKgyB,MAG7BL,EAAgB5xB,SAAQgyB,IACtB,IAAI5M,EAAYpU,SAASC,cAAc,UACvCmU,EAAUtf,MAAQ5H,KAAK6D,KAAK+D,MAAQ,EAAI5H,KAAK6D,KAAKP,MAAM4U,QACxDgP,EAAUzV,OAASzR,KAAKyR,OACxB,IAAInL,EAAa4gB,EAAUH,WAAW,MAClCgN,EAAqB,CAAEpO,OAAQuB,EAAWrhB,QAASS,EAAYwtB,eAAAA,EAAgBI,cAAc,GACjGl0B,KAAK6zB,iBAAiB9xB,KAAKgyB,MAI/B/zB,KAAKwM,MAAMxC,GAAG,SAAS,KACrBhK,KAAK6zB,iBAAiBxnB,QAAO8nB,IAAWA,EAAOL,eAAeM,OAAMtyB,SAAQqyB,IAC1EA,EAAOtuB,QAAQmnB,UAAU,EAAG,EAAGmH,EAAOxO,OAAO/d,MAAOusB,EAAOxO,OAAOlU,cAItEzR,KAAK6D,KAAKZ,KAAK6C,YAAYkE,GAAG,SAAS,IAAMhK,KAAK4W,WAG5Cyd,aAAaC,GACnB,OAAOhlB,QAAQC,IAAI+kB,EAAc7xB,KAAI0xB,GAC5B,IAAI7kB,SAAiBE,IACtB2kB,EAAOD,cACLC,EAAOL,eAAe/G,OACxBoH,EAAOtuB,QAAQmnB,UAAU,EAAG,EAAGmH,EAAOxO,OAAO/d,MAAOusB,EAAOxO,OAAOlU,QAChEzR,KAAKsD,MAAM6sB,kBACbgE,EAAOtuB,QAAQqO,UAAYlU,KAAKsD,MAAM6sB,gBACtCgE,EAAOtuB,QAAQuO,SAAS,EAAG,EAAG+f,EAAOxO,OAAO/d,MAAOusB,EAAOxO,OAAOlU,SAEnEjC,EACE2kB,EAAOL,eAAeS,SAASJ,EAAOtuB,QAASsuB,EAAOxO,OAAO/d,MAAOusB,EAAOxO,OAAOlU,UAE/EjC,GAAQ,SAKrB0gB,QACE,IAAIrqB,EAAU7F,KAAK6F,QACnBA,EAAQ4B,YAAczH,KAAKsD,MAAMoE,YACjC7B,EAAQ8B,UAAY,EACpB9B,EAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAEtE,IAAI+iB,EAAuBx0B,KAAK6zB,iBAAiBxnB,QAAO8nB,GAAUA,EAAOL,eAAeM,OACxFp0B,KAAKq0B,aAAaG,GAAsBC,MAAMC,IAC5CA,EAAQ5yB,SAAQ,CAAC6yB,EAAQxyB,IAAUqyB,EAAqBryB,GAAO+xB,aAAeS,OAGhF30B,KAAK6zB,iBAAiB/xB,SAAQolB,IAC5BrhB,EAAQ+uB,UACN1N,EAAUvB,OAAQ,EAAG,EACrBuB,EAAUvB,OAAO/d,MAAOsf,EAAUvB,OAAOlU,OACzCzR,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAC/B5G,KAAK6D,KAAK+D,MAAQ,EAAI5H,KAAK6D,KAAKP,MAAM4U,QAASlY,KAAKyR,WAI1D8e,YACE,IAAI1qB,EAAU7F,KAAK6F,QACnBA,EAAQ4B,YAAczH,KAAKsD,MAAMoE,YACjC7B,EAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QACtE5L,EAAQqO,UAAY,YACpBrO,EAAQuO,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAEtE+e,WACExwB,KAAK8W,aAAa5C,UAAYlU,KAAK0R,SAASxR,SAC5CF,KAAK8W,aAAa1C,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAGhFmF,SACE,IAAI6Z,GAAYzwB,KAAK6D,KAAK+D,MAAQ,EAAI5H,KAAK6D,KAAKP,MAAM4U,SAAWlY,KAAK6D,KAAKZ,KAAK6C,YAAY2N,MACxFid,EAAY1wB,KAAKyR,OAASzR,KAAK6D,KAAKZ,KAAK6C,YAAY2N,MAEzDzT,KAAK6zB,iBAAiB/xB,SAAQolB,IAExBtmB,KAAKC,MAAMqmB,EAAUvB,OAAO/d,SAAWhH,KAAKC,MAAM4vB,IAAa7vB,KAAKC,MAAMqmB,EAAUvB,OAAOlU,UAAY7Q,KAAKC,MAAM6vB,KACpHxJ,EAAUvB,OAAO/d,MAAQ6oB,EACzBvJ,EAAUvB,OAAOlU,OAASif,EAErBxJ,EAAUgN,eACbhN,EAAU4M,eAAeS,SAASrN,EAAUrhB,QAASqhB,EAAUvB,OAAO/d,MAAOsf,EAAUvB,OAAOlU,QAC9FyV,EAAUgN,cAAe,OAK/Bl0B,KAAKwM,MAAMnE,SAASqa,OAClB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKwM,MAAMlJ,MAAMiF,OAC9EvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAIpCof,gBACA5V,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1C2G,KAAK5G,EAAyBC,GACxB1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExCF,QAAQC,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C8G,OAAO/G,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,gBACM7b,KAAK8wB,UAET9wB,KAAKsE,KAAK,aAActE,MAG1B6C,YACE,MAAO,CACL4O,OAAQzR,KAAKyR,OACb8F,SAAUvX,KAAKuX,SACf/K,MAAOxM,KAAKwM,MAAQxM,KAAKwM,MAAM3J,YAAc,KAC7C4J,OAAQzM,KAAKyM,OAASzM,KAAKyM,OAAO5J,YAAc,KAChDW,GAAIxD,KAAKwD,GACTkO,SAAU1R,KAAK0R,SAAS7O,YACxBS,MAAOtD,KAAKsD,MACZiC,KAAMvF,KAAKuF,KACXwI,OAAQ,IAGZrN,mBAAmBmD,EAAYf,GAC7B,OAAO,IAAIib,EAAQla,EAAMf,EAAK2O,OAAQ,KAAM,CAC1CnO,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,UACjCqb,MAAOjqB,EAAK0J,SAKlB,IAAYynB,EAtMZ,YAsMA,SAAYA,GACV,yCACA,6CAFF,CAAYA,EAAA,EAAAA,aAAA,EAAAA,WAAU,KAuBtB,IAAIL,EAAsB,KACjB,CACLlsB,YAAa,OACbsqB,SAAS,IAcT2B,EAAwB,KACnB,K,kFCtPT,gBACA,UAEA,UAEA,UACA,UACA,UACA,UACA,SAEA,MAAaxV,UAAiB,EAAAiR,OAsB5BtvB,YACE+D,EACA4N,EACApH,EAAoB,GACpBnH,EAA2B2xB,KAE3BzxB,MAAMS,EAAM,EAAAmD,QAAQkY,OAAQ,EAAAoQ,OAAOnR,SAAU,CAC3CzC,WAAW,EACXpY,MAAOJ,EAAQI,MAAQ,IAAKwxB,OAA2B5xB,EAAQI,OAAUwxB,IACzEtoB,MAAOtJ,EAAQsJ,QAAmC,kBAAlBtJ,EAAQsJ,MACpC,IAAI,EAAAwK,SAASnT,EAAM,EAAA2B,aAAaC,GAAI,QAAS,GAAI,IACjD,EAAAuR,SAASrK,YAAY9I,EAAMX,EAAQsJ,QACvCC,OAAQvJ,EAAQuJ,SAAqC,kBAAnBvJ,EAAQuJ,OACtC,IAAI,EAAAuK,SAASnT,EAAM,EAAA2B,aAAayR,IAAK,QAAS,GAAI,IAClD,EAAAD,SAASrK,YAAY9I,EAAMX,EAAQuJ,SACvCjJ,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WApCd,KAAAqjB,mBAAuD,IAAI,EAAAC,MAG3D,KAAAxF,cAAwB,GAoC9BxvB,KAAKyR,OAASA,EACdpH,EAAOvI,SAAQ6gB,GAAUA,EAAOX,aAAa,EAAG,EAAG,EAAG,KACtD3X,EAAO4qB,MAAK,CAAC51B,EAAGqK,IAAMrK,EAAEqH,EAAIgD,EAAEhD,IAC9B1G,KAAKyvB,OAAS,IAAI,EAAA1f,MAAK,CAAC1Q,EAAGqK,IAAMrK,EAAEqH,EAAIgD,EAAEhD,GAAG2D,GAC5CrK,KAAK+0B,mBAAmBhI,QACxB/sB,KAAKyvB,OAAO3tB,SAAQozB,GAAal1B,KAAK+0B,mBAAmBnqB,IAAI,EAAA/K,MAAMiS,SAAS5R,SAAUg1B,KAElFl1B,KAAKwM,QACPxM,KAAKwM,MAAMxC,GAAG,WAAW,CAAC2U,EAAG1Y,KACvBA,EAAUnD,OAAM9C,KAAK+U,MAAQ9O,EAAUnD,SAE7C9C,KAAKwM,MAAMxC,GAAG,QAAQ,CAAC2U,EAAG7b,KACpBA,IAAM9C,KAAK+U,MAAQjS,OAGvB9C,KAAKyM,QAAQzM,KAAKyM,OAAOzC,GAAG,WAAW,CAAC2U,EAAG1Y,IAAcA,EAAUnD,KAAO9C,KAAK+U,QAEpD,oBAApBiS,gBACThnB,KAAKm1B,gBAAkB,IAAInO,gBAAgBhnB,KAAK4H,MAAO5H,KAAKyR,SAE5DzR,KAAKm1B,gBAAkBriB,SAASC,cAAc,UAC9C/S,KAAKm1B,gBAAgBvtB,MAAQ5H,KAAK4H,MAClC5H,KAAKm1B,gBAAgB1jB,OAASzR,KAAKyR,QAErCzR,KAAKo1B,iBAAmBp1B,KAAKm1B,gBAAgBpO,WAAW,MACxD/mB,KAAKq1B,kBA3DHtgB,YACF,OAAO/U,KAAKyvB,OAAO6F,UAAU7yB,KAAI8yB,GAAOA,EAAIja,UAE1CvG,UAAMA,GACR,IAAIgb,EAAS/vB,KAAK+U,MAClBA,EAAMjT,SAAQ6gB,GAAUA,EAAOX,aAAa,EAAG,EAAG,EAAG,KACrDjN,EAAMkgB,MAAK,CAAC51B,EAAGqK,IAAMrK,EAAEqH,EAAIgD,EAAEhD,IAC7B1G,KAAKyvB,OAAS,IAAI,EAAA1f,MAAK,CAAC1Q,EAAGqK,IAAMrK,EAAEqH,EAAIgD,EAAEhD,GAAGqO,GAC5C/U,KAAK+0B,mBAAmBhI,QACxB/sB,KAAKyvB,OAAO3tB,SAAQ+B,GAAQ7D,KAAK+0B,mBAAmBnqB,IAAI,EAAA/K,MAAMiS,SAAS5R,SAAU2D,KACjF7D,KAAKq1B,kBAEDr1B,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM+vB,EAAQ/vB,KAAKyvB,OAAO6F,WAkDhGD,kBACE,IAAKztB,EAAO6J,GAAU,CAACzR,KAAK4H,MAAQ5H,KAAKwvB,cAAexvB,KAAKyR,OAASzR,KAAKwvB,eAC3ExvB,KAAKo1B,iBAAiBpI,UAAU,EAAG,EAAGplB,EAAO6J,GAE7CzR,KAAKyvB,OAAO3tB,SAAQ+B,IAClB,IAAIosB,EAAQ,IAAI,EAAAjpB,QAAQnD,EAAKf,KAAK4D,EAAG,EAAI7C,EAAKf,KAAK8D,GAAG0b,SAAS1a,EAAO6J,GAAQ5G,IAAI7K,KAAKwvB,cAAgB,GACvGxvB,KAAKo1B,iBAAiBlhB,UAAYlU,KAAK+0B,mBAAmBtxB,IAAII,GAC9D7D,KAAKo1B,iBAAiBvtB,YACtB7H,KAAKo1B,iBAAiBxV,IAAIqQ,EAAMvpB,EAAGupB,EAAMrpB,EAAG5G,KAAKwvB,cAAgB,EAAG,EAAG,EAAA3P,SAASC,KAChF9f,KAAKo1B,iBAAiBpV,UAI1BkQ,QACE,IAAIrqB,EAAU7F,KAAK6D,KAAKgC,QAExBA,EAAQqO,UAAYlU,KAAKsD,MAAM6sB,gBAC/BtqB,EAAQ4B,YAAczH,KAAKsD,MAAMoE,YACjC7B,EAAQ8B,UAAY3H,KAAKsD,MAAM8sB,YAC/BvqB,EAAQuO,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QACpE5L,EAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAEtE,IAAK7J,EAAO6J,GAAU,CAACzR,KAAK4H,MAAQ5H,KAAKwvB,cAAexvB,KAAKyR,OAASzR,KAAKwvB,eACvEgG,EAAoBx1B,KAAKyvB,OAAOhtB,KAAIoB,GACtC,IAAI,EAAAmD,QAAQnD,EAAKf,KAAK4D,EAAG,EAAI7C,EAAKf,KAAK8D,GACpC+a,gBAAgB/Z,EAAO6J,GACvB+P,WAAWxhB,KAAKqI,UAChBmZ,WAAWxhB,KAAKwvB,cAAgB,KAGjCgG,EAAOp0B,OAAS,IAClByE,EAAQ4B,YAAczH,KAAKsD,MAAMmyB,UACjC5vB,EAAQ8B,UAAY,EACpB9B,EAAQgC,YACRhC,EAAQiC,OAAO9H,KAAKqI,SAAS3B,EAAG8uB,EAAO,GAAG5uB,GAC1C4uB,EAAO1zB,SAAQuuB,GAASxqB,EAAQgZ,OAAOwR,EAAM3pB,EAAG2pB,EAAMzpB,KACtDf,EAAQgZ,OAAO7e,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAO4tB,EAAOA,EAAOp0B,OAAS,GAAGwF,GACvEf,EAAQmC,UAGVnC,EAAQqO,UAAYlU,KAAKsD,MAAMoyB,WAC/BF,EAAO1zB,SAAQuuB,IACbxqB,EAAQgC,YACRhC,EAAQ+Z,IAAIyQ,EAAM3pB,EAAG2pB,EAAMzpB,EAAG5G,KAAKwvB,cAAgB,EAAG,EAAG,EAAA3P,SAASC,KAClEja,EAAQma,UAGZuQ,YACEvwB,KAAK6F,QAAQqO,UAAYlU,KAAKsD,MAAM6sB,gBACpCnwB,KAAK6F,QAAQuO,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAE3E+e,WACExwB,KAAK8W,aAAa5C,UAAYlU,KAAK0R,SAASxR,SAC5CF,KAAK8W,aAAa1C,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAGhFmF,SACE,IAAK6Z,EAAUC,GAAa,CAAC1wB,KAAK4H,MAAO5H,KAAKyR,QAG5C7Q,KAAKC,MAAMb,KAAKm1B,gBAAgBvtB,SAAWhH,KAAKC,MAAM4vB,IACnD7vB,KAAKC,MAAMb,KAAKm1B,gBAAgB1jB,UAAY7Q,KAAKC,MAAM6vB,KAG1D1wB,KAAKm1B,gBAAgBvtB,MAAQ6oB,EAC7BzwB,KAAKm1B,gBAAgB1jB,OAASif,EAC9B1wB,KAAKq1B,mBAGHr1B,KAAKwM,OACPxM,KAAKwM,MAAMnE,SAASqa,OAClB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKwM,MAAMlJ,MAAMiF,OAC9EvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAGhCzR,KAAKyM,QACPzM,KAAKyM,OAAOpE,SAASqa,OACnB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAK+D,MAAQ5H,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKyM,OAAOnJ,MAAMiF,OACjGvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAKtCkf,YAAYjc,GACV,IAAIub,EAAQvb,EAAaX,SAAS/T,KAAKqI,UACnCqJ,EAAW,EAAA7R,MAAMM,UAAUH,KAAKo1B,iBAAiBra,aAAakV,EAAMvpB,EAAGupB,EAAMrpB,EAAG,EAAG,GAAG9D,MAE1F,OADmB9C,KAAK+0B,mBAAmBtxB,IAAIiO,GAGjDkf,UAAUlc,GACR,IAAK9M,EAAO6J,GAAU,CAACzR,KAAK4H,MAAQ5H,KAAKwvB,cAAexvB,KAAKyR,OAASzR,KAAKwvB,eAE3ExvB,KAAK21B,aAAa7yB,KAAO4R,EACtBxS,MACClC,KAAKqI,SAAS3B,EAAI1G,KAAKwvB,cAAgB,EAAGxvB,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAQ5H,KAAKwvB,cAAgB,EAC9FxvB,KAAKqI,SAASzB,EAAI5G,KAAKwvB,cAAgB,EAAGxvB,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAASzR,KAAKwvB,cAAgB,GAEhG5N,gBAAgB5hB,KAAKqI,SAASwC,IAAI7K,KAAKwvB,cAAgB,IACvDxN,aAAa,EAAGpa,EAAO,EAAG6J,GAC1BoQ,iBAAiB,EAAGja,EAAO,EAAG6J,GAC9BuQ,aACChiB,KAAK21B,aAAaC,MAAM9yB,KAAK4D,GAAK,EAAG1G,KAAK21B,aAAajb,MAAM5X,KAAK4D,GAAK,GACtEmvB,EAAAA,EAAUA,EAAAA,GAEf71B,KAAK21B,aAAa7yB,KAAO,IAAI,EAAAkE,QAAQhH,KAAK21B,aAAa7yB,KAAK4D,EAAG,EAAI1G,KAAK21B,aAAa7yB,KAAK8D,GAE1F5G,KAAKq1B,kBAEPS,SAASphB,EAAuB9M,EAAe6J,GAC7C,IAOIskB,EAPAhG,EAAS/vB,KAAKyvB,OAAO6F,UAErBQ,EAAWphB,EACZX,SAAS/T,KAAKqI,SAASwC,IAAI7K,KAAKwvB,cAAgB,IAChD3N,iBAAiB,EAAGja,EAAO,EAAG6J,GACjCqkB,EAAW,IAAI,EAAA9uB,QAAQ8uB,EAASpvB,EAAG,EAAIovB,EAASlvB,GAGhD,IAAIovB,EAASh2B,KAAKyvB,OAAOwG,YAAWpyB,GAAQA,EAAKf,KAAK4D,GAAKovB,EAASpvB,IAE/CqvB,EAAN,OAAXC,EAAgCh2B,KAAKyvB,OAAOyG,QAAQJ,GACpC91B,KAAKyvB,OAAO0G,SAASL,EAAUE,GAEnDh2B,KAAK+0B,mBAAmBnqB,IAAI,EAAA/K,MAAMiS,SAAS5R,SAAU61B,GACrD/1B,KAAKq1B,kBACDr1B,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM+vB,EAAQ/vB,KAAKyvB,OAAO6F,WAEhGc,cACE,IAAIrG,EAAS/vB,KAAKyvB,OAAO6F,UACzBt1B,KAAKyvB,OAAO1jB,OAAO/L,KAAK21B,cACxB31B,KAAK+0B,mBAAmBhpB,OAAO/L,KAAK21B,cACpC31B,KAAKq1B,kBAEDr1B,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM+vB,EAAQ/vB,KAAKyvB,OAAO6F,WAGhGzE,gBACA5V,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAK1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,WAET9wB,KAAK21B,aAAe31B,KAAK2wB,YAAYjc,GACrC1U,KAAKq2B,iBAAmB3hB,EAExB1U,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,IAE1C2G,KAAK5G,EAAyBC,GAC5B,GAAI1U,KAAK8wB,SAAU,OAEnB,IAAKlpB,EAAO6J,GAAU,CAACzR,KAAK4H,MAAQ5H,KAAKwvB,cAAexvB,KAAKyR,OAASzR,KAAKwvB,gBACtExvB,KAAK21B,cAAgB31B,KAAKq2B,iBACzB,EAAArvB,QAAQC,SAASjH,KAAKq2B,iBAAkB3hB,IAAiB,GAC3D1U,KAAK81B,SAASphB,EAAc9M,EAAO6J,GAGrCzR,KAAK21B,cAAgB31B,KAAK21B,eAAiB31B,KAAK2wB,YAAYjc,IACzD1U,KAAKq2B,kBAAoBr2B,KAAKq2B,iBAAiB71B,QAAQkU,EAAc,IAExE1U,KAAKo2B,cACIp2B,KAAK21B,cAEV31B,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM,KAAMA,KAAKyvB,OAAO6F,WAG9Ft1B,KAAK21B,aAAe,KACpB31B,KAAKq2B,iBAAmB,KAExBr2B,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExCF,QAAQC,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C8G,OAAO/G,EAAyBC,GAC1B1U,KAAK8wB,WAEL9wB,KAAK21B,cAAc31B,KAAK4wB,UAAUlc,GAEtC1U,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,IAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,WAEL9wB,KAAK21B,eACP31B,KAAK4wB,UAAUlc,GACX1U,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM,KAAMA,KAAKyvB,OAAO6F,YAE9Ft1B,KAAK21B,aAAe,KACpB31B,KAAKq2B,iBAAmB,KAExBr2B,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,IAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,gBACM7b,KAAK8wB,SAGXjuB,YACE,MAAO,CACLwH,OAAQrK,KAAK+U,MAAMtS,KAAIkgB,GAAUA,EAAO9f,cACxC0U,SAAUvX,KAAKuX,SACf/K,MAAOxM,KAAKwM,MAAQxM,KAAKwM,MAAM3J,YAAc,KAC7C4J,OAAQzM,KAAKyM,OAASzM,KAAKyM,OAAO5J,YAAc,KAChDW,GAAIxD,KAAKwD,GACTkO,SAAU1R,KAAK0R,SAAS7O,YACxBS,MAAOtD,KAAKsD,MACZmO,OAAQzR,KAAKyR,OACblM,KAAMvF,KAAKuF,KACXwI,OAAQ,IAGZrN,mBAAmBmD,EAAYf,GAC7B,OAAO,IAAIqb,EAASta,EAAMf,EAAK2O,OAAQ3O,EAAKuH,OAAO5H,KAAI6zB,GAAa,EAAAtvB,QAAQ2F,YAAY2pB,KAAa,CACnG9pB,MAAO1J,EAAK0J,MACZC,OAAQ3J,EAAK2J,OACbnJ,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,aA9SvC,aA0TA,IAAIojB,EAAuB,KAClB,CACL3E,gBAAiB,UACjBuF,WAAY,UACZD,UAAW,UACX/tB,YAAa,OACb0oB,YAAa,EACb4B,SAAS,IAgBT6C,EAAyB,KACpB,K,0FC7VT,gBAGA,UACA,UACA,UACA,SACA,UAEA,MAAa9X,UAAyB,EAAAqS,OAEpCtvB,YACE+D,EACAkK,EAAmB,GACnB7K,EAAmCqzB,KAEnCnzB,MAAMS,EAAM,EAAAmD,QAAQkY,OAAQ,EAAAoQ,OAAOvS,iBAAkB,CACnDzZ,MAAOJ,EAAQI,MAAQ,IAAKkzB,OAAmCtzB,EAAQI,OAAUkzB,IACjFhqB,MAAOtJ,EAAQsJ,QAAmC,kBAAlBtJ,EAAQsJ,MACpC,IAAI,EAAAwK,SAASnT,EAAM,EAAA2B,aAAaC,GAAI,MAAO,GAAI,IAC/C,EAAAuR,SAASrK,YAAY9I,EAAMX,EAAQsJ,QACvCC,OAAQvJ,EAAQuJ,SAAqC,kBAAnBvJ,EAAQuJ,OACtC,IAAI,EAAAuK,SAASnT,EAAM,EAAA2B,aAAayR,IAAK,MAAO,GAAI,IAChD,EAAAD,SAASrK,YAAY9I,EAAMX,EAAQuJ,SACvCjJ,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WAGhB3D,GAAUA,EAAO3M,OAAS,GAAGpB,KAAKqxB,SAAStvB,QAAQgM,GAGzDmiB,SACAK,aACAC,WACExwB,KAAK8W,aAAa5C,UAAYlU,KAAK0R,SAASxR,SAC5CF,KAAK8W,aAAa1C,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAGhFmF,SACE,IAAIya,EAAWrxB,KAAKqxB,SAAShlB,QAAO2C,GAASA,EAAMgjB,UAE/CC,EAAiBjyB,KAAK4H,OAASypB,EAASjwB,OAAS,EAAKiwB,EAASjwB,OAAS,EAAK,GAAKpB,KAAKsD,MAAM+a,QAC7FoY,EAAgBxE,EAEhByE,EAAY,EAChBrF,EAASvvB,SAAQkN,GAAS0nB,EAAY91B,KAAK+N,IAAI+nB,EAAW1nB,EAAMyC,UAChEzR,KAAKyR,OAASilB,EAEd,IAAIC,EAAmB32B,KAAKqxB,SAAShlB,QAAO2C,KAAWA,EAAMpH,QAC7D+uB,EAAiB70B,SAAQkN,GAASA,EAAMpH,OAAQ,IAAA1F,OAAM8M,EAAMpH,MAAO,EAAGqqB,KACtE,IAAI2E,EAAaD,EAAiBnoB,QAAO,CAACC,EAAKC,IAASD,EAAMC,EAAK9G,OAAO,GAEtEivB,EAAiBJ,EACrBG,GAAa,IAAA10B,OAAM00B,EAAY,EAAGC,GAClCA,GAAkBD,EAClB,IAAIE,EAAYD,EAEZnwB,EAAI1G,KAAKqI,SAAS3B,EACtB2qB,EAASvvB,SAAQkN,IACf,IAAI+nB,EAWAnwB,EAVemwB,EAAb/nB,EAAMpH,MAAoBoH,EAAMpH,MACD,iBAArBoH,EAAM1L,MAAM0zB,KACbhoB,EAAM1L,MAAM0zB,KAAOF,EAEnB,EAGfC,GAAa,IAAA70B,OAAM60B,EAAY,EAAG9E,GAClCjjB,EAAMpH,MAAQmvB,EAGV/nB,EAAMyC,OAASzR,KAAKyR,OACtB7K,EAAI5G,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,EAAIzC,EAAMyC,OAAS,GAEvDzC,EAAMyC,OAASzR,KAAKyR,OACpB7K,EAAI5G,KAAKqI,SAASzB,GAEpBoI,EAAM3G,SAASqa,OAAOhc,EAAGE,GAEzBqrB,GAAkB8E,EAClBrwB,GAAKqwB,EAAa/2B,KAAKsD,MAAM+a,WAG3Bre,KAAKwM,OACPxM,KAAKwM,MAAMnE,SAASqa,OAClB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKwM,MAAMlJ,MAAMiF,OAC9EvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAGhCzR,KAAKyM,QACPzM,KAAKyM,OAAOpE,SAASqa,OACnB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAK+D,MAAQ5H,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKyM,OAAOnJ,MAAMiF,OACjGvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAKpCzR,KAAK6D,KAAKiQ,GAAG8C,SAGfia,gBACA5V,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1C2G,KAAK5G,EAAyBC,GACxB1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExCF,QAAQC,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C8G,OAAO/G,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,iBAEAhZ,YACE,MAAO,CACL0U,SAAUvX,KAAKuX,SACf/K,MAAOxM,KAAKwM,MAAQxM,KAAKwM,MAAM3J,YAAc,KAC7C4J,OAAQzM,KAAKyM,OAASzM,KAAKyM,OAAO5J,YAAc,KAChDW,GAAIxD,KAAKwD,GACTF,MAAOtD,KAAKsD,MACZoO,SAAU1R,KAAK0R,SAAS7O,YACxB0C,KAAMvF,KAAKuF,KACXwI,OAAQ/N,KAAKqxB,SAAS5uB,KAAIuM,GAAUA,EAAcnM,eAGtDnC,mBAAmBmD,EAAYf,GAC7B,IAAIm0B,EAAY,IAAIla,EAAiBlZ,EAAM,GAAI,CAC7CP,MAAOR,EAAKQ,MACZkJ,MAAO1J,EAAK0J,MACZC,OAAQ3J,EAAK2J,OACbjJ,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,YAoBnC,OAjBAulB,EAAU5F,SAAStvB,QAAQe,EAAKiL,OAAOtL,KAAI0vB,IACzC,OAAQA,EAAgB5sB,MACtB,KAAK,EAAA+pB,OAAOnS,OAAQ,OAAO,EAAAA,OAAOxQ,YAAY9I,EAAMsuB,GACpD,KAAK,EAAA7C,OAAO/Y,UAAW,OAAO,EAAAA,UAAU5J,YAAY9I,EAAMsuB,GAC1D,KAAK,EAAA7C,OAAOvR,QAAS,OAAO,EAAAA,QAAQpR,YAAY9I,EAAMsuB,GACtD,KAAK,EAAA7C,OAAOvS,iBAAkB,OAAOA,EAAiBpQ,YAAY9I,EAAMsuB,GACxE,KAAK,EAAA7C,OAAOrS,MAAO,OAAO,EAAAA,MAAMtQ,YAAY9I,EAAMsuB,GAClD,KAAK,EAAA7C,OAAOjT,MAAO,OAAO,EAAAA,MAAM1P,YAAY9I,EAAMsuB,GAClD,KAAK,EAAA7C,OAAOrR,MAAO,OAAO,EAAAA,MAAMtR,YAAY9I,EAAMsuB,GAClD,KAAK,EAAA7C,OAAOnT,MAAO,OAAO,EAAAA,MAAMxP,YAAY9I,EAAMsuB,GAClD,KAAK,EAAA7C,OAAO5R,OAAQ,OAAO,EAAAA,OAAO/Q,YAAY9I,EAAMsuB,GACpD,KAAK,EAAA7C,OAAO/S,OAAQ,OAAO,EAAAA,OAAO5P,YAAY9I,EAAMsuB,GACpD,KAAK,EAAA7C,OAAO1R,OAAQ,OAAO,EAAAA,OAAOjR,YAAY9I,EAAMsuB,GACpD,KAAK,EAAA7C,OAAOjS,OAAQ,OAAO,EAAAA,OAAO1Q,YAAY9I,EAAMsuB,GACpD,QAAS,YAGN8E,GA5KX,qBAmLA,IAAIT,EAA+B,KAC1B,CACLnY,QAAS,EACT2T,SAAS,IAaTuE,EAAiC,KAC5B,K,+EC7MT,gBAGA,UACA,UACA,UACA,UACA,SACA,UACA,UACA,SAEA,MAAala,UAAc,EAAA+S,OAsBzBtvB,YACE+D,EACAqzB,EACAh0B,EAAwBi0B,KAExB/zB,MAAMS,EAAM,EAAAmD,QAAQkY,OAAQ,EAAAoQ,OAAOjT,MAAO,CACxC/Y,MAAOJ,EAAQI,MAAQ,IAAK8zB,OAAwBl0B,EAAQI,OAAU8zB,IACtE7f,SAAUrU,EAAQqU,SAClB/K,MAAOtJ,EAAQsJ,QAAmC,kBAAlBtJ,EAAQsJ,MACpC,IAAI,EAAAwK,SAASnT,EAAM,EAAA2B,aAAaC,GAAI,SAAU,GAAI,IAClD,EAAAuR,SAASrK,YAAY9I,EAAMX,EAAQsJ,QACvCC,OAAQvJ,EAAQuJ,SAAqC,kBAAnBvJ,EAAQuJ,OACtC,IAAI,EAAAuK,SAASnT,EAAM,EAAA2B,aAAayR,IAAK,SAAU,GAAI,IACnD,EAAAD,SAASrK,YAAY9I,EAAMX,EAAQuJ,SACvCjJ,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WAGpB1R,KAAKq3B,MAAO,IAAA5zB,KAAIyzB,EAAc,EAAA/H,WAC9BnvB,KAAKs3B,aAlCHC,UACF,OAAIv3B,KAAKuX,SAAiBvX,KAAK0vB,UACxB1vB,KAAKq3B,KAEVE,QAAIA,GACN,IAAIxH,EAAS/vB,KAAKq3B,KACd3X,EAAS6X,EAETv3B,KAAKuX,SAAUvX,KAAKgwB,QAAQtQ,GAC3B1f,KAAKq3B,KAAO3X,EACjB1f,KAAKs3B,aAEDt3B,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM+vB,EAAQrQ,GAyBpF4X,aACOt3B,KAAKqF,SACRrF,KAAKqF,OAASyN,SAASC,cAAc,OACrC/S,KAAKqF,OAAOmyB,QAAW51B,GAAU,EAAAD,IAAIC,MAAMA,GAC3C5B,KAAKqF,OAAOoyB,OAAS,KACnBz3B,KAAK03B,YAAY9vB,MAAQ5H,KAAKqF,OAAOuC,MACrC5H,KAAK03B,YAAYjmB,OAASzR,KAAKqF,OAAOoM,OAEtCzR,KAAK23B,aAAa/C,UAAU50B,KAAKqF,OAAQ,EAAG,GAC5CrF,KAAK43B,MAAQ53B,KAAKqF,OAAOuC,MAAQ5H,KAAKqF,OAAOoM,OAC7CzR,KAAK4W,SACL5W,KAAK6D,KAAKiQ,GAAG+C,WAGZ7W,KAAK03B,cACuB,oBAApB1Q,gBAAiChnB,KAAK03B,YAAc,IAAI1Q,gBAAgB,EAAG,IAEpFhnB,KAAK03B,YAAc5kB,SAASC,cAAc,UAC1C/S,KAAK03B,YAAY9vB,MAAQ,EACzB5H,KAAK03B,YAAYjmB,OAAS,GAE5BzR,KAAK23B,aAAe33B,KAAK03B,YAAY3Q,WAAW,OAGlD/mB,KAAKqF,OAAOkyB,IAAMv3B,KAAKq3B,KAGzBnH,QACE,GAAIlwB,KAAK03B,aAAe13B,KAAK03B,YAAY9vB,MAAQ,GAAK5H,KAAK03B,YAAYjmB,OAAS,EAAG,CACjF,IAAI/K,EAAI1G,KAAKqI,SAAS3B,EAClB1G,KAAKqF,OAAOuC,MAAQ5H,KAAK6D,KAAKiQ,GAAG6d,eAC/B3xB,KAAKsD,MAAMmU,QAAU,EAAA9X,MAAMwxB,OAAQzqB,GAAK1G,KAAK6D,KAAKiQ,GAAG6d,aAAe,EAAI3xB,KAAKqF,OAAOuC,MAAQ,EACvF5H,KAAKsD,MAAMmU,QAAU,EAAA9X,MAAMof,QAAOrY,KAAQ1G,KAAK6D,KAAKiQ,GAAG6d,aAAe3xB,KAAKqF,OAAOuC,SAE7F5H,KAAK6F,QAAQ+uB,UACX50B,KAAK03B,YAAa,EAAG,EAAG13B,KAAKqF,OAAOuC,MAAO5H,KAAKqF,OAAOoM,OACvD/K,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAKqF,OAAOuC,MAAQ5H,KAAK4H,MAAQ5H,KAAKqF,OAAOuC,MAAQ5H,KAAK4H,MAAO5H,KAAKyR,SAIhG8e,YACE,GAAIvwB,KAAK03B,YAAa,CACpB,IAAIhxB,EAAI1G,KAAKqI,SAAS3B,EAClB1G,KAAKqF,OAAOuC,MAAQ5H,KAAK6D,KAAKiQ,GAAG6d,eAC/B3xB,KAAKsD,MAAMmU,QAAU,EAAA9X,MAAMwxB,OAAQzqB,GAAK1G,KAAK6D,KAAKiQ,GAAG6d,aAAe,EAAI3xB,KAAKqF,OAAOuC,MAAQ,EACvF5H,KAAKsD,MAAMmU,QAAU,EAAA9X,MAAMof,QAAOrY,KAAQ1G,KAAK6D,KAAKiQ,GAAG6d,aAAe3xB,KAAKqF,OAAOuC,SAE7F,IAAI/B,EAAU7F,KAAK6F,QACnBA,EAAQqO,UAAY,YACpBrO,EAAQ4B,YAAc,OACtB5B,EAAQuO,SAAS1N,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAKqF,OAAOuC,MAAQ5H,KAAK4H,MAAQ5H,KAAKqF,OAAOuC,MAAQ5H,KAAK4H,MAAO5H,KAAKyR,QAC3G5L,EAAQsO,WAAWzN,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAKqF,OAAOuC,MAAQ5H,KAAK4H,MAAQ5H,KAAKqF,OAAOuC,MAAQ5H,KAAK4H,MAAO5H,KAAKyR,SAGjH+e,WACExwB,KAAK8W,aAAa5C,UAAYlU,KAAK0R,SAASxR,SAE5C,IAAIwG,EAAI1G,KAAKqI,SAAS3B,EAClB1G,KAAKqF,OAAOuC,MAAQ5H,KAAK6D,KAAKiQ,GAAG6d,eAC/B3xB,KAAKsD,MAAMmU,QAAU,EAAA9X,MAAMwxB,OAAQzqB,GAAK1G,KAAK6D,KAAKiQ,GAAG6d,aAAe,EAAI3xB,KAAKqF,OAAOuC,MAAQ,EACvF5H,KAAKsD,MAAMmU,QAAU,EAAA9X,MAAMof,QAAOrY,KAAQ1G,KAAK6D,KAAKiQ,GAAG6d,aAAe3xB,KAAKqF,OAAOuC,SAE7F5H,KAAK8W,aAAa1C,SAAS1N,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAKqF,OAAOuC,MAAQ5H,KAAK4H,MAAQ5H,KAAKqF,OAAOuC,MAAQ5H,KAAK4H,MAAO5H,KAAKyR,QAGvHmF,SACO5W,KAAKqF,OAAOuC,OAAU5H,KAAKqF,OAAOoM,SAEnCzR,KAAKqF,OAAOuC,MAAQ5H,KAAK4H,MAC3B5H,KAAKyR,OAASzR,KAAK4H,MAAQ5H,KAAK43B,OAEhC53B,KAAK4H,MAAQ5H,KAAKqF,OAAOuC,MACzB5H,KAAKyR,OAASzR,KAAKqF,OAAOoM,QAGxBzR,KAAKwM,OACPxM,KAAKwM,MAAMnE,SAASqa,OAClB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKwM,MAAMlJ,MAAMiF,OAC9EvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAGhCzR,KAAKyM,QACPzM,KAAKyM,OAAOpE,SAASqa,OACnB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAK+D,MAAQ5H,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKyM,OAAOnJ,MAAMiF,OACjGvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,IAKtCof,aAAapR,EAAcC,GACzB1f,KAAKq3B,KAAO3X,EACZ1f,KAAKs3B,aAELt3B,KAAKyM,QAAUzM,KAAKyM,OAAOvH,QAAQwa,GAErCzE,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1C2G,KAAK5G,EAAyBC,GACxB1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExCF,QAAQC,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C8G,OAAO/G,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,iBAEAhZ,YACE,MAAO,CACLwC,OAAQrF,KAAKq3B,KACb9f,SAAUvX,KAAKuX,SACf/K,MAAOxM,KAAKwM,MAAQxM,KAAKwM,MAAM3J,YAAc,KAC7C4J,OAAQzM,KAAKyM,OAASzM,KAAKyM,OAAO5J,YAAc,KAChDS,MAAOtD,KAAKsD,MACZE,GAAIxD,KAAKwD,GACTkO,SAAU1R,KAAK0R,SAAS7O,YACxB0C,KAAMvF,KAAKuF,KACXwI,OAAQ,IAGZrN,mBAAmBmD,EAAYf,GAC7B,OAAO,IAAIuZ,EAAMxY,EAAMf,EAAKuC,OAAQ,CAClCkS,SAAUzU,EAAKyU,SACf/K,MAAO1J,EAAK0J,MACZC,OAAQ3J,EAAK2J,OACbnJ,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,aAzMvC,UAiNA,IAAI0lB,EAAoB,KACf,CACL3f,MAAO,EAAA9X,MAAMgX,KACbqb,SAAS,IAgBTmF,EAAsB,KACjB,K,+YCjPT,aACA,aACA,aACA,aACA,YACA,aACA,aACA,aACA,YACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,a,0FCjBA,gBACA,UAEA,UACA,UAEA,UACA,UACA,SACA,SAEA,MAAalZ,UAAc,EAAAmR,OA0BzBtvB,YACE+D,EACAX,EAAwB20B,EAAoBh0B,IAE5CT,MACES,EAAM,EAAAmD,QAAQkY,OAAQ,EAAAoQ,OAAOrR,MAAO,CACpC3a,MAAOJ,EAAQI,MAAQ,IAAKw0B,OAAwB50B,EAAQI,OAAUw0B,IACtEvgB,SAAUrU,EAAQqU,SAClB/K,MAAOtJ,EAAQsJ,QAAmC,kBAAlBtJ,EAAQsJ,MACpC,IAAI,EAAAwK,SAASnT,EAAM,EAAA2B,aAAaC,GAAIvC,EAAQI,MAAMiC,KAAM,GAAI,IAC5D,EAAAyR,SAASrK,YAAY9I,EAAMX,EAAQsJ,QACvCC,OAAQvJ,EAAQuJ,SAAqC,kBAAnBvJ,EAAQuJ,OACtC,IAAI,EAAAuK,SAASnT,EAAM,EAAA2B,aAAayR,IAAK/T,EAAQI,MAAMiC,KAAM,GAAI,IAC7D,EAAAyR,SAASrK,YAAY9I,EAAMX,EAAQuJ,SACvCjJ,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WAGpB1R,KAAKyR,QAAS,IAAAhO,KAAIP,EAAQuO,OAAQzR,KAAK6D,KAAKP,MAAMgb,WAE9Cte,KAAKsD,MAAMiC,OAASwyB,EAAUjP,QAAmC,iBAAlB5lB,EAAQ6R,QAAoB7R,EAAQ6R,MAAQijB,WAAW90B,EAAQ6R,QAClH/U,KAAKyvB,OAASvsB,EAAQ6R,MAEtB/U,KAAKi4B,aACLj4B,KAAKk4B,oBAEDl4B,KAAKwM,QACPxM,KAAKwM,MAAMxC,GAAG,WAAW,CAAC2U,EAAG1Y,KACvBA,EAAUnD,OAAM9C,KAAK+U,MAAQ9O,EAAUnD,SAE7C9C,KAAKwM,MAAMxC,GAAG,QAAQ,CAAC2U,EAAG7b,KACpBA,IAAM9C,KAAK+U,MAAQjS,OAGvB9C,KAAKyM,QAAQzM,KAAKyM,OAAOzC,GAAG,WAAW,CAAC2U,EAAG1Y,IAAcA,EAAUnD,KAAO9C,KAAK+U,QAEnF/U,KAAK6D,KAAKmG,GAAG,WAAW,KAClBhK,KAAKyM,QAAQzM,KAAKyM,OAAOvH,QAAQlF,KAAK+U,UA1D1CA,YACF,OAAI/U,KAAKuX,SAAiBvX,KAAK0vB,UACxB1vB,KAAKyvB,OAEV1a,UAAMA,GACR,IAAIojB,EACmEA,EAAnEn4B,KAAKsD,MAAMiC,OAASwyB,EAAUjP,QAA2B,iBAAV/T,EAA0BijB,WAAWjjB,GAC7EA,EAEX,IAAIgb,EAAS/vB,KAAK+U,MACd2K,EAASyY,EAETn4B,KAAKuX,SAAUvX,KAAKgwB,QAAQtQ,IAE9B1f,KAAKyvB,OAAS/P,EACd1f,KAAKo4B,aAAap4B,KAAKyvB,QACvBzvB,KAAKq4B,QAAQtjB,MAAQ/U,KAAKyvB,OAAOtuB,YAE/BnB,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM0f,EAAQqQ,GA4CpFkI,aACEj4B,KAAKkxB,MAAQ,IAAI,EAAA/U,MAAMnc,KAAK6D,KAAM7D,KAAK+U,MAAM5T,WAAY,CACvDmC,MAAO,CACLgP,SAAUtS,KAAKsD,MAAMgP,SACrBD,KAAMrS,KAAKsD,MAAM+O,KACjBoF,MAAOzX,KAAKsD,MAAMmU,MAClBhX,MAAOT,KAAKsD,MAAM7C,MAClByX,QAAS,EACTogB,UAAWt4B,KAAKsD,MAAMg1B,WAAa,MAClC7mB,OAAQzR,KAAKyR,SAElBzR,KAAKkxB,MAAMlnB,GAAG,SAAS,KACrB,GAAI8I,SAAS4Y,gBAAkB1rB,KAAKq4B,QAAS,CAC3C,IAAI3jB,EAAe1U,KAAKqI,SAASiL,UAAUtT,KAAK6D,KAAKZ,KAAK6C,YAAYwN,WACtEpC,OAAOwR,OAAO1iB,KAAKq4B,QAAQ/0B,MAAO,CAChC,WAAc,UACd,iBAAkB,MAClB,IAAQoR,EAAa9N,EAAI5G,KAAK6D,KAAKZ,KAAK6C,YAAY0N,iBAAiBmQ,IAAM,EAAK,KAChF,KAASjP,EAAahO,EAAI1G,KAAK6D,KAAKZ,KAAK6C,YAAY0N,iBAAiBoQ,KAAO,EAAK,KAClF,OAAU5jB,KAAK4H,MAAQ,GAAK5H,KAAK6D,KAAKZ,KAAK6C,YAAY2N,MAAQ,KAC/D,QAAWzT,KAAKyR,OAAS,GAAKzR,KAAK6D,KAAKZ,KAAK6C,YAAY2N,MAAQ,KACjE,cAAezT,KAAKsD,MAAM+O,KAC1B,YAAarR,SAAShB,KAAKsD,MAAMgP,SAASuC,QAAQ,KAAM,KAAO7U,KAAK6D,KAAKZ,KAAK6C,YAAY2N,MAAQ,KAClG,MAASzT,KAAKsD,MAAM7C,MACpB,mBAAoBT,KAAKq4B,QAAQE,SAASC,gBAAkB,MAAQx4B,KAAKsD,MAAM6sB,gBAC/E,aAAcnwB,KAAKsD,MAAMmU,QAEvBzX,KAAKsD,MAAMiC,OAASwyB,EAAUjP,SAAQ9oB,KAAKq4B,QAAQI,KAAOz4B,KAAKsD,MAAMm1B,MACzEz4B,KAAKq4B,QAAQ1e,YAGjB3Z,KAAKqxB,SAAStvB,KAAK/B,KAAKkxB,OAE1BgH,oBACEl4B,KAAKq4B,QAAUvlB,SAASC,cAAc,SACtC/S,KAAKq4B,QAAQ1N,UAAY,qBACzB3qB,KAAKq4B,QAAQK,YAAa,EAC1B,IAAIC,EAAgC,WAApB34B,KAAKsD,MAAMiC,KAAoB,OAASvF,KAAKsD,MAAMiC,KACnEvF,KAAKq4B,QAAQ9yB,KAAOvF,KAAKsD,MAAMs1B,QAAU,OAASD,EAClD34B,KAAKq4B,QAAQtjB,MAAQ/U,KAAK+U,MAAM5T,WAC5BnB,KAAKsD,MAAMs1B,UAAS54B,KAAKq4B,QAAQO,QAAU54B,KAAKsD,MAAMs1B,SACtD54B,KAAKsD,MAAMiC,OAASwyB,EAAUjP,QAAU9oB,KAAKsD,MAAMm1B,OAAMz4B,KAAKq4B,QAAQI,KAAOz4B,KAAKsD,MAAMm1B,MACxFz4B,KAAKsD,MAAMu1B,YAAW74B,KAAKq4B,QAAQQ,UAAY74B,KAAKsD,MAAMu1B,WAE9D74B,KAAKq4B,QAAQrS,iBAAiB,QAAQ,KACpChmB,KAAKq4B,QAAQ/0B,MAAMsnB,WAAa,SAChC5qB,KAAKq4B,QAAQ/0B,MAAMunB,cAAgB,OACnC7qB,KAAK+U,MAAQ/U,KAAKq4B,QAAQtjB,MAE1B/U,KAAKo4B,aAAap4B,KAAKsD,MAAMiC,OAASwyB,EAAUjP,OAASkP,WAAWh4B,KAAK+U,OAAS/U,KAAK+U,MAAM5T,YAE7FnB,KAAKsE,KAAK,OAAQtE,SAEpBA,KAAKq4B,QAAQS,QAAU,KACjB94B,KAAKsD,MAAMs1B,UACb54B,KAAKq4B,QAAQ/0B,MAAM6sB,gBAAkBnwB,KAAKq4B,QAAQE,SAASC,gBAAkB,SAAWx4B,KAAKsD,MAAM6sB,gBACnGnwB,KAAKkxB,MAAM5tB,MAAM7C,MAAQT,KAAKq4B,QAAQE,SAASC,gBAAkB,SAAWx4B,KAAKsD,MAAM7C,OAEzFT,KAAKsE,KAAK,QAAStE,OAErB8S,SAASG,KAAKC,YAAYlT,KAAKq4B,SAEjCD,aAAarjB,GACX/U,KAAKkxB,MAAMhV,KAAwB,iBAAVnH,IAAsB,IAAAwK,QAAOvf,KAAKsD,MAAMg1B,WAAavjB,EAAMxT,QAAQvB,KAAKsD,MAAMg1B,WAAavjB,EAGtHmb,QACElwB,KAAK6F,QAAQ4B,YAAczH,KAAKsD,MAAMkE,OACtCxH,KAAK6F,QAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAE7E8e,YACE,IAAI1qB,EAAU7F,KAAK6F,QACnBA,EAAQ4B,YAAczH,KAAKsD,MAAMkE,OACjC3B,EAAQqO,UAAYlU,KAAKsD,MAAM6sB,gBAC/BtqB,EAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QACtE5L,EAAQuO,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAEtE+e,WACExwB,KAAK8W,aAAa5C,UAAYlU,KAAK0R,SAASxR,SAC5CF,KAAK8W,aAAa1C,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAGhFmF,SACE5W,KAAKkxB,MAAM7oB,SAAWrI,KAAKqI,SAC3BrI,KAAKkxB,MAAMzf,OAASzR,KAAKyR,OACzBzR,KAAKkxB,MAAMtpB,MAAQ5H,KAAK4H,MAEpB5H,KAAKwM,OACPxM,KAAKwM,MAAMnE,SAASqa,OAClB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKwM,MAAMlJ,MAAMiF,OAC9EvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAGhCzR,KAAKyM,QACPzM,KAAKyM,OAAOpE,SAASqa,OACnB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAK+D,MAAQ5H,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKyM,OAAOnJ,MAAMiF,OACjGvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAKtCof,aAAapR,EAAcC,GACrB1f,KAAKsD,MAAMiC,OAASwyB,EAAUjP,QAA4B,iBAAXpJ,IAAqBA,EAASsY,WAAWtY,IAE5F1f,KAAKyvB,OAAS/P,EACd1f,KAAKo4B,aAAap4B,KAAKyvB,QACvBzvB,KAAKq4B,QAAQtjB,MAAQ/U,KAAKyvB,OAAOtuB,WAEjCnB,KAAKyM,QAAUzM,KAAKyM,OAAOvH,QAAQlF,KAAKyvB,QAE1CxU,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1C2G,KAAK5G,EAAyBC,GACxB1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExCF,QAAQC,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C8G,OAAO/G,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,gBACM7b,KAAK8wB,SAGXjuB,YACE,MAAO,CACLkS,MAAO/U,KAAK+U,MACZwC,SAAUvX,KAAKuX,SACf/K,MAAOxM,KAAKwM,MAAQxM,KAAKwM,MAAM3J,YAAc,KAC7C4J,OAAQzM,KAAKyM,OAASzM,KAAKyM,OAAO5J,YAAc,KAChD4O,OAAQzR,KAAKyR,OACbnO,MAAOtD,KAAKsD,MACZE,GAAIxD,KAAKwD,GACTkO,SAAU1R,KAAK0R,SAAS7O,YACxB0C,KAAMvF,KAAKuF,KACXwI,OAAQ,IAGZrN,mBAAmBmD,EAAYf,GAC7B,OAAO,IAAImb,EAAMpa,EAAM,CACrBkR,MAAOjS,EAAKiS,MACZwC,SAAUzU,EAAKyU,SACf/K,MAAO1J,EAAK0J,MACZC,OAAQ3J,EAAK2J,OACbgF,OAAQ3O,EAAK2O,OACbnO,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,aAKvC,IAAYqmB,EAzPZ,UAyPA,SAAYA,GACV,gBACA,kBAFF,CAAYA,EAAA,EAAAA,YAAA,EAAAA,UAAS,KAkBrB,IAAID,EAAoB,KACf,CACL3H,gBAAiB,OACjB1vB,MAAO,OACP6R,SAAU,OACVD,KAAM,QACN7K,OAAQ,kBACRiQ,MAAO,EAAA9X,MAAMgX,KACbpR,KAAMwyB,EAAUgB,OAmBhBlB,EAAuBh0B,IAClB,CACL4N,OAA+B,IAAvB5N,EAAKP,MAAMgb,a,+ECnTvB,gBAEA,UACA,UAEA,UACA,SACA,UACA,SAEA,MAAanC,UAAc,EAAAiT,OA6BzBtvB,YACE+D,EACAqY,EACAhZ,EAAwB81B,EAAoBn1B,IAE5CT,MAAMS,EAAM,EAAAmD,QAAQkY,OAAQ,EAAAoQ,OAAOnT,MAAO,CACxC7Y,MAAOJ,EAAQI,MAAQ,IAAK21B,OAAwB/1B,EAAQI,OAAU21B,IACtE1hB,SAAUrU,EAAQqU,SAClB/K,MAAOtJ,EAAQsJ,QAAmC,kBAAlBtJ,EAAQsJ,MACpC,IAAI,EAAAwK,SAASnT,EAAM,EAAA2B,aAAaC,GAAI,MAAO,GAAI,IAC/C,EAAAuR,SAASrK,YAAY9I,EAAMX,EAAQsJ,QACvCC,OAAQvJ,EAAQuJ,SAAqC,kBAAnBvJ,EAAQuJ,OACtC,IAAI,EAAAuK,SAASnT,EAAM,EAAA2B,aAAayR,IAAK,SAAU,GAAI,IACnD,EAAAD,SAASrK,YAAY9I,EAAMX,EAAQuJ,SACvCjJ,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WAGpB1R,KAAKk5B,MAAQl5B,KAAKuX,SAAWvX,KAAK0vB,UAAYxT,EAC9Clc,KAAK4W,SAEL5W,KAAKyR,QAAS,IAAAhO,KAAIP,EAAQuO,OAAQzR,KAAK0S,WAAa,GAC/C1S,KAAKsD,MAAM0zB,OAAMh3B,KAAK4H,MAAQ5H,KAAKm5B,cAEpCn5B,KAAKwM,QACPxM,KAAKwM,MAAMxC,GAAG,WAAW,CAAC2U,EAAG1Y,MACvB,IAAAsZ,QAAOtZ,EAAUnD,QAAO9C,KAAKkc,KAAOjW,EAAUnD,SAEpD9C,KAAKwM,MAAMxC,GAAG,QAAQ,CAAC2U,EAAG7b,MACpB,IAAAyc,QAAOzc,KAAO9C,KAAKkc,KAAOpZ,OAG9B9C,KAAKyM,QAAQzM,KAAKyM,OAAOzC,GAAG,WAAW,CAAC2U,EAAG1Y,IAAcA,EAAUnD,KAAO9C,KAAKkc,OAEnFlc,KAAK6D,KAAKmG,GAAG,WAAW,KAClBhK,KAAKyM,QAAQzM,KAAKyM,OAAOvH,QAAQlF,KAAKkc,SAzD1CA,WACF,IAAInH,EAKJ,OAJmBA,EAAf/U,KAAKuX,SAAkBvX,KAAK0vB,UACnB1vB,KAAKk5B,MAEG,iBAAVnkB,IAAoBA,EAAQ/U,KAAKo5B,OAAOrkB,IAC5CA,EAELmH,SAAKA,GACP,IAAI6T,EAAS/vB,KAAKk5B,MACdxZ,EAASxD,EAETlc,KAAKuX,SACPvX,KAAKgwB,QAAQtQ,IAEb1f,KAAKk5B,MAAQxZ,EACb1f,KAAK4W,UAGH5W,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM+vB,EAAQrQ,GA0CpFwQ,QACE,IAAIrqB,EAAU7F,KAAK6F,QAEnBA,EAAQqO,UAAYlU,KAAKsD,MAAM6sB,gBAC/BtqB,EAAQuO,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAEpE5L,EAAQqO,UAAYlU,KAAKsD,MAAM7C,MAC/BoF,EAAQwM,KAAOrS,KAAKsD,MAAMgP,SAAW,IAAMtS,KAAKsD,MAAM+O,KACtDxM,EAAQyO,aAAe,SACvB,IAAI1N,EAAI5G,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,EACpC/K,EAAI1G,KAAKqI,SAAS3B,EAClB1G,KAAKsD,MAAMmU,QAAU,EAAA9X,MAAMwxB,OAC7BzqB,GAAK1G,KAAK4H,MAAQ,EAAI5H,KAAKyS,UAAY,EAC9BzS,KAAKsD,MAAMmU,QAAU,EAAA9X,MAAMof,MACpCrY,GAAK1G,KAAK4H,MAAQ5H,KAAKyS,UAAYzS,KAAKsD,MAAM4U,QAE9CxR,GAAK1G,KAAKsD,MAAM4U,QAGlBrS,EAAQ0O,SAASvU,KAAKq5B,YAAa3yB,EAAGE,GAExC2pB,YACE,IAAI1qB,EAAU7F,KAAK6F,QACnBA,EAAQ4B,YAAc,OACtB5B,EAAQqO,UAAYlU,KAAKsD,MAAM7C,MAC/BoF,EAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QACtE5L,EAAQuO,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAEtE+e,WACExwB,KAAK8W,aAAa5C,UAAYlU,KAAK0R,SAASxR,SAC5CF,KAAK8W,aAAa1C,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAGhFmF,SACE,IAAI/Q,EAAU7F,KAAK6F,QACnBA,EAAQwM,KAAOrS,KAAKsD,MAAMgP,SAAW,IAAMtS,KAAKsD,MAAM+O,KACtDrS,KAAKm5B,aAAetzB,EAAQ2M,YAAYxS,KAAKkc,MAAMtU,MACnD5H,KAAKq5B,YAAcr5B,KAAKs5B,mBACxB,IAAI/mB,EAAU1M,EAAQ2M,YAAYxS,KAAKq5B,aACvCxzB,EAAQwM,KAAO,KACfrS,KAAKyS,UAAYF,EAAQ3K,MAEzB5H,KAAK0S,WAAaH,EAAQI,wBAA0BJ,EAAQK,yBAA2B,EAEnF5S,KAAKwM,OACPxM,KAAKwM,MAAMnE,SAASqa,OAClB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKwM,MAAMlJ,MAAMiF,OAC9EvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAGhCzR,KAAKyM,QACPzM,KAAKyM,OAAOpE,SAASqa,OACnB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAK+D,MAAQ5H,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKyM,OAAOnJ,MAAMiF,OACjGvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAItC6nB,mBACE,IAAIpd,EAAOlc,KAAKkc,KACa,iBAAjBA,IAA2BA,EAAOA,EAAK/a,YAEnD,IAAIyG,EAAQ5H,KAAK6F,QAAQ2M,YAAY0J,GAAMtU,MAC3C,MACM2xB,EAAgBv5B,KAAK6F,QAAQ2M,YADlB,KACwC5K,MACzD,GAAIA,GAAS5H,KAAK4H,OAASA,GAAS2xB,EAAe,OAAOrd,EAE1D,MAAM/Z,GAAQ,IAAAq3B,cAAa,CACzB7qB,IAAKuN,EAAK9a,OACVq4B,SAAWC,GAAgB15B,KAAK6F,QAAQ2M,YAAY0J,EAAKyd,UAAU,EAAGD,IAAM9xB,MAC5EgyB,MAAO55B,KAAK4H,MAAQ2xB,IAGtB,OAAOrd,EAAKyd,UAAU,EAAGx3B,GAVR,IAYnBi3B,OAAOrkB,GACL,OAAO,IAAAwK,QAAOvf,KAAKsD,MAAMg1B,WAAavjB,EAAMxT,QAAQvB,KAAKsD,MAAMg1B,WAAavjB,EAAM5T,WAGpF0vB,aAAapR,EAAcC,GACzB1f,KAAKk5B,MAAQxZ,EACb1f,KAAK4W,SAEL5W,KAAKyM,QAAUzM,KAAKyM,OAAOvH,QAAQlF,KAAKk5B,OAE1Cje,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1C2G,KAAK5G,EAAyBC,GACxB1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExCF,QAAQC,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C8G,OAAO/G,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,gBACM7b,KAAK8wB,SAGXjuB,YACE,MAAO,CACLqZ,KAAMlc,KAAKkc,KACX3E,SAAUvX,KAAKuX,SACf/K,MAAOxM,KAAKwM,MAAQxM,KAAKwM,MAAM3J,YAAc,KAC7C4J,OAAQzM,KAAKyM,OAASzM,KAAKyM,OAAO5J,YAAc,KAChD4O,OAAQzR,KAAKyR,OACbnO,MAAOtD,KAAKsD,MACZE,GAAIxD,KAAKwD,GACTkO,SAAU1R,KAAK0R,SAAS7O,YACxB0C,KAAMvF,KAAKuF,KACXwI,OAAQ,IAGZrN,mBAAmBmD,EAAYf,GAC7B,OAAO,IAAIqZ,EAAMtY,EAAMf,EAAKoZ,KAAM,CAChC3E,SAAUzU,EAAKyU,SACf/K,MAAO1J,EAAK0J,MACZC,OAAQ3J,EAAK2J,OACbgF,OAAQ3O,EAAK2O,OACbnO,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,aA1NvC,UAwOA,IAAIunB,EAAoB,KACf,CACLx4B,MAAO,OACP0vB,gBAAiB,cACjB7d,SAAU,OACVD,KAAM,QACNoF,MAAO,EAAA9X,MAAMgX,KACbuB,QAAS,EACT8Z,SAAS,IAkBTgH,EAAuBn1B,IAClB,CACL4N,OAA+B,IAAvB5N,EAAKP,MAAMgb,a,oFC9QvB,gBAEA,UACA,UAEA,UACA,UACA,UACA,SACA,SAEA,MAAad,UAAmB,EAAA4R,OAoB9BtvB,YACE+D,EACAwG,EAAmB,CAAC,WACpBkT,EAAmB,UACnBra,EAA6B22B,EAAyBh2B,IAEtDT,MAAMS,EAAM,EAAAmD,QAAQkY,OAAQ,EAAAoQ,OAAO9R,WAAY,CAC7Cla,MAAOJ,EAAQI,MAAQ,IAAKw2B,OAA6B52B,EAAQI,OAAUw2B,IAC3EviB,SAAUrU,EAAQqU,SAClB/K,MAAOtJ,EAAQsJ,QAAmC,kBAAlBtJ,EAAQsJ,MACpC,IAAI,EAAAwK,SAASnT,EAAM,EAAA2B,aAAaC,GAAI,UAAW,GAAI,IACnD,EAAAuR,SAASrK,YAAY9I,EAAMX,EAAQsJ,QACvCC,OAAQvJ,EAAQuJ,SAAqC,kBAAnBvJ,EAAQuJ,OACtC,IAAI,EAAAuK,SAASnT,EAAM,EAAA2B,aAAayR,IAAK,UAAW,GAAI,IACpD,EAAAD,SAASrK,YAAY9I,EAAMX,EAAQuJ,SACvCjJ,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WAGE,IAAlBrH,EAAOjJ,SAAciJ,EAAS,CAAC,YACnCrK,KAAK+5B,QAAU1vB,EACf,IAAI2vB,EAAgBh6B,KAAKuX,SAAWvX,KAAK0vB,UAAYnS,EACrDvd,KAAKi6B,UAAYj6B,KAAK+5B,QAAQl1B,SAASm1B,GAAiBA,EAAgBh6B,KAAK+5B,QAAQ,GACrF/5B,KAAKyR,QAAS,IAAAhO,KAAIP,EAAQuO,OAAQzR,KAAK6D,KAAKP,MAAMgb,WAE9Cte,KAAKwM,QACPxM,KAAKwM,MAAMxC,GAAG,WAAW,CAAC2U,EAAG1Y,KACvBA,EAAUnD,OAAM9C,KAAKi6B,UAAYh0B,EAAUnD,SAEjD9C,KAAKwM,MAAMxC,GAAG,QAAQ,CAAC2U,EAAG7b,UACJ,IAATA,IAAsB9C,KAAKi6B,UAAYn3B,OAGlD9C,KAAKyM,QAAQzM,KAAKyM,OAAOzC,GAAG,WAAW,CAAC2U,EAAG1Y,IAAcA,EAAUnD,KAAO9C,KAAKi6B,YAEnFj6B,KAAKk6B,cAELl6B,KAAK6D,KAAKmG,GAAG,WAAW,KAClBhK,KAAKyM,QAAQzM,KAAKyM,OAAOvH,QAAQlF,KAAKi6B,cAtD1C1c,eACF,OAAIvd,KAAKuX,SAAiBvX,KAAK0vB,UACxB1vB,KAAKi6B,UAEV1c,aAASA,GACNvd,KAAK+5B,QAAQl1B,SAAS0Y,KAAWA,EAAWvd,KAAK+5B,QAAQ,IAE9D,IAAIhK,EAAS/vB,KAAKud,SACdmC,EAASnC,EAETvd,KAAKuX,SAAUvX,KAAKgwB,QAAQtQ,GAC3B1f,KAAKi6B,UAAYva,EAElB1f,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM+vB,EAAQrQ,GA6CpFwa,cACEl6B,KAAKqxB,SAAStvB,QAAQ/B,KAAK+5B,QAAQt3B,KAAI03B,IACrC,IAAIjJ,EAAQ,IAAI,EAAA/U,MAAMnc,KAAK6D,KAAMs2B,EAAQ,CACvC72B,MAAO,CAAEmU,MAAO,EAAA9X,MAAMwxB,OAAQhB,gBAAiBnwB,KAAKsD,MAAM6sB,gBAAiB1vB,MAAOT,KAAKsD,MAAM7C,SAiB/F,OAdAywB,EAAMlnB,GAAG,SAAUowB,IACjB,GAAIA,EAAcle,OAASlc,KAAKud,SAAU,OAC1C,IAAI8c,EAAoBr6B,KAAKqxB,SAASrxB,KAAK+5B,QAAQ90B,QAAQjF,KAAKud,WAChErM,OAAOwR,OAAO2X,EAAkB/2B,MAAO,CACrC6sB,gBAAiBnwB,KAAKsD,MAAM6sB,gBAC5B1vB,MAAOT,KAAKsD,MAAM7C,QAEpByQ,OAAOwR,OAAO0X,EAAc92B,MAAO,CACjC6sB,gBAAiBnwB,KAAKsD,MAAMg3B,wBAC5B75B,MAAOT,KAAKsD,MAAMi3B,gBAEpBv6B,KAAKud,SAAW6c,EAAcle,QAGzBgV,MAEThgB,OAAOwR,OAAO1iB,KAAKqxB,SAASrxB,KAAK+5B,QAAQ90B,QAAQjF,KAAKi6B,YAAY32B,MAAO,CACvE6sB,gBAAiBnwB,KAAKsD,MAAMg3B,wBAC5B75B,MAAOT,KAAKsD,MAAMi3B,gBAItBrK,QACE,IAAIrqB,EAAU7F,KAAK6F,QACnBA,EAAQ4B,YAAczH,KAAKsD,MAAMoE,YACjC7B,EAAQ8B,UAAY3H,KAAKsD,MAAM8sB,YAC/BvqB,EAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAEtE,IAAI+oB,EAAcx6B,KAAK4H,MAAQ5H,KAAKqxB,SAASjwB,OACzCsF,EAAI1G,KAAKqI,SAAS3B,EAAI8zB,EAC1B,IAAK,IAAIl7B,EAAI,EAAGA,EAAIU,KAAKqxB,SAASjwB,OAAS,EAAG9B,GAAK,EACjDuG,EAAQgC,YACRhC,EAAQiC,OAAOpB,EAAG1G,KAAKqI,SAASzB,GAChCf,EAAQgZ,OAAOnY,EAAG1G,KAAKqI,SAASzB,EAAI5G,KAAKyR,QACzC5L,EAAQmC,SACRtB,GAAK8zB,EAGTjK,YACE,IAAI1qB,EAAU7F,KAAK6F,QACnBA,EAAQ4B,YAAczH,KAAKsD,MAAMoE,YACjC7B,EAAQqO,UAAYlU,KAAKsD,MAAM6sB,gBAC/BtqB,EAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QACtE5L,EAAQuO,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAEtE+e,WACExwB,KAAK8W,aAAa5C,UAAYlU,KAAK0R,SAASxR,SAC5CF,KAAK8W,aAAa1C,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAGhFmF,SACE,IAAIlQ,EAAI1G,KAAKqI,SAAS3B,EACtB1G,KAAKqxB,SAASvvB,SAAQkN,IACpBA,EAAMyC,OAASzR,KAAKyR,OACpBzC,EAAMpH,MAAQ5H,KAAK4H,MAAQ5H,KAAKqxB,SAASjwB,OACzC4N,EAAM3G,SAASqa,OAAOhc,EAAG1G,KAAKqI,SAASzB,GACvCF,GAAKsI,EAAMpH,SAGT5H,KAAKwM,OACPxM,KAAKwM,MAAMnE,SAASqa,OAClB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKwM,MAAMlJ,MAAMiF,OAC9EvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAGhCzR,KAAKyM,QACPzM,KAAKyM,OAAOpE,SAASqa,OACnB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAK+D,MAAQ5H,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKyM,OAAOnJ,MAAMiF,OACjGvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAKtCof,aAAapR,EAAcC,GACpB1f,KAAK+5B,QAAQl1B,SAAS6a,KAASA,EAAS1f,KAAK+5B,QAAQ,IAC1D/5B,KAAKi6B,UAAYva,EAEjB1f,KAAKyM,QAAUzM,KAAKyM,OAAOvH,QAAQlF,KAAKi6B,WAE1Chf,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1C2G,KAAK5G,EAAyBC,GACxB1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExCF,QAAQC,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C8G,OAAO/G,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,gBACM7b,KAAK8wB,SAGXjuB,YACE,MAAO,CACLwH,OAAQrK,KAAK+5B,QACbxc,SAAUvd,KAAKud,SACfhG,SAAUvX,KAAKuX,SACf/K,MAAOxM,KAAKwM,MAAQxM,KAAKwM,MAAM3J,YAAc,KAC7C4J,OAAQzM,KAAKyM,OAASzM,KAAKyM,OAAO5J,YAAc,KAChD4O,OAAQzR,KAAKyR,OACbnO,MAAOtD,KAAKsD,MACZE,GAAIxD,KAAKwD,GACTkO,SAAU1R,KAAK0R,SAAS7O,YACxB0C,KAAMvF,KAAKuF,KACXwI,OAAQ,IAGZrN,mBAAmBmD,EAAYf,GAC7B,OAAO,IAAI0a,EAAW3Z,EAAMf,EAAKuH,OAAQvH,EAAKya,SAAU,CACtDhG,SAAUzU,EAAKyU,SACf/K,MAAO1J,EAAK0J,MACZC,OAAQ3J,EAAK2J,OACbgF,OAAQ3O,EAAK2O,OACbnO,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,aAtNvC,eAmOA,IAAIooB,EAAyB,KACpB,CACLr5B,MAAO,OACP85B,cAAe,OACfpK,gBAAiB,cACjBmK,wBAAyB,OACzB5yB,YAAa,OACb0oB,YAAa,EACb4B,SAAS,IAmBT6H,EAA4Bh2B,IACvB,CACL4N,OAA+B,IAAvB5N,EAAKP,MAAMgb,a,gFC3QvB,gBAEA,UACA,UACA,UACA,UAEA,UACA,UACA,SACA,SAEA,MAAaZ,UAAe,EAAA0R,OA2B1BtvB,YACE+D,EACOwG,EAAmB,GAC1BnH,EAAyBu3B,EAAqB52B,IAE9CT,MAAMS,EAAM,EAAAmD,QAAQkY,OAAQ,EAAAoQ,OAAO5R,OAAQ,CACzCpa,MAAOJ,EAAQI,MAAQ,IAAKo3B,OAAyBx3B,EAAQI,OAAUo3B,IACvEnjB,SAAUrU,EAAQqU,SAClB/K,MAAOtJ,EAAQsJ,QAAmC,kBAAlBtJ,EAAQsJ,MACpC,IAAI,EAAAwK,SAASnT,EAAM,EAAA2B,aAAaC,GAAI,MAAO,GAAI,IAC/C,EAAAuR,SAASrK,YAAY9I,EAAMX,EAAQsJ,QACvCC,OAAQvJ,EAAQuJ,SAAqC,kBAAnBvJ,EAAQuJ,OACtC,IAAI,EAAAuK,SAASnT,EAAM,EAAA2B,aAAayR,IAAK,SAAU,GAAI,IACnD,EAAAD,SAASrK,YAAY9I,EAAMX,EAAQuJ,SACvCjJ,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WAbb,KAAArH,OAAAA,EAgBPrK,KAAKyR,QAAS,IAAAhO,KAAIP,EAAQuO,OAAQzR,KAAK6D,KAAKP,MAAMgb,WAClDte,KAAKi6B,UAAmC,IAAvBj6B,KAAKqK,OAAOjJ,OAAe,OAASpB,KAAKqK,OAAO,GAEjErK,KAAKkxB,MAAQ,IAAI,EAAA/U,MAAMnc,KAAK6D,KAAM7D,KAAKud,SAAU,CAAEja,MAAO,CAAEmU,MAAO,EAAA9X,MAAMwxB,UAAWnxB,KAAKsD,OAASmO,OAAQzR,KAAKyR,SAC/GzR,KAAKqxB,SAAStvB,KAAK/B,KAAKkxB,OAEpBlxB,KAAKwM,QACPxM,KAAKwM,MAAMxC,GAAG,WAAW,CAAC2U,EAAG1Y,KACG,iBAAnBA,EAAUnD,KAAmB9C,KAAKud,SAAWvd,KAAKqK,OAAOpE,EAAUnD,MAC3C,iBAAnBmD,EAAUnD,OAAmB9C,KAAKud,SAAWtX,EAAUnD,SAEzE9C,KAAKwM,MAAMxC,GAAG,QAAQ,CAAC2U,EAAG7b,KACJ,iBAATA,EAAmB9C,KAAKud,SAAWvd,KAAKqK,OAAOvH,GACjC,iBAATA,IAAmB9C,KAAKud,SAAWza,OAGnD9C,KAAKyM,QAAQzM,KAAKyM,OAAOzC,GAAG,WAAW,CAAC2U,EAAG1Y,IAAcA,EAAUnD,KAAO9C,KAAKud,WAEnFvd,KAAK6D,KAAKmG,GAAG,WAAW,KAClBhK,KAAKyM,QAAQzM,KAAKyM,OAAOvH,QAAQlF,KAAKud,aA5D1CA,eACF,GAAIvd,KAAKuX,SAAU,CACjB,IAAIxC,EAAQ/U,KAAK0vB,UACbiL,EAAW36B,KAAKqK,OAAOxF,SAASkQ,GAASA,EAAQ/U,KAAKqK,OAAO,GAEjE,OADA0K,EAA+B,IAAvB/U,KAAKqK,OAAOjJ,OAAe,OAASu5B,EACrC5lB,EAET,OAAO/U,KAAKi6B,UAEV1c,aAASA,GACX,IAAIod,EAAW36B,KAAKqK,OAAOxF,SAAS0Y,GAAYA,EAAWvd,KAAKqK,OAAO,GAEnE0lB,EAAS/vB,KAAKud,SACdmC,EAAgC,IAAvB1f,KAAKqK,OAAOjJ,OAAe,OAASu5B,EAE7C36B,KAAKuX,SAAUvX,KAAKgwB,QAAQtQ,IAE9B1f,KAAKi6B,UAAYva,EACjB1f,KAAKkxB,MAAMhV,KAAOwD,GAEhB1f,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM+vB,EAAQrQ,GA4CpFwQ,QACE,IAAIrqB,EAAU7F,KAAK6F,QACnBA,EAAQqO,UAAYlU,KAAKsD,MAAMs3B,WAC/B/0B,EAAQgC,YACRhC,EAAQiC,OAAO9H,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAChE5L,EAAQgZ,OAAO7e,KAAKqI,SAAS3B,EAAI1G,KAAKyR,OAAS,EAAAoO,SAASmP,OAAQhvB,KAAKqI,SAASzB,GAC9Ef,EAAQgZ,OAAO7e,KAAKqI,SAAS3B,EAAI1G,KAAKyR,OAAS,EAAAoO,SAASmP,OAAQhvB,KAAKqI,SAASzB,EAAI5G,KAAKyR,QACvF5L,EAAQgZ,OAAO7e,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAChE5L,EAAQiZ,YACRjZ,EAAQma,OAERna,EAAQqO,UAAYlU,KAAKsD,MAAMs3B,WAC/B/0B,EAAQgC,YACRhC,EAAQiC,OAAO9H,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAO5H,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAC7E5L,EAAQgZ,OAAO7e,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAS5H,KAAKyR,OAAS,EAAAoO,SAASmP,OAAShvB,KAAKqI,SAASzB,GAC7Ff,EAAQgZ,OAAO7e,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAS5H,KAAKyR,OAAS,EAAAoO,SAASmP,OAAShvB,KAAKqI,SAASzB,EAAI5G,KAAKyR,QACtG5L,EAAQgZ,OAAO7e,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAO5H,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAC7E5L,EAAQiZ,YACRjZ,EAAQma,OAEVuQ,YACE,IAAI1qB,EAAU7F,KAAK6F,QACnBA,EAAQqO,UAAYlU,KAAKsD,MAAMs3B,WAC/B/0B,EAAQ4B,YAAc,OACtB5B,EAAQuO,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QACpE5L,EAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAExE+e,WACExwB,KAAK8W,aAAa5C,UAAYlU,KAAK0R,SAASxR,SAC5CF,KAAK8W,aAAa1C,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAGhFmF,SACE5W,KAAKkxB,MAAMtpB,MAAqB,GAAb5H,KAAK4H,MACxB5H,KAAKkxB,MAAM7oB,SAASqa,OAClB1iB,KAAKqI,SAAS3B,EAAiB,IAAb1G,KAAK4H,MACvB5H,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,EAAIzR,KAAKkxB,MAAMzf,OAAS,GAGtDzR,KAAKwM,OACPxM,KAAKwM,MAAMnE,SAASqa,OAClB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKwM,MAAMlJ,MAAMiF,OAC9EvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAGhCzR,KAAKyM,QACPzM,KAAKyM,OAAOpE,SAASqa,OACnB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAK+D,MAAQ5H,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKyM,OAAOnJ,MAAMiF,OACjGvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAKtCof,aAAapR,EAAcob,GACzB,IAAIF,EAAW36B,KAAKqK,OAAOxF,SAASg2B,GAAYA,EAAW76B,KAAKqK,OAAO,GACnE0K,EAA+B,IAAvB/U,KAAKqK,OAAOjJ,OAAe,OAASu5B,EAChD36B,KAAKi6B,UAAYllB,EACjB/U,KAAKkxB,MAAMhV,KAAOlc,KAAKi6B,UAEvBj6B,KAAKyM,QAAUzM,KAAKyM,OAAOvH,QAAQlF,KAAKud,UAE1CtC,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1C2G,KAAK5G,EAAyBC,GACxB1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExCF,QAAQC,EAAyBC,GAC/B,GAAI1U,KAAK8wB,SAAU,OAEnB,GAA2B,IAAvB9wB,KAAKqK,OAAOjJ,OAAc,OAC9B,IAAI2a,EACJ,GAAIrH,EAAahO,EAAI1G,KAAKqI,SAAS3B,EAAiB,IAAb1G,KAAK4H,MAC1CmU,GAAa,MACR,MAAIrH,EAAahO,EAAI1G,KAAKqI,SAAS3B,EAAiB,IAAb1G,KAAK4H,OAE5C,OADLmU,EAAY,EAGd,IAAI3a,EAASpB,KAAKqK,OAAOjJ,OACzBpB,KAAKud,SAAWvd,KAAKqK,SAAUrK,KAAKqK,OAAOpF,QAAQjF,KAAKud,UAAYxB,GAAa3a,EAAUA,GAAUA,GACrGpB,KAAKkxB,MAAMhV,KAAOlc,KAAKud,SAEvBvd,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C8G,OAAO/G,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,gBACM7b,KAAK8wB,SAGXjuB,YACE,MAAO,CACLwH,OAAQrK,KAAKqK,OACbkN,SAAUvX,KAAKuX,SACf/K,MAAOxM,KAAKwM,MAAQxM,KAAKwM,MAAM3J,YAAc,KAC7C4J,OAAQzM,KAAKyM,OAASzM,KAAKyM,OAAO5J,YAAc,KAChD4O,OAAQzR,KAAKyR,OACbnO,MAAOtD,KAAKsD,MACZE,GAAIxD,KAAKwD,GACTkO,SAAU1R,KAAK0R,SAAS7O,YACxB0C,KAAMvF,KAAKuF,KACXwI,OAAQ,IAGZrN,mBAAmBmD,EAAYf,GAC7B,OAAO,IAAI4a,EAAO7Z,EAAMf,EAAKuH,OAAQ,CACnCkN,SAAUzU,EAAKyU,SACf/K,MAAO1J,EAAK0J,MACZC,OAAQ3J,EAAK2J,OACbgF,OAAQ3O,EAAK2O,OACbnO,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,aA/MvC,WA0NA,IAAIgpB,EAAqB,KAChB,CACLE,WAAY,OACZ5I,SAAS,IAkBTyI,EAAwB52B,IACnB,CACL4N,OAA+B,IAAvB5N,EAAKP,MAAMgb,a,gFC7PvB,gBAEA,UACA,SACA,UAEA,UACA,UACA,UAEA,MAAa/B,UAAe,EAAA6S,OAwB1BtvB,YACE+D,EAAmB+L,EAAoBjB,EACvCzL,EAAyB43B,EAAqBj3B,IAE9CT,MAAMS,EAAM,EAAAmD,QAAQkY,OAAQ,EAAAoQ,OAAO/S,OAAQ,CACzCb,WAAW,EACXpY,MAAOJ,EAAQI,MAAQ,IAAKy3B,EAAmBl3B,EAAMX,EAAQuO,WAAYvO,EAAQI,OAAUy3B,EAAmBl3B,EAAMX,EAAQuO,QAC5H8F,SAAUrU,EAAQqU,SAClB/K,MAAOtJ,EAAQsJ,QAAmC,kBAAlBtJ,EAAQsJ,MACpC,IAAI,EAAAwK,SAASnT,EAAM,EAAA2B,aAAaC,GAAI,SAAU,GAAI,IAClD,EAAAuR,SAASrK,YAAY9I,EAAMX,EAAQsJ,QACvCC,OAAQvJ,EAAQuJ,SAAqC,kBAAnBvJ,EAAQuJ,OACtC,IAAI,EAAAuK,SAASnT,EAAM,EAAA2B,aAAayR,IAAK,SAAU,GAAI,IACnD,EAAAD,SAASrK,YAAY9I,EAAMX,EAAQuJ,SACvCjJ,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WAdD,KAAA9B,IAAAA,EAAoB,KAAAjB,IAAAA,EAiBvC3O,KAAKyR,QAAS,IAAAhO,KAAIP,EAAQuO,OAAQzR,KAAK6D,KAAKP,MAAMgb,WAClDte,KAAKyvB,OAASzvB,KAAKuX,SAAWvX,KAAK0vB,WAAY,IAAAjsB,KAAIP,EAAQ6R,MAAOnF,GAClE5P,KAAKyvB,QAAS,IAAAvtB,OAAMlC,KAAKyvB,OAAQzvB,KAAK4P,IAAK5P,KAAK2O,KAE5C3O,KAAKwM,QACPxM,KAAKwM,MAAMxC,GAAG,WAAW,CAAC2U,EAAG1Y,KACvBA,EAAUnD,OAAM9C,KAAK+U,MAAQ9O,EAAUnD,SAE7C9C,KAAKwM,MAAMxC,GAAG,QAAQ,CAAC2U,EAAG7b,KACpBA,IAAM9C,KAAK+U,MAAQjS,OAGvB9C,KAAKyM,QAAQzM,KAAKyM,OAAOzC,GAAG,WAAW,CAAC2U,EAAG1Y,IAAcA,EAAUnD,KAAO9C,KAAK+U,QAEnF/U,KAAK6D,KAAKmG,GAAG,WAAW,KAClBhK,KAAKyM,QAAQzM,KAAKyM,OAAOvH,QAAQlF,KAAK+U,UArD1CA,YACF,OAAI/U,KAAKuX,SAAiBvX,KAAK0vB,UACxB1vB,KAAKyvB,OAEV1a,UAAMA,GACRA,GAAQ,IAAA7S,OAAM6S,EAAO/U,KAAK4P,IAAK5P,KAAK2O,KAEpC,IAAIohB,EAAS/vB,KAAK+U,MACd2K,EAAS3K,EACb2K,GAAS,IAAAH,QAAOvf,KAAKsD,MAAMg1B,WAAaN,WAAWtY,EAAOne,QAAQvB,KAAKsD,MAAMg1B,YAAc5Y,EAEvF1f,KAAKuX,SAAUvX,KAAKgwB,QAAQtQ,IAE9B1f,KAAKyvB,OAAS/P,EACd1f,KAAK4W,UAGH5W,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM+vB,EAAQrQ,GAwCpFwQ,QACE,IAAIrqB,EAAU7F,KAAK6F,QACnBA,EAAQ8B,UAAY3H,KAAKsD,MAAM03B,WAC/Bn1B,EAAQ4B,YAAczH,KAAKsD,MAAM7C,MACjCoF,EAAQ4sB,QAAU,OAElB,IAAIrwB,EAAQxB,KAAK+N,IAAI3O,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAAS3B,EAAI1G,KAAKi7B,UAAY,GACrE74B,IAAUpC,KAAKqI,SAAS3B,IAC1Bb,EAAQgC,YACRhC,EAAQiC,OAAO9H,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAChE5L,EAAQgZ,OAAOzc,EAAOpC,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GACtD5L,EAAQmC,UAEV5F,EAAQxB,KAAKgP,IAAI5P,KAAKqI,SAAS3B,EAAI,EAAI1G,KAAKsD,MAAM43B,YAAcl7B,KAAKi7B,UAAY,EAAGj7B,KAAKqI,SAAS3B,EAAI1G,KAAK4H,OACvGxF,IAAWpC,KAAKqI,SAAS3B,EAAI1G,KAAK4H,QACpC/B,EAAQgC,YACRhC,EAAQiC,OAAO1F,EAAOpC,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GACtD5L,EAAQgZ,OAAO7e,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAO5H,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAC7E5L,EAAQmC,UAGVnC,EAAQqO,UAAYlU,KAAKsD,MAAMgtB,WAC/BzqB,EAAQgC,YACRhC,EAAQ+Z,IACN5f,KAAKqI,SAAS3B,EAAI1G,KAAKsD,MAAM43B,YAAcl7B,KAAKi7B,UAChDj7B,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,EAAGzR,KAAKsD,MAAM43B,YAAa,EAAG,EAAArb,SAASC,KAEzEja,EAAQma,OAEVuQ,YACE,IAAI1qB,EAAU7F,KAAK6F,QACnBA,EAAQ4B,YAAc,OACtB5B,EAAQqO,UAAYlU,KAAKsD,MAAM7C,MAC/BoF,EAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QACtE5L,EAAQuO,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAEtE+e,WACExwB,KAAK8W,aAAa5C,UAAYlU,KAAK0R,SAASxR,SAC5CF,KAAK8W,aAAa1C,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAGhFmF,SACE5W,KAAKi7B,WAAY,IAAAxH,cAAY,IAAAnyB,WAAUtB,KAAK+U,MAAO/U,KAAK4P,IAAK5P,KAAK2O,KAAM,EAAG3O,KAAK4H,MAAQ,EAAI5H,KAAKsD,MAAM43B,aAEnGl7B,KAAKwM,OACPxM,KAAKwM,MAAMnE,SAASqa,OAClB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKwM,MAAMlJ,MAAMiF,OAC9EvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAGhCzR,KAAKyM,QACPzM,KAAKyM,OAAOpE,SAASqa,OACnB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAK+D,MAAQ5H,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKyM,OAAOnJ,MAAMiF,OACjGvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAKtCof,aAAapR,EAAcC,GACzB1f,KAAKyvB,OAAS/P,EACd1f,KAAK4W,SAEL5W,KAAKyM,QAAUzM,KAAKyM,OAAOvH,QAAQlF,KAAK+U,OAE1CkG,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1C2G,KAAK5G,EAAyBC,GACxB1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExCF,QAAQC,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C8G,OAAO/G,EAAyBC,GAC9B,GAAI1U,KAAK8wB,SAAU,OAEnB,IAAIlqB,EAAI5G,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,EAAIzR,KAAKsD,MAAM03B,WAAa,EACpEh7B,KAAKi7B,UAAYvmB,EACdxS,MAAMlC,KAAKqI,SAAS3B,EAAI1G,KAAKsD,MAAM43B,YAAal7B,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAQ5H,KAAKsD,MAAM43B,YAAat0B,EAAGA,GAC1Ggb,gBAAgB5hB,KAAKqI,SAAS3B,EAAI1G,KAAKsD,MAAM43B,YAAa,GAC1Dx0B,EAEH1G,KAAK+U,OAAQ,IAAA0e,cAAY,IAAAnyB,WAAUtB,KAAKi7B,UAAW,EAAGj7B,KAAK4H,MAAQ,EAAI5H,KAAKsD,MAAM43B,aAAcl7B,KAAK4P,IAAK5P,KAAK2O,KAE/G3O,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,gBACM7b,KAAK8wB,SAGXjuB,YACE,MAAO,CACL+M,IAAK5P,KAAK4P,IACVjB,IAAK3O,KAAK2O,IACVoG,MAAO/U,KAAK+U,MACZwC,SAAUvX,KAAKuX,SACf/K,MAAOxM,KAAKwM,MAAQxM,KAAKwM,MAAM3J,YAAc,KAC7C4J,OAAQzM,KAAKyM,OAASzM,KAAKyM,OAAO5J,YAAc,KAChD4O,OAAQzR,KAAKyR,OACbnO,MAAOtD,KAAKsD,MACZE,GAAIxD,KAAKwD,GACTkO,SAAU1R,KAAK0R,SAAS7O,YACxB0C,KAAMvF,KAAKuF,KACXwI,OAAQ,IAGZrN,mBAAmBmD,EAAYf,GAC7B,OAAO,IAAIyZ,EAAO1Y,EAAMf,EAAK8M,IAAK9M,EAAK6L,IAAK,CAC1CoG,MAAOjS,EAAKiS,MACZwC,SAAUzU,EAAKyU,SACf/K,MAAO1J,EAAK0J,MACZC,OAAQ3J,EAAK2J,OACbgF,OAAQ3O,EAAK2O,OACbnO,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,aA1MvC,WAsNA,IAAIqpB,EAAqB,CAACl3B,EAAY4N,KAC7B,CACLhR,MAAO,OACP6vB,WAAY,OACZ0K,WAAY,EACZE,iBAA+B,IAAXzpB,EAAyBA,EAAS,EAA4B,IAAvB5N,EAAKP,MAAMgb,UAAmB,IAqBzFwc,EAAwBj3B,IACnB,CACL4N,OAA+B,IAAvB5N,EAAKP,MAAMgb,a,gFC5PvB,gBAEA,UACA,UACA,UACA,UACA,UAEA,UACA,UACA,SACA,SAEA,MAAaV,UAAe,EAAAwR,OAyB1BtvB,YACE+D,EACAX,EAAyBi4B,EAAqBt3B,IAG9CT,MAAMS,EAAM,EAAAmD,QAAQkY,OAAQ,EAAAoQ,OAAO1R,OAAQ,CACzCta,MAAOJ,EAAQI,MAAQ,IAAK83B,OAAyBl4B,EAAQI,OAAU83B,IACvE7jB,SAAUrU,EAAQqU,SAClB/K,MAAOtJ,EAAQsJ,QAAmC,kBAAlBtJ,EAAQsJ,MACpC,IAAI,EAAAwK,SAASnT,EAAM,EAAA2B,aAAaC,GAAI,OAAQ,GAAI,IAChD,EAAAuR,SAASrK,YAAY9I,EAAMX,EAAQsJ,QACvCC,OAAQvJ,EAAQuJ,SAAqC,kBAAnBvJ,EAAQuJ,OACtC,IAAI,EAAAuK,SAASnT,EAAM,EAAA2B,aAAayR,IAAK,OAAQ,GAAI,IACjD,EAAAD,SAASrK,YAAY9I,EAAMX,EAAQuJ,SACvCjJ,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WAGpB1R,KAAKq7B,OAASn4B,EAAQm4B,OACtBr7B,KAAKyR,QAAS,IAAAhO,KAAIP,EAAQuO,OAAQzR,KAAK6D,KAAKP,MAAMgb,WAElDte,KAAKk4B,kBAAkBh1B,GAEvBlD,KAAKkxB,MAAQ,IAAI,EAAA/U,MAAMnc,KAAK6D,KAAM,SAAU,CAAEP,MAAO,CAAEmU,MAAO,EAAA9X,MAAMwxB,UAAWnxB,KAAKsD,OAASmO,OAAQzR,KAAKyR,SAC1GzR,KAAKkvB,SAAW,IAAI,EAAA7S,MAAMrc,KAAK6D,KAAM,EAAAqrB,UACrClvB,KAAKkxB,MAAMlnB,GAAG,SAAS,IAAMhK,KAAKs7B,UAAUC,UAC5Cv7B,KAAKqxB,SAAStvB,KAAK/B,KAAKkxB,MAAOlxB,KAAKkvB,UAEhClvB,KAAKwM,QACPxM,KAAKwM,MAAMxC,GAAG,WAAW,CAAC2U,EAAG1Y,KACvBA,EAAUnD,OAAM9C,KAAKw7B,KAAOv1B,EAAUnD,SAE5C9C,KAAKwM,MAAMxC,GAAG,QAAQ,CAAC2U,EAAG7b,KACpBA,IAAM9C,KAAKw7B,KAAO14B,OAGtB9C,KAAKyM,QAAQzM,KAAKyM,OAAOzC,GAAG,WAAW,CAAC2U,EAAG1Y,IAAcA,EAAUnD,KAAO9C,KAAKw7B,OAEnFx7B,KAAK6D,KAAKmG,GAAG,WAAW,KAClBhK,KAAKyM,QAAQzM,KAAKyM,OAAOvH,QAAQlF,KAAKw7B,SAxD1CA,WACF,OAAIx7B,KAAKuX,SAAiBvX,KAAK0vB,UACxB1vB,KAAKy7B,MAEVD,SAAKA,GACP,IAAIzL,EAAS/vB,KAAKw7B,KACd9b,EAAS8b,EAETx7B,KAAKuX,SAAUvX,KAAKgwB,QAAQtQ,IAE9B1f,KAAKy7B,MAAQ/b,EACb1f,KAAKkxB,MAAMhV,KAAOwD,EAAO5W,KAAK6wB,UAAU,EAAG35B,KAAKy7B,MAAM3yB,KAAK3H,WAAWu6B,YAAY,OAGhF17B,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM+vB,EAAQrQ,GA8CpFwY,kBAAkBh1B,GAChBlD,KAAKs7B,UAAYxoB,SAASC,cAAc,SACxC/S,KAAKs7B,UAAU/1B,KAAO,OAClBrC,EAAQm4B,SAAQr7B,KAAKs7B,UAAUD,OAASn4B,EAAQm4B,QACpDr7B,KAAKs7B,UAAUvQ,SAAW,KACxB,GAAI/qB,KAAKs7B,UAAUK,MAAMv6B,OAAS,EAAG,CACnC,IAAI2uB,EAAS/vB,KAAKw7B,KAClBx7B,KAAKw7B,KAAOx7B,KAAKs7B,UAAUK,MAAM,GAC7B37B,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM+vB,EAAQ/vB,KAAKw7B,QAK7FtL,QACElwB,KAAK6F,QAAQ4B,YAAczH,KAAKsD,MAAMoE,YACtC1H,KAAK6F,QAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAE7E8e,YACE,IAAI1qB,EAAU7F,KAAK6F,QACnBA,EAAQ4B,YAAczH,KAAKsD,MAAMoE,YACjC7B,EAAQqO,UAAYlU,KAAKsD,MAAM7C,MAC/BoF,EAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QACtE5L,EAAQuO,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAEtE+e,WACExwB,KAAK8W,aAAa5C,UAAYlU,KAAK0R,SAASxR,SAC5CF,KAAK8W,aAAa1C,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAGhFmF,SACE5W,KAAKkxB,MAAMtpB,MAAQ5H,KAAK4H,MACxB5H,KAAKkxB,MAAMzf,OAASzR,KAAKyR,OACzBzR,KAAKkxB,MAAM7oB,SAAWrI,KAAKqI,SAE3BrI,KAAKkvB,SAAStnB,MAAqB,GAAb5H,KAAK4H,MAC3B5H,KAAKkvB,SAAS7mB,SAASqa,OAAO1iB,KAAKqI,SAAS3B,EAAI,EAAG1G,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,EAAIzR,KAAKkvB,SAASzd,OAAS,GAE1GzR,KAAKwM,OACPxM,KAAKwM,MAAMnE,SAASqa,OAClB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKwM,MAAMlJ,MAAMiF,OAC9EvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAGhCzR,KAAKyM,QACPzM,KAAKyM,OAAOpE,SAASqa,OACnB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAK+D,MAAQ5H,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKyM,OAAOnJ,MAAMiF,OACjGvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAKtCof,aAAapR,EAAcC,GACzB1f,KAAKy7B,MAAQ/b,EACb1f,KAAKkxB,MAAMhV,KAAOlc,KAAKy7B,MAAM3yB,KAAK6wB,UAAU,EAAG35B,KAAKy7B,MAAM3yB,KAAK3H,WAAWu6B,YAAY,MAEtF17B,KAAKyM,QAAUzM,KAAKyM,OAAOvH,QAAQlF,KAAKy7B,OAE1CxgB,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1C2G,KAAK5G,EAAyBC,GACxB1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExCF,QAAQC,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C8G,OAAO/G,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,gBACM7b,KAAK8wB,SAGXjuB,YACE,MAAO,CACLw4B,OAAQr7B,KAAKq7B,OACb9jB,SAAUvX,KAAKuX,SACf/K,MAAOxM,KAAKwM,MAAQxM,KAAKwM,MAAM3J,YAAc,KAC7C4J,OAAQzM,KAAKyM,OAASzM,KAAKyM,OAAO5J,YAAc,KAChD4O,OAAQzR,KAAKyR,OACbnO,MAAOtD,KAAKsD,MACZE,GAAIxD,KAAKwD,GACTkO,SAAU1R,KAAK0R,SAAS7O,YACxB0C,KAAMvF,KAAKuF,KACXwI,OAAQ,IAGZrN,mBAAmBmD,EAAYf,GAC7B,OAAO,IAAI8a,EAAO/Z,EAAM,CACtBw3B,OAAQv4B,EAAKu4B,OACb9jB,SAAUzU,EAAKyU,SACf/K,MAAO1J,EAAK0J,MACZC,OAAQ3J,EAAK2J,OACbgF,OAAQ3O,EAAK2O,OACbnO,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,aAhMvC,WA2MA,IAAI0pB,EAAqB,KAChB,CACL1zB,YAAa,OACbsqB,SAAS,IAmBTmJ,EAAwBt3B,IACnB,CACL4N,OAA+B,IAAvB5N,EAAKP,MAAMgb,a,+EChPvB,gBAGA,UACA,UACA,UAEA,MAAarB,UAAc,EAAAmS,OAEzBtvB,YACE+D,EACAX,EAAwB04B,KAExBx4B,MAAMS,EAAM,EAAAmD,QAAQkY,OAAQ,EAAAoQ,OAAOrS,MAAO,CACxC3Z,MAAOJ,EAAQI,MAAQ,IAAKu4B,OAAwB34B,EAAQI,OAAUu4B,IACtEr4B,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WAGhBxO,EAAQ6K,QAAQ/N,KAAKqxB,SAAStvB,QAAQmB,EAAQ6K,QAIpDmiB,SACAK,aACAC,WACExwB,KAAK8W,aAAa5C,UAAYlU,KAAK0R,SAASxR,SAC5CF,KAAK8W,aAAa1C,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAGhFmF,SACE,IAAIya,EAAWrxB,KAAKqxB,SAAShlB,QAAO2C,GAASA,EAAMgjB,UAC/C8J,EAAoBzK,EAAS7iB,QAAO,CAACC,EAAKC,IAAUD,EAAMC,EAAK+C,QAAS,GACxEsqB,GAAoB1K,EAASjwB,OAAS,GAAKpB,KAAKsD,MAAM+a,QAC1Dre,KAAKyR,OAASqqB,EAAoBC,EAElC,IAAIn1B,EAAI5G,KAAKqI,SAASzB,EACtByqB,EAASvvB,SAAQkN,IACfA,EAAM3G,SAASqa,OAAO1iB,KAAKqI,SAAS3B,EAAGE,GACvCoI,EAAMpH,MAAQ5H,KAAK4H,MACnBhB,GAAKoI,EAAMyC,OAASzR,KAAKsD,MAAM+a,WAInCwS,gBACA5V,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1C2G,KAAK5G,EAAyBC,GACxB1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExCF,QAAQC,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C8G,OAAO/G,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,iBAEAhZ,YACE,MAAO,CACLS,MAAOtD,KAAKsD,MACZE,GAAIxD,KAAKwD,GACTkO,SAAU1R,KAAK0R,SAAS7O,YACxB0C,KAAMvF,KAAKuF,KACXgS,SAAU,KACV/K,MAAO,KACPC,OAAQ,KACRsB,OAAQ/N,KAAKqxB,SAAS5uB,KAAIuM,GAAUA,EAAcnM,eAGtDnC,mBAAmBmD,EAAYf,GAC7B,IAAIk5B,EAAQ,IAAI/e,EAAMpZ,EAAM,CAAEP,MAAOR,EAAKQ,MAAOE,GAAIV,EAAKU,GAAIkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,UAAW3D,OAAQ,KAmBlH,OAjBAiuB,EAAM3K,SAAStvB,QAAQe,EAAKiL,OAAOtL,KAAI0vB,IACrC,OAAQA,EAAgB5sB,MACtB,KAAK,EAAA+pB,OAAOnS,OAAQ,OAAO,EAAAA,OAAOxQ,YAAY9I,EAAMsuB,GACpD,KAAK,EAAA7C,OAAO/Y,UAAW,OAAO,EAAAA,UAAU5J,YAAY9I,EAAMsuB,GAC1D,KAAK,EAAA7C,OAAOvR,QAAS,OAAO,EAAAA,QAAQpR,YAAY9I,EAAMsuB,GACtD,KAAK,EAAA7C,OAAOvS,iBACZ,KAAK,EAAAuS,OAAOrS,MAAO,OAAOA,EAAMtQ,YAAY9I,EAAMsuB,GAClD,KAAK,EAAA7C,OAAOjT,MAAO,OAAO,EAAAA,MAAM1P,YAAY9I,EAAMsuB,GAClD,KAAK,EAAA7C,OAAOrR,MAAO,OAAO,EAAAA,MAAMtR,YAAY9I,EAAMsuB,GAClD,KAAK,EAAA7C,OAAOnT,MAAO,OAAO,EAAAA,MAAMxP,YAAY9I,EAAMsuB,GAClD,KAAK,EAAA7C,OAAO5R,OAAQ,OAAO,EAAAA,OAAO/Q,YAAY9I,EAAMsuB,GACpD,KAAK,EAAA7C,OAAO/S,OAAQ,OAAO,EAAAA,OAAO5P,YAAY9I,EAAMsuB,GACpD,KAAK,EAAA7C,OAAO1R,OAAQ,OAAO,EAAAA,OAAOjR,YAAY9I,EAAMsuB,GACpD,KAAK,EAAA7C,OAAOjS,OAAQ,OAAO,EAAAA,OAAO1Q,YAAY9I,EAAMsuB,GACpD,QAAS,YAGN6J,GAhHX,UAuHA,IAAIH,EAAoB,KACf,CACLxd,QAAS,EACT2T,SAAS,IAYT4J,EAAsB,KACjB,K,gFC9IT,gBAEA,UACA,UAEA,UACA,UACA,SACA,UAEA,MAAave,UAAe,EAAA+R,OAmB1BtvB,YACE+D,EACAX,EAAyB+4B,EAAqBp4B,IAE9CT,MAAMS,EAAM,EAAAmD,QAAQkY,OAAQ,EAAAoQ,OAAOjS,OAAQ,CACzC/Z,MAAOJ,EAAQI,MACX,IAAK44B,OAAyBh5B,EAAQI,OACtC44B,IACJ3kB,SAAUrU,EAAQqU,SAClB/K,MAAOtJ,EAAQsJ,QAAmC,kBAAlBtJ,EAAQsJ,MACpC,IAAI,EAAAwK,SAASnT,EAAM,EAAA2B,aAAaC,GAAI,UAAW,GAAI,IACnD,EAAAuR,SAASrK,YAAY9I,EAAMX,EAAQsJ,QACvCC,OAAQvJ,EAAQuJ,SAAqC,kBAAnBvJ,EAAQuJ,OACtC,IAAI,EAAAuK,SAASnT,EAAM,EAAA2B,aAAayR,IAAK,UAAW,GAAI,IACpD,EAAAD,SAASrK,YAAY9I,EAAMX,EAAQuJ,SACvCjJ,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WAlCd,KAAAyqB,UAAoB,EAqC1Bn8B,KAAKm8B,SAAWn8B,KAAKuX,SAAWvX,KAAK0vB,UAAYxsB,EAAQ6R,MACzD/U,KAAKyR,QAAS,IAAAhO,KAAIP,EAAQuO,OAAQzR,KAAK6D,KAAKP,MAAMgb,WAC7Cte,KAAKsD,MAAM0zB,OAAMh3B,KAAK4H,MAAsB,IAAd5H,KAAKyR,QAEpCzR,KAAKwM,QACPxM,KAAKwM,MAAMxC,GAAG,WAAW,CAAC2U,EAAG1Y,KACvBA,EAAUnD,OAAM9C,KAAKo8B,QAAUn2B,EAAUnD,SAE/C9C,KAAKwM,MAAMxC,GAAG,QAAQ,CAAC2U,EAAG7b,UACJ,IAATA,IAAsB9C,KAAKo8B,QAAUt5B,OAGhD9C,KAAKyM,QAAQzM,KAAKyM,OAAOzC,GAAG,WAAW,CAAC2U,EAAG1Y,IAAcA,EAAUnD,KAAO9C,KAAKo8B,UAEnFp8B,KAAK6D,KAAKmG,GAAG,WAAW,KAClBhK,KAAKyM,QAAQzM,KAAKyM,OAAOvH,QAAQlF,KAAKo8B,YAlD1CA,cACF,OAAIp8B,KAAKuX,SAAiBvX,KAAK0vB,UACxB1vB,KAAKm8B,SAEVC,YAAQA,GACV,IAAIrM,EAAS/vB,KAAKo8B,QACd1c,EAAS0c,EAETp8B,KAAKuX,SACPvX,KAAKgwB,QAAQtQ,GAEb1f,KAAKm8B,SAAWzc,EAEd1f,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM+vB,EAAQrQ,GAyCpFwQ,QACE,IAAIrqB,EAAU7F,KAAK6F,QACnBA,EAAQ4B,YAAczH,KAAKsD,MAAM6sB,gBACjCtqB,EAAQ8B,UAA0B,IAAd3H,KAAKyR,OACzB5L,EAAQ4sB,QAAU,QAClB5sB,EAAQgC,YACRhC,EAAQiC,OAAO9H,KAAKqI,SAAS3B,EAAI1G,KAAK6F,QAAQ8B,UAAY,EAAG3H,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAC7F5L,EAAQgZ,OAAO7e,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAQ5H,KAAK6F,QAAQ8B,UAAY,EAAG3H,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAC1G5L,EAAQmC,SAERnC,EAAQqO,UAAYlU,KAAKsD,MAAM7C,MAC/BoF,EAAQgC,YACRhC,EAAQ+Z,IACN5f,KAAKo8B,QAAUp8B,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAQ5H,KAAKyR,OAAS,EAAIzR,KAAKqI,SAAS3B,EAAI1G,KAAKyR,OAAS,EAChGzR,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,EAAGzR,KAAKyR,OAAS,EAAG,EAAG,EAAAoO,SAASC,KAElEja,EAAQma,OAEVuQ,YACE,IAAI1qB,EAAU7F,KAAK6F,QACnBA,EAAQ4B,YAAczH,KAAKsD,MAAM7C,MACjCoF,EAAQqO,UAAYlU,KAAKsD,MAAM6sB,gBAC/BtqB,EAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QACtE5L,EAAQuO,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAEtE+e,WACExwB,KAAK8W,aAAa5C,UAAYlU,KAAK0R,SAASxR,SAC5CF,KAAK8W,aAAa1C,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAGhFmF,SACM5W,KAAKwM,OACPxM,KAAKwM,MAAMnE,SAASqa,OAClB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKwM,MAAMlJ,MAAMiF,OAC9EvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAGhCzR,KAAKyM,QACPzM,KAAKyM,OAAOpE,SAASqa,OACnB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAK+D,MAAQ5H,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKyM,OAAOnJ,MAAMiF,OACjGvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAKtCof,aAAapR,EAAcC,GACzB1f,KAAKm8B,SAAWzc,EAEhB1f,KAAKyM,QAAUzM,KAAKyM,OAAOvH,QAAQlF,KAAKo8B,SAE1CnhB,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1C2G,KAAK5G,EAAyBC,GACxB1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExCF,QAAQC,EAAyBC,GAC3B1U,KAAK8wB,WAET9wB,KAAKo8B,SAAWp8B,KAAKo8B,QAErBp8B,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,IAE3C8G,OAAO/G,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,gBACM7b,KAAK8wB,SAGXjuB,YACE,MAAO,CACLu5B,QAASp8B,KAAKo8B,QACd7kB,SAAUvX,KAAKuX,SACf/K,MAAOxM,KAAKwM,MAAQxM,KAAKwM,MAAM3J,YAAc,KAC7C4J,OAAQzM,KAAKyM,OAASzM,KAAKyM,OAAO5J,YAAc,KAChD4O,OAAQzR,KAAKyR,OACbnO,MAAOtD,KAAKsD,MACZE,GAAIxD,KAAKwD,GACTkO,SAAU1R,KAAK0R,SAAS7O,YACxB0C,KAAMvF,KAAKuF,KACXwI,OAAQ,IAGZrN,mBAAmBmD,EAAYf,GAC7B,OAAO,IAAIua,EAAOxZ,EAAM,CACtB0T,SAAUzU,EAAKyU,SACf/K,MAAO1J,EAAK0J,MACZC,OAAQ3J,EAAK2J,OACbgF,OAAQ3O,EAAK2O,OACbnO,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,aA/KvC,WA8LA,IAAIuqB,EAAwBp4B,IACnB,CACLkR,OAAO,EACPtD,OAA+B,IAAvB5N,EAAKP,MAAMgb,YAQnB4d,EAAqB,KAChB,CACL/L,gBAAiB,OACjB1vB,MAAO,OACPuxB,SAAS,K,yFCvNb,gBACA,UACA,UAGA,SACA,SAGA,MAAsB5C,UAAe,EAAApsB,MA4BnClD,YAAmB+D,EAAYwE,EAA0B9C,EAAcrC,EAAyBm5B,KAC9Fj5B,QADiB,KAAAS,KAAAA,EAAsC,KAAA0B,KAAAA,EAfzD,KAAAqC,MAAgB,EAChB,KAAA6J,OAAiB,EAiBfzR,KAAK+R,YAAY7O,EAAQwO,UACzB1R,KAAKwD,IAAK,IAAAC,KAAIP,EAAQM,IAAI,IAAAE,eAC1B1D,KAAK0b,WAAY,IAAAjY,KAAIP,EAAQwY,WAAW,GACxC1b,KAAKgc,UAAW,IAAAvY,KAAIP,EAAQ8Y,UAAU,GACtChc,KAAKs8B,UAAW,IAAA74B,KAAIP,EAAQ8uB,SAAS,GACrChyB,KAAKsD,OAAQ,IAAAG,KAAIP,EAAQI,MAAO,IAChCtD,KAAKqxB,SAAW,GAChBrxB,KAAKqI,SAAWA,EAChBrI,KAAK8wB,UAAW,EAChB9wB,KAAKuX,SAAWrU,EAAQqU,SACpBvX,KAAKuX,UACPvX,KAAK6D,KAAKyT,MAAMtX,KAAKuX,UAAU,CAACwY,EAAQrQ,IAAW1f,KAAK6wB,aAAad,EAAQrQ,KAE/E1f,KAAKwM,MAAQtJ,EAAQsJ,MACrBxM,KAAKyM,OAASvJ,EAAQuJ,OAElBzM,KAAKwM,QACPxM,KAAK6D,KAAK0J,SAASxL,KAAK/B,KAAKwM,OAC7BxM,KAAKwM,MAAMxC,GAAG,WAAW,IAAMhK,KAAK8wB,UAAW,IAC/C9wB,KAAKwM,MAAMxC,GAAG,cAAc,IAAMhK,KAAK8wB,UAAW,KAEhD9wB,KAAKyM,QAAQzM,KAAK6D,KAAKsJ,UAAUpL,KAAK/B,KAAKyM,QApC7C5G,cAAsC,OAAO7F,KAAK6D,KAAKgC,QACvDiR,mBAA+E,OAAO9W,KAAK6D,KAAKiT,aAGhGga,eAAsB,OAAO9wB,KAAKu8B,UAClCzL,aAASA,GACX9wB,KAAKu8B,UAAYzL,EACjB9wB,KAAKqxB,SAASvvB,SAAQkN,GAASA,EAAM8hB,SAAWA,IAE9CkB,cAAqB,OAAOhyB,KAAKs8B,SACjCtK,YAAQjd,GAAkB/U,KAAKs8B,SAAWvnB,EAAO/U,KAAK6D,KAAKiQ,GAAG+C,SA6BlE7G,OAAOjC,GACDtM,MAAMC,QAAQqM,GAChB/N,KAAKqxB,SAAStvB,QAAQgM,GAEtB/N,KAAKqxB,SAAStvB,KAAKgM,GAErB/N,KAAK6W,SAGL7W,KAAK6D,KAAKiQ,GAAG+C,SAEfA,SACE7W,KAAK4W,SACL5W,KAAKsE,KAAK,SAAUtE,MACpBA,KAAKqxB,SAASvvB,SAAQkN,GAASA,EAAM6H,WAEvC5E,oBACE,GAAIjS,KAAK6D,KAAKoE,YAAYC,YAAc,EAAAC,UAAUyS,UAAW,OAE7D,IAAIvH,EAAUrT,KAAKqI,SAASiL,UAAUtT,KAAK6D,KAAKZ,KAAK6C,YAAYwN,WACjEtT,KAAKiI,aAAc,IAAAsL,YACjB,EAAG,EACHvT,KAAK6D,KAAKZ,KAAK6C,YAAY0N,iBAAiB5L,MAAO5H,KAAK6D,KAAKZ,KAAK6C,YAAY0N,iBAAiB/B,OAC/F4B,EAAQ3M,EAAG2M,EAAQzM,EACnByM,EAAQ3M,EAAI1G,KAAK4H,MAAQ5H,KAAK6D,KAAKZ,KAAK6C,YAAY2N,MAAOJ,EAAQzM,EAAI5G,KAAKyR,OAASzR,KAAK6D,KAAKZ,KAAK6C,YAAY2N,OAGlHzT,KAAKqxB,SAASvvB,SAAQkN,GAASA,EAAMiD,sBAE/BF,YAAYL,GAClB,IAAKA,EAEH,IADAA,EAAW,EAAA7R,MAAMiS,SACV9R,KAAK6D,KAAKqS,QAAQzS,IAAIiO,EAAStR,aAAeJ,KAAK6D,KAAKsS,UAAU1S,IAAIiO,EAAStR,aAAasR,EAAW,EAAA7R,MAAMiS,SAEtH9R,KAAK0R,SAAWA,EAChB1R,KAAK6D,KAAKqS,QAAQtL,IAAI5K,KAAK0R,SAAStR,WAAYJ,MAElD4F,SACE,IAAK5F,KAAKgyB,QAAS,OACnB,GAAIhyB,KAAKiI,cAAgB,EAAAxI,SAASuU,QAAS,OAE3C,IAAInO,EAAU7F,KAAK6F,QACf7F,KAAK6D,KAAKoE,YAAY4N,MAAQ,EAAAnW,IAAI2Y,MACpCxS,EAAQE,OACR/F,KAAKuwB,YACL1qB,EAAQQ,WACCrG,KAAK6D,KAAKoE,YAAY4N,MAAQ,EAAAnW,IAAIoW,MAC3CjQ,EAAQE,OACR/F,KAAKkwB,QACLrqB,EAAQQ,UAERrG,KAAK8W,aAAa/Q,OAClB/F,KAAKwwB,WACLxwB,KAAK8W,aAAazQ,WAEdrG,KAAKuF,OAAS+pB,EAAO/Y,YACvB1Q,EAAQE,OACR/F,KAAKuwB,YACL1qB,EAAQQ,WAIRrG,KAAK6D,KAAKoE,YAAY4N,IAAM,IAC1B7V,KAAKwM,OAAOxM,KAAKwM,MAAM5G,SACvB5F,KAAKyM,QAAQzM,KAAKyM,OAAO7G,UAG/B5F,KAAKsE,KAAK,SAAUtE,MACpBA,KAAKqxB,SAASvvB,SAAQkN,GAASA,EAAMpJ,WAGvC8pB,UACE,OAAO1vB,KAAK6D,KAAKU,MAAMvE,KAAKuX,UAE9ByY,QAAQwM,GACNx8B,KAAK6D,KAAKU,MAAMvE,KAAKuX,UAAYilB,EAGnCC,MAAMA,GACJ,IAAI9H,EAAS,GACb8H,EAAQA,EAAMtqB,OACd,IAAItD,EAAkB,CAAC7O,MACvB,KAAwB,IAAjB6O,EAAMzN,QAAc,CACzB,IAAIsN,EAAOG,EAAME,QACbL,EAAKnJ,OAASk3B,GAAO9H,EAAO5yB,KAAK2M,GACrCA,EAAK2iB,SAASvvB,SAAQkN,GAASH,EAAM9M,KAAKiN,KAG5C,OAAO2lB,GAmCX,IAAYrF,EAlLZ,WAkLA,SAAYA,GACV,kBACA,wBACA,oBACA,uCACA,gBACA,gBACA,gBACA,gBACA,kBACA,kBACA,cACA,kBACA,kBACA,sBACA,0BACA,sBACA,oBAjBF,CAAYA,EAAA,EAAAA,SAAA,EAAAA,OAAM,KA+BlB,IAAI+M,EAAuB,KAClB,CACL3gB,WAAW,EACXM,UAAU,EACVgW,SAAS,EACT1uB,MAAO,GACPiU,SAAU,KACV/K,MAAO,KACPC,OAAQ,KACRjJ,IAAI,IAAAE,cACJgO,SAAU,Q,gFCpOd,gBAEA,UACA,SACA,UAEA,UACA,UACA,UAEA,MAAaiL,UAAgB,EAAAyS,OAuB3BtvB,YACE+D,EAAmB+L,EAAoBjB,EACvCzL,EAA0Bw5B,EAAsB74B,IAEhDT,MAAMS,EAAM,EAAAmD,QAAQkY,OAAQ,EAAAoQ,OAAO3S,QAAS,CAC1CjB,WAAW,EACXpY,MAAOJ,EAAQI,MAAQ,IAAKq5B,EAAoB94B,EAAMX,EAAQ0E,UAAW1E,EAAQI,OAAUq5B,EAAoB94B,EAAMX,EAAQ0E,OAC7H2P,SAAUrU,EAAQqU,SAClB/K,MAAOtJ,EAAQsJ,QAAmC,kBAAlBtJ,EAAQsJ,MACpC,IAAI,EAAAwK,SAASnT,EAAM,EAAA2B,aAAaC,GAAI,SAAU,GAAI,IAClD,EAAAuR,SAASrK,YAAY9I,EAAMX,EAAQsJ,QACvCC,OAAQvJ,EAAQuJ,SAAqC,kBAAnBvJ,EAAQuJ,OACtC,IAAI,EAAAuK,SAASnT,EAAM,EAAA2B,aAAayR,IAAK,SAAU,GAAI,IACnD,EAAAD,SAASrK,YAAY9I,EAAMX,EAAQuJ,SACvCjJ,GAAIN,EAAQM,GACZkO,SAAUxO,EAAQwO,WAdD,KAAA9B,IAAAA,EAAoB,KAAAjB,IAAAA,EAiBvC3O,KAAKyR,QAAS,IAAAhO,KAAIP,EAAQuO,OAAoC,EAA5BzR,KAAK6D,KAAKP,MAAMgb,WAClDte,KAAK4H,OAAQ,IAAAnE,KAAIP,EAAQ0E,MAAO5H,KAAK6D,KAAKP,MAAMgb,WAChDte,KAAKyvB,OAASzvB,KAAKuX,SAAWvX,KAAK0vB,WAAY,IAAAjsB,KAAIP,EAAQ6R,MAAOnF,GAClE5P,KAAKyvB,QAAS,IAAAvtB,OAAMlC,KAAKyvB,OAAQzvB,KAAK4P,IAAK5P,KAAK2O,KAE5C3O,KAAKwM,QACPxM,KAAKwM,MAAMxC,GAAG,WAAW,CAAC2U,EAAG1Y,KACvBA,EAAUnD,OAAM9C,KAAK+U,MAAQ9O,EAAUnD,SAE7C9C,KAAKwM,MAAMxC,GAAG,QAAQ,CAAC2U,EAAG7b,KACpBA,IAAM9C,KAAK+U,MAAQjS,OAGvB9C,KAAKyM,QAAQzM,KAAKyM,OAAOzC,GAAG,WAAW,CAAC2U,EAAG1Y,IAAcA,EAAUnD,KAAO9C,KAAK+U,QAEnF/U,KAAK6D,KAAKmG,GAAG,WAAW,KAClBhK,KAAKyM,QAAQzM,KAAKyM,OAAOvH,QAAQlF,KAAK+U,UArD1CA,YACF,OAAI/U,KAAKuX,SAAiBvX,KAAK0vB,UACxB1vB,KAAKyvB,OAEV1a,UAAMA,GACRA,GAAQ,IAAA7S,OAAM6S,EAAO/U,KAAK4P,IAAK5P,KAAK2O,KAEpC,IAAIohB,EAAS/vB,KAAK+U,MACd2K,EAAS3K,EAET/U,KAAKuX,SAAUvX,KAAKgwB,QAAQtQ,IAE9B1f,KAAKyvB,OAAS/P,EACd1f,KAAK4W,UAGH5W,KAAK6D,KAAKZ,KAAKsB,QAAU,EAAAC,UAAUC,SAASzE,KAAKsE,KAAK,SAAUtE,KAAM+vB,EAAQrQ,GAyCpFwQ,QACE,IAAIrqB,EAAU7F,KAAK6F,QACnBA,EAAQ8B,UAAY3H,KAAKsD,MAAMs5B,UAC/B/2B,EAAQ4B,YAAczH,KAAKsD,MAAM7C,MACjCoF,EAAQ4sB,QAAU,OAElB,IAAIrwB,EAAQxB,KAAK+N,IAAI3O,KAAKqI,SAASzB,EAAG5G,KAAKqI,SAASzB,EAAI5G,KAAKi7B,UAAY,GACrE74B,IAAUpC,KAAKqI,SAASzB,IAC1Bf,EAAQgC,YACRhC,EAAQiC,OAAO9H,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAQ,EAAG5H,KAAKqI,SAASzB,GAC/Df,EAAQgZ,OAAO7e,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAQ,EAAGxF,GACjDyD,EAAQmC,UAEV5F,EAAQxB,KAAKgP,IAAI5P,KAAKqI,SAASzB,EAAI,EAAI5G,KAAKsD,MAAM43B,YAAcl7B,KAAKi7B,UAAY,EAAGj7B,KAAKqI,SAASzB,EAAI5G,KAAKyR,QACvGrP,IAAWpC,KAAKqI,SAASzB,EAAI5G,KAAKyR,SACpC5L,EAAQgC,YACRhC,EAAQiC,OAAO9H,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAQ,EAAGxF,GACjDyD,EAAQgZ,OAAO7e,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAQ,EAAG5H,KAAKqI,SAASzB,EAAI5G,KAAKyR,QACxE5L,EAAQmC,UAGVnC,EAAQqO,UAAYlU,KAAKsD,MAAMgtB,WAC/BzqB,EAAQgC,YACRhC,EAAQ+Z,IACN5f,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAQ,EAC/B5H,KAAKqI,SAASzB,EAAI5G,KAAKsD,MAAM43B,YAAcl7B,KAAKi7B,UAAWj7B,KAAKsD,MAAM43B,YAAa,EAAG,EAAArb,SAASC,KAEjGja,EAAQma,OAEVuQ,YACE,IAAI1qB,EAAU7F,KAAK6F,QACnBA,EAAQ4B,YAAc,OACtB5B,EAAQqO,UAAYlU,KAAKsD,MAAM7C,MAC/BoF,EAAQsO,WAAWnU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QACtE5L,EAAQuO,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAEtE+e,WACExwB,KAAK8W,aAAa5C,UAAYlU,KAAK0R,SAASxR,SAC5CF,KAAK8W,aAAa1C,SAASpU,KAAKqI,SAAS3B,EAAG1G,KAAKqI,SAASzB,EAAG5G,KAAK4H,MAAO5H,KAAKyR,QAGhFmF,SACE5W,KAAKi7B,WAAY,IAAAxH,aAAY,GAAI,IAAAnyB,WAAUtB,KAAK+U,MAAO/U,KAAK4P,IAAK5P,KAAK2O,KAAM,EAAG3O,KAAKyR,OAAS,EAAIzR,KAAKsD,MAAM43B,aAExGl7B,KAAKwM,OACPxM,KAAKwM,MAAMnE,SAASqa,OAClB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKwM,MAAMlJ,MAAMiF,OAC9EvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAGhCzR,KAAKyM,QACPzM,KAAKyM,OAAOpE,SAASqa,OACnB1iB,KAAK6D,KAAKwE,SAAS3B,EAAI1G,KAAK6D,KAAK+D,MAAQ5H,KAAK6D,KAAKP,MAAMgF,oBAAsBtI,KAAKyM,OAAOnJ,MAAMiF,OACjGvI,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAAS,GAKtCof,aAAapR,EAAcC,GACzB1f,KAAKyvB,OAAS/P,EACd1f,KAAK4W,SAEL5W,KAAKyM,QAAUzM,KAAKyM,OAAOvH,QAAQlF,KAAK+U,OAE1CkG,OAAOxG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoG,OAAOrG,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1C2G,KAAK5G,EAAyBC,GACxB1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,KAAMtE,KAAMyU,EAAgBC,GAExCF,QAAQC,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C8G,OAAO/G,EAAyBC,GAC9B,GAAI1U,KAAK8wB,SAAU,OAEnB,IAAIpqB,EAAI1G,KAAKqI,SAAS3B,EAAI1G,KAAK4H,MAAQ,EAAI5H,KAAKsD,MAAMs5B,UAAY,EAClE58B,KAAKi7B,UAAYvmB,EACdxS,MAAMwE,EAAGA,EAAG1G,KAAKqI,SAASzB,EAAI5G,KAAKsD,MAAM43B,YAAal7B,KAAKqI,SAASzB,EAAI5G,KAAKyR,OAASzR,KAAKsD,MAAM43B,aACjGtZ,gBAAgB,EAAG5hB,KAAKqI,SAASzB,EAAI5G,KAAKsD,MAAM43B,aAChDt0B,EAEH5G,KAAK+U,OAAQ,IAAA0e,aAAY,GAAI,IAAAnyB,WAAUtB,KAAKi7B,UAAW,EAAGj7B,KAAKyR,OAAS,EAAIzR,KAAKsD,MAAM43B,aAAcl7B,KAAK4P,IAAK5P,KAAK2O,KAEpH3O,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CgE,QAAQjE,EAAyBC,GAC3B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAMyU,EAAgBC,GAE3C3P,OAAO0P,EAAyBC,GAC1B1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,OAAQtE,KAAMyU,EAAgBC,GAE1CoH,QAAQC,EAAoBtH,EAAyBC,GAC/C1U,KAAK8wB,UAET9wB,KAAKsE,KAAK,QAAStE,KAAM+b,EAAWtH,EAAgBC,GAEtDmH,gBACM7b,KAAK8wB,SAGXjuB,YACE,MAAO,CACL+M,IAAK5P,KAAK4P,IACVjB,IAAK3O,KAAK2O,IACVoG,MAAO/U,KAAK+U,MACZwC,SAAUvX,KAAKuX,SACf/K,MAAOxM,KAAKwM,MAAQxM,KAAKwM,MAAM3J,YAAc,KAC7C4J,OAAQzM,KAAKyM,OAASzM,KAAKyM,OAAO5J,YAAc,KAChD4O,OAAQzR,KAAKyR,OACb7J,MAAO5H,KAAK4H,MACZtE,MAAOtD,KAAKsD,MACZE,GAAIxD,KAAKwD,GACTkO,SAAU1R,KAAK0R,SAAS7O,YACxB0C,KAAMvF,KAAKuF,KACXwI,OAAQ,IAGZrN,mBAAmBmD,EAAYf,GAC7B,OAAO,IAAI6Z,EAAQ9Y,EAAMf,EAAK8M,IAAK9M,EAAK6L,IAAK,CAC3CoG,MAAOjS,EAAKiS,MACZwC,SAAUzU,EAAKyU,SACf/K,MAAO1J,EAAK0J,MACZC,OAAQ3J,EAAK2J,OACbgF,OAAQ3O,EAAK2O,OACb7J,MAAO9E,EAAK8E,MACZtE,MAAOR,EAAKQ,MACZE,GAAIV,EAAKU,GACTkO,SAAU,EAAA7R,MAAM8M,YAAY7J,EAAK4O,aA5MvC,YAuNA,IAAIirB,EAAsB,CAAC94B,EAAY+D,KAC9B,CACLnH,MAAO,OACP6vB,WAAY,OACZsM,UAAW,EACX1B,iBAA8B,IAAVtzB,EAAwBA,EAAQ,EAA4B,IAAvB/D,EAAKP,MAAMgb,UAAmB,IAuBvFoe,EAAyB74B,IACpB,CACL4N,OAA+B,EAAvB5N,EAAKP,MAAMgb,UACnB1W,MAAO/D,EAAKP,MAAMgb,a,6FChQtB,gBAKExe,YAAmB+8B,EAA2CC,GAA3C,KAAAD,WAAAA,EAA2C,KAAAC,qBAAAA,EAC5D98B,KAAKjB,KAAO,KACZiB,KAAK+8B,kBAAoB,GACzB/8B,KAAKmP,KAAO,EAGdsC,OAAO5N,GACL,OAAKA,EACEA,EAAK4N,OADM,EAGpBurB,YAAYn5B,GACV,IAAIo5B,EAAUp5B,EAAK+f,KAOnB,OANA/f,EAAK+f,KAAOqZ,EAAQC,MACpBD,EAAQC,MAAQr5B,EAEhBA,EAAK4N,OAAS7Q,KAAK+N,IAAI9K,EAAK+f,KAAO/f,EAAK+f,KAAKnS,OAAS,EAAG5N,EAAKq5B,MAAQr5B,EAAKq5B,MAAMzrB,OAAS,GAAK,EAC/FwrB,EAAQxrB,OAAS7Q,KAAK+N,IAAIsuB,EAAQrZ,KAAOqZ,EAAQrZ,KAAKnS,OAAS,EAAGwrB,EAAQC,MAAQD,EAAQC,MAAMzrB,OAAS,GAAK,EAEvGwrB,EAETE,WAAWt5B,GACT,IAAIo5B,EAAUp5B,EAAKq5B,MAOnB,OANAr5B,EAAKq5B,MAAQD,EAAQrZ,KACrBqZ,EAAQrZ,KAAO/f,EAEfA,EAAK4N,OAAS7Q,KAAK+N,IAAI9K,EAAK+f,KAAO/f,EAAK+f,KAAKnS,OAAS,EAAG5N,EAAKq5B,MAAQr5B,EAAKq5B,MAAMzrB,OAAS,GAAK,EAC/FwrB,EAAQxrB,OAAS7Q,KAAK+N,IAAIsuB,EAAQrZ,KAAOqZ,EAAQrZ,KAAKnS,OAAS,EAAGwrB,EAAQC,MAAQD,EAAQC,MAAMzrB,OAAS,GAAK,EAEvGwrB,EAETG,WAAWv5B,GACT,OAAKA,GACGA,EAAK+f,KAAO/f,EAAK+f,KAAKnS,OAAS,IAAM5N,EAAKq5B,MAAQr5B,EAAKq5B,MAAMzrB,OAAS,GAD5D,EAIpB5G,IAAI/H,GACF,IAAIu6B,EAAgC,CAAEx5B,KAAM,MAI5C,OAHA7D,KAAKjB,KAAOiB,KAAKs9B,QAAQt9B,KAAKjB,KAAM+D,EAAMu6B,GAC1Cr9B,KAAK+8B,kBAAkB/8B,KAAK88B,qBAAqBh6B,IAASu6B,EAAIx5B,KAC9D7D,KAAKmP,MAAQ,EACNkuB,EAAIx5B,KAELy5B,QAAQz5B,EAAsBf,EAASu6B,GAC7C,IAAKx5B,EAAM,CACT,IAAI05B,EAAU,IAAIC,EAAY,CAAC16B,IAE/B,OADAu6B,EAAIx5B,KAAO05B,EACJA,EAIT,GAA4C,IAAxCv9B,KAAK68B,WAAW/5B,EAAMe,EAAKf,KAAK,IAGlC,OAFAe,EAAKf,KAAKf,KAAKe,GACfu6B,EAAIx5B,KAAOA,EACJA,EAGL7D,KAAK68B,WAAW/5B,EAAMe,EAAKf,KAAK,IAAM,EAAGe,EAAK+f,KAAO5jB,KAAKs9B,QAAQz5B,EAAK+f,KAAM9gB,EAAMu6B,GAClFx5B,EAAKq5B,MAAQl9B,KAAKs9B,QAAQz5B,EAAKq5B,MAAOp6B,EAAMu6B,GAEjDx5B,EAAK4N,OAAS,EAAI7Q,KAAK+N,IAAI9K,EAAK+f,KAAO/f,EAAK+f,KAAKnS,OAAS,EAAG5N,EAAKq5B,MAAQr5B,EAAKq5B,MAAMzrB,OAAS,GAC9F,IAAIgsB,EAAUz9B,KAAKo9B,WAAWv5B,GAE9B,OAAI45B,EAAU,GAAKz9B,KAAK68B,WAAW/5B,EAAMe,EAAK+f,KAAK9gB,KAAK,IAAM,EAAU9C,KAAKg9B,YAAYn5B,GACrF45B,EAAU,GAAKz9B,KAAK68B,WAAW/5B,EAAMe,EAAK+f,KAAK9gB,KAAK,IAAM,GAC5De,EAAK+f,KAAO5jB,KAAKm9B,WAAWt5B,EAAK+f,MAC1B5jB,KAAKg9B,YAAYn5B,IAEtB45B,GAAW,GAAKz9B,KAAK68B,WAAW/5B,EAAMe,EAAKq5B,MAAMp6B,KAAK,IAAM,EAAU9C,KAAKm9B,WAAWt5B,GACtF45B,GAAW,GAAKz9B,KAAK68B,WAAW/5B,EAAMe,EAAKq5B,MAAMp6B,KAAK,IAAM,GAC9De,EAAKq5B,MAAQl9B,KAAKg9B,YAAYn5B,EAAKq5B,OAC5Bl9B,KAAKm9B,WAAWt5B,IAGlBA,EAGTkT,OAAOjU,GACL,IAAIu6B,EAA4B,CAAEK,SAAS,GAI3C,OAHA19B,KAAKjB,KAAOiB,KAAK29B,QAAQ39B,KAAKjB,KAAM+D,EAAMu6B,UACnCr9B,KAAK+8B,kBAAkB/8B,KAAK88B,qBAAqBh6B,IACxD9C,KAAKmP,MAAQ,EACNkuB,EAAIK,QAELC,QAAQ95B,EAAsBf,EAASu6B,GAC7C,IAAKx5B,EAAM,OAAOA,EAElB,GAAI7D,KAAK68B,WAAW/5B,EAAMe,EAAKf,KAAK,IAAM,EAAGe,EAAK+f,KAAO5jB,KAAK29B,QAAQ95B,EAAK+f,KAAM9gB,EAAMu6B,QAClF,GAAIr9B,KAAK68B,WAAW/5B,EAAMe,EAAKf,KAAK,IAAM,EAAGe,EAAKq5B,MAAQl9B,KAAK29B,QAAQ95B,EAAKq5B,MAAOp6B,EAAMu6B,OACzF,CAEH,GAAIx5B,EAAKf,KAAK1B,OAAS,EAAG,CACxB,IAAIe,EAAQ0B,EAAKf,KAAK6d,WAAUid,GAAY59B,KAAK88B,qBAAqBc,KAAc59B,KAAK88B,qBAAqBh6B,KAO9G,OANIX,GAAS,GACX0B,EAAKf,KAAKkC,OAAO7C,EAAO,GACxBk7B,EAAIK,SAAU,GAEdL,EAAIK,SAAU,EAET75B,EAEP,GAAKA,EAAK+f,MAAS/f,EAAKq5B,MAUjB,CACL,IAAI1K,EAAOxyB,KAAK69B,SAASh6B,EAAKq5B,OAC9Br5B,EAAKf,KAAO0vB,EAAK1vB,KACjBe,EAAKq5B,MAAQl9B,KAAK29B,QAAQ95B,EAAKq5B,MAAO1K,EAAK1vB,KAAK,GAAIu6B,GACpDA,EAAIK,SAAU,MAde,CAC7B,IAAIlL,EAAO,KAENA,EADA3uB,EAAK+f,KACE/f,EAAK+f,KADM/f,EAAKq5B,MAMrBr5B,EAHF2uB,GAEI,KAET6K,EAAIK,SAAU,GASpB,IAAK75B,EAAM,OAAOA,EAElBA,EAAK4N,OAAS7Q,KAAK+N,IAAI9K,EAAK+f,KAAO/f,EAAK+f,KAAKnS,OAAS,EAAG5N,EAAKq5B,MAAQr5B,EAAKq5B,MAAMzrB,OAAS,GAAK,EAC/F,IAAIgsB,EAAUz9B,KAAKo9B,WAAWv5B,GAE9B,OAAI45B,EAAU,GAAKz9B,KAAKo9B,WAAWv5B,EAAK+f,OAAS,EAAU5jB,KAAKg9B,YAAYn5B,GACxE45B,EAAU,GAAKz9B,KAAKo9B,WAAWv5B,EAAK+f,MAAQ,GAC9C/f,EAAK+f,KAAO5jB,KAAKm9B,WAAWt5B,EAAK+f,MAC1B5jB,KAAKg9B,YAAYn5B,IAEtB45B,GAAW,GAAKz9B,KAAKo9B,WAAWv5B,EAAKq5B,QAAU,EAAUl9B,KAAKm9B,WAAWt5B,GACzE45B,GAAW,GAAKz9B,KAAKo9B,WAAWv5B,EAAKq5B,OAAS,GAChDr5B,EAAKq5B,MAAQl9B,KAAKg9B,YAAYn5B,EAAKq5B,OAC5Bl9B,KAAKm9B,WAAWt5B,IAElBA,EAGTg6B,SAASh6B,GACP,IAAI6K,EAAO7K,EACX,KAAO6K,EAAKkV,MAAMlV,EAAOA,EAAKkV,KAC9B,OAAOlV,EAET5M,QAAQg8B,GACN99B,KAAK+9B,SAAS/9B,KAAKjB,KAAM++B,GAGnBC,SAASl6B,EAAsBi6B,GACxB,OAATj6B,IACF7D,KAAK+9B,SAASl6B,EAAK+f,KAAMka,GACzBj6B,EAAKf,KAAKhB,SAAQgB,GAAQg7B,EAAOh7B,KACjC9C,KAAK+9B,SAASl6B,EAAKq5B,MAAOY,IAGtBE,gBAAgBn6B,EAAsBi6B,GAC/B,OAATj6B,IACF7D,KAAK+9B,SAASl6B,EAAKq5B,MAAOY,GAC1Bj6B,EAAKf,KAAKhB,SAAQgB,GAAQg7B,EAAOh7B,KACjC9C,KAAK+9B,SAASl6B,EAAK+f,KAAMka,MAM/B,MAAaN,EAKX19B,YAAmBgD,GAAA,KAAAA,KAAAA,EACjB9C,KAAKyR,OAAS,EACdzR,KAAK4jB,KAAO,KACZ5jB,KAAKk9B,MAAQ,MARjB,iB,4ECtKA,cAIEp9B,cACEE,KAAKyC,IAAM,IAAI2G,IACfpJ,KAAKi+B,WAAa,IAAI70B,IAGxB3F,IAAIy6B,GACF,OAAOl+B,KAAKyC,IAAIgB,IAAIy6B,IAAal+B,KAAKi+B,WAAWx6B,IAAIy6B,GAEvDtzB,IAAIwG,EAAY2D,GACd/U,KAAKyC,IAAImI,IAAIwG,EAAK2D,GAClB/U,KAAKi+B,WAAWrzB,IAAImK,EAAO3D,GAE7B9C,IAAI4vB,GACF,OAAOl+B,KAAKyC,IAAI6L,IAAI4vB,IAAal+B,KAAKi+B,WAAW3vB,IAAI4vB,GAEvDnyB,OAAOmyB,GACL,IAAIC,EAAQn+B,KAAKyC,IAAIgB,IAAIy6B,GACrBE,EAAQp+B,KAAKi+B,WAAWx6B,IAAIy6B,QACX,IAAVC,GAAyBn+B,KAAKyC,IAAIsJ,OAAOmyB,QAC/B,IAAVE,GAAyBp+B,KAAKi+B,WAAWlyB,OAAOmyB,GAG3Dl+B,KAAKyC,IAAIsJ,OAAOoyB,GAChBn+B,KAAKi+B,WAAWlyB,OAAOoyB,GACvBn+B,KAAKyC,IAAIsJ,OAAOqyB,GAChBp+B,KAAKi+B,WAAWlyB,OAAOqyB,GAEzBrR,QACE/sB,KAAKyC,IAAIsqB,QACT/sB,KAAKi+B,WAAWlR,W,mFClCpB,gBACA,UACA,UAEA,MAAasR,EAgGXv+B,YAAmBw+B,GAAA,KAAAA,UAAAA,EAJnB,KAAAC,QAAmC,GACnC,KAAAC,aAAyB,GACzB,KAAAC,aAAuB,EAE8Bz+B,KAAK0+B,OAAS,IAAI,EAAAC,OAEvEC,SAASC,EAAc18B,GACrB,IAAI28B,EACJ,GAAI9+B,KAAKu+B,QAAQM,GAAOC,EAAU9+B,KAAKu+B,QAAQM,OAC1C,CACH,GAAI7+B,KAAKw+B,aAAap9B,SAAWpB,KAAKy+B,aAAc,CAClD,IAAIM,EAAa/+B,KAAKw+B,aAAazvB,eAC5B/O,KAAKu+B,QAAQQ,GAEtB/+B,KAAKw+B,aAAaz8B,KAAK88B,GACvB7+B,KAAKu+B,QAAQM,GAAQ7+B,KAAK0+B,OAAO3Q,MAAM8Q,GACvCC,EAAU9+B,KAAKu+B,QAAQM,GAEzB,IAAIlK,EAAmB,GAEvB,IAAK,IAAIqK,KAASF,EAChB,OAAQE,EAAMz5B,MACZ,KAAK,EAAA05B,UAAUC,QACbvK,EAAO5yB,KAAKi9B,EAAMjqB,OAClB,MAEF,KAAK,EAAAkqB,UAAUE,SAEb,GAAIH,EAAMjqB,QAAWiqB,EAAMjqB,MAAiBqqB,cAAe,CACzD,IAAK39B,MAAMC,QAAQ1B,KAAKs+B,UAAUU,EAAMjqB,QACtC,MAAM,IAAIsqB,MAAM,qDAAwDL,EAAMjqB,MAAiBqqB,eAC1FzK,EAAO5yB,KAAK/B,KAAKs+B,UAAUU,EAAMjqB,aAEpCtT,MAAMC,QAAQ1B,KAAKs+B,UAAUU,EAAMjqB,cAA4B,IAAV5S,EACvDwyB,EAAO5yB,KAAK/B,KAAKs+B,UAAUU,EAAMjqB,OAAO5S,IAExCwyB,EAAO5yB,KAAK/B,KAAKs+B,UAAUU,EAAMjqB,QAGrC,MAEF,KAAK,EAAAkqB,UAAUK,SAAU,CACvB,IAAK1b,EAAMsZ,GAAS,CAACvI,EAAO/T,MAAO+T,EAAO/T,OAC1C,GAAoB,iBAATgD,GAAsC,iBAAVsZ,EAAoB,MAAM,IAAImC,MAAM,0CAE3E,OAAQL,EAAMjqB,OACZ,IAAK,IAAO4f,EAAO5yB,KAAK6hB,EAAOsZ,GAAQ,MACvC,IAAK,IAAOvI,EAAO5yB,KAAK6hB,EAAOsZ,GAAQ,MACvC,IAAK,IAAOvI,EAAO5yB,KAAKm7B,EAAQtZ,GAAO,MACvC,IAAK,IAAO+Q,EAAO5yB,KAAKm7B,EAAQtZ,GAAO,MACvC,IAAK,IAAO+Q,EAAO5yB,KAAKm7B,EAAQtZ,GAAO,MACvC,IAAK,IAAO+Q,EAAO5yB,KAAKnB,KAAKsiB,IAAIga,EAAOtZ,IAAQ,MAChD,IAAK,IAAO+Q,EAAO5yB,KAAKm7B,EAAQtZ,GAAO,MACvC,IAAK,IAAO+Q,EAAO5yB,KAAKm7B,EAAQtZ,GAAO,MACvC,QAAS,MAAM,IAAIyb,MAAM,oBAAsBL,EAAMjqB,OAEvD,MAEF,KAAK,EAAAkqB,UAAUM,SAAU,CACvB,IAAI9pB,EAAO,GACX,IAAK,IAAInW,EAAI,EAAGA,EAAI0/B,EAAMQ,MAAOlgC,GAAK,EAAGmW,EAAK1T,KAAK4yB,EAAO/T,OAC1D+T,EAAO5yB,KAAMs8B,EAAUoB,UAAkBT,EAAMjqB,UAAUU,IACzD,MAEF,QAAS,MAAM,IAAI4pB,MAAM,uBAAyBL,EAAMz5B,MAI5D,OAAOovB,EAAO,IAhKlB,cAES,EAAA+K,UAAY,CACjBC,IAAK,EAAA9f,SAASC,IACd8f,GAAIh/B,KAAKmuB,GACT8Q,IAAK,EAAAhgB,SAASoP,IACd6Q,IAAKl/B,KAAKm/B,IACVC,KAAMp/B,KAAKq/B,KACXC,MAAOt/B,KAAKu/B,MACZC,OAAQx/B,KAAKy/B,QAER,EAAAZ,UAAY,CACjB3M,IAAKlyB,KAAKkyB,IACVwN,KAAM1/B,KAAK0/B,KACXC,MAAO3/B,KAAK2/B,MACZxN,IAAKnyB,KAAKmyB,IACVyN,KAAM5/B,KAAK4/B,KACXC,MAAO7/B,KAAK6/B,MACZC,IAAK9/B,KAAK8/B,IACVC,KAAM//B,KAAK+/B,KACXC,MAAOhgC,KAAKggC,MACZ1N,MAAOtyB,KAAKsyB,MACZ7Q,IAAKzhB,KAAKyhB,IACV/f,KAAM1B,KAAK0B,KACXM,MAAOhC,KAAKgC,MACZ/B,MAAOD,KAAKC,MACZggC,IAAKjgC,KAAKigC,IACVxrB,OAAQzU,KAAKyU,OACb4N,KAAMriB,KAAKqiB,KACX6d,KAAMlgC,KAAKkgC,KACXC,MAAOngC,KAAKmgC,MACZC,KAAMpgC,KAAKogC,KACX1wB,IAAK,CAACyE,EAAeksB,IAA2BA,EAAQrgC,KAAK0P,IAAIyE,GAASnU,KAAK0P,IAAI2wB,GAASrgC,KAAK0P,IAAIyE,GACrGmsB,KAAM,CAACC,EAAYC,EAAYre,EAAYC,IAAwBpiB,KAAKqiB,KAAKriB,KAAKsiB,IAAIH,EAAKoe,EAAI,GAAKvgC,KAAKsiB,IAAIF,EAAKoe,EAAI,IACtHC,IAAK,CAAChiC,EAAWqK,KAAgB,KAAa,IAANA,GAAS,CAAE,MAAM43B,EAAIjiC,EAAIqK,EAAGrK,EAAIqK,EAAGA,EAAI43B,EAAK,OAAOjiC,EAAI,GAAKA,EAAIA,GACxGsP,IAAK,IAAI8G,IAAyBhU,MAAMC,QAAQ+T,EAAK,IAAM7U,KAAK+N,OAAO8G,EAAK,IAAM7U,KAAK+N,OAAO8G,GAC9F7F,IAAK,IAAI6F,IAAyBhU,MAAMC,QAAQ+T,EAAK,IAAM7U,KAAKgP,OAAO6F,EAAK,IAAM7U,KAAKgP,OAAO6F,GAC9F8rB,MAAO,IAAI9rB,KACT,IAAIkf,EAAS,EACT6M,EAAU,EAYd,OAXY//B,MAAMC,QAAQ+T,EAAK,IAAMA,EAAK,GAAKA,GACzC3T,SAAQ4E,IACZ,MAAMqO,EAAQnU,KAAKyhB,IAAI3b,GACnB86B,EAAUzsB,GACZ4f,EAASA,GAAU6M,EAAUzsB,IAAUysB,EAAUzsB,GACjD4f,GAAU,EACV6M,EAAUzsB,GAEV4f,GAAmB5f,EAAQ,EAAMA,EAAQysB,GAAYzsB,EAAQysB,GAAYzsB,KAGtEysB,EAAU5gC,KAAKqiB,KAAK0R,IAE7B8M,IAAK,CAACpiC,EAAWqK,KACf,GAAU,IAANrK,EAAS,OAAOA,EACpB,GAAU,IAANqK,EAAS,OAAOA,EACpB,MAAMg4B,EAAOriC,EAAIqK,EACjB,KAAa,IAANA,GAAS,CAAE,MAAMzH,EAAIyH,EAAGA,EAAIrK,EAAI4C,EAAG5C,EAAI4C,EAC9C,OAAOrB,KAAKyhB,IAAIqf,EAAOriC,IAEzBsiC,IAAK,IAAIlsB,KACKhU,MAAMC,QAAQ+T,EAAK,IAAMA,EAAK,GAAKA,GAClCjH,QAAO,CAACC,EAAKC,IAASD,EAAMC,GAAM,GAEjDkzB,KAAM,IAAInsB,KACR,IAAIjJ,EAAQ/K,MAAMC,QAAQ+T,EAAK,IAAMA,EAAK,GAAKA,EAC/C,OAAO4oB,EAAUoB,UAAUkC,IAAIn1B,GAASA,EAAMpL,QAEhDygC,OAAQ,IAAIpsB,KACV,IAAIjJ,EAAQ/K,MAAMC,QAAQ+T,EAAK,IAAMA,EAAK,GAAKA,EAE/C,OADAjJ,EAAMyoB,MAAK,CAAC51B,EAAGqK,IAAMrK,EAAIqK,IAClB8C,EAAMpL,OAAS,GAAM,GAAKoL,EAAMA,EAAMpL,OAAS,EAAI,GAAKoL,EAAMA,EAAMpL,OAAS,IAAM,EAAIoL,EAAM5L,KAAKC,MAAM2L,EAAMpL,OAAS,KAEhI0gC,IAAK,IAAIrsB,KACP,IAAIjJ,EAAQ/K,MAAMC,QAAQ+T,EAAK,IAAMA,EAAK,GAAKA,EAC/C,OAAO7U,KAAKqiB,KAAKob,EAAUoB,UAAUsC,IAAIv1B,KAE3Cu1B,IAAK,IAAItsB,KACP,IAAIjJ,EAAQ/K,MAAMC,QAAQ+T,EAAK,IAAMA,EAAK,GAAKA,EAC3CmsB,EAAOvD,EAAUoB,UAAUmC,KAAKp1B,GACpC,OAAOA,EAAMgC,QAAO,CAACC,EAAKC,IAASD,EAAM7N,KAAKsiB,IAAIxU,EAAOkzB,EAAM,IAAI,GAAKp1B,EAAMpL,QAEhF4gC,KAAOC,IACL,IAAI5E,EAAM,EACV,IAAK,IAAI/9B,EAAI2iC,EAAG3iC,EAAI,EAAGA,GAAK,EAAG+9B,GAAO/9B,EACtC,OAAO+9B,IAGJ,EAAA6E,kBAAoB,CAAC,MAAO,MAAO,QAAS,MAAO,OAAQ,SAAU,MAAO,Q,+YC5FrF,aACA,aACA,aACA,aACA,aACA,aACA,YACA,a,mGCPA,gBAEA,MAAaC,EAMXriC,cAJQ,KAAA60B,OAAkB,GAClB,KAAAyN,aAAyB,GACzB,KAAAC,aAAyB,GAIjCC,SAASzD,GAMP,IAAI18B,EACJ,IANAnC,KAAK20B,OAAS,GACd30B,KAAKoiC,aAAe,GACpBpiC,KAAKqiC,aAAe,IAIsB,KAAlClgC,EAAQ08B,EAAK55B,QAAQ,SAC3B45B,EAAOA,EAAKlF,UAAU,EAAGx3B,GAAS08B,EAAK0D,OAAOpgC,EAAQ,GAAGqgC,cAAgB3D,EAAKlF,UAAUx3B,EAAQ,GAgDlG,OA7CA08B,EAAO7+B,KAAKyiC,iBAAiB5D,IACZhqB,QAAQ,OAAQ,IAAI6tB,MAAM,IAErC5gC,SAAQ6gC,IACZ,GAAI3iC,KAAK4iC,QAAQD,GACf3iC,KAAKoiC,aAAargC,KAAK4gC,QAClB,GAAI3iC,KAAK6iC,eAAeF,GAC7B3iC,KAAKoiC,aAAargC,KAAK4gC,QAClB,GAAI3iC,KAAK8iC,SAASH,GACnB3iC,KAAKoiC,aAAahhC,SACpBpB,KAAK+iC,sBACL/iC,KAAK20B,OAAO5yB,KAAK,IAAIihC,EAAM/D,EAAUK,SAAU,OAGjDt/B,KAAKqiC,aAAatgC,KAAK4gC,QAClB,GAAI3iC,KAAKijC,WAAWN,GACrB3iC,KAAKoiC,aAAahhC,OAAQpB,KAAK+iC,sBAC1B/iC,KAAKqiC,aAAajhC,QAAQpB,KAAKkjC,sBAExCljC,KAAK20B,OAAO5yB,KAAK,IAAIihC,EAAM/D,EAAUK,SAAUqD,SAC1C,GAAI3iC,KAAKmjC,kBAAkBR,GAC5B3iC,KAAKqiC,aAAajhC,QACpBpB,KAAK20B,OAAO5yB,KAAK,IAAIihC,EAAM/D,EAAUM,SAAUv/B,KAAKqiC,aAAae,KAAK,MACtEpjC,KAAKqiC,aAAe,IACXriC,KAAKoiC,aAAahhC,SAC3BpB,KAAK+iC,sBACL/iC,KAAK20B,OAAO5yB,KAAK,IAAIihC,EAAM/D,EAAUK,SAAU,OAGjDt/B,KAAK20B,OAAO5yB,KAAK,IAAIihC,EAAM/D,EAAUoE,aAAcV,SAC9C,GAAI3iC,KAAKsjC,mBAAmBX,GAC7B3iC,KAAKqiC,aAAajhC,QAAQpB,KAAKkjC,sBAC/BljC,KAAKoiC,aAAahhC,QAAQpB,KAAK+iC,sBAEnC/iC,KAAK20B,OAAO5yB,KAAK,IAAIihC,EAAM/D,EAAUsE,aAAcZ,QAC9C,KAAI3iC,KAAKwjC,QAAQb,GAKjB,MAAMtD,MAAM,sBAAwBsD,GAJrC3iC,KAAKoiC,aAAahhC,QAAQpB,KAAK+iC,sBAC/B/iC,KAAKqiC,aAAajhC,QAAQpB,KAAKkjC,sBAEnCljC,KAAK20B,OAAO5yB,KAAK,IAAIihC,EAAM/D,EAAUwE,aAAcd,QAGnD3iC,KAAKoiC,aAAahhC,QAAQpB,KAAK+iC,sBAC/B/iC,KAAKqiC,aAAajhC,QAAQpB,KAAKkjC,sBAE5BljC,KAAK20B,OAEN8N,iBAAiB5D,GACvB,OAAOA,EACJhqB,QAAQ,MAAO,EAAAwpB,UAAUqB,UAAUE,GAAGz+B,YACtC0T,QAAQ,OAAQ,EAAAwpB,UAAUqB,UAAUC,IAAIx+B,YACxC0T,QAAQ,OAAQ,EAAAwpB,UAAUqB,UAAUG,IAAI1+B,YACxC0T,QAAQ,OAAQ,EAAAwpB,UAAUqB,UAAUI,IAAI3+B,YACxC0T,QAAQ,QAAS,EAAAwpB,UAAUqB,UAAUM,KAAK7+B,YAC1C0T,QAAQ,SAAU,EAAAwpB,UAAUqB,UAAUQ,MAAM/+B,YAC5C0T,QAAQ,UAAW,EAAAwpB,UAAUqB,UAAUU,OAAOj/B,YAE3C4hC,sBACN,IAAIW,EAAU1L,WAAWh4B,KAAKoiC,aAAagB,KAAK,KAChDpjC,KAAKoiC,aAAe,GACfuB,MAAMD,IAAY1jC,KAAK20B,OAAO5yB,KAAK,IAAIihC,EAAM/D,EAAUC,QAASwE,IAE/DR,sBACN,IAAK,IAAI5jC,EAAI,EAAGA,EAAIU,KAAKqiC,aAAajhC,OAAQ9B,IAC5CU,KAAK20B,OAAO5yB,KAAK,IAAIihC,EAAM/D,EAAUE,SAAUn/B,KAAKqiC,aAAa/iC,KAC7DA,EAAIU,KAAKqiC,aAAajhC,OAAS,GAAGpB,KAAK20B,OAAO5yB,KAAK,IAAIihC,EAAM/D,EAAUK,SAAU,MAEvFt/B,KAAKqiC,aAAe,GAEdmB,QAAQb,GAAgB,MAAiB,MAATA,EAChCC,QAAQD,GAAgB,MAAO,KAAKiB,KAAKjB,GACzCG,SAASH,GAAgB,MAAO,WAAWiB,KAAKjB,GAChDM,WAAWN,GAAgB,OAAOR,EAAM0B,UAAUh/B,SAAS89B,GAC3DQ,kBAAkBR,GAAgB,MAAgB,MAATA,EACzCW,mBAAmBX,GAAgB,MAAe,KAARA,EAC1CE,eAAeF,GAAgB,MAAgB,MAATA,GAGhD,IAAY1D,EAjGZ,UACS,EAAA4E,UAAY,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAgGzD,SAAY5E,GACV,oBACA,sBACA,sBACA,8BACA,8BACA,sBACA,8BAPF,CAAYA,EAAA,EAAAA,YAAA,EAAAA,UAAS,KAUrB,MAAa+D,EA0BXljC,YAAmByF,EAAwBwP,GAAxB,KAAAxP,KAAAA,EAAwB,KAAAwP,MAAAA,EAA0B/U,KAAKw/B,MAAQ,EAH9EsE,iBAAuB,OAAQd,EAAMc,WAAmB9jC,KAAK+U,OAC7DgvB,oBAA0B,OAAQf,EAAMe,cAAsB/jC,KAAK+U,OAIvE5T,WAAqB,OAAOnB,KAAKuF,KAAO,IAAMvF,KAAK+U,MAAQ,KA5B7D,UACS,EAAAgvB,cAAgB,CACrB,IAAK,QACL,IAAK,OACL,IAAK,OACL,IAAK,OACL,IAAK,OACL,IAAK,OACL,IAAK,OACL,IAAK,QAEA,EAAAD,WAAa,CAClB,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,I,yFChIT,gBAEA,MAAa/zB,UAAgB,EAAA/M,MAK3BlD,YAAmB+8B,EAAqCx3B,GACtDjC,QADiB,KAAAy5B,WAAAA,EAJnB,KAAAmH,KAAoB,KACpB,KAAAC,KAAoB,KACpB,KAAA7iC,OAAiB,EAIXiE,GAAQA,EAAOvD,SAAQiT,GAAS/U,KAAKgQ,OAAO+E,KAGlDmhB,QAAQpzB,GACN,IAAIy6B,EAAU,IAAI2G,EAASphC,GAY3B,OAXkB,OAAd9C,KAAKgkC,MACPhkC,KAAKgkC,KAAOzG,EACZv9B,KAAKikC,KAAO1G,IAEZv9B,KAAKgkC,KAAKpO,KAAO2H,EACjBA,EAAQ7iB,KAAO1a,KAAKgkC,KACpBhkC,KAAKgkC,KAAOzG,GAGdv9B,KAAKoB,QAAU,EACfpB,KAAKsE,KAAK,UAAWtE,KAAMu9B,GACpBA,EAETvtB,OAAOlN,GACL,IAAIy6B,EAAUz6B,aAAgBohC,EAAWphC,EAAO,IAAIohC,EAASphC,GAY7D,OAXkB,OAAd9C,KAAKikC,MACPjkC,KAAKgkC,KAAOzG,EACZv9B,KAAKikC,KAAO1G,IAEZv9B,KAAKikC,KAAKvpB,KAAO6iB,EACjBA,EAAQ3H,KAAO51B,KAAKikC,KACpBjkC,KAAKikC,KAAO1G,GAGdv9B,KAAKoB,QAAU,EACfpB,KAAKsE,KAAK,SAAUtE,KAAMu9B,GACnBA,EAETrtB,YAAYi0B,GAAgB,GAC1B,IAAIC,EACJ,OAAkB,OAAdpkC,KAAKgkC,KAAsB,MACN,IAAhBhkC,KAAKoB,QACZgjC,EAAUpkC,KAAKgkC,KAAKlhC,KACpB9C,KAAKgkC,KAAO,KACZhkC,KAAKikC,KAAO,OAEZG,EAAUpkC,KAAKgkC,KAAKlhC,KACpB9C,KAAKgkC,KAAKtpB,KAAKkb,KAAO,KACtB51B,KAAKgkC,KAAOhkC,KAAKgkC,KAAKtpB,MAGxB1a,KAAKoB,QAAU,EACX+iC,GAAMnkC,KAAKsE,KAAK,cAAetE,KAAMokC,GAClCA,GAETC,aACE,IAAID,EACJ,OAAkB,OAAdpkC,KAAKikC,KAAsB,MACN,IAAhBjkC,KAAKoB,QACZgjC,EAAUpkC,KAAKikC,KAAKnhC,KACpB9C,KAAKgkC,KAAO,KACZhkC,KAAKikC,KAAO,OAEZG,EAAUpkC,KAAKikC,KAAKnhC,KACpB9C,KAAKikC,KAAKrO,KAAKlb,KAAO,KACtB1a,KAAKikC,KAAOjkC,KAAKikC,KAAKrO,MAGxB51B,KAAKoB,QAAU,EACfpB,KAAKsE,KAAK,aAActE,KAAMokC,GACvBA,GAETjO,SAASrzB,EAASe,GAChB,IAAI05B,EAAU,IAAI2G,EAAYphC,GAQ9B,OAPAy6B,EAAQ7iB,KAAO7W,EAAK6W,KACpB6iB,EAAQ3H,KAAO/xB,EACfA,EAAK6W,KAAO6iB,EACRA,EAAQ7iB,OAAM6iB,EAAQ7iB,KAAKkb,KAAO2H,GAClC15B,IAAS7D,KAAKikC,OAAMjkC,KAAKikC,KAAO1G,GACpCv9B,KAAKoB,QAAU,EAERm8B,EAET+G,UAAUxhC,EAASe,GACjB,IAAI05B,EAAU,IAAI2G,EAAYphC,GAQ9B,OAPAy6B,EAAQ3H,KAAO/xB,EAAK+xB,KACpB2H,EAAQ7iB,KAAO7W,EACfA,EAAK+xB,KAAO2H,EACRA,EAAQ3H,OAAM2H,EAAQ3H,KAAKlb,KAAO6iB,GAClC15B,IAAS7D,KAAKgkC,OAAMhkC,KAAKgkC,KAAOzG,GACpCv9B,KAAKoB,QAAU,EAERm8B,EAETxxB,OAAOlI,GACe,IAAhB7D,KAAKoB,QACPpB,KAAKgkC,KAAO,KACZhkC,KAAKikC,KAAO,MAELpgC,IAAS7D,KAAKgkC,KACrBhkC,KAAKkQ,cACErM,IAAS7D,KAAKikC,KACrBjkC,KAAKqkC,cAEDxgC,EAAK+xB,OAAM/xB,EAAK+xB,KAAKlb,KAAO7W,EAAK6W,MACjC7W,EAAK6W,OAAM7W,EAAK6W,KAAKkb,KAAO/xB,EAAK+xB,MACrC51B,KAAKoB,QAAU,GAGnBmjC,WAAWz0B,GACT,IAAIpB,EAAO1O,KAAKgkC,KAChB,KAAgB,OAATt1B,GAAe,CACpB,GAAIoB,EAASpB,GAAO,OAAOA,EAC3BA,EAAOA,EAAKgM,KAEd,OAAO,KAETub,WAAWnmB,GACT,IAAIpB,EAAO1O,KAAKikC,KAChB,KAAgB,OAATv1B,GAAe,CACpB,GAAIoB,EAASpB,GAAO,OAAOA,EAC3BA,EAAOA,EAAKknB,KAEd,OAAO,KAETnyB,IAAItB,GACF,GAAIA,GAASnC,KAAKoB,OAAQ,OAAO,KAC5B,GAAc,IAAVe,EAAa,OAAOnC,KAAKgkC,KAAOhkC,KAAKgkC,KAAKlhC,KAAO,KACrD,GAAIX,IAAWnC,KAAKoB,OAAS,EAAI,OAAOpB,KAAKikC,KAAOjkC,KAAKikC,KAAKnhC,KAAO,KACrE,CACH,IAAI08B,EAAQ,EACR9wB,EAAO1O,KAAKgkC,KAChB,KAAgB,OAATt1B,GAAe,CACpB,GAAI8wB,IAAUr9B,EAAO,OAAOuM,EAAK5L,KACjC08B,GAAS,EACT9wB,EAAOA,EAAKgM,KAEd,OAAO,MAIX5Y,QAAQgO,GACN,IAAIpB,EAAO1O,KAAKgkC,KAChB,KAAgB,OAATt1B,GACLoB,EAASpB,GACTA,EAAOA,EAAKgM,KAGhBjY,IAAIqN,GACF,IAAI00B,EAAgB,GAEpB,OADAxkC,KAAK8B,SAAQ+B,GAAQ2gC,EAAOziC,KAAK+N,EAASjM,MACnC2gC,EAETlP,UACE,IAAIxyB,EAAY,GAEhB,OADA9C,KAAK8B,SAAQ+B,GAAQf,EAAKf,KAAK8B,EAAKf,QAC7BA,EAET3B,WACE,OAAOnB,KAAKs1B,UAAU8N,KAAK,OAjK/B,SAqKA,MAAac,EAKXpkC,YAAYgD,GACV9C,KAAK41B,KAAO,KACZ51B,KAAK0a,KAAO,KACZ1a,KAAK8C,KAAOA,GAAc,MAR9B,c,aCvKA,IAAY2hC,E,yEAAZ,SAAYA,GACV,qBAAW,qBAAW,mBAAU,mBAAU,iBAAS,qBAAW,2BADhE,CAAYA,EAAA,EAAAA,WAAA,EAAAA,SAAQ,KAIpB,MAAa9iC,EAGXjB,gBAAgB+U,GACVzV,KAAK0kC,UAAYD,EAASE,OAC9Bt0B,QAAQu0B,MAAMC,MAAM7kC,KAAMyV,GAE5B/U,gBAAgB+U,GACVzV,KAAK0kC,UAAYD,EAASK,OAC9Bz0B,QAAQ00B,MAAMF,MAAM7kC,KAAMyV,GAE5B/U,eAAe+U,GACTzV,KAAK0kC,UAAYD,EAASO,MAC9B30B,QAAQ40B,KAAKJ,MAAM7kC,KAAMyV,GAE3B/U,cAAc+U,GACRzV,KAAK0kC,UAAYD,EAASS,KAC9B70B,QAAQC,IAAIu0B,MAAM7kC,KAAMyV,GAE1B/U,eAAe+U,GACTzV,KAAK0kC,UAAYD,EAASU,MAC9B90B,QAAQ+0B,KAAKP,MAAM7kC,KAAMyV,GAE3B/U,gBAAgB+U,GACVzV,KAAK0kC,UAAYD,EAASY,OAC9Bh1B,QAAQzO,MAAMijC,MAAM7kC,KAAMyV,IAzB9B,QACS,EAAAivB,UAAsBD,EAASO,M,gFCLxC,gBAEA,eAGEllC,cAAgBE,KAAKslC,MAAQ,IAAI,EAAAnD,MAEzBoD,KAAKC,GAAc,OAAOA,EAAIvkC,OAAO,GAAG,GAEhD8sB,MAAM0X,GACJ,IAAIC,EAAS1lC,KAAKslC,MAAMhD,SAASmD,GAC7BzJ,EAAiB,GACjBvvB,EAAkB,GAClBk5B,EAAkB,GAClBC,EAAqB,GAoDzB,IAlDAF,EAAO5jC,SAAQk9B,IACb,GAAIA,EAAMz5B,OAAS,EAAA05B,UAAUC,SAAWF,EAAMz5B,OAAS,EAAA05B,UAAUE,SAC/D1yB,EAAO1K,KAAKi9B,QACmB,IAApBh/B,KAAKulC,KAAKI,KACnBA,EAAK/kB,MACL+kB,EAAK5jC,MAAK,SAEP,GAAIi9B,EAAMz5B,OAAS,EAAA05B,UAAUM,SAClCvD,EAAMj6B,KAAKi9B,GACX4G,EAAS7jC,KAAK,QACiB,IAApB/B,KAAKulC,KAAKI,KACnBA,EAAK/kB,MACL+kB,EAAK5jC,MAAK,IAEZ4jC,EAAK5jC,MAAK,QACL,GAAIi9B,EAAMz5B,OAAS,EAAA05B,UAAUwE,aAAc,CAChD,KAAOzjC,KAAKulC,KAAKvJ,IAAUh8B,KAAKulC,KAAKvJ,GAAOz2B,OAAS,EAAA05B,UAAUoE,cAC7D52B,EAAO1K,KAAKi6B,EAAMpb,OAEZ+kB,EAAK/kB,OACJglB,EAAS7jC,KAAK6jC,EAAShlB,MAAQ,GACxC+kB,EAAK5jC,MAAK,QACL,GAAIi9B,EAAMz5B,MAAQ,EAAA05B,UAAUK,SAAU,CAC3C,KAAOt/B,KAAKulC,KAAKvJ,IAAWh8B,KAAKulC,KAAKvJ,GAAOz2B,OAAS,EAAA05B,UAAUK,WAEnC,SAAxBN,EAAM+E,eAA4B/E,EAAM8E,YAAc9jC,KAAKulC,KAAKvJ,GAAO8H,YAC5C,UAAxB9E,EAAM+E,eAA6B/E,EAAM8E,WAAa9jC,KAAKulC,KAAKvJ,GAAO8H,aAG7Er3B,EAAO1K,KAAKi6B,EAAMpb,OAEpBob,EAAMj6B,KAAKi9B,QACN,GAAIA,EAAMz5B,OAAS,EAAA05B,UAAUoE,aAClCrH,EAAMj6B,KAAKi9B,QACN,GAAIA,EAAMz5B,OAAS,EAAA05B,UAAUsE,aAAc,CAChD,KAAOvjC,KAAKulC,KAAKvJ,IAAUh8B,KAAKulC,KAAKvJ,GAAOz2B,OAAS,EAAA05B,UAAUoE,cAC7D52B,EAAO1K,KAAKi6B,EAAMpb,OAIpB,GAFAob,EAAMpb,MAEF5gB,KAAKulC,KAAKvJ,IAAUh8B,KAAKulC,KAAKvJ,GAAOz2B,OAAS,EAAA05B,UAAUM,SAAU,CACpE,IAAIsG,EAAY7J,EAAMpb,MAClBvhB,EAAIumC,EAAShlB,MACT+kB,EAAK/kB,QACJvhB,GAAK,GACdwmC,EAAUrG,MAAQngC,EAClBoN,EAAO1K,KAAK8jC,QAIX7lC,KAAKulC,KAAKvJ,IAAUvvB,EAAO1K,KAAKi6B,EAAMpb,OAE7C,OAAOnU,K,6NCjEX,eAEa,EAAA/I,WAAa,KACxB,IAAIoiC,EAAK,KAA8B,OAArB,EAAIllC,KAAKyU,UAAuB,GAAGlU,SAAS,IAAIw4B,UAAU,GAC5E,OAAQmM,IAAO,IAAMA,IAAO,IAAMA,IAAO,IAAMA,KAEpC,EAAAxkC,UAAY,CAACyT,EAAenF,EAAajB,IAChDiB,IAAQjB,EAAY,GAChBoG,EAAQnF,IAAQjB,EAAMiB,GAEnB,EAAA6jB,YAAc,CAACsS,EAAoBn2B,EAAajB,KACnDA,EAAMiB,GAAOm2B,EAAan2B,EAEvB,EAAA9O,UAAY,CAAC8O,EAAajB,IAC9B/N,KAAKyU,UAAY1G,EAAMiB,GAAOA,EAE1B,EAAA2D,WAAa,CAACyyB,EAAiBC,EAAiBC,EAAeC,EAAeC,EAAiBC,EAAiBC,EAAeC,MAC9HH,EAAUF,GAASI,EAAQN,GAAWK,EAAUF,GAASI,EAAQN,GAErEG,EAAUJ,GAAWK,EAAUJ,GAAWK,EAAQJ,GAASK,EAAQJ,EAC7D,EAAA1mC,SAAS8Y,UADmE,EAAA9Y,SAAS+R,OAErF,EAAA/R,SAASuU,QAEZ,EAAA9R,MAAQ,CAAC6S,EAAenF,EAAajB,IACzC/N,KAAKgP,IAAIhP,KAAK+N,IAAIoG,EAAOnF,GAAMjB,GAE3B,EAAAhM,KAAO,CAACtD,EAAWqK,EAAWzH,KACjC,EAAIA,GAAK5C,EAAI4C,EAAIyH,EAEd,EAAAvE,WAAa,CAACE,EAAkBT,EAAuBc,EAAcxB,MAC3EU,IACDS,IAAWT,IACXS,EAAOxB,OAASe,EAAYf,OAC5BwB,EAAOE,OAASX,EAAYW,SAC3BG,EAAML,EAAOM,UAAUd,SAASD,EAAYe,aAC5CzB,EAAeiB,WAAWE,EAAOxB,KAAMe,EAAYf,UAG7C,EAAA2iC,QAAWC,IACtB,IAAK,IAAI9nB,KAAK8nB,EAAK,OAAO,EAC1B,OAAO,GAEI,EAAAC,UAAY,CAAC3xB,EAAenF,EAAajB,IAC7C/N,KAAKgP,IAAImF,EAAOnF,IAAQA,GAAOhP,KAAK+N,IAAIoG,EAAOpG,IAAQA,EAEnD,EAAA4Q,OAAUxK,GACd,MAAOA,EAEH,EAAAtR,IAAM,CAAIsR,EAAU4xB,IAC3B,MAAO5xB,EAAgD4xB,EACpD5xB,EAEI,EAAAykB,aAAe,EAAG7qB,IAAAA,EAAK8qB,SAAAA,EAAUG,MAAAA,MAC5C,IAAIhqB,EAAM,EACV,KAAOA,GAAOjB,GAAK,CACjB,IAAIi4B,EAAMhmC,KAAKC,OAAO+O,EAAMjB,GAAO,GACnC,MAAMD,EAAO+qB,EAASmN,GAEtB,GAAIl4B,IAASkrB,EAAO,OAAOgN,EACvBl4B,EAAOkrB,EAAOhqB,EAAMg3B,EAAM,EACzBj4B,EAAMi4B,EAAM,EAEnB,OAAOj4B,GAEI,EAAAmZ,KAAO,SClEhB+e,EAA2B,GAG/B,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqB3T,IAAjB4T,EACH,OAAOA,EAAa/nC,QAGrB,IAAIC,EAAS2nC,EAAyBE,GAAY,CAGjD9nC,QAAS,IAOV,OAHAgoC,EAAoBF,GAAUziC,KAAKpF,EAAOD,QAASC,EAAQA,EAAOD,QAAS6nC,GAGpE5nC,EAAOD,QAIf6nC,EAAoBI,EAAID,E/CzBpBznC,EAAW,GACfsnC,EAAoBK,EAAI,CAACxS,EAAQyS,EAAUC,EAAIC,KAC9C,IAAGF,EAAH,CAMA,IAAIG,EAAe1R,EAAAA,EACnB,IAASv2B,EAAI,EAAGA,EAAIE,EAAS4B,OAAQ9B,IAAK,CAGzC,IAFA,IAAK8nC,EAAUC,EAAIC,GAAY9nC,EAASF,GACpCkoC,GAAY,EACPC,EAAI,EAAGA,EAAIL,EAAShmC,OAAQqmC,MACpB,EAAXH,GAAsBC,GAAgBD,IAAap2B,OAAOC,KAAK21B,EAAoBK,GAAGO,OAAOt2B,GAAS01B,EAAoBK,EAAE/1B,GAAKg2B,EAASK,MAC9IL,EAASpiC,OAAOyiC,IAAK,IAErBD,GAAY,EACTF,EAAWC,IAAcA,EAAeD,IAG7C,GAAGE,EAAW,CACbhoC,EAASwF,OAAO1F,IAAK,GACrB,IAAIgiC,EAAI+F,SACEjU,IAANkO,IAAiB3M,EAAS2M,IAGhC,OAAO3M,EAvBN2S,EAAWA,GAAY,EACvB,IAAI,IAAIhoC,EAAIE,EAAS4B,OAAQ9B,EAAI,GAAKE,EAASF,EAAI,GAAG,GAAKgoC,EAAUhoC,IAAKE,EAASF,GAAKE,EAASF,EAAI,GACrGE,EAASF,GAAK,CAAC8nC,EAAUC,EAAIC,IgDL/BR,EAAoBa,EAAI,CAAClB,EAAKrvB,IAAUlG,OAAO2W,UAAU+f,eAAetjC,KAAKmiC,EAAKrvB,G,MCKlF,IAAIywB,EAAkB,CACrB,IAAK,GAaNf,EAAoBK,EAAEM,EAAKK,GAA0C,IAA7BD,EAAgBC,GAGxD,IAAIC,EAAuB,CAACC,EAA4BllC,KACvD,IAGIikC,EAAUe,GAHTV,EAAUa,EAAaC,GAAWplC,EAGhBxD,EAAI,EAC3B,GAAG8nC,EAASe,MAAM3kC,GAAgC,IAAxBqkC,EAAgBrkC,KAAa,CACtD,IAAIujC,KAAYkB,EACZnB,EAAoBa,EAAEM,EAAalB,KACrCD,EAAoBI,EAAEH,GAAYkB,EAAYlB,IAGhD,GAAGmB,EAAS,IAAIvT,EAASuT,EAAQpB,GAGlC,IADGkB,GAA4BA,EAA2BllC,GACrDxD,EAAI8nC,EAAShmC,OAAQ9B,IACzBwoC,EAAUV,EAAS9nC,GAChBwnC,EAAoBa,EAAEE,EAAiBC,IAAYD,EAAgBC,IACrED,EAAgBC,GAAS,KAE1BD,EAAgBT,EAAS9nC,IAAM,EAEhC,OAAOwnC,EAAoBK,EAAExS,IAG1ByT,EAAqB7oC,KAA+B,yBAAIA,KAA+B,0BAAK,GAChG6oC,EAAmBtmC,QAAQimC,EAAqB3a,KAAK,KAAM,IAC3Dgb,EAAmBrmC,KAAOgmC,EAAqB3a,KAAK,KAAMgb,EAAmBrmC,KAAKqrB,KAAKgb,K,GC7CvF,IAAIC,EAAsBvB,EAAoB,M,OAC9CuB,EAAsBvB,EAAoBK,EAAEkB,I","sources":["webpack://flow-connect/webpack/universalModuleDefinition","webpack://flow-connect/webpack/runtime/chunk loaded","webpack://flow-connect/./src/common/enums.ts","webpack://flow-connect/./src/common/index.ts","webpack://flow-connect/./src/core/color.ts","webpack://flow-connect/./src/core/connector.ts","webpack://flow-connect/./src/core/flow.ts","webpack://flow-connect/./src/core/graph.ts","webpack://flow-connect/./src/core/group.ts","webpack://flow-connect/./src/core/hooks.ts","webpack://flow-connect/./src/core/index.ts","webpack://flow-connect/./src/core/node.ts","webpack://flow-connect/./src/core/subflow-node.ts","webpack://flow-connect/./src/core/terminal.ts","webpack://flow-connect/./src/core/tunnel-node.ts","webpack://flow-connect/./src/core/vector.ts","webpack://flow-connect/./src/flow-connect.ts","webpack://flow-connect/./src/resource/audio-worklets.ts","webpack://flow-connect/./src/resource/constants.ts","webpack://flow-connect/./src/resource/icons.ts","webpack://flow-connect/./src/ui/2d-slider.ts","webpack://flow-connect/./src/ui/button.ts","webpack://flow-connect/./src/ui/container.ts","webpack://flow-connect/./src/ui/dial.ts","webpack://flow-connect/./src/ui/display.ts","webpack://flow-connect/./src/ui/envelope.ts","webpack://flow-connect/./src/ui/horizontal-layout.ts","webpack://flow-connect/./src/ui/image.ts","webpack://flow-connect/./src/ui/index.ts","webpack://flow-connect/./src/ui/input.ts","webpack://flow-connect/./src/ui/label.ts","webpack://flow-connect/./src/ui/radio-group.ts","webpack://flow-connect/./src/ui/select.ts","webpack://flow-connect/./src/ui/slider.ts","webpack://flow-connect/./src/ui/source.ts","webpack://flow-connect/./src/ui/stack.ts","webpack://flow-connect/./src/ui/toggle.ts","webpack://flow-connect/./src/ui/ui-node.ts","webpack://flow-connect/./src/ui/v-slider.ts","webpack://flow-connect/./src/utils/avl-tree.ts","webpack://flow-connect/./src/utils/bidirectional-map.ts","webpack://flow-connect/./src/utils/evaluator.ts","webpack://flow-connect/./src/utils/index.ts","webpack://flow-connect/./src/utils/lexer.ts","webpack://flow-connect/./src/utils/linked-list.ts","webpack://flow-connect/./src/utils/logger.ts","webpack://flow-connect/./src/utils/parser.ts","webpack://flow-connect/./src/utils/utils.ts","webpack://flow-connect/webpack/bootstrap","webpack://flow-connect/webpack/runtime/hasOwnProperty shorthand","webpack://flow-connect/webpack/runtime/jsonp chunk loading","webpack://flow-connect/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, function() {\nreturn ","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","/** To distinguish whether two rectangles are inside/intersecting/disconnected */\nexport enum ViewPort {\n  INSIDE = 'INSIDE',\n  OUTSIDE = 'OUTSIDE',\n  INTERSECT = 'INTERSECT'\n}\n\n/** Levels of Detail, affects rendering while zooming in/out */\nexport enum LOD {\n  LOD0,\n  LOD1,\n  LOD2\n}\n\nexport enum Align {\n  Left,\n  Center,\n  Right\n}\n\nexport enum GlobalEventType {\n  Emitter,\n  Receiver\n}\n","export * from './enums';\nexport * from './interfaces';\n","import { clamp, getRandom, lerp, normalize } from \"../utils/utils\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Log } from \"../utils/logger\";\n\nexport class Color implements Serializable {\n  hexValue: string;\n  rgbaValue: Uint8ClampedArray | number[];\n  rgbaString: string;\n  rgbaCSSString: string;\n\n  constructor(rgba: Uint8ClampedArray | number[]) {\n    this.rgbaValue = rgba;\n    this.hexValue = Color.rgbaToHex(this.rgbaValue);\n    this.rgbaString = Color.rgbaToString(this.rgbaValue);\n    this.rgbaCSSString = Color.rgbaToCSSString(this.rgbaValue);\n  }\n  isEqual(color: Color) {\n    return color.rgbaValue[0] === this.rgbaValue[0]\n      && color.rgbaValue[1] === this.rgbaValue[1]\n      && color.rgbaValue[2] === this.rgbaValue[2]\n      && color.rgbaValue[3] === this.rgbaValue[3];\n  }\n\n  static Random(): Color {\n    return new Color(new Uint8ClampedArray(\n      [Math.floor(getRandom(0, 255)), Math.floor(getRandom(0, 255)), Math.floor(getRandom(0, 255)), 255]\n    ));\n  }\n  static hexToRGBA(hex: string): Uint8ClampedArray {\n    return new Uint8ClampedArray([parseInt(hex.slice(1, 3), 16), parseInt(hex.slice(3, 5), 16), parseInt(hex.slice(5, 7), 16), parseInt(hex.slice(7, 9), 16)]);\n  }\n  private static _componentToHex(c: number) {\n    let hex = c.toString(16);\n    return hex.length === 1 ? '0' + hex : hex;\n  }\n  static rgbaToHex(rgba: number[] | Uint8ClampedArray): string {\n    return \"#\" + Color._componentToHex(rgba[0]) + Color._componentToHex(rgba[1]) + Color._componentToHex(rgba[2]) + Color._componentToHex(rgba[3]);\n  }\n  static rgbaToString(rgba: Uint8ClampedArray | number[]): string {\n    return `${rgba[0]}:${rgba[1]}:${rgba[2]}:${rgba[3]}`;\n  }\n  static rgbaToCSSString(rgba: Uint8ClampedArray | number[]): string {\n    return `rgba(${rgba[0]}, ${rgba[1]}, ${rgba[2]}, ${normalize(rgba[3], 0, 255).toFixed(3)})`;\n  }\n\n  /** A linear interpolator for given array of colors */\n  static scale(colors: Color[] | Uint8ClampedArray | string[] | number[][]): (t: number) => string {\n    if (!Array.isArray(colors)) {\n      Log.error('An array is expected to create a color scale');\n      return;\n    }\n    if (colors.length <= 1) {\n      Log.error('At least two colors are required to create a color scale');\n      return;\n    }\n\n    let colorObjs: Color[] = [];\n    if (colors[0] instanceof Uint8ClampedArray || (Array.isArray(colors[0]) && typeof colors[0][0] === 'number')) {\n      colors.forEach(color => colorObjs.push(new Color(color as any)));\n    } else if (typeof colors[0] === 'string') {\n      colors.forEach(color => colorObjs.push(new Color(Color.hexToRGBA(color as any))));\n    } else {\n      colorObjs = colors as any;\n    }\n\n    return (t) => {\n      t = clamp(t, 0, 1);\n\n      let index = (colorObjs.length - 1) * t;\n      let start = Math.floor(index);\n      let end = Math.ceil(index);\n\n      t = index - start;\n\n      let startColor = colorObjs[start], endColor = colorObjs[end];\n\n      let result = startColor.rgbaValue.map((component, i) => {\n        component = lerp(component, endColor.rgbaValue[i], t);\n        if (i < 3) component = Math.round(component);\n        return component;\n      });\n\n      return 'rgba(' + result + ')';\n    }\n  }\n\n  serialize(): SerializedColor {\n    return {\n      rgba: [this.rgbaValue[0], this.rgbaValue[1], this.rgbaValue[2], this.rgbaValue[3]]\n    }\n  }\n  static deSerialize(data: SerializedColor) {\n    return new Color(data.rgba);\n  }\n}\n\nexport interface SerializedColor {\n  rgba: number[]\n}\n","import { Vector2, SerializedVector2 } from \"./vector\";\nimport { get, getNewUUID } from \"../utils/utils\";\nimport { Flow, FlowState } from \"./flow\";\nimport { Terminal, TerminalType } from './terminal';\nimport { Renderable, RenderResolver, Serializable } from \"../common/interfaces\";\nimport { Node, NodeState } from \"./node\";\nimport { Hooks } from './hooks';\n\nexport class Connector extends Hooks implements Serializable, Renderable {\n  renderResolver: RenderResolver<Connector, ConnectorRenderParams> = () => null;\n\n  start: Terminal;\n  end: Terminal;\n  startNode: Node;\n  endNode: Node;\n  style: ConnectorStyle;\n  id: string;\n\n  _data: any;\n  floatingTip: Vector2;\n\n  get data(): any { return this._data; }\n  set data(data: any) {\n    this._data = data;\n    this.end && this.end.call('data', this.end, data);\n    if (this.flow.state !== FlowState.Stopped) {\n      this.flow.executionGraph.setDirty(this.endNode);\n    }\n  }\n\n  constructor(\n    public flow: Flow,\n    start: Terminal,\n    end: Terminal,\n    options: ConnectorOptions = DefaultConnectorOptions()\n  ) {\n    super();\n\n    this.style = options.style ? { ...DefaultConnectorStyle(), ...options.style } : DefaultConnectorStyle();\n    this.id = get(options.id, getNewUUID());\n    this.floatingTip = options.floatingTip;\n\n    this.start = start;\n    this.end = end;\n    if (this.start) this.startNode = this.start.node;\n    if (this.end) this.endNode = this.end.node;\n    if (start && end) {\n      this.floatingTip = null;\n\n      this.start.connectors.push(this);\n      if (this.end.connectors.length > 0) {\n        this.end.connectors[0].removeConnection();\n        this.end.connectors[0] = this;\n      } else this.end.connectors.push(this);\n\n      if (!options.isDeserialization) this.flow.executionGraph.connect(this.startNode, this.endNode);\n      this.start.onConnect(this);\n      this.end.onConnect(this);\n    }\n  }\n\n  completeConnection(destination: Terminal) {\n    if (!this.start) {\n      this.start = destination;\n      this.startNode = this.start.node;\n    } else {\n      this.end = destination;\n      this.endNode = this.end.node;\n    }\n\n    if (!this.start.connectors.includes(this)) this.start.connectors.push(this);\n    this.end.connectors[0] = this;\n    this.floatingTip = null;\n\n    this.startNode.currHitTerminal && this.startNode.currHitTerminal.onExit(null, null);\n    this.startNode.currHitTerminal = null;\n    this.endNode.currHitTerminal && this.endNode.currHitTerminal.onExit(null, null);\n    this.endNode.currHitTerminal = null;\n\n    this.flow.executionGraph.connect(this.startNode, this.endNode);\n    this.start.onConnect(this);\n    this.end.onConnect(this);\n  }\n  removeConnection() {\n    if (this.start) {\n      this.start.connectors.includes(this) && this.start.connectors.splice(this.start.connectors.indexOf(this), 1);\n      if (this.startNode.currHitTerminal) {\n        this.startNode.currHitTerminal.onExit(null, null);\n        this.startNode.currHitTerminal = null;\n      }\n    }\n    if (this.end) {\n      this.end.connectors.includes(this) && this.end.connectors.splice(this.end.connectors.indexOf(this), 1);\n      if (this.endNode.currHitTerminal) {\n        this.endNode.currHitTerminal.onExit(null, null);\n        this.endNode.currHitTerminal = null;\n      }\n    }\n  }\n  setData(data: any) {\n    this._data = data;\n    this.end && this.end.call('data', this.end, data);\n  }\n  canConnect(other: Terminal): boolean {\n    let firstTerminal = !this.start ? this.end : this.start;\n    let source, destination;\n    if (firstTerminal.type === TerminalType.IN) {\n      source = other;\n      destination = firstTerminal;\n    } else {\n      source = firstTerminal;\n      destination = other;\n    }\n\n    if (!destination) return false;\n    if (source === destination) return false;\n    if (source.node === destination.node) return false;\n    if (source.type === destination.type) return false;\n    if (!this.flow.rules[source.dataType].includes(destination.dataType)) return false;      // Directional !!\n    if (!this.flow.executionGraph.canConnect(source.node, destination.node)) return false;\n    return true;\n  }\n\n  render() {\n    let context = this.flow.flowConnect.context;\n    context.save();\n    let flowRenderResolver = this.flow.renderResolver.connector;\n    let flowConnectRenderResolver = this.flow.flowConnect.renderResolver.connector;\n    ((this.renderResolver && this.renderResolver(this))\n      || (flowRenderResolver && flowRenderResolver(this))\n      || (flowConnectRenderResolver && flowConnectRenderResolver(this))\n      || this._render\n    )(context, this.getRenderParams(), this);\n    context.restore();\n\n    let offContext = this.flow.flowConnect.offContext;\n    offContext.save();\n    this._offRender();\n    offContext.restore();\n\n    this.call('render', this);\n  }\n  private _render(context: CanvasRenderingContext2D, params: ConnectorRenderParams, connector: Connector) {\n    let ax = params.start.x, ay = params.start.y, dx = params.end.x, dy = params.end.y;\n\n    let offset = Vector2.Distance(ax, ay, dx, dy);\n    offset *= .2;\n\n    let [bx, by] = [ax + offset, ay];\n    let [cx, cy] = [dx - offset, dy];\n    let [midx, midy] = [(bx + cx) / 2, (by + cy) / 2];\n\n    if (connector.style.border) {\n      context.strokeStyle = connector.style.borderColor;\n      context.lineWidth = connector.style.width + 2;\n      context.beginPath();\n      context.moveTo(ax, ay);\n      context.quadraticCurveTo(bx, by, midx, midy);\n      context.moveTo(midx, midy);\n      context.quadraticCurveTo(cx, cy, dx, dy);\n      context.stroke();\n    }\n\n    context.strokeStyle = connector.style.color;\n    context.lineWidth = connector.style.width;\n    context.beginPath();\n    context.moveTo(ax, ay);\n    context.quadraticCurveTo(bx, by, midx, midy);\n    context.moveTo(midx, midy);\n    context.quadraticCurveTo(cx, cy, dx, dy);\n    context.stroke();\n  }\n  private _offRender() { /**/ }\n  private getRenderParams(): ConnectorRenderParams {\n    let start: SerializedVector2, end: SerializedVector2;\n    if (this.start) {\n      if (this.startNode.renderState.nodeState === NodeState.MAXIMIZED)\n        start = this.start.position.serialize();\n      else {\n        start = this.startNode.position.serialize();\n        start.x += this.startNode.width + this.startNode.style.terminalStripMargin + this.start.style.radius;\n        start.y += this.startNode.style.titleHeight / 2;\n      }\n    } else\n      start = this.floatingTip.serialize();\n    if (this.end) {\n      if (this.endNode.renderState.nodeState === NodeState.MAXIMIZED)\n        end = this.end.position.serialize();\n      else {\n        end = this.endNode.position.serialize();\n        end.x -= (this.endNode.style.terminalStripMargin + this.end.style.radius);\n        end.y += this.endNode.style.titleHeight / 2;\n      }\n    } else\n      end = this.floatingTip.serialize();\n\n    return { start, end };\n  }\n\n  serialize(): SerializedConnector {\n    return {\n      id: this.id,\n      startId: this.start.id,\n      endId: this.end.id,\n      startNodeId: this.startNode.id,\n      endNodeId: this.endNode.id,\n      style: this.style\n    }\n  }\n  static deSerialize(flow: Flow, start: Terminal, end: Terminal, data: SerializedConnector): Connector {\n    return new Connector(flow, start, end, {\n      style: data.style,\n      id: data.id,\n      isDeserialization: true\n    });\n  }\n}\n\nexport interface SerializedConnector {\n  startNodeId: string,\n  endNodeId: string,\n  startId: string,\n  endId: string,\n  id: string,\n  style: ConnectorStyle\n}\n\nexport interface ConnectorStyle {\n  width?: number,\n  color?: string,\n  border?: boolean,\n  borderColor?: string\n}\nlet DefaultConnectorStyle = (): ConnectorStyle => {\n  return {\n    width: 5,\n    color: '#7fff00aa',\n    border: true,\n    borderColor: 'grey'\n  };\n};\n\nexport interface ConnectorOptions {\n  floatingTip?: Vector2,\n  style?: ConnectorStyle,\n  id?: string,\n  isDeserialization?: boolean\n}\nlet DefaultConnectorOptions = (): ConnectorOptions => {\n  return {\n    style: {},\n    id: getNewUUID()\n  };\n}\n\nexport interface ConnectorRenderParams {\n  start: SerializedVector2,\n  end: SerializedVector2\n}\n","import { FlowConnect } from \"../flow-connect\";\nimport { Vector2 } from \"./vector\";\nimport { Node, NodeButton, NodeButtonRenderParams, NodeRenderParams, NodeStyle, SerializedNode } from \"./node\";\nimport { Hooks } from './hooks';\nimport { Group, GroupRenderParams, SerializedGroup } from './group';\nimport { Connector, ConnectorRenderParams, SerializedConnector } from './connector';\nimport { AVLTree } from \"../utils/avl-tree\";\nimport { Serializable, Rules, RenderResolver } from '../common/interfaces';\nimport { SubFlowNode } from \"./subflow-node\";\nimport { TunnelNode, SerializedTunnelNode } from \"./tunnel-node\";\nimport { getNewUUID } from \"../utils/utils\";\nimport { Graph, SerializedGraph } from \"./graph\";\nimport { Terminal, TerminalRenderParams, TerminalStyle } from \"./terminal\";\nimport { Log } from '../utils/logger';\nimport { Container, ContainerRenderParams } from '../ui/container';\n\n/** A Flow is a set of Nodes, Connectors and Groups, it can also contain SubFlowNodes thereby creating a tree of Flows.\n *  ![](media://example.png)\n */\nexport class Flow extends Hooks implements Serializable {\n  sortedNodes: AVLTree<Node>;\n  nodes: Map<string, Node>;\n  groups: Group[];\n  connectors: Map<string, Connector>;\n  inputs: TunnelNode[];\n  outputs: TunnelNode[];\n  get state(): FlowState { return this.executionGraph.state; }\n  globalEvents: Hooks = new Hooks();\n  parentFlow: Flow = null;\n\n  nodeHitColors: Map<string, Node>;\n  groupHitColors: Map<string, Group>;\n  listeners: Record<string, number> = {};\n\n  executionGraph: Graph;\n\n  readonly renderResolver: {\n    connector?: RenderResolver<Connector, ConnectorRenderParams>,\n    node?: RenderResolver<Node, NodeRenderParams>,\n    nodeButton?: RenderResolver<NodeButton, NodeButtonRenderParams>,\n    uiContainer?: RenderResolver<Container, ContainerRenderParams>\n    group?: RenderResolver<Group, GroupRenderParams>,\n    terminal?: RenderResolver<Terminal, TerminalRenderParams>,\n  } = {};\n\n  constructor(\n    public flowConnect: FlowConnect,\n    public name: string,\n    public rules: Rules,\n    public terminalColors: Record<string, string>,\n    public id: string = getNewUUID()\n  ) {\n\n    super();\n    this.nodes = new Map();\n    this.groups = [];\n    this.connectors = new Map();\n    this.nodeHitColors = new Map();\n    this.groupHitColors = new Map();\n    this.sortedNodes = new AVLTree((a: Node, b: Node) => (a.zIndex - b.zIndex), (node: Node) => node.id);\n    this.inputs = [];\n    this.outputs = [];\n    this.executionGraph = new Graph();\n\n    this.registerListeners();\n\n    this.flowConnect.on('tick', () => {\n      if (this.state === FlowState.Running) this.call('tick', this);\n    });\n  }\n\n  private registerListeners() {\n    let id = this.flowConnect.on('transform', () => this.call('transform', this));\n    this.listeners['transform'] = id;\n  }\n  deregisterListeners() {\n    this.flowConnect.off('transform', this.listeners['transform']);\n    delete this.listeners['transform'];\n  }\n\n  existsInFlow(flow: Flow): boolean {\n    for (let node of [...this.nodes.values()]) {\n      if ((node as SubFlowNode).subFlow === flow) return true;\n      else if ((node as SubFlowNode).subFlow) {\n        return (node as SubFlowNode).subFlow.existsInFlow(flow);\n      }\n    }\n    return false;\n  }\n\n  addInput(name: string, dataType: string, position: Vector2): TunnelNode {\n    let flowInput = new TunnelNode(this, 'Input', position, 100, [], [{ name: name, dataType: dataType }]);\n    flowInput.on('process', () => {\n      flowInput.outputs[0].setData(flowInput.proxyTerminal.getData());\n    });\n\n    this.inputs.push(flowInput);\n    this.nodes.set(flowInput.id, flowInput);\n    this.sortedNodes.add(flowInput);\n    this.executionGraph.add(flowInput);\n\n    this.call('add-input', this, flowInput);\n    return flowInput;\n  }\n  addOutput(name: string, dataType: string, position: Vector2): TunnelNode {\n    let flowOutput = new TunnelNode(this, 'Output', position, 100, [{ name: name, dataType: dataType }], []);\n\n    this.outputs.push(flowOutput);\n    this.nodes.set(flowOutput.id, flowOutput);\n    this.sortedNodes.add(flowOutput);\n    this.executionGraph.add(flowOutput);\n\n    this.call('add-output', this, flowOutput);\n    return flowOutput;\n  }\n  addSubFlow(flow: Flow, position: Vector2): SubFlowNode {\n    if (flow.parentFlow) {\n      Log.error('Provided flow is already a sub-flow, a sub-flow cannot have multiple parent flows');\n      return null;\n    }\n    let subFlowNode = new SubFlowNode(this, flow, position, 150,\n      flow.inputs.map(inputNode => { return { name: inputNode.outputs[0].name, dataType: inputNode.outputs[0].dataType } }),\n      flow.outputs.map(outputNode => { return { name: outputNode.inputs[0].name, dataType: outputNode.inputs[0].dataType } }),\n      { name: flow.name }\n    );\n    this.nodes.set(subFlowNode.id, subFlowNode);\n    this.sortedNodes.add(subFlowNode);\n    this.executionGraph.add(subFlowNode);\n    flow.parentFlow = this;\n\n    return subFlowNode;\n  }\n  createNode(name: string, position: Vector2, width: number, options?: NodeOptions): Node {\n    options = options ? { ...DefaultNodeOptions(), ...options } : DefaultNodeOptions();\n\n    let inTerminals: any[] = [], outTerminals: any[] = [];\n    if (typeof options.inputs !== 'undefined') inTerminals = options.inputs;\n    if (typeof options.outputs !== 'undefined') outTerminals = options.outputs;\n\n    return new Node(this, name, position, width, inTerminals, outTerminals, {\n      style: options.style,\n      terminalStyle: options.terminalStyle,\n      state: options.state\n    });\n  }\n  removeNode(nodeOrID: Node | string) {\n    /** TODO */\n  }\n  removeConnector(id: string) {\n    if (this.connectors.get(id) === this.flowConnect.floatingConnector) this.flowConnect.floatingConnector = null;\n    this.connectors.delete(id);\n  }\n  removeAllFocus() {\n    this.nodes.forEach(node => node.focused = false);\n  }\n  render() {\n    this.groups.forEach(group => group.render());\n    this.connectors.forEach(connector => connector.render());\n    this.sortedNodes.forEach(node => node.render());\n\n    this.call('render', this);\n  }\n  start() {\n    if (this.state !== FlowState.Stopped) return;\n    this.executionGraph.start();\n    this.call('start', this);\n  }\n  stop() {\n    // Bottom-up, all child sub-flows gets stopped first before parent\n    // What if FlowState is Running ?\n    if (this.state === FlowState.Stopped) return;\n\n    // Bottom-up, sub-flows are stopped from highest order to lowest (order = depth of node in the tree)\n    for (let order = this.executionGraph.nodes.length - 1; order >= 0; order -= 1) {\n      this.executionGraph.nodes[order]\n        .filter(graphNode => graphNode.flowNode instanceof SubFlowNode)\n        .map(graphNode => graphNode.flowNode)\n        .forEach((subFlowNode: SubFlowNode) => subFlowNode.subFlow.stop());\n    }\n    this.executionGraph.stop();\n    this.call('stop', this);\n  }\n\n  serialize(): SerializedFlow {\n    return {\n      id: this.id,\n      name: this.name,\n      rules: this.rules,\n      terminalColors: this.terminalColors,\n      nodes: [...this.nodes.values()].map(node => node.serialize()),\n      groups: this.groups.map(group => group.serialize()),\n      connectors: [...this.connectors.values()].map(connector => connector.serialize()),\n      inputs: this.inputs.map(input => input.serialize()),\n      outputs: this.outputs.map(output => output.serialize()),\n      executionGraph: this.executionGraph.serialize()\n    }\n  }\n  static deSerialize(flowConnect: FlowConnect, data: SerializedFlow): Flow {\n    let flow = new Flow(flowConnect, data.name, data.rules, data.terminalColors, data.id);\n\n    data.nodes.forEach(serializedNode => {\n      let node;\n      if (serializedNode.subFlow) node = SubFlowNode.deSerialize(flow, serializedNode);\n      else node = Node.deSerialize(flow, serializedNode);\n      flow.nodes.set(node.id, node);\n      flow.sortedNodes.add(node);\n    });\n    data.groups.forEach(serializedGroup => {\n      let group = Group.deSerialize(flow, serializedGroup);\n      flow.groups.push(group);\n      group.nodes.forEach(node => node.group = group);\n    });\n    data.inputs.forEach(serializedInput => {\n      let input = TunnelNode.deSerialize(flow, serializedInput);\n      flow.inputs.push(input);\n      flow.nodes.set(input.id, input);\n      flow.sortedNodes.add(input);\n    });\n    data.outputs.forEach(serializedOutput => {\n      let output = TunnelNode.deSerialize(flow, serializedOutput);\n      flow.outputs.push(output);\n      flow.nodes.set(output.id, output);\n      flow.sortedNodes.add(output);\n    });\n    data.connectors.forEach(serializedConnector => {\n      let startNode = flow.nodes.get(serializedConnector.startNodeId);\n      let startTerminal = startNode.outputs.concat(startNode.outputsUI).find(terminal => terminal.id === serializedConnector.startId);\n      let endNode = flow.nodes.get(serializedConnector.endNodeId);\n      let endTerminal = endNode.inputs.concat(endNode.inputsUI).find(terminal => terminal.id === serializedConnector.endId);\n      let connector = Connector.deSerialize(flow, startTerminal, endTerminal, serializedConnector);\n      flow.connectors.set(serializedConnector.id, connector);\n    });\n\n    flow.executionGraph = Graph.deSerialize(flow, data.executionGraph);\n\n    return flow;\n  }\n}\n\nexport enum FlowState {\n  Running,\n  Idle,\n  Stopped\n}\n\nexport interface FlowOptions {\n  name: string,\n  rules: Rules,\n  terminalColors: Record<string, string>\n}\n\nexport interface SerializedFlow {\n  id: string,\n  name: string,\n  rules: Rules,\n  terminalColors: Record<string, string>,\n  nodes: SerializedNode[],\n  groups: SerializedGroup[],\n  connectors: SerializedConnector[],\n  inputs: SerializedTunnelNode[],\n  outputs: SerializedTunnelNode[],\n  executionGraph: SerializedGraph\n}\n\nexport interface NodeOptions {\n  inputs?: any[],\n  outputs?: any[],\n  style: NodeStyle,\n  terminalStyle: TerminalStyle,\n  state?: Record<string, any>\n}\nlet DefaultNodeOptions = (): NodeOptions => {\n  return {\n    style: {},\n    terminalStyle: {}\n  }\n}\n","import { Log } from \"../utils/logger\";\nimport { getNewUUID } from \"../utils/utils\";\nimport { Flow, FlowState } from \"./flow\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Node } from \"./node\";\nimport { List } from \"../utils/linked-list\";\n\n\n// A directed acyclic graph\nexport class Graph implements Serializable {\n  state: FlowState = FlowState.Stopped;\n  nodes: GraphNode[][];\n  graphNodes: Map<string, GraphNode>;\n  dirtyNodes: Map<string, GraphNode>;\n\n  constructor() {\n    this.nodes = [];\n    this.graphNodes = new Map();\n    this.dirtyNodes = new Map();\n  }\n\n  add(data: Node) {\n    if (!this.nodes[0]) this.nodes.push([]);\n    let graphNode = new GraphNode(data);\n    this.nodes[0].push(graphNode);\n    this.graphNodes.set(data.id, graphNode);\n  }\n  connect(sourceNode: Node, destinationNode: Node) {\n    let startGraphNode = this.graphNodes.get(sourceNode.id);\n    let endGraphNode = this.graphNodes.get(destinationNode.id);\n\n    if (!startGraphNode.childs.includes(endGraphNode)) {\n      startGraphNode.childs.push(endGraphNode);\n\n      if (endGraphNode.order <= startGraphNode.order) {\n        this.updateOrder(endGraphNode, startGraphNode.order + 1);\n      }\n    }\n  }\n  disconnect(sourceNode: Node, destinationNode: Node) {\n    let sourceGraphNode = this.graphNodes.get(sourceNode.id);\n    let destinationGraphNode = this.graphNodes.get(destinationNode.id);\n\n    let connectedEndNodes = new Set<Node>();\n    sourceNode.outputs\n      .forEach(terminal => terminal.connectors\n        .forEach(connector => connector.endNode && connectedEndNodes.add(connector.endNode))\n      );\n\n    if (connectedEndNodes.has(destinationNode)) return;\n    sourceGraphNode.childs.splice(sourceGraphNode.childs.indexOf(destinationGraphNode), 1);\n\n    let maxOrderOfConnectedStartNodes = destinationNode.inputs\n      .filter(terminal => terminal.connectors.length > 0)\n      .map(terminal => this.graphNodes.get(terminal.connectors[0].startNode.id).order)\n      .reduce((acc, curr) => Math.max(acc, curr), 0);\n\n    this.updateOrder(destinationGraphNode, maxOrderOfConnectedStartNodes);\n  }\n  updateOrder(root: GraphNode, order: number) {\n    this._updateOrder(root, order);\n    let queue: GraphNode[] = [];\n    queue.push(root);\n    while (queue.length !== 0) {\n      let currNode = queue.shift();\n      currNode.childs.forEach(child => {\n        if (child.order <= currNode.order) {\n          this._updateOrder(child, currNode.order + 1);\n          if (!queue.includes(child)) queue.push(child);\n        }\n      });\n    }\n  }\n  private _updateOrder(graphNode: GraphNode, order: number) {\n    this.nodes[graphNode.order].splice(this.nodes[graphNode.order].indexOf(graphNode), 1);\n    if (!this.nodes[order]) this.nodes[order] = [];\n    graphNode.order = order;\n    this.nodes[order].push(graphNode);\n  }\n  canConnect(sourceNode: Node, destinationNode: Node) {\n    if (this.graphNodes.get(destinationNode.id).childs.includes(this.graphNodes.get(sourceNode.id))) return false;\n    return true;\n  }\n\n  async start() {\n    if (this.state === FlowState.Stopped) {       // Full Run\n      this.state = FlowState.Running;\n      if (this.nodes[0]) {\n        try {\n          await this.runAll(this.nodes[0]);\n\n          while (this.dirtyNodes.size !== 0) {\n            await this.runAll(this.lowestDirty([...this.dirtyNodes.values()]));\n          }\n        } catch (error) {\n          Log.error('Error while executing graph', error);\n          this.state = FlowState.Stopped;\n          return;\n        }\n      }\n    } else if (this.state === FlowState.Idle) {   // Partial Run\n      this.state = FlowState.Running;\n      try {\n        while (this.dirtyNodes.size !== 0) {\n          await this.runAll(this.lowestDirty([...this.dirtyNodes.values()]));\n        }\n      } catch (error) {\n        Log.error('Error while executing graph', error);\n        this.state = FlowState.Stopped;\n        return;\n      }\n    }\n\n    this.state = FlowState.Idle;\n  }\n  stop() {\n    this.state = FlowState.Stopped;\n  }\n  // Runs selective nodes within the >same order< in async (how about parallel, future ?)\n  async runAll(graphNodes: GraphNode[]) {\n    await Promise.all(\n      graphNodes.map(\n        graphNode => new Promise<void>(resolve => {\n          graphNode.flowNode.run();\n          this.clearDirty(graphNode);\n          resolve();\n        })\n      )\n    );\n  }\n  setDirty(node: Node | GraphNode) {\n    let graphNode = node instanceof Node ? this.graphNodes.get(node.id) : node;\n    if (!graphNode) return;\n\n    this.dirtyNodes.set(graphNode.id, graphNode);\n  }\n  clearDirty(node: Node | GraphNode) {\n    let graphNode = node instanceof Node ? this.graphNodes.get(node.id) : node;\n    this.dirtyNodes.delete(graphNode.id);\n  }\n  // Returns all dirty nodes with lowest order\n  lowestDirty(graphNodes: GraphNode[]) {\n    let lowestOrder = Math.min(...graphNodes.map(graphNode => graphNode.order));\n    return graphNodes.filter(graphNode => graphNode.order === lowestOrder);\n  }\n  // Generic graph traversing function that can be used to do some stuff with nodes starting with provided root\n  propagate(root: Node | GraphNode, callback: (node: Node) => void) {\n    let start = root instanceof Node ? this.graphNodes.get(root.id) : root;\n    let queue = new List<GraphNode>();\n    queue.append(start);\n    while (queue.length !== 0) {\n      let currGNode = queue.removeFirst();\n      callback(currGNode.flowNode);\n      currGNode.childs.forEach(child => queue.append(child));\n    }\n  }\n  debugNode(node: GraphNode, indent: string) {\n    console.log(`${indent}[${node.flowNode.name}, ${node.order}]`);\n    node.childs.forEach(child => this.debugNode(child, indent + '  '));\n  }\n  debugGraph() {\n    this.nodes[0].forEach(graphNode => {\n      this.debugNode(graphNode, '');\n    });\n  }\n\n  serialize(): SerializedGraph {\n    let nodeToGraphNodeIds: Record<string, string> = {};\n    this.graphNodes.forEach((_graphNode, id) => nodeToGraphNodeIds[id] = this.graphNodes.get(id).id);\n\n    return {\n      nodes: this.nodes.map(groupedNodes => groupedNodes.map(graphNode => graphNode.serialize())),\n      nodeToGraphNode: nodeToGraphNodeIds\n    };\n  }\n  static deSerialize(flow: Flow, data: SerializedGraph): Graph {\n    let graph = new Graph();\n\n    let serializedGraphNodes: Record<string, SerializedGraphNode> = {};\n    let deSerializedGraphNodes: Record<string, GraphNode> = {};\n\n    data.nodes.forEach((serializedGroupedNodes, index) => {\n      graph.nodes[index] = serializedGroupedNodes.map(serializedGraphNode => {\n        let graphNode = GraphNode.deSerialize(flow.nodes.get(serializedGraphNode.nodeId), serializedGraphNode);\n        deSerializedGraphNodes[graphNode.id] = graphNode;\n        serializedGraphNodes[graphNode.id] = serializedGraphNode;\n        return graphNode;\n      });\n    });\n\n    Object.keys(deSerializedGraphNodes).forEach(key => {\n      deSerializedGraphNodes[key].childs = serializedGraphNodes[key].childs.map(childId => deSerializedGraphNodes[childId]);\n    });\n    Object.keys(data.nodeToGraphNode).forEach(nodeId => {\n      graph.graphNodes.set(nodeId, deSerializedGraphNodes[data.nodeToGraphNode[nodeId]]);\n    })\n\n    return graph;\n  }\n}\n\nexport interface SerializedGraph {\n  nodes: SerializedGraphNode[][],\n  nodeToGraphNode: Record<string, string>\n}\n\nexport class GraphNode implements Serializable {\n  id: string;\n  childs: GraphNode[] = [];\n  order: number;\n\n  constructor(public flowNode: Node, order?: number, id?: string) {\n    this.order = order ? order : 0;\n    this.id = id ? id : getNewUUID();\n  }\n\n  serialize(): SerializedGraphNode {\n    return {\n      id: this.id,\n      nodeId: this.flowNode.id,\n      order: this.order,\n      childs: this.childs.map(child => child.id)\n    };\n  }\n  static deSerialize(node: Node, data: SerializedGraphNode): GraphNode {\n    return new GraphNode(node, data.order, data.id);\n  }\n}\nexport interface SerializedGraphNode {\n  id: string,\n  nodeId: string,\n  order: number,\n  childs: string[]\n}\n","import { SerializedVector2, Vector2 } from \"./vector\";\nimport { get, getNewUUID, intersects } from \"../utils/utils\";\nimport { Color, SerializedColor } from \"./color\";\nimport { Flow } from './flow';\nimport { Hooks } from './hooks';\nimport { Node } from './node';\nimport { Renderable, RenderResolver, Serializable } from \"../common/interfaces\";\nimport { ViewPort } from \"../common/enums\";\n\nexport class Group extends Hooks implements Serializable, Renderable {\n  renderResolver: RenderResolver<Group, GroupRenderParams> = () => null;\n\n  nodes: Node[] = [];\n  get name(): string { return this._name; }\n  set name(name: string) {\n    if (!name || name.trim() === '') this._name = 'No Name';\n    else this._name = name;\n    this.computeTextMetrics();\n  }\n  get position(): Vector2 { return this._position; }\n  set position(position: Vector2) {\n    this._position = position;\n    this.updateRenderState();\n    this.recomputeNodePositions();\n  }\n\n  nodeDeltas: Vector2[] = [];\n\n  hitColor: Color;\n  private textWidth: number;\n  private textHeight: number;\n  private _name: string;\n  private renderState: ViewPort = ViewPort.INSIDE;\n  private _position: Vector2;\n\n  width: number;\n  height: number\n  style: GroupStyle;\n  id: string;\n\n  constructor(\n    public flow: Flow,\n    position: Vector2,\n    options: GroupOptions = DefaultGroupOptions()\n  ) {\n\n    super();\n\n    this.width = get(options.width, 0);\n    this.height = get(options.height, 0);\n    this.style = get(options.style, {});\n    this.id = get(options.id, getNewUUID());\n\n    this.hitColor = options.hitColor;\n    this.style = { ...DefaultGroupStyle(), ...options.style };\n    this.id = getNewUUID();\n    this._position = position;\n    if (!this.style.color || !this.style.borderColor) {\n      let colors = DefaultGroupColors.Random();\n      this.style.borderColor = colors[0];\n      this.style.color = colors[1];\n    }\n    this.name = options.name;\n    this.setHitColor(options.hitColor);\n    this.computeTextMetrics();\n\n    this.flow.on('transform', () => this.updateRenderState());\n  }\n\n  private setHitColor(hitColor: Color) {\n    if (!hitColor) {\n      hitColor = Color.Random();\n      while (this.flow.groupHitColors.get(hitColor.rgbaString)) hitColor = Color.Random();\n    }\n    this.hitColor = hitColor;\n    this.flow.groupHitColors.set(this.hitColor.rgbaString, this);\n  }\n  private computeTextMetrics() {\n    let context = this.flow.flowConnect.context;\n    context.font = this.style.fontSize + ' ' + this.style.font;\n    let metrics = context.measureText(this.name);\n    this.textWidth = metrics.width;\n    metrics = context.measureText('M');\n    context.font = null;\n    this.textHeight = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;\n\n    if (typeof this.textHeight === 'undefined') {\n      let d = document.createElement(\"span\");\n      d.textContent = \"M\";\n      d.style.font = this.style.fontSize + ' ' + this.style.font;\n      document.body.appendChild(d);\n      this.textHeight = d.offsetHeight;\n      document.body.removeChild(d);\n    }\n  }\n  private updateRenderState() {\n    let realPos = this.position.transform(this.flow.flowConnect.transform);\n    this.renderState = intersects(\n      0, 0,\n      this.flow.flowConnect.canvasDimensions.width, this.flow.flowConnect.canvasDimensions.height,\n      realPos.x, realPos.y,\n      realPos.x + this.width * this.flow.flowConnect.scale,\n      realPos.y + this.height * this.flow.flowConnect.scale\n    );\n  }\n  setContainedNodes() {\n    let groupRealPos = this.position.transform(this.flow.flowConnect.transform);\n\n    this.nodes = [...this.flow.nodes.values()]\n      .filter(node => !node.group && node.renderState.viewport === ViewPort.INSIDE)\n      .filter(node => {\n        let nodeRealPos = node.position.transform(this.flow.flowConnect.transform);\n\n        return intersects(groupRealPos.x, groupRealPos.y,\n          groupRealPos.x + this.width * this.flow.flowConnect.scale,\n          groupRealPos.y + this.height * this.flow.flowConnect.scale,\n          nodeRealPos.x, nodeRealPos.y,\n          nodeRealPos.x + node.width * this.flow.flowConnect.scale,\n          nodeRealPos.y + node.ui.height * this.flow.flowConnect.scale\n        ) === ViewPort.INSIDE;\n      });\n\n    this.nodes.forEach((node, index) => {\n      node.group = this;\n      this.nodeDeltas[index] = node.position.subtract(this.position);\n    });\n  }\n  private recomputeNodePositions() {\n    this.nodes.forEach((node, index) => {\n      node.position = this.position.add(this.nodeDeltas[index]);\n    });\n  }\n\n  render() {\n    if (this.renderState === ViewPort.OUTSIDE) return;\n\n    let context = this.flow.flowConnect.context;\n    context.save();\n    let flowRenderResolver = this.flow.renderResolver.group;\n    let flowConnectRenderResolver = this.flow.flowConnect.renderResolver.group;\n    ((this.renderResolver && this.renderResolver(this))\n      || (flowRenderResolver && flowRenderResolver(this))\n      || (flowConnectRenderResolver && flowConnectRenderResolver(this))\n      || this._render\n    )(context, this.getRenderParams(), this);\n    context.restore();\n\n    this.flow.flowConnect.offGroupContext.save();\n    this._offRender();\n    this.flow.flowConnect.offGroupContext.restore();\n\n    this.call('render', this);\n  }\n  private _render(context: CanvasRenderingContext2D, params: GroupRenderParams, group: Group) {\n    context.strokeStyle = group.style.borderColor;\n    context.lineWidth = 2;\n    context.fillStyle = group.style.color;\n    context.strokeRect(params.position.x, params.position.y, params.width, params.height);\n    context.fillRect(params.position.x, params.position.y, params.width, params.height);\n    context.fillStyle = group.style.titleColor;\n    context.textBaseline = 'bottom';\n    context.font = group.style.fontSize + ' ' + group.style.font;\n    context.fillText(group.name, params.position.x, params.position.y - 10);\n  }\n  private _offRender() {\n    this.flow.flowConnect.offGroupContext.fillStyle = this.hitColor.rgbaCSSString;\n    this.flow.flowConnect.offGroupContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n    this.flow.flowConnect.offGroupContext.fillRect(this.position.x, this.position.y - this.textHeight - 10, this.textWidth, this.textHeight + 10);\n  }\n  private getRenderParams(): GroupRenderParams {\n    return {\n      position: this.position.serialize(),\n      width: this.width,\n      height: this.height\n    };\n  }\n\n  onClick(screenPosition: Vector2, realPosition: Vector2) {\n    this.call('click', this, screenPosition, realPosition);\n\n    let thisRealPosition = this.position.transform(this.flow.flowConnect.transform);\n    if (screenPosition.y < thisRealPosition.y) {\n      this.flow.flowConnect.showGenericInput(thisRealPosition.subtract(0, (10 + this.textHeight) * this.flow.flowConnect.scale), this.name, {\n        width: Math.max(this.textWidth, 50) * this.flow.flowConnect.scale + 'px',\n        height: this.textHeight * this.flow.flowConnect.scale + 'px',\n        fontSize: parseInt(this.style.fontSize.replace('px', '')) * this.flow.flowConnect.scale + 'px',\n        fontFamily: this.style.font\n      }, {\n        type: 'text'\n      }, (value) => {\n        this.name = value;\n      });\n    }\n  }\n\n  serialize(): SerializedGroup {\n    return {\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      position: this.position.serialize(),\n      name: this.name,\n      width: this.width,\n      height: this.height,\n      style: this.style,\n      nodes: this.nodes.map(node => node.id),\n      nodeDeltas: this.nodeDeltas.map(nodeDelata => nodeDelata.serialize())\n    };\n  }\n  static deSerialize(flow: Flow, data: SerializedGroup): Group {\n    let group = new Group(flow, Vector2.deSerialize(data.position), {\n      width: data.width,\n      height: data.height,\n      name: data.name,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n\n    data.nodes.forEach(nodeId => {\n      group.nodes.push(flow.nodes.get(nodeId));\n    });\n    data.nodeDeltas.forEach(serializedVector => {\n      group.nodeDeltas.push(Vector2.deSerialize(serializedVector));\n    });\n\n    return group;\n  }\n}\n\nexport interface SerializedGroup {\n  position: SerializedVector2,\n  width: number,\n  height: number,\n  name: string,\n  style: GroupStyle,\n  id: string,\n  hitColor: SerializedColor,\n  nodes: string[],\n  nodeDeltas: SerializedVector2[]\n}\n\nlet DefaultGroupColors = {\n  colors: [\n    ['rgba(239, 134, 119, 1)', 'rgba(239, 134, 119, .5)'],\n    ['rgba(160, 231, 125, 1)', 'rgba(160, 231, 125, .5)'],\n    ['rgba(130, 182, 217, 1)', 'rgba(130, 182, 217, .5)']\n  ],\n  RED: () => DefaultGroupColors.colors[0],\n  GREEN: () => DefaultGroupColors.colors[1],\n  BLUE: () => DefaultGroupColors.colors[2],\n  Random: () => DefaultGroupColors.colors[Math.floor(Math.random() * DefaultGroupColors.colors.length)]\n};\n\nexport interface GroupStyle {\n  color?: string;\n  borderColor?: string;\n  titleColor?: string;\n  fontSize?: string;\n  font?: string;\n}\nlet DefaultGroupStyle = () => {\n  return {\n    titleColor: '#000',\n    fontSize: '16px',\n    font: 'arial'\n  };\n}\n\nexport interface GroupOptions {\n  width?: number,\n  height?: number,\n  name?: string,\n  style?: GroupStyle,\n  id?: string,\n  hitColor?: Color\n}\n\nlet DefaultGroupOptions = (): GroupOptions => {\n  return {\n    width: 0,\n    height: 0,\n    style: {},\n    id: getNewUUID()\n  }\n}\n\nexport interface GroupRenderParams {\n  position: SerializedVector2,\n  width: number,\n  height: number\n}\n","/** \n * Hooks is a general purpose class used by FlowConnect, Flow, Node, UINode, Terminal, Group... classes\n * for making their normal processes available as events to listen to when they happen.\n * For e.g you can listen to any Terminal's 'connect'/'disconnect' event to do some custom stuff\n */\nexport class Hooks {\n  protected registeredEvents: Record<string, Record<number, (...args: any) => void>>;\n  protected lastId: number;\n\n  constructor() {\n    this.registeredEvents = {};\n    this.lastId = 0;\n  }\n\n  /** \n   * Register a callback to an event\n   * \n   * @param eventKey name of the event to listen to\n   * @param callback reference to a callback that will be triggered when this event happens\n   * @returns a numbered ID that can be used later to de-register this hook\n   */\n  on(eventKey: string, callback: (...args: any) => void): number {\n    if (!this.registeredEvents[eventKey]) this.registeredEvents[eventKey] = {};\n\n    let id = this.lastId;\n    this.registeredEvents[eventKey][id] = callback;\n    this.lastId += 1;\n    return id;\n  }\n  call(eventKey: string, ...args: any) {\n    if (this.registeredEvents[eventKey]) {\n      if (!args) args = [];\n      Object.values(this.registeredEvents[eventKey]).forEach(callback => callback(...args));\n    }\n  }\n  /** \n   * De-register a callback to an event\n   * \n   * @param eventKey name of the event to de-register\n   * @param id a numbered id that was generated at the time of event registration\n   */\n  off(eventKey: string, id: number) {\n    if (this.registeredEvents[eventKey]) delete this.registeredEvents[eventKey][id];\n  }\n  offAll() {\n    this.registeredEvents = {};\n  }\n}\n","export * from './color';\nexport * from './connector';\nexport * from './flow';\nexport * from './graph';\nexport * from './group';\nexport * from './hooks';\nexport * from './node';\nexport * from './subflow-node';\nexport * from './terminal';\nexport * from './tunnel-node';\nexport * from './vector';\n","import { SerializedVector2, Vector2 } from \"./vector\";\nimport { ViewPort, LOD, Align } from '../common/enums';\nimport {\n  VSlider, VSliderStyle, Slider2D, Slider2DStyle, RadioGroup, RadioGroupStyle, Envelope, EnvelopeStyle,\n  Dial, DialStyle, Container, ContainerRenderParams, SerializedContainer, Label, LabelStyle,\n  Button, ButtonStyle, Image, ImageStyle, HorizontalLayout, HorizontalLayoutStyle, Toggle, ToggleStyle,\n  Select, SelectStyle, Source, SourceStyle, Display, DisplayStyle, CustomRendererConfig, Input, InputStyle,\n  Stack, StackStyle, Slider, SliderStyle, UINode\n} from \"../ui/index\";\nimport { get, getNewUUID, intersects } from \"../utils/utils\";\nimport { Color, SerializedColor } from \"./color\";\nimport { Flow, FlowState, SerializedFlow } from './flow';\nimport { Group } from './group';\nimport { Terminal, TerminalType, TerminalStyle, SerializedTerminal, TerminalRenderParams } from './terminal';\nimport { Hooks } from './hooks';\nimport { Events, Renderable, RenderFunction, RenderResolver, RenderState, Serializable } from \"../common/interfaces\";\nimport { Connector } from \"./connector\";\nimport { Log } from \"../utils/logger\";\n\nexport class Node extends Hooks implements Events, Serializable, Renderable {\n  //#region Properties\n  renderResolver: {\n    node?: RenderResolver<Node, NodeRenderParams>,\n    nodeButton?: RenderResolver<NodeButton, NodeButtonRenderParams>,\n    terminal?: RenderResolver<Terminal, TerminalRenderParams>,\n    uiContainer?: RenderResolver<Container, ContainerRenderParams>,\n  } = {};\n  hitColor: Color;\n  private _width: number;\n\n  uiNodes: Map<string, UINode>;\n  terminals: Map<string, Terminal>;\n  nodeButtons: Map<string, NodeButton>;\n  private _zIndex: number;\n  private _position: Vector2;\n  private stateObserver = new Hooks();\n\n  renderState: RenderState = { viewport: ViewPort.INSIDE, nodeState: NodeState.MAXIMIZED, lod: LOD.LOD2 };\n\n  currHitTerminal: Terminal;\n  prevHitTerminal: Terminal;\n  currHitUINode: UINode;\n  prevHitUINode: UINode;\n\n  focused: boolean = false;\n  inputs: Terminal[] = [];\n  outputs: Terminal[] = [];\n  inputsUI: Terminal[] = [];\n  outputsUI: Terminal[] = [];\n  ui: Container;\n  state: Record<string, any>;\n  group: Group = null;\n  //#endregion\n\n  //#region Accessors\n  get height(): number { return this.ui.height };\n  get context(): CanvasRenderingContext2D { return this.flow.flowConnect.context }\n  get offContext(): OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D { return this.flow.flowConnect.offContext }\n  get offUIContext(): OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D { return this.flow.flowConnect.offUIContext }\n  get position(): Vector2 { return this._position }\n  set position(position: Vector2) {\n    this._position = position;\n    this.reflow();\n    this.ui.update();\n    this.updateRenderState();\n  }\n  get zIndex(): number { return this._zIndex }\n  set zIndex(zIndex: number) {\n    if (this.flow.sortedNodes.remove(this)) {\n      this._zIndex = zIndex;\n      this.flow.sortedNodes.add(this);\n    } else {\n      this._zIndex = zIndex;\n    }\n  }\n  get width(): number { return this._width }\n  set width(width: number) {\n    this._width = width;\n    this.ui.width = width;\n    this.ui.update();\n  }\n  //#endregion\n\n  style: NodeStyle;\n  terminalStyle: TerminalStyle;\n  id: string;\n\n  constructor(\n    public flow: Flow,\n    public name: string,\n    position: Vector2,\n    width: number,\n    inputs: SerializedTerminal[], outputs: SerializedTerminal[],\n    options: NodeConstructorOptions = DefaultNodeConstructorOptions()\n  ) {\n\n    super();\n\n    this.style = get(options.style, {});\n    this.terminalStyle = get(options.terminalStyle, {});\n    this.id = get(options.id, getNewUUID());\n    options.state = get(options.state, {});\n\n    this.hitColor = options.hitColor;\n    this._width = width;\n    this.style = { ...DefaultNodeStyle(), ...options.style }\n    this._position = position;\n    this.setupState(options.state);\n    this.uiNodes = new Map();\n    this.terminals = new Map();\n    this.nodeButtons = new Map();\n    this._zIndex = 0;\n    this.setHitColor(options.hitColor);\n\n    this.setupTerminals(options, inputs, outputs);\n\n    if (options.ui) {\n      this.ui = options.ui instanceof Container ? options.ui : Container.deSerialize(this, options.ui)\n    } else {\n      this.ui = new Container(this, width);\n    }\n\n    this.addNodeButton(() => this.toggleNodeState(), this._renderNodeButton, Align.Left);\n\n    this.reflow();\n    this.ui.update();\n\n    this.flow.on('transform', () => this.updateRenderState());\n\n    this.flow.nodes.set(this.id, this);\n    this.flow.sortedNodes.add(this);\n    this.flow.executionGraph.add(this);\n  }\n\n  //#region Methods\n  setupTerminals(options: NodeConstructorOptions, inputs: SerializedTerminal[], outputs: SerializedTerminal[]) {\n    this.inputs.push(...inputs.map(input =>\n      new Terminal(this, TerminalType.IN, input.dataType, input.name, {\n        style: input.style ? input.style : { ...options.terminalStyle },\n        id: input.id ? input.id : null,\n        hitColor: input.hitColor ? Color.deSerialize(input.hitColor) : null\n      })\n    ));\n    this.outputs.push(...outputs.map(output =>\n      new Terminal(this, TerminalType.OUT, output.dataType, output.name, {\n        style: output.style ? output.style : { ...options.terminalStyle },\n        id: output.id ? output.id : null,\n        hitColor: output.hitColor ? Color.deSerialize(output.hitColor) : null\n      })\n    ));\n  }\n  private setupState(state: any) {\n    this.state = new Proxy<any>({}, {\n      set: (target, prop, value) => {\n        let oldValue = target[prop];\n        target[prop] = value;\n        this.stateObserver.call(prop as string, oldValue, value);\n        return true;\n      }\n    });\n\n    Object.keys(state).forEach(key => this.state[key] = state[key]);\n  }\n  watch(propName: string, callback: (oldVal: any, newVal: any) => void): number {\n    if (typeof this.state[propName] !== 'undefined') {\n      return this.stateObserver.on(propName, callback);\n    } else {\n      Log.error(`Cannot watch prop '${propName}', prop not found`);\n    }\n  }\n  unwatch(propName: string, id: number) {\n    if (typeof this.state[propName] !== 'undefined') {\n      this.stateObserver.off(propName, id);\n    } else {\n      Log.error(`Cannot unwatch prop '${propName}', prop not found`);\n    }\n  }\n  private setHitColor(hitColor: Color) {\n    if (!hitColor) {\n      hitColor = Color.Random();\n      while (this.flow.nodeHitColors.get(hitColor.rgbaString)) hitColor = Color.Random();\n    }\n    this.hitColor = hitColor;\n    this.flow.nodeHitColors.set(this.hitColor.rgbaString, this);\n  }\n  addNodeButton(callback: () => void, render: RenderFunction<NodeButton, NodeButtonRenderParams>, align: Align): NodeButton {\n    let newNodeButton = new NodeButton(this, callback, render, align);\n\n    let noOfButtons = [...this.nodeButtons.values()].filter(nodeButton => nodeButton.align === newNodeButton.align).length - 1;\n    let deltaX;\n    if (align === Align.Left) deltaX = noOfButtons * (this.style.nodeButtonSize + this.style.nodeButtonSpacing);\n    else deltaX = this.width - noOfButtons * (this.style.nodeButtonSize + this.style.nodeButtonSpacing) - this.style.nodeButtonSize;\n    newNodeButton.deltaX = deltaX;\n\n    return newNodeButton;\n  }\n  private reflow(): void {\n    let y = this.position.y + this.style.terminalRowHeight / 2 + this.style.padding / 2 + this.style.titleHeight;\n    if (this.inputs.length > this.outputs.length) {\n      this.recalculateInputTerminals(y);\n      y = this.position.y + (this.inputs.length * this.style.terminalRowHeight) / 2 - (this.outputs.length * this.style.terminalRowHeight) / 2 + this.style.terminalRowHeight / 2 + this.style.padding / 2 + this.style.titleHeight;\n      this.recalculateOutputTerminals(y);\n    } else {\n      this.recalculateOutputTerminals(y);\n      y = this.position.y + (this.outputs.length * this.style.terminalRowHeight) / 2 - (this.inputs.length * this.style.terminalRowHeight) / 2 + this.style.terminalRowHeight / 2 + this.style.padding / 2 + this.style.titleHeight;\n      this.recalculateInputTerminals(y);\n    }\n  }\n  private updateRenderState() {\n    let realPos = this.position.transform(this.flow.flowConnect.transform);\n    this.renderState.viewport = intersects(\n      0, 0,\n      this.flow.flowConnect.canvasDimensions.width, this.flow.flowConnect.canvasDimensions.height,\n      realPos.x, realPos.y,\n      realPos.x + this.width * this.flow.flowConnect.scale,\n      realPos.y + (this.renderState.nodeState === NodeState.MAXIMIZED ? this.ui.height : this.style.titleHeight) * this.flow.flowConnect.scale\n    );\n\n    if (this.flow.flowConnect.scale > 0.6) this.renderState.lod = LOD.LOD2;\n    else if (this.flow.flowConnect.scale <= 0.6 && this.flow.flowConnect.scale > .3) this.renderState.lod = LOD.LOD1;\n    else this.renderState.lod = LOD.LOD0;\n\n    if (this.renderState.viewport === ViewPort.INTERSECT) {\n      this.ui.updateRenderState();\n    }\n  }\n  private recalculateInputTerminals(y: number) {\n    this.inputs.forEach(terminal => {\n      terminal.position.x = this.position.x - this.style.terminalStripMargin - terminal.style.radius;\n      terminal.position.y = y;\n      y += this.style.terminalRowHeight;\n    });\n  }\n  private recalculateOutputTerminals(y: number) {\n    this.outputs.forEach(terminal => {\n      terminal.position.x = this.position.x + this.ui.width + this.style.terminalStripMargin + terminal.style.radius;\n      terminal.position.y = y;\n      y += this.style.terminalRowHeight;\n    });\n  }\n  getHitTerminal(hitColor: string, screenPosition: Vector2, realPosition: Vector2) {\n    let hitTerminal = null;\n\n    realPosition = realPosition.transform(this.flow.flowConnect.transform);\n    let thisRealPosition = this.position.transform(this.flow.flowConnect.transform);\n    if (\n      (this.inputs.length + this.inputsUI.length > 0 && realPosition.x < thisRealPosition.x) ||\n      (this.outputs.length + this.outputsUI.length > 0 && realPosition.x > thisRealPosition.x + this.ui.width * this.flow.flowConnect.scale)\n    ) {\n      hitTerminal = this.terminals.get(hitColor);\n    }\n\n    if (this.currHitTerminal && this.currHitTerminal !== hitTerminal) {\n      this.currHitTerminal.onExit(screenPosition, realPosition);\n      hitTerminal && hitTerminal.onEnter(screenPosition, realPosition);\n    }\n\n    return hitTerminal;\n  }\n  getHitUINode(hitColor: string): UINode {\n    let uiNode = this.uiNodes.get(hitColor);\n    if (uiNode instanceof Container) return null;\n    return uiNode;\n  }\n  private getHitNodeButton(hitColor: string): NodeButton {\n    return this.nodeButtons.get(hitColor);\n  }\n  run() {\n    if (this.flow.state === FlowState.Stopped) return;\n\n    this.call('process', this, this.inputs.map(terminal => terminal.connectors.length > 0 ? terminal.connectors[0].data : null));\n  }\n\n  render(): void {\n    if (this.renderState.viewport === ViewPort.OUTSIDE) return;\n    if (this.renderState.nodeState === NodeState.MAXIMIZED) this.ui.render();\n\n    let context = this.context;\n    context.save();\n    this.renderTerminals(context);\n    this.renderName(context);\n    this.renderFocused(context);\n    let flowRenderResolver = this.flow.renderResolver.node;\n    let flowConnectRenderResolver = this.flow.flowConnect.renderResolver.node;\n    ((this.renderResolver.node && this.renderResolver.node(this))\n      || (flowRenderResolver && flowRenderResolver(this))\n      || (flowConnectRenderResolver && flowConnectRenderResolver(this))\n      || this._render\n    )(context, this.getRenderParams(), this);\n    context.restore();\n\n    this.nodeButtons.forEach(nodeButton => nodeButton.render());\n\n    this.offContext.save();\n    this._offRender();\n    this.offContext.restore();\n\n    this.call('render', this);\n  }\n  private renderTerminals(context: CanvasRenderingContext2D) {\n    if (this.renderState.nodeState === NodeState.MAXIMIZED) {\n      if (this.renderState.lod > 0) {\n        this.inputs.forEach(terminal => terminal.render());\n        this.outputs.forEach(terminal => terminal.render());\n      }\n\n      context.fillStyle = this.style.color;\n      context.font = this.style.fontSize + ' ' + this.style.font;\n      context.textBaseline = 'middle';\n      this.inputs.forEach(terminal => {\n        context.fillText(terminal.name, terminal.position.x + terminal.style.radius + this.style.terminalStripMargin + this.style.padding, terminal.position.y);\n      });\n      this.outputs.forEach(terminal => {\n        context.fillText(terminal.name, terminal.position.x - terminal.style.radius - this.style.terminalStripMargin - this.style.padding - context.measureText(terminal.name).width, terminal.position.y);\n      });\n    } else {\n      context.fillStyle = this.style.minimizedTerminalColor;\n      if ((this.inputs.length + this.inputsUI.length) > 0) {\n        let radius = this.inputs.length > 0 ? this.inputs[0].style.radius : this.inputsUI[0].style.radius;\n        context.fillRect(this.position.x - this.style.terminalStripMargin - radius * 2, this.position.y + this.style.titleHeight / 2 - radius, radius * 2, radius * 2);\n      }\n      if ((this.outputs.length + this.outputsUI.length) > 0) {\n        let radius = this.outputs.length > 0 ? this.outputs[0].style.radius : this.outputsUI[0].style.radius;\n        context.fillRect(this.position.x + this.width + this.style.terminalStripMargin, this.position.y + this.style.titleHeight / 2 - radius, radius * 2, radius * 2);\n      }\n    }\n  }\n  private renderName(context: CanvasRenderingContext2D) {\n    context.fillStyle = this.style.titleColor;\n    context.font = this.style.titleFontSize + ' ' + this.style.titleFont;\n    context.textBaseline = 'middle';\n    context.fillText(this.name, this.position.x + this.ui.width / 2 - context.measureText(this.name).width / 2, this.position.y + this.style.titleHeight / 2);\n  }\n  private renderFocused(context: CanvasRenderingContext2D) {\n    if (this.focused) {\n      context.strokeStyle = this.style.outlineColor;\n      context.lineWidth = 2;\n\n      let inputTerminalsWidth;\n      if (this.inputs.length === 0) {\n        inputTerminalsWidth = this.inputsUI.length === 0 ? 0 : this.inputsUI[0].style.radius * 2;\n      } else {\n        inputTerminalsWidth = this.inputs[0].style.radius * 2;\n      }\n      inputTerminalsWidth += this.style.terminalStripMargin * 2;\n\n      let outputTerminalsWidth;\n      if (this.outputs.length === 0) {\n        outputTerminalsWidth = this.outputsUI.length === 0 ? 0 : this.outputsUI[0].style.radius * 2;\n      } else {\n        outputTerminalsWidth = this.outputs[0].style.radius * 2;\n      }\n      outputTerminalsWidth += this.style.terminalStripMargin * 2;\n\n      context.strokeRoundRect(\n        this.position.x - inputTerminalsWidth,\n        this.position.y,\n        this.width + inputTerminalsWidth + outputTerminalsWidth,\n        this.renderState.nodeState === NodeState.MAXIMIZED ? (this.ui.height + this.style.padding) : this.style.titleHeight,\n        4\n      );\n    }\n  }\n  private _render() { /**/ }\n  private _offRender() {\n    this.offContext.fillStyle = this.hitColor.rgbaCSSString;\n    let x = this.position.x;\n    let y = this.position.y;\n    let inputTerminalsStripWidth = 0, outputTerminalsStripWidth = 0;\n    if ((this.inputs.length + this.inputsUI.length) !== 0) {\n      let radius = this.inputs.length > 0 ? this.inputs[0].style.radius : this.inputsUI[0].style.radius;\n      x -= this.style.terminalStripMargin + radius * 2;\n      inputTerminalsStripWidth = radius * 2 + this.style.terminalStripMargin;\n    }\n    if ((this.outputs.length + this.outputsUI.length) !== 0) {\n      let radius = this.outputs.length > 0 ? this.outputs[0].style.radius : this.outputsUI[0].style.radius;\n      outputTerminalsStripWidth = radius * 2 + this.style.terminalStripMargin;\n    }\n    this.offContext.fillRect(x, y,\n      this.ui.width + inputTerminalsStripWidth + outputTerminalsStripWidth,\n      this.renderState.nodeState === NodeState.MAXIMIZED ? this.ui.height : this.style.titleHeight\n    );\n  }\n  private _renderNodeButton(context: CanvasRenderingContext2D, params: NodeButtonRenderParams, nodeButton: NodeButton) {\n    let style = nodeButton.node.style;\n    context.fillStyle = style.maximizeButtonColor;\n    context.fillRect(params.position.x, params.position.y, style.nodeButtonSize, style.nodeButtonSize);\n  }\n  private getRenderParams(): NodeRenderParams {\n    return {\n      position: this.position.serialize(),\n      width: this.width,\n      height: this.ui.height,\n      focus: this.focused\n    }\n  }\n  addTerminal(terminal: Terminal | SerializedTerminal) {\n    if (!(terminal instanceof Terminal)) {\n      terminal = Terminal.deSerialize(this, terminal);\n    }\n    if (terminal.type === TerminalType.IN) this.inputs.push(terminal);\n    else this.outputs.push(terminal);\n    this.ui.update();\n    this.reflow();\n  }\n  removeTerminal(terminal: Terminal) {\n    let type = terminal.type;\n    let index = type === TerminalType.IN ? this.inputs.indexOf(terminal) : this.outputs.indexOf(terminal);\n    if (index < 0) {\n      Log.error('Cannot remove terminal, terminal not found');\n      return;\n    }\n    terminal.disconnect();\n    if (type === TerminalType.IN) this.inputs.splice(index, 1);\n    else this.outputs.splice(index, 1);\n    terminal.offAll();\n\n    this.ui.update();\n    this.reflow();\n  }\n  getInput(terminal: string | number): any {\n    if (typeof terminal === 'string') {\n      let inputTerminal = this.inputs.find(currTerm => (currTerm.name === terminal));\n      if (inputTerminal) return inputTerminal.getData();\n    } else {\n      if (this.inputs[terminal]) return this.inputs[terminal].getData();\n    }\n    return null;\n  }\n  getInputs(): any[] {\n    return this.inputs.map(terminal => terminal.getData());\n  }\n  setOutputs(outputs: string | number | Record<string, any>, data?: any) {\n    if (typeof outputs === 'string') {\n      let outputTerminal = this.outputs.find(term => (term.name === outputs));\n      if (outputTerminal) outputTerminal.setData(data);\n    } else if (typeof outputs === 'number') {\n      if (this.outputs[outputs]) this.outputs[outputs].setData(data);\n    } else {\n      let outputData = new Map<Terminal, any>();\n      Object.entries(outputs).forEach(entry => {\n        let terminal = this.outputs.find(term => term.name === entry[0]);\n        if (terminal) outputData.set(terminal, entry[1]);\n        else throw Log.error(\"Terminal '\" + entry[0] + \"' not found\");\n      });\n      let groupedConnectors = new Map<Node, Connector[]>();\n      let outputDataIterator = outputData.keys();\n\n      let curr: Terminal = outputDataIterator.next().value;\n      while (curr) {\n        curr.connectors.forEach(connector => {\n          if (groupedConnectors.has(connector.endNode)) groupedConnectors.get(connector.endNode).push(connector);\n          else groupedConnectors.set(connector.endNode, [connector]);\n        });\n        curr = outputDataIterator.next().value;\n      }\n      let gCntrsIterator = groupedConnectors.values();\n\n      let connectors: Connector[] = gCntrsIterator.next().value;\n      while (connectors) {\n        for (let i = 1; i < connectors.length; i++) connectors[i].setData(outputData.get(connectors[i].start));\n        connectors[0].data = outputData.get(connectors[0].start);\n        connectors = gCntrsIterator.next().value;\n      }\n    }\n\n    // If FlowState is Idle, start a partial run of all the dirty nodes this method has created\n    if (this.flow.state === FlowState.Idle) {\n      this.flow.executionGraph.start();\n    }\n  }\n  toggleNodeState() {\n    this.renderState.nodeState = this.renderState.nodeState === NodeState.MAXIMIZED ? NodeState.MINIMIZED : NodeState.MAXIMIZED;\n  }\n  dispose(): void {\n    this.flow.removeNode(this.id);\n  }\n  //#endregion\n\n  //#region Events\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    this.call('down', this, screenPosition, realPosition);\n\n    let hitColor = Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data);\n\n    this.currHitUINode = this.getHitUINode(hitColor);\n    this.currHitUINode && this.currHitUINode.onDown(screenPosition, realPosition);\n\n    let hitTerminal = this.getHitTerminal(hitColor, screenPosition, realPosition);\n    if (hitTerminal) {\n      this.currHitTerminal = hitTerminal;\n      this.currHitTerminal.onDown(screenPosition, realPosition);\n    }\n  }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    this.call('over', this, screenPosition, realPosition);\n\n    let hitColor = Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data);\n\n    let hitTerminal = this.getHitTerminal(hitColor, screenPosition, realPosition);\n\n    if (hitTerminal !== this.prevHitTerminal) {\n      this.prevHitTerminal && this.prevHitTerminal.onExit(screenPosition, realPosition);\n      hitTerminal && hitTerminal.onEnter(screenPosition, realPosition);\n    } else {\n      hitTerminal && (!this.currHitTerminal) && hitTerminal.onOver(screenPosition, realPosition);\n    }\n    this.prevHitTerminal = hitTerminal;\n\n    let hitUINode = this.getHitUINode(hitColor);\n    if (hitUINode !== this.prevHitUINode) {\n      this.prevHitUINode && this.prevHitUINode.onExit(screenPosition, realPosition);\n      hitUINode && hitUINode.onEnter(screenPosition, realPosition);\n    } else {\n      hitUINode && (!this.currHitUINode) && hitUINode.onOver(screenPosition, realPosition);\n    }\n    this.prevHitUINode = hitUINode;\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2): void {\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2): void {\n    this.call('exit', this, screenPosition, realPosition);\n\n    let hitColor = Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data);\n\n    let hitTerminal = this.getHitTerminal(hitColor, screenPosition, realPosition);\n    hitTerminal && hitTerminal.onExit(screenPosition, realPosition);\n    this.prevHitTerminal && this.prevHitTerminal.onExit(screenPosition, realPosition);\n    this.prevHitTerminal = null;\n    this.currHitTerminal && this.currHitTerminal.onExit(screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    this.call('up', this, screenPosition, realPosition);\n\n    let hitColor = Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data);\n\n    this.currHitUINode = null;\n    let hitUINode = this.getHitUINode(hitColor);\n    hitUINode && hitUINode.onUp(screenPosition.clone(), realPosition.clone());\n\n    let hitTerminal = this.getHitTerminal(hitColor, screenPosition, realPosition);\n    hitTerminal && hitTerminal.onUp(screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    this.call('click', this, screenPosition, realPosition);\n\n    let hitColor = Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data);\n    if (realPosition.y < this.position.y + this.style.titleHeight * this.flow.flowConnect.scale) {\n      let hitNodeButton = this.getHitNodeButton(hitColor);\n      hitNodeButton && hitNodeButton.callback();\n    } else {\n      this.currHitTerminal && this.currHitTerminal.onClick(screenPosition, realPosition);\n\n      let hitUINode = this.getHitUINode(hitColor);\n      hitUINode && hitUINode.onClick(screenPosition.clone(), realPosition.clone());\n    }\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    this.call('drag', this, screenPosition, realPosition);\n\n    let hitColor = Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data);\n    let hitUINodeWhileDragging = this.getHitUINode(hitColor);\n\n    if (this.currHitUINode && this.currHitUINode.draggable) {\n      if (hitUINodeWhileDragging === this.currHitUINode) {\n        this.currHitUINode.onDrag(screenPosition, realPosition);\n      } else {\n        this.currHitUINode.onExit(screenPosition, realPosition);\n        this.currHitUINode = null;\n        this.flow.flowConnect.currHitNode = null;\n        this.flow.flowConnect.pointers = [];\n      }\n    }\n  }\n  onContextMenu(): void {\n    this.call('rightclick', this);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2): void {\n    this.call('wheel', this, direction, screenPosition, realPosition);\n\n    let hitColor = Color.rgbaToString(this.flow.flowConnect.offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data);\n    let hitUINode = this.getHitUINode(hitColor);\n\n    hitUINode && hitUINode.zoomable && hitUINode.onWheel(direction, screenPosition, realPosition);\n  }\n  //#endregion\n\n  //#region UICreators\n  createLabel(text: string | number, options?: LabelCreatorOptions): Label {\n    return new Label(this, text, options);\n  }\n  createImage(source: string, options?: ImageCreatorOptions): Image {\n    return new Image(this, source, options);\n  }\n  createSlider(min: number, max: number, options?: SliderCreatorOptions) {\n    return new Slider(this, min, max, options);\n  }\n  createSlider2D(options?: Slider2DCreatorOptions) {\n    return new Slider2D(this, options);\n  }\n  createVSlider(min: number, max: number, options?: VSliderCreatorOptions) {\n    return new VSlider(this, min, max, options);\n  }\n  createDial(min: number, max: number, size: number, options?: DialCreatorOptions) {\n    return new Dial(this, min, max, size, options);\n  }\n  createHozLayout(childs: UINode[] = [], options?: HorizontalLayoutCreatorOptions) {\n    return new HorizontalLayout(this, childs, options);\n  }\n  createStack(options?: StackCreatorOptions) {\n    return new Stack(this, options);\n  }\n  createButton(text: string, options?: ButtonCreatorOption) {\n    return new Button(this, text, options);\n  }\n  createToggle(options?: ToggleCreatorOptions) {\n    return new Toggle(this, options);\n  }\n  createRadioGroup(values?: string[], selected?: string, options?: RadioGroupCreatorOptions) {\n    return new RadioGroup(this, values, selected, options);\n  }\n  createSelect(values: string[], options?: SelectCreatorOptions) {\n    return new Select(this, values, options);\n  }\n  createSource(options?: SourceCreatorOptions) {\n    return new Source(this, options);\n  }\n  createDisplay(height: number, renderers: CustomRendererConfig[], options?: DisplayCreatorOptions) {\n    return new Display(this, height, renderers, options);\n  }\n  createInput(options?: InputCreatorOptions) {\n    return new Input(this, options);\n  }\n  createEnvelope(height: number, values?: Vector2[], options?: EnvelopeCreatorOptions): Envelope {\n    return new Envelope(this, height, values, options);\n  }\n  //#endregion\n\n  serialize(): SerializedNode {\n    return {\n      id: this.id,\n      name: this.name,\n      position: this.position.serialize(),\n      width: this.width,\n      state: this.state,\n      inputs: this.inputs.map(terminal => terminal.serialize()),\n      outputs: this.outputs.map(terminal => terminal.serialize()),\n      style: this.style,\n      terminalStyle: this.terminalStyle,\n      hitColor: this.hitColor.serialize(),\n      zIndex: this.zIndex,\n      focused: this.focused,\n      renderState: this.renderState,\n      ui: this.ui.serialize()\n    };\n  }\n  static deSerialize(flow: Flow, data: SerializedNode): Node {\n    return new Node(flow, data.name, Vector2.deSerialize(data.position), data.width, data.inputs, data.outputs, {\n      style: data.style,\n      terminalStyle: data.terminalStyle,\n      state: data.state,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor),\n      ui: data.ui\n    });\n  }\n}\n\nexport interface NodeRenderParams {\n  position: SerializedVector2,\n  width: number,\n  height: number,\n  focus: boolean\n}\nexport enum NodeState {\n  MAXIMIZED,\n  MINIMIZED\n}\n\nexport interface NodeStyle {\n  font?: string,\n  fontSize?: string,\n  titleFont?: string,\n  titleFontSize?: string,\n  padding?: number,\n  spacing?: number,\n  rowHeight?: number,\n  color?: string,\n  titleColor?: string,\n  titleHeight?: number,\n  terminalRowHeight?: number,\n  terminalStripMargin?: number,\n  maximizeButtonColor?: string,\n  expandButtonColor?: string;\n  minimizedTerminalColor?: string,\n  nodeButtonSize?: number,\n  nodeButtonSpacing?: number,\n  outlineColor?: string\n}\nlet DefaultNodeStyle = () => {\n  return {\n    font: 'arial',\n    fontSize: '.75rem',\n    titleFont: 'arial',\n    titleFontSize: '.85rem',\n    color: '#000',\n    titleColor: '#000',\n    maximizeButtonColor: 'darkgrey',\n    nodeButtonSize: 10,\n    nodeButtonSpacing: 5,\n    expandButtonColor: '#000',\n    minimizedTerminalColor: 'green',\n    outlineColor: '#000',\n    padding: 10,\n    spacing: 10,\n    rowHeight: 20,\n    titleHeight: 29,\n    terminalRowHeight: 24,\n    terminalStripMargin: 8\n  };\n};\n\nexport interface SerializedNode {\n  hitColor: SerializedColor,\n  zIndex: number,\n  focused: boolean,\n  id: string,\n  position: SerializedVector2,\n  state: Record<string, any>,\n  renderState: RenderState,\n  inputs: SerializedTerminal[],\n  outputs: SerializedTerminal[],\n  name: string,\n  style: NodeStyle,\n  terminalStyle: TerminalStyle,\n  ui: SerializedContainer,\n  width: number,\n  subFlow?: SerializedFlow\n}\n\nexport interface NodeConstructorOptions {\n  style?: NodeStyle,\n  terminalStyle?: TerminalStyle,\n  state?: Object,\n  id?: string,\n  hitColor?: Color,\n  ui?: Container | SerializedContainer\n}\nlet DefaultNodeConstructorOptions = (): NodeConstructorOptions => {\n  return {\n    style: {},\n    terminalStyle: {},\n    state: {},\n    id: getNewUUID(),\n  }\n}\n\ninterface ToggleCreatorOptions {\n  propName?: string,\n  input?: boolean,\n  output?: boolean,\n  height?: number,\n  style?: ToggleStyle\n}\ninterface StackCreatorOptions {\n  childs?: UINode[],\n  style?: StackStyle\n}\ninterface SourceCreatorOptions {\n  accept?: string,\n  propName?: string,\n  input?: boolean,\n  output?: boolean,\n  height?: number,\n  style?: SourceStyle\n}\ninterface SliderCreatorOptions {\n  value?: number,\n  propName?: string,\n  input?: boolean,\n  output?: boolean,\n  height?: number,\n  style?: SliderStyle\n}\ninterface VSliderCreatorOptions {\n  value?: number,\n  propName?: string,\n  input?: boolean,\n  output?: boolean,\n  height?: number,\n  width?: number,\n  style?: VSliderStyle\n}\ninterface Slider2DCreatorOptions {\n  value?: Vector2,\n  propName?: string,\n  input?: boolean,\n  output?: boolean,\n  height?: number,\n  style?: Slider2DStyle\n}\ninterface SelectCreatorOptions {\n  height?: number,\n  propName?: string,\n  input?: boolean,\n  output?: boolean,\n  style?: SelectStyle\n}\ninterface RadioGroupCreatorOptions {\n  propName?: string,\n  input?: boolean,\n  output?: boolean,\n  height?: number,\n  style?: RadioGroupStyle\n}\ninterface LabelCreatorOptions {\n  propName?: string,\n  input?: boolean,\n  output?: boolean,\n  style?: LabelStyle,\n  height?: number\n}\ninterface InputCreatorOptions {\n  value?: string | number,\n  propName?: string,\n  input?: boolean,\n  output?: boolean,\n  height?: number,\n  style?: InputStyle\n}\ninterface ImageCreatorOptions {\n  propName?: string,\n  style?: ImageStyle\n}\ninterface HorizontalLayoutCreatorOptions {\n  style?: HorizontalLayoutStyle,\n  input?: boolean,\n  output?: boolean\n}\ninterface ButtonCreatorOption {\n  input?: boolean,\n  output?: boolean,\n  height?: number,\n  style?: ButtonStyle\n}\ninterface DialCreatorOptions {\n  value?: number\n  propName?: string,\n  input?: boolean,\n  output?: boolean,\n  style?: DialStyle,\n}\ninterface DisplayCreatorOptions {\n  style?: DisplayStyle\n}\ninterface EnvelopeCreatorOptions {\n  input?: boolean,\n  output?: boolean,\n  style?: EnvelopeStyle\n}\n\nexport class NodeButton extends Hooks implements Renderable {\n  renderResolver: RenderResolver<NodeButton, NodeButtonRenderParams> = () => null;\n  defaultRenderFn: RenderFunction<NodeButton, NodeButtonRenderParams>;\n  style: Record<string, any> = {};\n\n  hitColor: Color;\n  deltaX: number = 0;\n\n  constructor(\n    public node: Node,\n    public callback: () => void,\n    render: RenderFunction<NodeButton, NodeButtonRenderParams>,\n    public align: Align,\n    style?: Record<string, any>\n  ) {\n    super();\n\n    this.style = get(style, {});\n    this.setHitColor();\n    this.defaultRenderFn = render;\n  }\n\n  private setHitColor() {\n    let color = Color.Random();\n    while (this.node.nodeButtons.get(color.rgbaString)) color = Color.Random();\n    this.hitColor = color;\n    this.node.nodeButtons.set(this.hitColor.rgbaString, this);\n  }\n  render() {\n    this.node.context.save();\n    let nodeRenderResolver = this.node.renderResolver.nodeButton;\n    let flowRenderResolver = this.node.flow.renderResolver.nodeButton;\n    let flowConnectRenderResolver = this.node.flow.flowConnect.renderResolver.nodeButton;\n    ((this.renderResolver && this.renderResolver(this))\n      || (nodeRenderResolver && nodeRenderResolver(this))\n      || (flowRenderResolver && flowRenderResolver(this))\n      || (flowConnectRenderResolver && flowConnectRenderResolver(this))\n      || this.defaultRenderFn\n    )(this.node.context, this.getRenderParams(), this);\n    this.node.context.restore();\n\n    this.node.offUIContext.save();\n    this._offUIRender();\n    this.node.offUIContext.restore();\n\n    this.call('render', this);\n  }\n  private getRenderParams(): NodeButtonRenderParams {\n    let position = this.node.position.serialize();\n    position.x += this.deltaX;\n    position.y += (this.node.style.titleHeight / 2 - this.node.style.nodeButtonSize / 2);\n    return { position }\n  }\n  private _offUIRender() {\n    this.node.offUIContext.fillStyle = this.hitColor.rgbaCSSString;\n    this.node.offUIContext.fillRect(\n      this.node.position.x + this.deltaX,\n      this.node.position.y + this.node.style.titleHeight / 2 - this.node.style.nodeButtonSize / 2,\n      this.node.style.nodeButtonSize,\n      this.node.style.nodeButtonSize\n    );\n  }\n}\nexport interface NodeButtonRenderParams {\n  position: SerializedVector2\n}\n","import { Vector2 } from './vector';\nimport { Color } from './color';\nimport { Flow, FlowState } from './flow';\nimport { Node, NodeButton, NodeStyle, SerializedNode, NodeButtonRenderParams } from './node';\nimport { Terminal, TerminalType, TerminalStyle } from './terminal';\nimport { TunnelNode } from './tunnel-node';\nimport { Align } from '../common/enums';\n\nexport class SubFlowNode extends Node {\n  subFlow: Flow;\n\n  constructor(\n    flow: Flow,\n    subFlow: Flow,\n    position: Vector2,\n    width: number,\n    inputs: any[],\n    outputs: any[],\n    options: SubFlowOptions = DefaultSubFlowOptions()\n  ) {\n\n    super(flow, options.name || 'New SubFlow', position, width, inputs ? inputs : [], outputs ? outputs : [], {\n      style: options.style,\n      terminalStyle: options.terminalStyle,\n      state: options.state,\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.subFlow = subFlow;\n\n    this.subFlow.on('add-input', (_, tunnel: TunnelNode) => {\n      let proxyTerminal = new Terminal(this, TerminalType.IN, tunnel.outputs[0].dataType, tunnel.outputs[0].name);\n      tunnel.proxyTerminal = proxyTerminal;\n      this.addTerminal(proxyTerminal);\n    });\n    this.subFlow.on('add-output', (_, tunnel: TunnelNode) => {\n      let proxyTerminal = new Terminal(this, TerminalType.OUT, tunnel.inputs[0].dataType, tunnel.inputs[0].name);\n      tunnel.proxyTerminal = proxyTerminal;\n      this.addTerminal(proxyTerminal);\n    });\n\n    this.subFlow.inputs.forEach((inputNode, index) => inputNode.proxyTerminal = this.inputs[index]);\n    this.subFlow.outputs.forEach((outputNode, index) => outputNode.proxyTerminal = this.outputs[index]);\n\n    this.addNodeButton(\n      () => this.flow.flowConnect.render(this.subFlow),\n      (context: CanvasRenderingContext2D, params: NodeButtonRenderParams, nodeButton: NodeButton) => {\n        let style = nodeButton.node.style;\n\n        context.strokeStyle = style.expandButtonColor;\n        context.beginPath();\n        context.moveTo(params.position.x, params.position.y + style.nodeButtonSize / 2);\n        context.lineTo(params.position.x, params.position.y + style.nodeButtonSize);\n        context.lineTo(params.position.x + style.nodeButtonSize, params.position.y);\n        context.lineTo(params.position.x + style.nodeButtonSize, params.position.y + style.nodeButtonSize / 2);\n        context.moveTo(params.position.x + style.nodeButtonSize, params.position.y);\n        context.lineTo(params.position.x + style.nodeButtonSize / 2, params.position.y);\n        context.moveTo(params.position.x, params.position.y + style.nodeButtonSize);\n        context.lineTo(params.position.x + style.nodeButtonSize / 2, params.position.y + style.nodeButtonSize);\n        context.closePath();\n\n        context.stroke();\n      }, Align.Right\n    );\n  }\n\n  run() {\n    if (this.flow.state === FlowState.Stopped) return;\n    this.subFlow.start();\n  }\n  serialize(): SerializedNode {\n    return {\n      id: this.id,\n      name: this.name,\n      position: this.position.serialize(),\n      width: this.width,\n      state: this.state,\n      inputs: this.inputs.map(terminal => terminal.serialize()),\n      outputs: this.outputs.map(terminal => terminal.serialize()),\n      style: this.style,\n      terminalStyle: this.terminalStyle,\n      hitColor: this.hitColor.serialize(),\n      zIndex: this.zIndex,\n      focused: this.focused,\n      renderState: this.renderState,\n      ui: this.ui.serialize(),\n      subFlow: this.subFlow.serialize()\n    };\n  }\n  static deSerialize(flow: Flow, data: SerializedNode): SubFlowNode {\n    let subFlow = Flow.deSerialize(flow.flowConnect, data.subFlow);\n    return new SubFlowNode(flow, subFlow, Vector2.deSerialize(data.position), data.width, data.inputs, data.outputs, {\n      name: data.name,\n      style: data.style,\n      terminalStyle: data.terminalStyle,\n      state: data.state,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface SubFlowOptions {\n  name?: string,\n  style?: NodeStyle,\n  terminalStyle?: TerminalStyle,\n  state?: Object,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultSubFlowOptions = (): SubFlowOptions => {\n  return {\n    style: {},\n    terminalStyle: {},\n    state: {}\n  }\n}\n","import { Vector2, SerializedVector2 } from \"./vector\";\nimport { getNewUUID, canConnect, get, exists } from \"../utils/utils\";\nimport { Color, SerializedColor } from \"./color\";\nimport { Connector, ConnectorStyle } from './connector';\nimport { Hooks } from './hooks';\nimport { Node } from './node';\nimport { Events, Renderable, RenderResolver, Serializable } from \"../common/interfaces\";\nimport { Log } from \"../utils/logger\";\nimport { Constant } from \"../resource/constants\";\n\nexport class Terminal extends Hooks implements Events, Serializable, Renderable {\n  /**\n   * Terminals can hold any user-defined reference, using this variable to store a reference to something (and thereby binding it to this terminal) is helpful in special applications\n   * for e.g audio connections - terminal can hold a reference to WebAudio Node which can be used to connect said AudioNodes when two terminals are connected,\n   * almost all StandardNodes.Audio nodes uses this variable.\n   * This can be ignored for other applications where such pattern is not useful or doesn't make sense.\n  **/\n  ref: any;\n  connectors: Connector[];\n  focus: boolean;\n  position: Vector2;\n  hitColor: Color;\n  style: TerminalStyle;\n  id: string;\n  private _propName: string;\n  private watcherId: number;\n\n  get propName(): string { return this._propName; }\n  set propName(propName: string) {\n    if (!propName || propName === '') {\n      Log.error('Failed to set prop name \\'' + propName + '\\', prop name is invalid');\n      return;\n    }\n\n    let oldPropName = this._propName;\n    let newPropName = propName;\n    if (exists(this.watcherId)) { this.node.unwatch(oldPropName, this.watcherId); }\n    this._propName = newPropName;\n    this.watcherId = this.node.watch(newPropName, (_oldVal: any, newVal: any) => {\n      if (this.type === TerminalType.OUT) this.setData(newVal);\n    });\n  }\n\n  renderResolver: RenderResolver<Terminal, TerminalRenderParams> = () => null;\n\n  constructor(\n    public node: Node,\n    public type: TerminalType,\n    public dataType: string,\n    public name: string,\n    public options = DefaultTerminalOptions()\n  ) {\n\n    super();\n    this.hitColor = options.hitColor;\n    if (options.propName) this.propName = options.propName;\n    this.style = options.style ? { ...DefaultTerminalStyle(), ...options.style } : DefaultTerminalStyle();\n    this.id = get(options.id, getNewUUID());\n    this.setHitColor(this.hitColor);\n    this.connectors = [];\n    this.position = Vector2.Zero();\n    this.focus = false;\n\n    if (this.type === TerminalType.IN) {\n      this.on('data', (_inst, data) => {\n        if (this.propName) this.node.state[this.propName] = data;\n      });\n    }\n  }\n\n  getData(): any {\n    if (this.type === TerminalType.OUT) { Log.error(\"Cannot call 'getData' on output terminal\"); return; }\n    if (this.connectors.length > 0) return this.connectors[0].data;\n    return null;\n  }\n  setData(data: any) {\n    if (this.type === TerminalType.IN) { Log.error(\"Cannot call 'setData' on input terminal\"); return; }\n    this.connectors.forEach(connector => connector.data = data);\n  }\n  private setHitColor(hitColor: Color) {\n    if (!hitColor) {\n      hitColor = Color.Random();\n      while (this.node.terminals.get(hitColor.rgbaString) || this.node.uiNodes.get(hitColor.rgbaString)) hitColor = Color.Random();\n    }\n    this.hitColor = hitColor;\n    this.node.terminals.set(this.hitColor.rgbaString, this);\n  }\n  render() {\n    let context = this.node.context;\n    context.save();\n    let nodeRenderResolver = this.node.renderResolver.terminal;\n    let flowRenderResolver = this.node.flow.renderResolver.terminal;\n    let flowConnectRenderResolver = this.node.flow.flowConnect.renderResolver.terminal;\n    ((this.renderResolver && this.renderResolver(this))\n      || (nodeRenderResolver && nodeRenderResolver(this))\n      || (flowRenderResolver && flowRenderResolver(this))\n      || (flowConnectRenderResolver && flowConnectRenderResolver(this))\n      || this._render\n    )(context, this.getRenderParams(), this);\n    context.restore();\n\n    this.offUIRender();\n\n    this.call('render', this);\n  }\n  _render(context: CanvasRenderingContext2D, params: TerminalRenderParams, terminal: Terminal) {\n    if (params.focus) {\n      context.beginPath();\n      context.arc(params.position.x, params.position.y, terminal.style.radius * 3, 0, Constant.TAU);\n      context.fillStyle = terminal.style.outerFocusColor;\n      context.fill();\n    }\n\n    if (terminal.dataType === 'event') {\n      context.beginPath();\n      context.moveTo(params.position.x, params.position.y - terminal.style.radius * 1.3);\n      context.lineTo(params.position.x + terminal.style.radius * 1.3, params.position.y);\n      context.lineTo(params.position.x, params.position.y + terminal.style.radius * 1.3);\n      context.lineTo(params.position.x - terminal.style.radius * 1.3, params.position.y);\n      context.lineTo(params.position.x, params.position.y - terminal.style.radius * 1.3);\n      context.closePath();\n    } else {\n      context.beginPath();\n      context.arc(params.position.x, params.position.y, terminal.style.radius, 0, Constant.TAU);\n    }\n    context.fillStyle = params.focus ? terminal.style.focusColor : (terminal.node.flow.terminalColors[terminal.dataType] || terminal.style.color);\n    context.strokeStyle = terminal.style.borderColor;\n    context.shadowBlur = terminal.style.shadowBlur;\n    context.shadowColor = terminal.style.shadowColor;\n    context.fill();\n    context.stroke();\n  }\n  getRenderParams(): TerminalRenderParams {\n    return {\n      focus: this.focus,\n      position: this.position.serialize()\n    };\n  }\n  connect(otherTerminal: Terminal, style?: ConnectorStyle): boolean {\n    // Check if already connected\n    if (this.type !== otherTerminal.type) {\n      let start = this.type === TerminalType.OUT ? this : otherTerminal;\n      let end = this.type === TerminalType.IN ? this : otherTerminal;\n      if (end.connectors.length > 0 && start.connectors.includes(end.connectors[0])) return false;\n    }\n\n    // Check if these terminals can be connected\n    if (canConnect(this, otherTerminal, this.node.flow.rules, this.node.flow.executionGraph)) {\n      let newConnector = new Connector(\n        this.node.flow,\n        this.type === TerminalType.OUT ? this : otherTerminal,\n        this.type === TerminalType.IN ? this : otherTerminal,\n        { style }\n      );\n      this.node.flow.connectors.set(newConnector.id, newConnector);\n\n      return true;\n    } else return false;\n  }\n  /**\n   * Disconnects terminal to terminal connections.\n   * If no parameters are passed and the terminal on which this method is called is an output terminal then,\n   * all the connections going out from this terminal will be diconnected.\n   * \n   * @param connector optional connector Id or reference, used only when the terminal on which this method is called is an Output terminal\n   * @returns \n   */\n  disconnect(connector?: string | Connector): boolean {\n    if (this.type === TerminalType.IN) {\n      this._disconnect(this.connectors[0]);\n      return true;\n    } else {\n      if (typeof connector === 'string') {\n        let cntr = this.connectors.find((currCntr => currCntr.id === connector));\n        if (!cntr) {\n          Log.error('Connector not found while disconnecting', connector);\n          return false;\n        }\n        this._disconnect(cntr);\n      } else if (connector instanceof Connector) {\n        if (!this.connectors.find(cntr => cntr.id === connector.id)) {\n          Log.error('Connector cannot be disconnected from the terminal because its not associated with it', connector);\n          return false;\n        }\n        this._disconnect(connector);\n      } else {\n        this.connectors.forEach(cntr => this._disconnect(cntr));\n      }\n      return true;\n    }\n  }\n  private _disconnect(connector: Connector): void {\n    let [startTerm, endTerm] = [connector.start, connector.end];\n    this.node.flow.connectors.delete(connector.id);\n    connector.start.connectors.splice(connector.start.connectors.findIndex(cntr => cntr.id === connector.id), 1);\n    connector.end.connectors.pop();\n    this.node.flow.executionGraph.disconnect(startTerm.node, endTerm.node);\n    connector.start.onDisconnect(connector, startTerm, endTerm);\n    connector.end.onDisconnect(connector, startTerm, endTerm);\n  }\n  private offUIRender() {\n    let context = this.node.offUIContext;\n    context.save();\n\n    context.beginPath();\n    context.arc(this.position.x, this.position.y, this.style.radius + this.node.style.terminalStripMargin, 0, Constant.TAU);\n    context.fillStyle = this.hitColor.rgbaCSSString;\n    context.fill();\n\n    context.restore();\n  }\n  isConnected(): boolean {\n    return this.connectors.length > 0;\n  }\n\n  onEnter(screenPosition: Vector2, realPosition: Vector2): void {\n    this.call('enter', this, screenPosition, realPosition);\n\n    this.focus = true;\n    this.node.flow.flowConnect.cursor = 'pointer';\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2): void {\n    this.call('exit', this, screenPosition, realPosition);\n\n    this.focus = false;\n    this.node.flow.flowConnect.cursor = 'unset';\n  }\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    this.call('down', this, screenPosition, realPosition);\n\n    if (this.connectors.length > 0) {\n      if (this.type === TerminalType.IN) {\n        let [startTerm, endTerm] = [this.connectors[0].start, this.connectors[0].end];\n        this.connectors[0].endNode.currHitTerminal = null;\n        this.connectors[0].end = null;\n        this.connectors[0].endNode = null;\n        this.connectors[0].floatingTip = realPosition;\n        this.node.flow.flowConnect.floatingConnector = this.connectors[0];\n        let removedConnector = this.connectors.pop();\n        this.node.flow.executionGraph.disconnect(startTerm.node, endTerm.node);\n        removedConnector.start.onDisconnect(removedConnector, startTerm, endTerm);\n        this.onDisconnect(removedConnector, startTerm, endTerm);\n      } else {\n        if (this.node.flow.flowConnect.floatingConnector) return;\n        let connector = new Connector(this.node.flow, this, null, { floatingTip: realPosition });\n        this.node.flow.connectors.set(connector.id, connector);\n        this.node.flow.flowConnect.floatingConnector = connector;\n      }\n    } else {\n      if (this.node.flow.flowConnect.floatingConnector) return;\n      let connector = new Connector(\n        this.node.flow,\n        this.type === TerminalType.IN ? null : this,\n        this.type === TerminalType.IN ? this : null,\n        { floatingTip: realPosition }\n      );\n      this.node.flow.connectors.set(connector.id, connector);\n      this.node.flow.flowConnect.floatingConnector = connector;\n    }\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    this.call('rightclick', this);\n  }\n  onConnect(connector: Connector) {\n    this.call('connect', this, connector);\n  }\n  onDisconnect(connector: Connector, startTerminal?: Terminal, endTerminal?: Terminal) {\n    this.call('disconnect', this, connector, startTerminal, endTerminal);\n  }\n\n  onEvent(data: any): void {\n    if (this.type === TerminalType.IN) {\n      this.call('event', this, data);\n    }\n  }\n  emit(data: any) {\n    if (this.type === TerminalType.OUT && this.connectors.length !== 0) {\n      this.connectors.forEach(connector => {\n        connector.end && connector.end.onEvent(data);\n      });\n      this.call('emit', this, data);\n    }\n  }\n\n  serialize(): SerializedTerminal {\n    return {\n      name: this.name,\n      type: this.type,\n      dataType: this.dataType,\n      propName: this.propName,\n      id: this.id,\n      style: this.style,\n      hitColor: this.hitColor.serialize()\n    };\n  }\n  static deSerialize(node: Node, data: SerializedTerminal): Terminal {\n    return new Terminal(node, data.type, data.dataType, data.name, {\n      propName: data.propName,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport enum TerminalType {\n  IN = 1,\n  OUT = 2\n}\n\nexport interface SerializedTerminal {\n  name: string;\n  dataType: string;\n  type?: TerminalType;\n  propName?: string,\n  id?: string;\n  hitColor?: SerializedColor;\n  style?: TerminalStyle\n}\n\nexport interface TerminalStyle {\n  radius?: number,\n  color?: string,\n  borderColor?: string,\n  shadowColor?: string,\n  shadowBlur?: number,\n  focusColor?: string,\n  outerFocusColor?: string\n}\nlet DefaultTerminalStyle = () => {\n  return {\n    radius: 4,\n    color: '#888',\n    borderColor: '#222',\n    shadowBlur: 0,\n    shadowColor: '#ccc',\n    focusColor: '#00ff00',\n    outerFocusColor: '#bbbbbb80'\n  };\n}\n\nexport interface TerminalRenderParams {\n  focus: boolean,\n  position: SerializedVector2\n}\n\nexport interface TerminalOptions {\n  propName?: string,\n  style?: TerminalStyle,\n  id?: string,\n  hitColor?: Color\n}\nconst DefaultTerminalOptions = (): TerminalOptions => {\n  return {\n    style: {}\n  };\n}\n","import { Vector2 } from \"./vector\";\nimport { Color } from \"./color\";\nimport { Flow } from \"./flow\";\nimport { Node, NodeStyle, SerializedNode } from \"./node\";\nimport { Terminal, TerminalStyle } from \"./terminal\";\n\nexport class TunnelNode extends Node {\n  private _proxyTerminal: Terminal;\n  \n  get proxyTerminal(): Terminal { return this._proxyTerminal; }\n  set proxyTerminal(terminal: Terminal) {\n    this._proxyTerminal = terminal;\n    this._proxyTerminal.on('data', (_, data) => this.outputs[0].setData(data));\n  }\n\n  constructor(\n    flow: Flow,\n    name: string,\n    position: Vector2,\n    width: number,\n    inputs: any[],\n    outputs: any[],\n    options: TunnelNodeOptions = DefaultTunnelNodeOptions()\n  ) {\n\n    super(flow, name, position, width, inputs, outputs, {\n      style: options.style,\n      terminalStyle: options.terminalStyle,\n      state: options.state,\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    if (this.inputs.length > 0) {\n      this.inputs[0].on('data', (_, data) => this.proxyTerminal.setData(data));\n    } else {\n      this.outputs[0].on('connect', (_, connector) => {\n        if (this.proxyTerminal.connectors.length > 0) {\n          connector.data = this.proxyTerminal.connectors[0].data;\n        }\n      });\n    }\n  }\n\n  serialize(): SerializedTunnelNode {\n    return {\n      id: this.id,\n      name: this.name,\n      position: this.position.serialize(),\n      width: this.width,\n      state: this.state,\n      inputs: this.inputs.map(terminal => terminal.serialize()),\n      outputs: this.outputs.map(terminal => terminal.serialize()),\n      style: this.style,\n      terminalStyle: this.terminalStyle,\n      hitColor: this.hitColor.serialize(),\n      zIndex: this.zIndex,\n      focused: this.focused,\n      renderState: this.renderState,\n      ui: this.ui.serialize(),\n      proxyTerminalId: this.proxyTerminal.id\n    }\n  }\n  static deSerialize(flow: Flow, data: SerializedTunnelNode): TunnelNode {\n    return new TunnelNode(flow, data.name, Vector2.deSerialize(data.position), data.width, data.inputs, data.outputs, {\n      style: data.style,\n      terminalStyle: data.terminalStyle,\n      state: data.state,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface SerializedTunnelNode extends SerializedNode {\n  proxyTerminalId: string\n}\n\nexport interface TunnelNodeOptions {\n  style?: NodeStyle,\n  terminalStyle?: TerminalStyle,\n  state?: Object,\n  id?: string,\n  hitColor?: Color,\n}\nlet DefaultTunnelNodeOptions = (): TunnelNodeOptions => {\n  return {\n    style: {},\n    terminalStyle: {},\n    state: {}\n  }\n}\n","import { Serializable } from '../common/interfaces';\nimport { normalize, clamp } from '../utils/utils';\n\nexport class Vector2 implements Serializable {\n  x: number;\n  y: number;\n\n  constructor(xOrDOMPoint: number | DOMPoint, y?: number) {\n    if (xOrDOMPoint instanceof DOMPoint)\n      [this.x, this.y] = [xOrDOMPoint.x, xOrDOMPoint.y];\n    else\n      [this.x, this.y] = [xOrDOMPoint || 0, y || 0];\n  }\n\n  addInPlace(vector: Vector2): Vector2;\n  addInPlace(scalar: number): Vector2;\n  addInPlace(x: number, y: number): Vector2;\n  addInPlace(arg1: number | Vector2, arg2?: number): Vector2 {\n    if (arg1 instanceof Vector2) {\n      this.x += arg1.x;\n      this.y += arg1.y;\n    } else if (typeof arg2 === 'undefined') {\n      this.x += arg1;\n      this.y += arg1;\n    } else {\n      this.x += arg1;\n      this.y += arg2;\n    }\n    return this;\n  }\n  multiplyInPlace(vector: Vector2): Vector2;\n  multiplyInPlace(scalar: number): Vector2;\n  multiplyInPlace(x: number, y: number): Vector2;\n  multiplyInPlace(arg1: number | Vector2, arg2?: number): Vector2 {\n    if (arg1 instanceof Vector2) {\n      this.x *= arg1.x;\n      this.y *= arg1.y;\n    } else if (typeof arg2 === 'undefined') {\n      this.x *= arg1;\n      this.y *= arg1;\n    } else {\n      this.x *= arg1;\n      this.y *= arg2;\n    }\n    return this;\n  }\n  subtractInPlace(vector: Vector2): Vector2;\n  subtractInPlace(scalar: number): Vector2;\n  subtractInPlace(x: number, y: number): Vector2;\n  subtractInPlace(arg1: number | Vector2, arg2?: number): Vector2 {\n    if (arg1 instanceof Vector2) {\n      this.x -= arg1.x;\n      this.y -= arg1.y;\n    } else if (typeof arg2 === 'undefined') {\n      this.x -= arg1;\n      this.y -= arg1;\n    } else {\n      this.x -= arg1;\n      this.y -= arg2;\n    }\n    return this;\n  }\n  normalizeInPlace(min: number, max: number): Vector2;\n  normalizeInPlace(minX: number, maxX: number, minY: number, maxY: number): Vector2;\n  normalizeInPlace(min: number, max: number, minY?: number, maxY?: number): Vector2 {\n    if (typeof minY !== 'undefined' && typeof maxY !== 'undefined') {\n      this.x = normalize(this.x, min, max);\n      this.y = normalize(this.y, minY, maxY);\n    } else {\n      this.x = normalize(this.x, min, max);\n      this.y = normalize(this.y, min, max);\n    }\n\n    return this;\n  }\n  clampInPlace(min: number, max: number): Vector2;\n  clampInPlace(minX: number, maxX: number, minY: number, maxY: number): Vector2;\n  clampInPlace(min: number, max: number, minY?: number, maxY?: number): Vector2 {\n    if (typeof minY !== 'undefined' && typeof maxY !== 'undefined') {\n      this.x = clamp(this.x, min, max);\n      this.y = clamp(this.y, minY, maxY);\n    } else {\n      this.x = clamp(this.x, min, max);\n      this.y = clamp(this.y, min, max);\n    }\n\n    return this;\n  }\n  transformInPlace(transform: DOMMatrix): Vector2 {\n    let transformedPoint = transform.transformPoint(this);\n    [this.x, this.y] = [transformedPoint.x, transformedPoint.y];\n    return this;\n  }\n  absInPlace(): Vector2 {\n    this.x = Math.abs(this.x);\n    this.y = Math.abs(this.y);\n    return this;\n  }\n\n  add(vector: Vector2): Vector2;\n  add(scalar: number): Vector2;\n  add(x: number, y: number): Vector2;\n  add(arg1: number | Vector2, arg2?: number): Vector2 {\n    return (new Vector2(this.x, this.y) as any).addInPlace(arg1, arg2);\n  }\n  multiply(vector: Vector2): Vector2;\n  multiply(scalar: number): Vector2;\n  multiply(x: number, y: number): Vector2;\n  multiply(arg1: number | Vector2, arg2?: number): Vector2 {\n    return (new Vector2(this.x, this.y) as any).multiplyInPlace(arg1, arg2);\n  }\n  subtract(vector: Vector2): Vector2;\n  subtract(scalar: number): Vector2;\n  subtract(x: number, y: number): Vector2;\n  subtract(arg1: number | Vector2, arg2?: number): Vector2 {\n    return (new Vector2(this.x, this.y) as any).subtractInPlace(arg1, arg2);\n  }\n  normalize(min: number, max: number): Vector2;\n  normalize(minX: number, maxX: number, minY: number, maxY: number): Vector2;\n  normalize(min: number, max: number, minY?: number, maxY?: number): Vector2 {\n    return new Vector2(this.x, this.y).normalizeInPlace(min, max, minY, maxY);\n  }\n  clamp(min: number, max: number): Vector2;\n  clamp(minX: number, maxX: number, minY: number, maxY: number): Vector2;\n  clamp(min: number, max: number, minY?: number, maxY?: number): Vector2 {\n    return new Vector2(this.x, this.y).clampInPlace(min, max, minY, maxY);\n  }\n  isInside(start: Vector2, end: Vector2): boolean;\n  isInside(x1: number, y1: number, x2: number, y2: number): boolean;\n  isInside(arg1: number | Vector2, arg2: number | Vector2, arg3?: number, arg4?: number): boolean {\n    if (arg1 instanceof Vector2 && arg2 instanceof Vector2) {\n      if (this.x < arg1.x || this.x > arg2.x) return false;\n      if (this.y < arg1.y || this.y > arg2.y) return false;\n    } else {\n      if (this.x < arg1 || this.x > arg3) return false;\n      if (this.y < arg2 || this.y > arg4) return false;\n    }\n\n    return true;\n  }\n  assign(vector: Vector2): Vector2;\n  assign(scalar: number): Vector2;\n  assign(x: number, y: number): Vector2;\n  assign(arg1: number | Vector2, arg2?: number): Vector2 {\n    if (arg1 instanceof Vector2) {\n      this.x = arg1.x;\n      this.y = arg1.y;\n    } else if (typeof arg2 === 'undefined') {\n      this.x = arg1;\n      this.y = arg1;\n    } else {\n      this.x = arg1;\n      this.y = arg2;\n    }\n    return this;\n  }\n  transform(transform: DOMMatrix): Vector2 {\n    return new Vector2(this.x, this.y).transformInPlace(transform);\n  }\n  abs(): Vector2 {\n    return new Vector2(this.x, this.y).absInPlace();\n  }\n  toString() {\n    return '[' + this.x.toFixed(3) + ', ' + this.y.toFixed(3) + ']';\n  }\n  clone(): Vector2 {\n    return new Vector2(this.x, this.y);\n  }\n  max(): number {\n    return Math.max(this.x, this.y);\n  }\n  isEqual(vector: Vector2, threshold?: number): boolean {\n    if (typeof threshold !== 'undefined') {\n      return Vector2.Distance(this, vector) <= threshold;\n    }\n\n    return this.x === vector.x && this.y === vector.y;\n  }\n\n  static Distance(vector1OrX1: Vector2 | number, vector2OrY1: Vector2 | number, x2?: number, y2?: number): number {\n    if (vector1OrX1 instanceof Vector2 && vector2OrY1 instanceof Vector2) {\n      return Math.sqrt(Math.pow(vector2OrY1.x - vector1OrX1.x, 2) + Math.pow(vector2OrY1.y - vector1OrX1.y, 2));\n    } else if (typeof vector1OrX1 === 'number' && typeof vector2OrY1 === 'number') {\n      return Math.sqrt(Math.pow(x2 - vector1OrX1, 2) + Math.pow(y2 - vector2OrY1, 2));\n    }\n  }\n  static Midpoint(vector1: Vector2, vector2: Vector2): Vector2 {\n    return new Vector2((vector1.x + vector2.x) / 2, (vector1.y + vector2.y) / 2);\n  }\n  static Zero(): Vector2 {\n    return new Vector2(0, 0);\n  }\n  static Random(minX: number, maxX: number, minY: number, maxY: number): Vector2 {\n    return new Vector2(\n      Math.random() * (maxX - minX) + minX,\n      Math.random() * (maxY - minY) + minY\n    );\n  }\n\n  serialize(): SerializedVector2 {\n    return { x: this.x, y: this.y };\n  }\n  static deSerialize(data: SerializedVector2): Vector2 {\n    return new Vector2(data.x, data.y);\n  }\n}\n\nexport interface SerializedVector2 {\n  x: number, y: number\n}\n","import { Connector, Flow, Group, Node, Color, Hooks, ConnectorRenderParams, NodeRenderParams, GroupRenderParams, NodeButton, NodeButtonRenderParams } from \"./core/index\";\nimport { Vector2 } from \"./core/vector\";\nimport { Dimension, Pointer, RenderResolver, Rules } from \"./common/interfaces\";\nimport { intersects, noop } from \"./utils/utils\";\nimport { Log } from './utils/logger';\nimport { Terminal, TerminalRenderParams, TerminalType } from './core/terminal';\nimport { FlowState, FlowOptions, SerializedFlow } from './core/flow';\nimport { ViewPort } from './common/enums';\nimport { generateAudioWorklets, WorkletUtils } from \"./resource/audio-worklets\";\nimport { Container, ContainerRenderParams } from \"./ui/container\";\n\ndeclare global {\n  interface CanvasRenderingContext2D {\n    roundRect: (x: number, y: number, width: number, height: number, radius: number) => void,\n    strokeRoundRect: (x: number, y: number, width: number, height: number, radius: number) => void,\n    fillRoundRect: (x: number, y: number, width: number, height: number, radius: number) => void\n  }\n}\n/**\n * FlowConnect is like a placeholder that contains references to all Flows created by this instance and can render one flow at a time on-screen\n * \n * One FlowConnect instance is bound to exactly one HTMLCanvasElement, this instance maintains/tracks the dimensions of HTMLCanvasElement,\n * it registers user-interaction events (mouse, keyboard, touch) and creates additional OffScreenCanvas's to track/act-upon these events\n */\nexport class FlowConnect extends Hooks {\n  static async create(mount?: HTMLCanvasElement | HTMLDivElement): Promise<FlowConnect> {\n    let flowConnect = new FlowConnect(mount);\n    await flowConnect.setupAudioContext();\n    return flowConnect;\n  }\n\n  /** Reference to the canvas element on which the flows will be rendered by FlowConnect instance */\n  canvas: HTMLCanvasElement;\n  private _context: CanvasRenderingContext2D;\n  get context(): CanvasRenderingContext2D { return this._context }\n\n  /** Reference to the AudioContext (one FlowConnect instance will only have one audio context) */\n  private _audioContext: AudioContext;\n  get audioContext(): AudioContext { return this._audioContext }\n\n  /** @hidden Only used for audio stuff */\n  audioBufferCache: Map<ArrayBuffer, AudioBuffer> = new Map();\n  /** @hidden Only used for audio stuff */\n  arrayBufferCache: Map<string, ArrayBuffer> = new Map();\n\n  /** For rendering color hit-maps for Nodes */\n  offCanvas: OffscreenCanvas | HTMLCanvasElement;\n  private _offContext: OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D;\n  get offContext(): OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D { return this._offContext }\n\n  /** For rendering color hit-maps for UI elements and Terminals of Nodes */\n  offUICanvas: OffscreenCanvas | HTMLCanvasElement;\n  private _offUIContext: OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D;\n  get offUIContext(): OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D { return this._offUIContext }\n\n  /** For rendering color hit-maps for Groups */\n  offGroupCanvas: OffscreenCanvas | HTMLCanvasElement;\n  private _offGroupContext: OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D;\n  get offGroupContext(): OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D { return this._offGroupContext }\n\n  /** Canvas's absolute position and dimension from viewport origin (top-left) (for e.g. if the canvas element is inside a scrollable parent) */\n  canvasDimensions: Dimension = { top: 0, left: 0, width: 0, height: 0 };\n\n  get cursor(): string { return this.canvas.style.cursor; }\n  set cursor(cursor: string) { this.canvas.style.cursor = cursor; }\n\n  state: FlowConnectState = FlowConnectState.Stopped;\n\n  /** Id recieved from *requestAnimationFrame* */\n  private frameId: number;\n\n  /** Root flow of the flow-tree (Flow that contains SubFlowNodes that again contains SubFlowNodes and so on...) */\n  private rootFlow: Flow;\n  /** Flow which is currently rendered on the canvas */\n  private currFlow: Flow;\n\n  /** All the flows created by this FlowConnect instance  */\n  flows: Flow[] = [];\n\n  /** Reference of the current/previous Nodes/Groups under user-interaction (mouse, touch) */\n  currHitNode: Node;\n  private prevHitNode: Node;\n  private currHitGroup: Group;\n\n  /** Reference to the new Group being drawn */\n  private currGroup: Group;\n  private groupStartPoint: Vector2;\n\n  /** @hidden Reference to the new Connector being drawn */\n  floatingConnector: Connector;\n\n  /** For controlling user-interaction */\n  pointers: Pointer[] = [];\n  private keymap: Record<string, boolean> = {};\n  private touchControls: Record<string, boolean> = { 'CreateGroup': false };\n\n  /** @hidden HTML input overlayed on canvas when focused */\n  private genericInput: HTMLInputElement = document.createElement('input');\n  /** @hidden ResizeObservers to trigger re-render when dimensions change */\n  private parentResizeObserver: ResizeObserver;\n  private bodyResizeObserver: ResizeObserver;\n\n  minScale: number = 0.1;\n  maxScale: number = 5;\n  wheelScaleDelta: number = 1.05;\n  pinchScaleDelta: number = 1.02;\n  get scale(): number { return this._transform.a }\n  disableScale: boolean = false;\n  private _transform: DOMMatrix = new DOMMatrix();\n\n  /** Current transformation matrix */\n  get transform(): DOMMatrix { return this._transform }\n  private inverseTransform: DOMMatrix = new DOMMatrix();\n  private identity: DOMMatrix = new DOMMatrix();\n\n  /** Time (in ms) when one or more flows created by this FlowConnect instance was started */\n  startTime: number = -1;\n  private timerId: number;\n  /** No. of milliseconds passed since the start of one or more flows */\n  get time(): number { return (this.startTime < 0) ? this.startTime : (performance.now() - this.startTime) }\n\n  readonly renderResolver: {\n    connector?: RenderResolver<Connector, ConnectorRenderParams>,\n    node?: RenderResolver<Node, NodeRenderParams>,\n    nodeButton?: RenderResolver<NodeButton, NodeButtonRenderParams>,\n    uiContainer?: RenderResolver<Container, ContainerRenderParams>\n    group?: RenderResolver<Group, GroupRenderParams>,\n    terminal?: RenderResolver<Terminal, TerminalRenderParams>,\n  } = {};\n\n  /**\n   * @param mount HTML element (div or canvas) on which FlowConnect will render Flows, if no mount is provided, a new canvas element will be created and attached to document.body\n   */\n  private constructor(mount?: HTMLCanvasElement | HTMLDivElement) {\n    super();\n    this.prepareCanvas(mount);\n    this.setupHitCanvas();\n    this.calculateCanvasDimension(true);\n    this.registerChangeListeners();\n    this.attachStyles();\n    this.canvasUtils();\n    this.registerEvents();\n    this.setGenericInput();\n  }\n\n  /** Re-calculates cavnvas position/dimension when scrolling/resizing happens */\n  private registerChangeListeners() {\n    let throttle = false;\n    document.addEventListener('scroll', () => {\n      if (!throttle) {\n        window.requestAnimationFrame(() => {\n          this.calculateCanvasDimension(false);\n          throttle = false;\n        });\n        throttle = true;\n      }\n    });\n    this.registerObservers(this.canvas.parentElement);\n  }\n  private registerObservers(parent: HTMLElement) {\n    this.parentResizeObserver && this.parentResizeObserver.disconnect();\n    this.bodyResizeObserver && this.bodyResizeObserver.disconnect();\n\n    this.parentResizeObserver = new ResizeObserver(() => {\n      this.calculateCanvasDimension(true);\n      this.updateTransform(null, null, null);\n    });\n    this.parentResizeObserver.observe(parent);\n    if (parent !== document.body) {\n      this.bodyResizeObserver = new ResizeObserver(() => {\n        this.calculateCanvasDimension(true);\n        this.updateTransform(null, null, null);\n      });\n      this.bodyResizeObserver.observe(document.body);\n    }\n  }\n  private prepareCanvas(mount?: HTMLCanvasElement | HTMLDivElement) {\n    if (!mount) {\n      this.canvas = document.createElement('canvas');\n      this.canvas.width = document.body.clientWidth;\n      this.canvas.height = document.body.clientHeight;\n      document.body.appendChild(this.canvas);\n    } else if (mount instanceof HTMLDivElement) {\n      this.canvas = document.createElement('canvas');\n      this.canvas.width = mount.clientWidth;\n      this.canvas.height = mount.clientHeight;\n      mount.appendChild(this.canvas);\n    } else if (mount instanceof HTMLCanvasElement) {\n      this.canvas = mount;\n    } else {\n      Log.error('mount provided is not of type HTMLDivElement or HTMLCanvasElement')\n    }\n\n    Object.assign(this.canvas.style, {\n      position: 'absolute',\n      width: '100%',\n      height: '100%'\n    })\n    this._context = this.canvas.getContext('2d');\n  }\n  /** Creates additional canvas's for rendering color hit-maps */\n  private setupHitCanvas() {\n    if (typeof OffscreenCanvas !== 'undefined' && typeof OffscreenCanvasRenderingContext2D !== 'undefined') {\n      this.offCanvas = new OffscreenCanvas(this.canvasDimensions.width, this.canvasDimensions.height);\n      this.offUICanvas = new OffscreenCanvas(this.canvasDimensions.width, this.canvasDimensions.height);\n      this.offGroupCanvas = new OffscreenCanvas(this.canvasDimensions.width, this.canvasDimensions.height);\n    } else {\n      this.offCanvas = document.createElement('canvas');\n      this.offUICanvas = document.createElement('canvas');\n      this.offGroupCanvas = document.createElement('canvas');\n    }\n    this._offContext = this.offCanvas.getContext('2d');\n    this._offUIContext = this.offUICanvas.getContext('2d');\n    this._offGroupContext = this.offGroupCanvas.getContext('2d');\n  }\n  private attachStyles() {\n    this.canvas.style.touchAction = 'none';\n\n    let inputStyle = document.createElement('style');\n    inputStyle.innerHTML = 'input.flow-connect-input { position: fixed; visibility: hidden; pointer-events: none; z-index: 100; border: none; border-radius: 0; box-sizing: border-box;} input.flow-connect-input:focus { outline: none; }';\n    document.getElementsByTagName('head')[0].appendChild(inputStyle);\n  }\n  private calculateCanvasDimension(adjust: boolean) {\n    if (adjust) {\n      let parentBoundingRect = this.canvas.parentElement.getBoundingClientRect();\n      this.canvas.width = parentBoundingRect.width;\n      this.canvas.height = parentBoundingRect.height;\n      this.call('dimension-change', this, this.canvas.width, this.canvas.height);\n    }\n\n    let boundingRect = this.canvas.getBoundingClientRect();\n    this.canvasDimensions = {\n      top: Math.round(boundingRect.top),\n      left: Math.round(boundingRect.left),\n      width: Math.round(boundingRect.width),\n      height: Math.round(boundingRect.height)\n    }\n\n    this.offCanvas.width = this.canvasDimensions.width;\n    this.offCanvas.height = this.canvasDimensions.height;\n    this.offUICanvas.width = this.canvasDimensions.width;\n    this.offUICanvas.height = this.canvasDimensions.height;\n    this.offGroupCanvas.width = this.canvasDimensions.width;\n    this.offGroupCanvas.height = this.canvasDimensions.height;\n  }\n  private canvasUtils() {\n    FlowConnect.prototype.canvasUtils = noop;\n    CanvasRenderingContext2D.prototype.roundRect = function (x: number, y: number, width: number, height: number, radius: number) {\n      this.beginPath();\n      this.moveTo(x + radius, y);\n      this.lineTo(x + width - radius, y);\n      this.quadraticCurveTo(x + width, y, x + width, y + radius);\n      this.lineTo(x + width, y + height - radius);\n      this.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\n      this.lineTo(x + radius, y + height);\n      this.quadraticCurveTo(x, y + height, x, y + height - radius);\n      this.lineTo(x, y + radius);\n      this.quadraticCurveTo(x, y, x + radius, y);\n      this.closePath();\n    }\n    CanvasRenderingContext2D.prototype.strokeRoundRect = function (x: number, y: number, width: number, height: number, radius: number) {\n      if (typeof radius === 'undefined') radius = 5;\n      this.roundRect(x, y, width, height, radius);\n      this.stroke();\n    }\n    CanvasRenderingContext2D.prototype.fillRoundRect = function (x: number, y: number, width: number, height: number, radius: number) {\n      if (typeof radius === 'undefined') radius = 5;\n      this.roundRect(x, y, width, height, radius);\n      this.fill();\n    }\n  }\n  private registerEvents(): void {\n    let dragDelta: Vector2;\n    let prevPanPosition: Vector2 = Vector2.Zero();\n    let prevPinchDistance: number = -1;\n\n    window.onkeydown = (ev: KeyboardEvent) => {\n      !this.keymap[ev.key] && (this.keymap[ev.key] = true);\n    }\n    window.onkeyup = (ev: KeyboardEvent) => {\n      this.keymap[ev.key] = false;\n    }\n\n    this.canvas.onpointerdown = (ev: PointerEvent) => {\n      if (!this.currFlow) return;\n\n      this.addPointer(ev.pointerId, this.getRelativePosition(ev));\n      if (this.pointers.length === 1) {\n        prevPanPosition = this.pointers[0].screenPosition;\n        this.currHitNode = this.getHitNode(this.pointers[0].screenPosition);\n        if (this.currHitNode) {\n          this.currHitNode.zIndex = Number.MAX_SAFE_INTEGER;\n          if (this.keymap['Control']) {\n            this.currHitNode.focused = !this.currHitNode.focused;\n          } else {\n            this.currFlow.removeAllFocus();\n            this.currHitNode.focused = true;\n          }\n          this.currHitNode.onDown(this.pointers[0].screenPosition.clone(), this.pointers[0].realPosition.clone());\n          dragDelta = this.currHitNode.position.subtract(this.pointers[0].realPosition);\n        } else {\n          if (!this.keymap['Control']) {\n            this.currFlow.removeAllFocus();\n\n            this.currHitGroup = this.getHitGroup(this.pointers[0].screenPosition);\n            this.currHitGroup && (dragDelta = this.currHitGroup.position.subtract(this.pointers[0].realPosition));\n          }\n          else if (this.keymap['Control'] || this.touchControls['CreateGroup']) {\n            this.groupStartPoint = this.pointers[0].realPosition.clone();\n            this.currGroup = new Group(this.currFlow, this.groupStartPoint.clone(), { name: 'New Group' });\n          }\n        }\n      } else {\n        this.currHitNode = null;\n        this.currHitGroup = null;\n        this.currFlow.removeAllFocus();\n        if (this.floatingConnector) {\n          this.fallbackConnection();\n        }\n      }\n    }\n    this.canvas.onpointerup = (ev) => {\n      if (!this.currFlow) return;\n\n      this.removePointer(this.pointers, ev);\n\n      if (this.pointers.length < 2) prevPinchDistance = -1;\n\n      let screenPosition = this.getRelativePosition(ev);\n      let realPosition = screenPosition.transform(this.inverseTransform);\n\n      if (this.currHitNode) this.handleGrouping(screenPosition);\n\n      this.currHitNode = null;\n      this.currHitGroup = null;\n\n      let hitNode = this.getHitNode(screenPosition);\n      hitNode && hitNode.onUp(screenPosition.clone(), realPosition.clone());\n\n      if (this.currGroup) {\n        let newGroup = this.currGroup;\n        this.currGroup = null;\n        if (newGroup.width > 10 && newGroup.height > 10) {\n          this.currFlow.groups.push(newGroup);\n          newGroup.setContainedNodes();\n        }\n      }\n      if (this.floatingConnector) this.handleConnection(hitNode, screenPosition, realPosition);\n    }\n    this.canvas.onpointerout = (ev) => {\n      if (!this.currFlow) return;\n\n      this.removePointer(this.pointers, ev);\n      if (this.pointers.length === 0) {\n        if (this.currHitNode) {\n          let screenPosition = this.getRelativePosition(ev);\n          this.handleGrouping(screenPosition);\n        }\n        this.currHitNode = null;\n        this.currHitGroup = null;\n      }\n\n      if (this.currGroup) {\n        let newGroup = this.currGroup;\n        this.currGroup = null;\n        if (newGroup.width > 10 && newGroup.height > 10) {\n          this.currFlow.groups.push(newGroup);\n          newGroup.setContainedNodes();\n        }\n      }\n\n      if (this.floatingConnector) this.fallbackConnection();\n\n      if (this.prevHitNode) {\n        let screenPosition = this.getRelativePosition(ev);\n        let realPosition = screenPosition.transform(this.inverseTransform);\n        this.prevHitNode.onExit(screenPosition, realPosition);\n        this.prevHitNode = null;\n      }\n    }\n    this.canvas.onpointermove = (ev) => {\n      if (!this.currFlow) return;\n\n      let screenPosition = this.getRelativePosition(ev);\n      let realPosition = screenPosition.transform(this.inverseTransform);\n\n      this.updatePointer(ev.pointerId, screenPosition, realPosition);\n\n      if (this.pointers.length === 2) {\n        let currPinchDistance = Vector2.Distance(this.pointers[0].screenPosition, this.pointers[1].screenPosition);\n        if (prevPinchDistance > 0) {\n          if (currPinchDistance !== prevPinchDistance) {\n            this.handleZoom(currPinchDistance > prevPinchDistance, Vector2.Midpoint(this.pointers[0].screenPosition, this.pointers[1].screenPosition), this.pinchScaleDelta);\n          }\n        }\n        prevPinchDistance = currPinchDistance;\n      }\n\n      if (this.currGroup) {\n        if (realPosition.x < this.groupStartPoint.x) this.currGroup.position.x = realPosition.x;\n        this.currGroup.width = Math.abs(this.groupStartPoint.x - realPosition.x);\n\n        if (realPosition.y < this.groupStartPoint.y) this.currGroup.position.y = realPosition.y;\n        this.currGroup.height = Math.abs(this.groupStartPoint.y - realPosition.y);\n      }\n\n      if (this.currHitNode) {\n        // If dragging UINode outside its bounds, Node can pre-empt currHitNode\n        this.currHitNode.onDrag(screenPosition.clone(), realPosition.clone());\n        if (this.currHitNode) {\n          if ((!this.currHitNode.currHitUINode || !this.currHitNode.currHitUINode.draggable) && !this.currHitNode.currHitTerminal && !this.floatingConnector) {\n            this.currHitNode.position = realPosition.add(dragDelta);\n\n            let hitGroup = this.getHitGroup(screenPosition);\n            if (hitGroup && hitGroup === this.currHitNode.group) {\n              let groupRealPos = hitGroup.position.transform(this._transform);\n              let nodeRealPos = this.currHitNode.position.transform(this._transform);\n\n              let intersection = intersects(groupRealPos.x, groupRealPos.y,\n                groupRealPos.x + hitGroup.width * this.scale,\n                groupRealPos.y + hitGroup.height * this.scale,\n                nodeRealPos.x, nodeRealPos.y,\n                nodeRealPos.x + this.currHitNode.width * this.scale,\n                nodeRealPos.y + this.currHitNode.ui.height * this.scale\n              );\n\n              if (intersection === ViewPort.INSIDE) {\n                let nodeIndex = hitGroup.nodes.findIndex(node => node.id === this.currHitNode.id);\n                hitGroup.nodeDeltas[nodeIndex] = this.currHitNode.position.subtract(hitGroup.position);\n              }\n            }\n          }\n        }\n      } else {\n        if (this.currHitGroup) {\n          this.currHitGroup.position = realPosition.add(dragDelta);\n        } else if (this.pointers.length === 1 && !this.keymap['Control'] && !this.touchControls['CreateGroup']) {\n          let delta = screenPosition.subtract(prevPanPosition).multiplyInPlace(1 / this.scale);\n          prevPanPosition = screenPosition;\n          this.updateTransform(null, null, delta);\n        }\n      }\n      if (this.floatingConnector) this.floatingConnector.floatingTip = realPosition;\n\n      if (ev.pointerType === 'mouse' && !this.currHitNode) {\n        let hitNode = this.getHitNode(screenPosition);\n        if (hitNode !== this.prevHitNode) {\n          this.prevHitNode && this.prevHitNode.onExit(screenPosition, realPosition);\n          hitNode && hitNode.onEnter(screenPosition, realPosition);\n        } else {\n          hitNode && (!this.currHitNode) && hitNode.onOver(screenPosition, realPosition);\n        }\n        this.prevHitNode = hitNode;\n      }\n    }\n    this.canvas.onclick = (ev) => {\n      if (!this.currFlow) return;\n\n      let screenPosition = this.getRelativePosition(ev);\n      let realPosition = screenPosition.transform(this.inverseTransform);\n      let hitNode = this.getHitNode(screenPosition);\n      hitNode && hitNode.onClick(screenPosition.clone(), realPosition.clone());\n\n      if (!hitNode) {\n        let hitGroup = this.getHitGroup(screenPosition);\n        hitGroup && hitGroup.onClick(screenPosition.clone(), realPosition.clone());\n      }\n    };\n    this.canvas.oncontextmenu = (ev) => {\n      if (!this.currFlow) return;\n\n      ev.preventDefault();\n\n      let screenPosition = this.getRelativePosition(ev);\n      let hitNode = this.getHitNode(screenPosition);\n      hitNode && hitNode.onContextMenu();\n      if (!this.keymap['Control']) this.currFlow.removeAllFocus();\n      hitNode && (hitNode.focused = true);\n    }\n    this.canvas.onwheel = (ev: WheelEvent) => {\n      if (!this.currFlow) return;\n\n      let screenPosition = this.getRelativePosition(ev);\n      let hitNode = this.getHitNode(screenPosition);\n      if (hitNode) {\n        let hitColor = Color.rgbaToString(this.offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data);\n        let hitUINode = hitNode.getHitUINode(hitColor);\n\n        // Need to add touch compability for pinch on UINodes\n        if (hitUINode && hitUINode.zoomable) {\n          hitNode.onWheel(ev.deltaY < 0, screenPosition, screenPosition.transform(this.inverseTransform));\n          return;\n        }\n      }\n\n      if (!this.disableScale) {\n        ev.preventDefault();\n        this.handleZoom(ev.deltaY < 0, screenPosition, this.wheelScaleDelta);\n      }\n    }\n  }\n  private setGenericInput() {\n    this.genericInput.className = 'flow-connect-input';\n    this.genericInput.style.visibility = 'hidden';\n    this.genericInput.style.pointerEvents = 'none';\n    this.genericInput.style.padding = '0';\n\n    this.genericInput.onblur = () => {\n      this.genericInput.style.visibility = 'hidden';\n      this.genericInput.style.pointerEvents = 'none';\n\n      this.genericInput.onchange = null;\n    }\n\n    document.body.appendChild(this.genericInput);\n  }\n  private async setupAudioContext() {\n    if ((window as any).__FLOWCONNECT_AUDIO_CTX__) {\n      this._audioContext = (window as any).__FLOWCONNECT_AUDIO_CTX__;\n    } else {\n      this._audioContext = new AudioContext();\n      (window as any).__FLOWCONNECT_AUDIO_CTX__ = this._audioContext;\n    }\n\n    // This one-time setup is not at all related to FlowConnect, couldn't find any place to do this\n    // Might be a better idea to do this somewhere in StandardNodes.Audio scope\n\n    let audioWorklets = generateAudioWorklets(WorkletUtils.CircularBuffer);\n    await this.audioContext.audioWorklet.addModule(WorkletUtils.CircularBuffer);\n    return Promise.all(Object.keys(audioWorklets).map(key => this.audioContext.audioWorklet.addModule(audioWorklets[key])));\n  }\n\n  showGenericInput(position: Vector2 | DOMPoint, value: string, styles: Record<string, any>, attributes: Record<string, any>, callback: (value: string) => void) {\n    if (document.activeElement === this.genericInput) return;\n\n    Object.assign(this.genericInput.style, styles);\n    Object.assign(this.genericInput, attributes);\n\n    Object.assign(this.genericInput.style, {\n      left: (position.x + this.canvasDimensions.left) + 'px',\n      top: (position.y + this.canvasDimensions.top - 3) + 'px',\n      visibility: 'visible',\n      pointerEvents: 'all'\n    });\n    this.genericInput.value = value;\n    this.genericInput.onchange = () => callback(this.genericInput.value);\n    this.genericInput.focus();\n  }\n  changeParent(newParent: HTMLElement) {\n    this.registerObservers(newParent);\n  }\n  private updatePointer(id: number, screenPosition: Vector2, realPosition: Vector2) {\n    let pointer = this.pointers.find(pntr => pntr.id === id);\n    if (pointer) {\n      pointer.screenPosition = screenPosition;\n      pointer.realPosition = realPosition;\n    }\n  }\n  private handleZoom(zoomIn: boolean, origin: Vector2, scaleDelta: number) {\n    if ((this._transform.a >= this.maxScale && zoomIn) || (this._transform.a <= this.minScale && !zoomIn)) return;\n    this.updateTransform(zoomIn ? scaleDelta : (1 / scaleDelta), origin, null);\n    this.call('scale', this.scale);\n  }\n  private handleGrouping(screenPosition: Vector2) {\n    let hitGroup = this.getHitGroup(screenPosition);\n\n    let intersection;\n    if (hitGroup) {\n      let groupRealPos = hitGroup.position.transform(this._transform);\n      let nodeRealPos = this.currHitNode.position.transform(this._transform);\n\n      intersection = intersects(groupRealPos.x, groupRealPos.y,\n        groupRealPos.x + hitGroup.width * this.scale,\n        groupRealPos.y + hitGroup.height * this.scale,\n        nodeRealPos.x, nodeRealPos.y,\n        nodeRealPos.x + this.currHitNode.width * this.scale,\n        nodeRealPos.y + this.currHitNode.ui.height * this.scale\n      );\n    }\n\n    if (this.currHitNode.group) {\n      if (this.currHitNode.group !== hitGroup) {\n        let nodeIndex = this.currHitNode.group.nodes.findIndex(node => node.id === this.currHitNode.id);\n        this.currHitNode.group.nodes.splice(nodeIndex, 1);\n        this.currHitNode.group.nodeDeltas.splice(nodeIndex, 1);\n        this.currHitNode.group = null;\n      } else {\n        if (intersection !== ViewPort.INSIDE) {\n          let nodeIndex = this.currHitNode.group.nodes.findIndex(node => node.id === this.currHitNode.id);\n          this.currHitNode.group.nodes.splice(nodeIndex, 1);\n          this.currHitNode.group.nodeDeltas.splice(nodeIndex, 1);\n          this.currHitNode.group = null;\n        }\n      }\n    }\n\n    if (hitGroup) {\n      if (intersection === ViewPort.INSIDE) {\n        this.currHitNode.group = hitGroup;\n        hitGroup.nodes.push(this.currHitNode);\n        hitGroup.nodeDeltas.push(this.currHitNode.position.subtract(hitGroup.position));\n      }\n    }\n  }\n  private handleConnection(hitNode: Node, screenPosition: Vector2, realPosition: Vector2) {\n    if (!hitNode) {\n      this.fallbackConnection();\n      return;\n    }\n    let hitTerminal = hitNode.getHitTerminal(\n      Color.rgbaToString(this._offUIContext.getImageData(screenPosition.x, screenPosition.y, 1, 1).data),\n      screenPosition.clone(),\n      realPosition.clone()\n    );\n    if (hitTerminal) hitNode.currHitTerminal = hitTerminal;\n    if (!hitTerminal) {\n      this.fallbackConnection();\n      return;\n    }\n\n    let destination = hitNode.currHitTerminal;\n    if (!this.floatingConnector.canConnect(destination)) {\n      this.fallbackConnection();\n      hitNode.currHitTerminal = null;\n    } else {\n      if (destination.type === TerminalType.OUT) {\n        this.floatingConnector.completeConnection(destination);\n        hitNode.currHitTerminal = null;\n      } else {\n        if (destination.connectors.length > 0) {\n          if (destination.connectors[0].start === this.floatingConnector.start) {\n            this.fallbackConnection();\n            hitNode.currHitTerminal = null;\n            return;\n          }\n          let index = destination.connectors[0].start.connectors.indexOf(destination.connectors[0]);\n          let [oldConnector] = destination.connectors[0].start.connectors.splice(index, 1);\n          let [startTerm, endTerm] = [oldConnector.start, oldConnector.end];\n          this.currFlow.connectors.delete(oldConnector.id);\n          this.currFlow.executionGraph.disconnect(startTerm.node, endTerm.node);\n          oldConnector.start.onDisconnect(oldConnector, startTerm, endTerm);\n          oldConnector.end.onDisconnect(oldConnector, startTerm, endTerm);\n\n          this.floatingConnector.completeConnection(destination);\n          hitNode.currHitTerminal = null;\n        } else {\n          this.floatingConnector.completeConnection(destination);\n          hitNode.currHitTerminal = null;\n        }\n      }\n      this.floatingConnector = null;\n    }\n  }\n  private getRelativePosition(ev: PointerEvent | WheelEvent | MouseEvent) {\n    return new Vector2(ev.clientX - this.canvasDimensions.left, ev.clientY - this.canvasDimensions.top);\n  }\n  private updateTransform(scale?: number, scaleOrigin?: Vector2, translate?: Vector2) {\n    if (scale) {\n      let realSpaceOrigin = scaleOrigin.transform(this.inverseTransform);\n      this._transform\n        .translateSelf(realSpaceOrigin.x, realSpaceOrigin.y)\n        .scaleSelf(scale, scale)\n        .translateSelf(-realSpaceOrigin.x, -realSpaceOrigin.y);\n    }\n    if (translate) {\n      this._transform.translateSelf(translate.x, translate.y);\n    }\n\n    this.inverseTransform = this._transform.inverse();\n\n    this._context.setTransform(this._transform);\n    this._offContext.setTransform(this._transform);\n    this._offUIContext.setTransform(this._transform);\n    this._offGroupContext.setTransform(this._transform);\n\n    this.call('transform', this);\n  }\n  translateBy(delta: Vector2) {\n    this.updateTransform(null, null, delta);\n  }\n  scaleBy(scale: number, scaleOrigin: Vector2) {\n    this.updateTransform(scale, scaleOrigin);\n  }\n  private fallbackConnection() {\n    this.floatingConnector.removeConnection();\n    this.currFlow.removeConnector(this.floatingConnector.id);\n  }\n  private addPointer(pointerId: number, position: Vector2) {\n    this.pointers.push({\n      id: pointerId,\n      screenPosition: position,\n      realPosition: position.transform(this.inverseTransform)\n    });\n  }\n  private removePointer(pointers: Pointer[], ev: PointerEvent) {\n    pointers.splice(pointers.findIndex(pointer => pointer.id === ev.pointerId), 1);\n  }\n  private getHitNode(position: Vector2): Node {\n    let rgbaString = Color.rgbaToString(this._offContext.getImageData(position.x, position.y, 1, 1).data);\n    return this.currFlow.nodeHitColors.get(rgbaString);\n  }\n  private getHitGroup(position: Vector2): Group {\n    let rgbaString = Color.rgbaToString(this._offGroupContext.getImageData(position.x, position.y, 1, 1).data);\n    return this.currFlow.groupHitColors.get(rgbaString);\n  }\n  private clear() {\n    this._context.save();\n    this._context.setTransform(this.identity);\n    this._context.clearRect(0, 0, this.canvasDimensions.width, this.canvasDimensions.height);\n    this._context.restore();\n\n    this._offContext.save();\n    this._offContext.setTransform(this.identity);\n    this._offContext.clearRect(0, 0, this.canvasDimensions.width, this.canvasDimensions.height);\n    this._offContext.restore();\n\n    this._offUIContext.save();\n    this._offUIContext.setTransform(this.identity);\n    this._offUIContext.clearRect(0, 0, this.canvasDimensions.width, this.canvasDimensions.height);\n    this._offUIContext.restore();\n\n    this._offGroupContext.save();\n    this._offGroupContext.setTransform(this.identity);\n    this._offGroupContext.clearRect(0, 0, this.canvasDimensions.width, this.canvasDimensions.height);\n    this._offGroupContext.restore();\n  }\n\n  startGlobalTime() {\n    if (this.startTime < 0) {\n      this.startTime = performance.now();\n      this._startGlobalTime();\n      this.state = FlowConnectState.Running;\n      this.call('start', this);\n    }\n  }\n  private _startGlobalTime() {\n    this.call('tick', this);\n    this.timerId = window.requestAnimationFrame(this._startGlobalTime.bind(this));\n  }\n\n  stopGlobalTime() {\n    if (this.isRootFlowStopped()) {\n      cancelAnimationFrame(this.timerId);\n      this.startTime = -1;\n      this.state = FlowConnectState.Stopped;\n      this.call('tickreset', this);\n      this.call('stop', this);\n    }\n  }\n  private isRootFlowStopped(): boolean {\n    let root = this.currFlow;\n    while (true) {\n      if (root.parentFlow) root = root.parentFlow;\n      else return root.state === FlowState.Stopped;\n    }\n  }\n  private _render() {\n    this.clear();\n\n    this.currGroup && this.currGroup.render();\n    this.currFlow.render();\n    this.call('render', this);\n\n    this.frameId = window.requestAnimationFrame(this._render.bind(this));\n  }\n\n  createFlow(options: FlowOptions = { name: 'New Flow', rules: {}, terminalColors: {} }): Flow {\n    if (!options.rules) options.rules = {};\n    if (!options.terminalColors) options.terminalColors = {};\n\n    options.rules = { ...options.rules, ...DefaultRules() };\n    let flow = new Flow(this, options.name, options.rules, options.terminalColors);\n    this.flows.push(flow);\n\n    flow.on('start', () => this.startGlobalTime());\n    flow.on('stop', () => this.stopGlobalTime());\n\n    return flow;\n  }\n  render(flow: Flow) {\n    if (flow === this.currFlow) return;\n    if (this.currFlow) {\n      window.cancelAnimationFrame(this.frameId);\n      this.currFlow.deregisterListeners();\n    }\n    if (!this.rootFlow || !this.rootFlow.existsInFlow(flow)) {\n      this.rootFlow = flow;\n    }\n    this.currFlow = flow;\n    this._render();\n  }\n  /** Render the root flow of the flow-tree */\n  top() {\n    this.render(this.rootFlow);\n  }\n  /** Creates a flow from json\n   * @param json Json string with schema SerializedFlow\n   */\n  fromJson(json: string): Flow {\n    let data: SerializedFlow;\n    let flow: Flow = null;\n\n    try {\n      data = JSON.parse(json);\n      flow = Flow.deSerialize(this, data);\n    } catch (error) {\n      Log.error(error);\n    }\n    return flow;\n  }\n  toJson(flow: Flow): string {\n    let serializedFlow: SerializedFlow = flow.serialize();\n    try {\n      return JSON.stringify(serializedFlow, null);\n    } catch (error) {\n      Log.error(error);\n    }\n  }\n}\n\nexport enum FlowConnectState {\n  Stopped,\n  Running\n}\n\n/** Default rules every Flow will have, for e.g. a string output can only be connected to string inputs.\n   *  ```javascript\n   *  {\n   *    'string': ['string'],\n   *    'number': ['number'],\n   *    'boolean': ['boolean'],\n   *    'file': ['file'],\n   *    'event': ['event'], ...\n   *  }\n   *  ```\n   */\nlet DefaultRules: () => Rules = () => ({\n  'string': ['string', 'any'],\n  'number': ['number', 'audioparam', 'any'],\n  'boolean': ['boolean', 'any'],\n  'array': ['array', 'any'],\n  'file': ['file', 'any'],\n  'event': ['event', 'any'],\n  'vector2': ['vector2', 'any'],\n  'array-buffer': ['array-buffer', 'any'],\n  'audio': ['audio', 'audioparam'],\n  'audioparam': ['audioparam'],\n  'audio-buffer': ['audio-buffer', 'any'],\n  'any': ['any']\n});\n\nexport * from './common/index';\nexport * from './core/index';\nexport { Constant } from './resource/constants';\nexport * from './ui/index';\nexport * from './utils/index';\n","export const WorkletUtils = {\n  CircularBuffer: URL.createObjectURL(new Blob([\n    `export default class CircularBuffer {\n      constructor(bufferLength, noOfChannels) {\n        this.noOfChannels = noOfChannels;\n        this.bufferLength = bufferLength;\n\n        this.read = this.write = this.frames = 0;\n        this.channels = [];\n        for (let i = 0; i < this.noOfChannels; ++i) this.channels[i] = new Float32Array(bufferLength);\n      }\n      pushBlock(buffer) {\n        let sourceLength = buffer[0].length;\n        for (let i = 0; i < sourceLength; ++i) {\n          let write = (this.write + i) % this.bufferLength;\n          for (let c = 0; c < this.noOfChannels; ++c) {\n            this.channels[c][write] = buffer[c][i];\n          }\n        }\n        this.write += sourceLength;\n        if (this.write >= this.bufferLength) this.write = 0;\n        this.frames += sourceLength;\n        if (this.frames > this.bufferLength) this.frames = this.bufferLength;\n      }\n      popBlock(buffer) {\n        if (this.frames === 0) return;\n        let destinationLength = buffer[0].length;\n        for (let i = 0; i < destinationLength; ++i) {\n          let read = (this.read + i) % this.bufferLength;\n          for (let c = 0; c < this.noOfChannels; ++c) {\n            buffer[c][i] = this.channels[c][read];\n          }\n        }\n        this.read += destinationLength;\n        if (this.read >= this.bufferLength) this.read = 0;\n        this.frames -= destinationLength;\n        if (this.frames < 0) this.frames = 0;\n      }\n    }`\n  ], { type: 'application/javascript' })),\n}\nexport const generateAudioWorklets = (utilsFileName: string) => {\n  let audioWorklets: Record<string, string> = {\n    // Creates a AudioWorkletProcessor to setup custom AudioParams for AudioBufferSourceNode's automation (because of their fire-forget-destroy behaviour)\n    Worklet_ProxyParamForSource: URL.createObjectURL(new Blob([\n      `registerProcessor('proxy-param-for-source', class ProxyParamForSource extends AudioWorkletProcessor {\n          static get parameterDescriptors() {\n            return [{\n              name: 'detune',\n              defaultValue: 0,\n              minValue: -2400,\n              maxValue: 2400,\n              automationRate: 'k-rate'\n            }, {\n              name: 'playbackRate',\n              defaultValue: 1,\n              minValue: 0.25,\n              maxValue: 3,\n              automationRate: 'k-rate'\n            }]\n          }\n          process(inputs, outputs, parameters) {\n            outputs[0].forEach(channel => {\n              for (let i = 0; i < channel.length; i++) {\n                // wierd bug, the detune is off by 1200 cents, have to offset this anomaly\n                channel[i] = (parameters['detune'].length > 1 ? parameters['detune'][i] : parameters['detune'][0]) - 1200;\n              }\n            });\n            outputs[1].forEach(channel => {\n              for (let i = 0; i < channel.length; i++) {\n                channel[i] = (parameters['playbackRate'].length > 1 ? parameters['playbackRate'][i] : parameters['playbackRate'][0]);\n              }\n            });\n            return true;\n          }\n        })`\n    ], { type: 'application/javascript' })),\n\n    // Same as above, but not specifically for AudioBufferSourceNodes, this is more general purpose\n    Worklet_ProxyParam: URL.createObjectURL(new Blob([\n      `registerProcessor('proxy-param', class ProxyParam extends AudioWorkletProcessor {\n          static get parameterDescriptors() {\n            return [{\n              name: 'param',\n              defaultValue: 0,\n              minValue: -340282346638528859811704183484516925439,\n              maxValue: 340282346638528859811704183484516925439,\n              automationRate: 'k-rate'\n            }]\n          }\n\n          min = -340282346638528859811704183484516925439;\n          max =  340282346638528859811704183484516925439;\n          offset = 0;\n          constructor(...args) {\n            super(...args);\n            this.port.onmessage = (e) => {\n              switch(e.data.type) {\n                case 'set-range': {\n                  this.min = e.data.value.min;\n                  this.max = e.data.value.max;\n                  break;\n                }\n                case 'set-offset': {\n                  this.offset = -e.data.value\n                  break;\n                }\n                default: break;\n              }\n            }\n          }\n          clamp(value) { return Math.min(Math.max(value, this.min), this.max); }\n          process(inputs, outputs, parameters) {\n            outputs[0].forEach(channel => {\n              for (let i = 0; i < channel.length; i++) {\n                channel[i] = this.clamp((parameters['param'].length > 1 ? parameters['param'][i] : parameters['param'][0]) + this.offset);\n              }\n            });\n            return true;\n          }\n        })`\n    ], { type: 'application/javascript' })),\n\n    // This one is used to only peak at the audio data flowing through this node, mainly for debugging purposes\n    Worklet_Debug: URL.createObjectURL(new Blob([\n      `registerProcessor('debug', class Debug extends AudioWorkletProcessor {\n          throttle = 1000;\n          lastPeak = -Infinity;\n          constructor(...args) {\n            super(...args);\n            this.port.onmessage = (e) => {\n              this.throttle = e.data;\n            }\n          }\n          process(inputs, outputs, parameters) {\n            if (Date.now() - this.lastPeak > this.throttle) {\n              let data = {\n                inputs: inputs.map(input => input.length),\n                outputs: outputs.map(output => output.length)\n              };\n              this.port.postMessage(data);\n              this.lastPeak = Date.now();\n            }\n            let input = inputs[0];\n            let output = outputs[0]\n            for (let i = 0 ; i < input.length ; i+=1) {\n              for(let c = 0 ; c < input[i].length ; c+=1) {\n                output[i][c] = input[i][c];\n              }\n            }\n            return true;\n          }\n        })`\n    ], { type: 'application/javascript' })),\n\n    Worklet_MoogEffect: URL.createObjectURL(new Blob([\n      `import CircularBuffer from '${utilsFileName}'\n      registerProcessor('moog-effect', class MoogEffect extends AudioWorkletProcessor {\n      cutoff = 0.065;\n      resonance = 3.5;\n      f = 0; inputFactor = 0; fb = 0;\n\n      constructor(options) {\n        super();\n        this.bufferSize = options.processorOptions.bufferSize;\n\n        this.setParams();\n        this.port.onmessage = (e) => {\n          this.cutoff = e.data.cutoff;\n          this.resonance = e.data.resonance;\n          this.setParams();\n        }\n      }\n      setParams() {\n        this.f = this.cutoff * 1.16;\n        this.inputFactor = 0.35013 * (this.f * this.f) * (this.f * this.f);\n        this.fb = this.resonance * (1.0 - 0.15 * this.f * this.f);\n      }\n      channelsChanged(newNoOfChannels) {\n        this.channelCount = newNoOfChannels;\n        this.inputBuffer = new CircularBuffer(this.bufferSize, this.channelCount);\n        this.outputBuffer = new CircularBuffer(this.bufferSize, this.channelCount);\n        this.in1 = new Array(this.channelCount).fill(0);\n        this.in2 = new Array(this.channelCount).fill(0);\n        this.in3 = new Array(this.channelCount).fill(0);\n        this.in4 = new Array(this.channelCount).fill(0);\n        this.out1 = new Array(this.channelCount).fill(0);\n        this.out2 = new Array(this.channelCount).fill(0);\n        this.out3 = new Array(this.channelCount).fill(0);\n        this.out4 = new Array(this.channelCount).fill(0);\n      }\n\n      _process(input, output) {\n        for (let c = 0; c < input.length; ++c) {\n          for (let i = 0; i < input[c].length; ++i) {\n            input[c][i] -= this.out4[c] * this.fb;\n            input[c][i] *= this.inputFactor;\n            this.out1[c] = input[c][i] + 0.3 * this.in1[c] + (1 - this.f) * this.out1[c];\n            this.in1[c] = input[c][i];\n            this.out2[c] = this.out1[c] + 0.3 * this.in2[c] + (1 - this.f) * this.out2[c];\n            this.in2[c] = this.out1[c];\n            this.out3[c] = this.out2[c] + 0.3 * this.in3[c] + (1 - this.f) * this.out3[c];\n            this.in3[c] = this.out2[c];\n            this.out4[c] = this.out3[c] + 0.3 * this.in4[c] + (1 - this.f) * this.out4[c];\n            this.in4[c] = this.out3[c];\n            output[c][i] = this.out4[c];\n          }\n        }\n      }\n      process(inputs, outputs, parameters) {\n        let input = inputs[0], output = outputs[0];\n        if (input.length === 0) return true;\n\n        if (!this.prevChannelCount || this.prevChannelCount !== inputs[0].length) {\n          this.channelsChanged(inputs[0].length);\n          this.prevChannelCount = inputs[0].length;\n        }\n\n        this.inputBuffer.pushBlock(input);\n        if (this.inputBuffer.frames >= this.bufferSize) {\n          let tmpInBuffer = [], tmpOutBuffer = [];\n          for (let i = 0; i < this.channelCount; ++i) {\n            tmpInBuffer[i] = new Float32Array(this.bufferSize);\n            tmpOutBuffer[i] = new Float32Array(this.bufferSize);\n          }\n\n          this.inputBuffer.popBlock(tmpInBuffer);\n          this._process(tmpInBuffer, tmpOutBuffer);\n          this.outputBuffer.pushBlock(tmpOutBuffer);\n        }\n        this.outputBuffer.popBlock(output);\n        return true;\n      }\n    })`\n    ], { type: 'application/javascript' })),\n\n    Worklet_BitcrusherEffect: URL.createObjectURL(new Blob([\n      `import CircularBuffer from '${utilsFileName}'\n      registerProcessor('bitcrusher-effect', class BitcrusherEffect extends AudioWorkletProcessor {\n      bits = 4;\n      normFreq = 0.1;\n      step = 0;\n\n      constructor(options) {\n        super();\n        this.bufferSize = options.processorOptions.bufferSize;\n\n        this.setParams();\n        this.port.onmessage = (e) => {\n          this.bits = e.data.bits;\n          this.normFreq = e.data.normFreq;\n          this.setParams();\n        }\n      }\n      setParams() {\n        this.step = Math.pow(1 / 2, this.bits);\n      }\n      channelsChanged(newNoOfChannels) {\n        this.channelCount = newNoOfChannels;\n        this.inputBuffer = new CircularBuffer(this.bufferSize, this.channelCount);\n        this.outputBuffer = new CircularBuffer(this.bufferSize, this.channelCount);\n        this.phaser = new Array(this.channelCount).fill(0);\n        this.last = new Array(this.channelCount).fill(0);\n      }\n\n      _process(input, output) {\n        for (let c = 0; c < input.length; ++c) {\n          for (let i = 0; i < input[c].length; ++i) {\n            this.phaser[c] += this.normFreq;\n            if (this.phaser[c] >= 1.0) {\n              this.phaser[c] -= 1.0;\n              this.last[c] = this.step * Math.floor(input[c][i] / this.step + 0.5);\n            }\n            output[c][i] = this.last[c];\n          }\n        }\n      }\n      process(inputs, outputs, parameters) {\n        let input = inputs[0], output = outputs[0];\n        if (input.length === 0) return true;\n        if (!this.prevChannelCount || this.prevChannelCount !== inputs[0].length) {\n          this.channelsChanged(inputs[0].length);\n          this.prevChannelCount = inputs[0].length;\n        }\n        this.inputBuffer.pushBlock(input);\n        if (this.inputBuffer.frames >= this.bufferSize) {\n          let tmpInBuffer = [], tmpOutBuffer = [];\n          for (let i = 0; i < this.channelCount; ++i) {\n            tmpInBuffer[i] = new Float32Array(this.bufferSize);\n            tmpOutBuffer[i] = new Float32Array(this.bufferSize);\n          }\n          this.inputBuffer.popBlock(tmpInBuffer);\n          this._process(tmpInBuffer, tmpOutBuffer);\n          this.outputBuffer.pushBlock(tmpOutBuffer);\n        }\n        this.outputBuffer.popBlock(output);\n        return true;\n      }\n    })`\n    ], { type: 'application/javascript' })),\n\n    Worklet_LFO: URL.createObjectURL(new Blob([\n      `registerProcessor('lfo', class LFO extends AudioWorkletProcessor {\n      oscillation = 0.3;\n      offset = 0.85;\n      phaseInc = 0;\n      phase = 0;\n\n      constructor(options) {\n        super();\n        this.sampleRate = options.processorOptions.sampleRate;\n\n        this.port.onmessage = (e) => {\n          switch(e.data.type) {\n            case 'set-oscillation': { this.oscillation = e.data.value; break; }\n            case 'set-offset': { this.offset = e.data.value; break; }\n            case 'set-phase': { this.phase = e.data.value; break; }\n            case 'set-frequency': { this.phaseInc = 2 * Math.PI * e.data.value * 128 / this.sampleRate; break; }\n            case 'set-all': {\n              this.oscillation = e.data.value.oscillation;\n              this.offset = e.data.value.offset;\n              this.phase = e.data.value.phase;\n              this.phaseInc = 2 * Math.PI * e.data.value.frequency * 128 / this.sampleRate;\n              break;\n            }\n            default: return;\n          }\n        }\n      }\n      process(inputs, outputs, parameters) {\n        let output = outputs[0][0];\n\n        for (let i = 0; i < output.length; ++i) {\n          this.phase += this.phaseInc;\n          if (this.phase > 2 * Math.PI) this.phase = 0;\n          output[i] = this.offset + this.oscillation * Math.sin(this.phase);\n        }\n\n        return true;\n      }\n    })`\n    ], { type: 'application/javascript' })),\n\n    Worklet_Noise: URL.createObjectURL(new Blob([\n      `registerProcessor('noise', class Noise extends AudioWorkletProcessor {\n      type = 'white';\n      types = ['white', 'pink', 'brownian'];\n\n      constructor(options) {\n        super();\n        this.port.onmessage = (e) => {\n          if (!this.types.includes(e.data)) this.type = 'white';\n          else this.type = e.data;\n        }\n\n        this.generate = {\n          'white': (output) => {\n            for (let i = 0; i < output.length; ++i) output[i] = Math.random() * 2 - 1;\n          },\n          'pink': (output) => {\n            let b0, b1, b2, b3, b4, b5, b6;\n            b0 = b1 = b2 = b3 = b4 = b5 = b6 = 0.0;\n\n            for (let i = 0; i < output.length; ++i) {\n              let white = Math.random() * 2 - 1;\n              b0 = 0.99886 * b0 + white * 0.0555179;\n              b1 = 0.99332 * b1 + white * 0.0750759;\n              b2 = 0.96900 * b2 + white * 0.1538520;\n              b3 = 0.86650 * b3 + white * 0.3104856;\n              b4 = 0.55000 * b4 + white * 0.5329522;\n              b5 = -0.7616 * b5 - white * 0.0168980;\n              output[i] = b0 + b1 + b2 + b3 + b4 + b5 + b6 + white * 0.5362;\n              output[i] *= 0.11;\n              b6 = white * 0.115926;\n            }\n          },\n          'brownian': (output) => {\n            let lastOut = 0.0;\n            for (let i = 0; i < output.length; i++) {\n              let white = Math.random() * 2 - 1;\n              output[i] = (lastOut + (0.02 * white)) / 1.02;\n              lastOut = output[i];\n              output[i] *= 3.5;\n            }\n          }\n        }\n      }\n      process(inputs, outputs, parameters) {\n        this.generate[this.type](outputs[0][0]);\n        return true;\n      }\n    })`\n    ], { type: 'application/javascript' })),\n\n    // Just a normal proxy, outputs the inputs as it is, used for seamless connections of SourceNodes\n    Worklet_Proxy: URL.createObjectURL(new Blob([\n      `registerProcessor('proxy', class Proxy extends AudioWorkletProcessor {\n\n      constructor() { super(); }\n      process(inputs, outputs, parameters) {\n        inputs.forEach((input, index) => input.forEach((channel, cIndex) => {\n          outputs[index][cIndex].set(channel);\n        }));\n        return true;\n      }\n    })`\n    ], { type: 'application/javascript' })),\n  }\n\n  return audioWorklets;\n}\n","export class Constant {\n  static TAU = 2 * Math.PI;\n  static SIN_60 = 0.866;\n  static PHI = 1.6180339887498948;\n}\n","export const fileIcon = \"data:image/svg+xml;charset=UTF-8,%3c?xml version='1.0' encoding='iso-8859-1'?%3e%3c!-- --%3e%3csvg version='1.1' id='Capa_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 477.867 477.867' style='enable-background:new 0 0 477.867 477.867;' xml:space='preserve'%3e%3cg%3e%3cg%3e%3cpath d='M324.267,119.467c-9.426,0-17.067-7.641-17.067-17.067V0H102.4C74.123,0,51.2,22.923,51.2,51.2v375.467 c0,28.277,22.923,51.2,51.2,51.2h273.067c28.277,0,51.2-22.923,51.2-51.2v-307.2H324.267z'/%3e%3c/g%3e%3c/g%3e%3cg%3e%3cg%3e%3cpolygon points='341.333,10.001 341.333,85.333 416.666,85.333 '/%3e%3c/g%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3cg%3e%3c/g%3e%3c/svg%3e\";\nexport const imageIcon = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAQAAAAAYLlVAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAHdElNRQfjDAMLKTYM6GTwAAACaElEQVRo3u2ZP2gUQRSHv90zGKMY/IPxBBGSEGKUixGsFFSQnAZEbUQrEXuvCIiIiKWCbbQXLBRsgpVgockhIhYJGg0oJEWwuNOYYJI7E29scufuZndvNjs30+yb5vbd2/l9Ozvv7cyuRdU6ybATPVZknK9Ox2FGEZrbCH1V+dMsapcXCBbJgkWaL2zVNPRem6M7xV1OGpKHZrCYpMsYAExalNhYO8yzpEF0E0drv8u4pkW7lqtud2raWiRDLAEwDrBBOrKFixxnFwXe8JQFdQhyWZBlxhH3nYEYiq4skAMYYMVTx1c4pw+glaLPo+Qn21UAyEzCq+zw8W7jWozbUDMZgFMR/coBdgf407oAZiP6lQPkA/yjKgBksmAfJZ8sKNOxTsXIWTDNLR/vHb6FnJOihzZVIwBwk2VXGbqNFdLn+dW6+ZYD9UZAfkGynyE+UuQTj3y7/W/9Dth5TqgCkLW9FFx9lrigE6CJ/JrpuswVfQBDvluQCtf1AFwO3AVVuNF4gIP8Dt2K3WsswBYm6u4GH2I3CsDiWV15geAJTY0BGJSSFwiG6YkCkJYqqMf4Iw0gGJMDaOEBPxAIZsiFrp7bXAvWqC0AYA/vXf+8C7w9KV7GkA8AyDC9JnCOS74A92PJ+wKcYT4g+DGbPfJnqagGyPE3JHyCjEO+k9mY8h6AroBa7mxL5Fblm/kQW94DMCZ50nMOcYRXCuSFhVh38VFixrfnCUACkAAkAAlAApAA2JSN6pdtpowCTNm8MAowbJHmM62G5H/RDZA19Ol2gf4qSR8j2uVf0ws43vZ10Kvt832B8eprzn/ptwK4iL9QVQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOS0xMi0wM1QxMTo0MTo1NCswMDowME8knnIAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTktMTItMDNUMTE6NDE6NTQrMDA6MDA+eSbOAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAABJRU5ErkJggg==\";\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { SerializedVector2, Vector2 } from \"../core/vector\";\nimport { get } from \"../utils/utils\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Constant } from \"../resource/constants\";\n\nexport class Slider2D extends UINode implements Serializable {\n  private _value: Vector2;\n  private thumbHitColor: string;\n  offThumbCanvas: OffscreenCanvas | HTMLCanvasElement;\n  private offThumbContext: OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D;\n  private pointDiameter: number = 20;\n\n  get value(): Vector2 {\n    if (this.propName) return this.getProp();\n    return this._value;\n  }\n  set value(value: Vector2) {\n    value = value.clamp(0, 1);\n\n    let oldVal = this.value;\n    let newVal = value;\n\n    if (this.propName) this.setProp(newVal);\n    else {\n      this._value = newVal;\n    }\n    this.renderOffThumb();\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node,\n    options: Slider2DOptions = DefaultSlider2DOptions(node)\n  ) {\n    super(node, Vector2.Zero(), UIType.Slider2D, {\n      draggable: true,\n      style: options.style ? { ...DefaultSlider2DStyle(), ...options.style } : DefaultSlider2DStyle(),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'vector2', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'vector2', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.height = get(options.height, this.node.style.rowHeight * 4);\n    this._value = this.propName ? this.getProp() : get(options.value, new Vector2(.5, .5));\n    this._value.clampInPlace(0, 1);\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this.value = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (data) this.value = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.value);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.value);\n    });\n\n    this.thumbHitColor = Color.Random().hexValue;\n    if (typeof OffscreenCanvas !== 'undefined') {\n      this.offThumbCanvas = new OffscreenCanvas(this.width, this.height);\n    } else {\n      this.offThumbCanvas = document.createElement('canvas');\n      this.offThumbCanvas.width = this.width;\n      this.offThumbCanvas.height = this.height;\n    }\n    this.offThumbContext = this.offThumbCanvas.getContext('2d');\n    this.renderOffThumb();\n  }\n\n  renderOffThumb() {\n    let [width, height] = [this.width - this.pointDiameter, this.height - this.pointDiameter];\n    this.offThumbContext.clearRect(0, 0, width, height);\n\n    let coord = new Vector2(this.value.x, 1 - this.value.y).multiply(width, height).add(this.pointDiameter / 2);\n    this.offThumbContext.fillStyle = this.thumbHitColor;\n    this.offThumbContext.beginPath();\n    this.offThumbContext.arc(coord.x, coord.y, this.pointDiameter / 2, 0, Constant.TAU);\n    this.offThumbContext.fill();\n  }\n\n  paint(): void {\n    let context = this.node.context;\n\n    context.fillStyle = this.style.backgroundColor;\n    context.strokeStyle = this.style.borderColor;\n    context.lineWidth = this.style.borderWidth;\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n\n    let [width, height] = [this.width - this.pointDiameter, this.height - this.pointDiameter];\n    let point = new Vector2(this.value.x, 1 - this.value.y)\n      .multiplyInPlace(width, height)\n      .addInPlace(this.position)\n      .addInPlace(this.pointDiameter / 2);\n\n    context.fillStyle = this.style.thumbColor;\n    context.beginPath();\n    context.arc(point.x, point.y, this.pointDiameter / 2, 0, Constant.TAU);\n    context.fill();\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = '#000';\n    context.fillStyle = this.style.backgroundColor;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    let [newWidth, newHeight] = [this.width, this.height];\n\n    if (\n      Math.floor(this.offThumbCanvas.width) !== Math.floor(newWidth)\n      || Math.floor(this.offThumbCanvas.height) !== Math.floor(newHeight)\n    ) {\n\n      this.offThumbCanvas.width = newWidth;\n      this.offThumbCanvas.height = newHeight;\n      this.renderOffThumb();\n    }\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n  getHitPoint(realPosition: Vector2): boolean {\n    let coord = realPosition.subtract(this.position);\n    let hitColor = Color.rgbaToHex(this.offThumbContext.getImageData(coord.x, coord.y, 1, 1).data);\n    return this.thumbHitColor === hitColor;\n  }\n  movePoint(realPosition: Vector2) {\n    let [width, height] = [this.width - this.pointDiameter, this.height - this.pointDiameter];\n\n    this._value = realPosition\n      .clamp(\n        this.position.x + this.pointDiameter / 2, this.position.x + this.width - this.pointDiameter / 2,\n        this.position.y + this.pointDiameter / 2, this.position.y + this.height - this.pointDiameter / 2\n      )\n      .subtractInPlace(this.position.add(this.pointDiameter / 2))\n      .clampInPlace(0, width, 0, height)\n      .normalizeInPlace(0, width, 0, height);\n\n    this.value = new Vector2(this._value.x, 1 - this._value.y);\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    this._value = newVal;\n    this.renderOffThumb();\n\n    this.output && this.output.setData(this.value);\n  }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n\n  private isHit: boolean;\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, null, this._value);\n    this.isHit = false;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.movePoint(realPosition);\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    if (this.isHit) {\n      this.movePoint(realPosition);\n      if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, null, this._value);\n    }\n    this.isHit = false;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedSlider2D {\n    return {\n      value: this.value.serialize(),\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedSlider2D) {\n    return new Slider2D(node, {\n      value: Vector2.deSerialize(data.value),\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface Slider2DStyle extends UINodeStyle {\n  backgroundColor?: string,\n  thumbColor?: string\n  borderColor?: string,\n  borderWidth?: number\n}\nlet DefaultSlider2DStyle = () => {\n  return {\n    backgroundColor: '#666',\n    thumbColor: '#fff',\n    borderColor: '#000',\n    borderWidth: 1\n  }\n}\n\nexport interface SerializedSlider2D extends SerializedUINode {\n  value: SerializedVector2,\n  height: number\n}\n\ninterface Slider2DOptions {\n  value?: Vector2,\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: Slider2DStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultSlider2DOptions = (node: Node): Slider2DOptions => {\n  return {\n    height: node.style.rowHeight * 4\n  }\n};\n","import { Node } from \"../core/node\";\nimport { Terminal, TerminalType, SerializedTerminal } from '../core/terminal';\nimport { Vector2 } from \"../core/vector\";\nimport { Label } from \"./label\";\nimport { SerializedUINode, UINode, UIType, UINodeStyle } from './ui-node';\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { Align } from \"../common/enums\";\nimport { get } from \"../utils/utils\";\n\nexport class Button extends UINode implements Serializable {\n  label: Label;\n\n  constructor(\n    node: Node,\n    public text: string,\n    options: ButtonOptions = DefaultButtonOptions(node)\n  ) {\n    super(node, Vector2.Zero(), UIType.Button, {\n      style: options.style ? { ...DefaultButtonStyle(), ...options.style } : DefaultButtonStyle(),\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'event', '', {})\n        : new Terminal(node, options.input.type, options.input.dataType, options.input.name, {\n          style: options.input.style, id: options.input.id, hitColor: Color.deSerialize(options.input.hitColor)\n        })),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'event', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    if (this.input) this.input.on('event', () => this.call('click', this));\n    this.height = get(options.height, this.node.style.rowHeight + 2 * this.style.padding);\n\n    this.label = new Label(this.node, text, {\n      style: {\n        fontSize: this.style.fontSize,\n        font: this.style.font,\n        align: Align.Center,\n        color: this.style.color\n      },\n      height: this.height\n    });\n    this.label.on('click', (_node: Node, position: Vector2) => this.call('click', this, position));\n    /* this.label.on('enter', () => this.node.flow.flowConnect.cursor = 'pointer');\n    this.label.on('exit', () => this.node.flow.flowConnect.cursor = 'unset'); */\n    this.children.push(this.label);\n  }\n\n  paint(): void {\n    this.context.fillStyle = this.style.backgroundColor;\n    this.context.shadowColor = this.style.shadowColor;\n    this.context.shadowBlur = this.style.shadowBlur;\n    this.context.shadowOffsetX = this.style.shadowOffset.x;\n    this.context.shadowOffsetY = this.style.shadowOffset.y;\n    this.context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  paintLOD1() {\n    this.context.strokeStyle = '#000';\n    this.paint();\n    this.context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    this.label.position = this.position;\n    this.label.height = this.height;\n    this.label.width = this.width;\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange() { /**/ }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n\n    this.call('rightclick', this);\n  }\n\n  serialize(): SerializedButton {\n    return {\n      text: this.text,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      id: this.id,\n      style: this.style,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedButton): Button {\n    return new Button(node, data.text, {\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface ButtonStyle extends UINodeStyle {\n  backgroundColor?: string,\n  color?: string,\n  fontSize?: string,\n  font?: string,\n  padding?: number,\n  shadowColor?: string,\n  shadowBlur?: number,\n  shadowOffset?: Vector2;\n}\nlet DefaultButtonStyle = () => {\n  return {\n    backgroundColor: '#666',\n    padding: 5,\n    color: '#fff',\n    font: 'arial',\n    fontSize: '11px',\n    shadowColor: '#555',\n    shadowBlur: 3,\n    shadowOffset: new Vector2(3, 3)\n  };\n};\n\nexport interface SerializedButton extends SerializedUINode {\n  text: string,\n  height: number\n}\n\ninterface ButtonOptions {\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: ButtonStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultButtonOptions = (node: Node): ButtonOptions => {\n  return {\n    height: node.style.rowHeight * 1.5\n  };\n};\n","import { Color } from \"../core/color\";\nimport { RenderResolver, Serializable } from \"../common/interfaces\";\nimport { Node } from \"../core/node\";\nimport { Vector2 } from \"../core/vector\";\nimport { Button, Display, HorizontalLayout, Stack, Image, Input, Label, Select, Slider, Source, Toggle } from \"./index\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType, UINodeRenderParams } from \"./ui-node\";\nimport { Align } from \"../common/enums\";\n\nexport class Container extends UINode implements Serializable {\n  renderResolver: RenderResolver<Container, ContainerRenderParams> = () => null;\n  contentWidth: number;\n\n  constructor(\n    node: Node,\n    width: number,\n    options: ContainerOptions = DefaultContainerOptions()\n  ) {\n    super(node, node.position, UIType.Container, {\n      style: options.style ? { ...DefaultContainerStyle(), ...options.style } : DefaultContainerStyle(),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.width = width;\n    this.height = this.node.style.padding * 2;\n    this.contentWidth = this.width - 2 * this.node.style.padding;\n  }\n\n  paint(): void {\n    let context = this.context;\n    let nodeRenderResolver = this.node.renderResolver.uiContainer;\n    let flowRenderResolver = this.node.flow.renderResolver.uiContainer;\n    let flowConnectRenderResolver = this.node.flow.flowConnect.renderResolver.uiContainer;\n    ((this.renderResolver && this.renderResolver(this))\n      || (nodeRenderResolver && nodeRenderResolver(this))\n      || (flowRenderResolver && flowRenderResolver(this))\n      || (flowConnectRenderResolver && flowConnectRenderResolver(this))\n      || this._paint\n    )(context, this.getRenderParams(), this);\n  }\n  private _paint(context: CanvasRenderingContext2D, params: ContainerRenderParams, container: Container) {\n    context.shadowColor = container.style.shadowColor;\n    context.shadowBlur = container.style.shadowBlur;\n    context.shadowOffsetX = container.style.shadowOffset.x;\n    context.shadowOffsetY = container.style.shadowOffset.y;\n    context.fillStyle = container.style.backgroundColor;\n    context.strokeStyle = container.style.borderColor;\n    context.lineWidth = container.style.borderWidth;\n    context.roundRect(params.position.x, params.position.y, params.width, params.height, 5);\n    context.stroke();\n    context.fill();\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.fillStyle = this.style.backgroundColor;\n    context.strokeStyle = this.style.borderColor;\n    context.lineWidth = this.style.borderWidth;\n    context.roundRect(\n      this.position.x, this.position.y + this.node.style.titleHeight,\n      this.width, this.height - this.node.style.titleHeight, 5\n    );\n    context.stroke();\n    context.fill();\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  getRenderParams(): ContainerRenderParams {\n    let position = this.position.serialize();\n    position.y += this.node.style.titleHeight\n    return {\n      position: position,\n      width: this.width,\n      height: this.height - this.node.style.titleHeight\n    }\n  }\n\n  reflow(): void {\n    this.position = this.node.position;\n    let terminalsDisplayHeight = Math.max(this.node.inputs.length, this.node.outputs.length) * this.node.style.terminalRowHeight + this.node.style.titleHeight;\n    let x = this.position.x + this.node.style.padding;\n    let y = this.position.y + terminalsDisplayHeight;\n    this.children.filter(child => child.visible).forEach(child => {\n      y += this.node.style.spacing;\n      let availableWidth = this.width - this.node.style.padding * 2;\n      child.width = (child.width > availableWidth ? availableWidth : child.width) || availableWidth;\n      if (child.width < availableWidth) {\n        let childX;\n        if (child.style.align === Align.Center) {\n          childX = this.position.x + this.width / 2 - child.width / 2;\n        } else if (child.style.align === Align.Right) {\n          childX = this.position.x + this.width - this.node.style.padding - child.width;\n        } else {\n          childX = x;\n        }\n        child.position = new Vector2(childX, y);\n      } else {\n        child.position = new Vector2(x, y);\n      }\n      y += child.height;\n    });\n    this.height = y + this.node.style.padding - this.position.y;\n  }\n\n  onPropChange() { /**/ }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void { /**/ }\n\n  serialize(): SerializedContainer {\n    return {\n      width: this.width,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      id: this.id,\n      style: {\n        backgroundColor: this.style.backgroundColor,\n        shadowColor: this.style.shadowColor,\n        shadowBlur: this.style.shadowBlur,\n        shadowOffset: this.style.shadowOffset.serialize(),\n        borderWidth: this.style.borderWidth,\n        borderColor: this.style.borderColor\n      },\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: this.children.map(child => (child as any).serialize())\n    }\n  }\n  static deSerialize(node: Node, data: SerializedContainer): Container {\n    let uiContainer = new Container(node, data.width, {\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n\n    uiContainer.children.push(...data.childs.map(serializedChild => {\n      switch (serializedChild.type) {\n        case UIType.Button: return Button.deSerialize(node, serializedChild);\n        case UIType.Container: return Container.deSerialize(node, serializedChild);\n        case UIType.Display: return Display.deSerialize(node, serializedChild);\n        case UIType.HorizontalLayout: return HorizontalLayout.deSerialize(node, serializedChild);\n        case UIType.Stack: return Stack.deSerialize(node, serializedChild);\n        case UIType.Image: return Image.deSerialize(node, serializedChild);\n        case UIType.Input: return Input.deSerialize(node, serializedChild);\n        case UIType.Label: return Label.deSerialize(node, serializedChild);\n        case UIType.Select: return Select.deSerialize(node, serializedChild);\n        case UIType.Slider: return Slider.deSerialize(node, serializedChild);\n        case UIType.Source: return Source.deSerialize(node, serializedChild);\n        case UIType.Toggle: return Toggle.deSerialize(node, serializedChild);\n        default: return;\n      }\n    }));\n    return uiContainer;\n  }\n}\n\nexport interface ContainerStyle extends UINodeStyle {\n  backgroundColor?: string,\n  shadowColor?: string,\n  shadowBlur?: number,\n  shadowOffset?: Vector2,\n  borderColor?: string,\n  borderWidth?: number\n}\nlet DefaultContainerStyle = () => {\n  return {\n    backgroundColor: '#ddd',\n    shadowColor: '#666',\n    shadowBlur: 3,\n    shadowOffset: new Vector2(3, 3),\n    borderWidth: 1,\n    borderColor: '#444',\n    visible: true\n  };\n};\n\nexport interface SerializedContainer extends SerializedUINode {\n  width: number\n}\n\ninterface ContainerOptions {\n  style?: ContainerStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultContainerOptions = () => {\n  return {};\n};\n\nexport interface ContainerRenderParams extends UINodeRenderParams { }\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { Vector2 } from \"../core/vector\";\nimport { clamp, denormalize, get, normalize } from \"../utils/utils\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Constant } from \"../resource/constants\";\n\nexport class Dial extends UINode implements Serializable {\n  private _value: number;\n  private thumbStart: Vector2 = Vector2.Zero();\n  private thumbEnd: Vector2 = Vector2.Zero();\n  private lastAngle: number;\n  private deltaValue: number;\n  private temp: number;\n\n  get value(): number {\n    if (this.propName) return this.getProp();\n    return this._value;\n  }\n  set value(value: number) {\n    let oldVal = this.value;\n    let newVal = clamp(value, this.min, this.max);\n\n    if (this.propName) this.setProp(newVal);\n    else this._value = newVal;\n    this.temp = normalize(newVal, this.min, this.max);\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node,\n    public min: number, public max: number,\n    height: number,\n    options: DialOptions = DefaultDialOptions(min)\n  ) {\n    super(node, Vector2.Zero(), UIType.Dial, {\n      draggable: true,\n      style: options.style ? { ...DefaultDialStyle(height), ...options.style } : DefaultDialStyle(height),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'number', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'number', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.height = height;\n    this._value = get(options.value, min);\n    this.temp = normalize(this._value, this.min, this.max);\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this.value = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (data) this.value = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.value);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.value);\n    });\n  }\n\n  paint(): void {\n    let context = this.context;\n    let size = Math.min(this.width, this.height);\n\n    context.fillStyle = this.style.color;\n    context.strokeStyle = this.style.borderColor;\n    context.lineWidth = this.style.borderWidth;\n    context.shadowColor = this.style.shadowColor;\n    context.shadowBlur = this.style.shadowBlur;\n    context.shadowOffsetX = 3;\n    context.shadowOffsetY = 3;\n    context.beginPath();\n    context.arc(this.position.x + this.width / 2, this.position.y + this.height / 2, size / 2, 0, Constant.TAU);\n    context.stroke();\n    context.fill();\n\n    context.lineCap = 'round';\n    context.lineWidth = 10;\n    context.strokeStyle = this.style.thumbColor;\n    context.shadowColor = this.style.thumbShadowColor;\n    context.shadowBlur = this.style.thumbShadowBlur;\n    context.beginPath();\n    context.moveTo(this.thumbStart.x, this.thumbStart.y);\n    context.lineTo(this.thumbEnd.x, this.thumbEnd.y);\n    context.stroke();\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = '#000';\n    context.fillStyle = this.style.color;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    let context = this.offUIContext;\n    let size = Math.min(this.width, this.height);\n\n    context.fillStyle = this.hitColor.hexValue;\n    context.beginPath();\n    context.arc(this.position.x + this.width / 2, this.position.y + this.height / 2, size / 2, 0, Constant.TAU);\n    context.fill();\n  }\n\n  reflow(): void {\n    let center = this.position.add(this.width / 2, this.height / 2);\n    let angle = normalize(this.value, this.min, this.max) * Constant.TAU + (Math.PI / 2);\n    let size = Math.min(this.width, this.height);\n    this.thumbStart.assign(center.x + Math.cos(angle) * (size / 5), center.y + Math.sin(angle) * (size / 5));\n    this.thumbEnd.assign(center.x + Math.cos(angle) * (size / 2 - 10), center.y + Math.sin(angle) * (size / 2 - 10));\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n  private pointToValue(position: Vector2): number {\n    let diff = position.subtract(this.position.add(this.width / 2, this.height / 2));\n    let angle = Math.atan2(diff.y, diff.x);\n    if (angle < 0) angle += Constant.TAU;\n    return (((angle / Constant.TAU) - 0.25) + 1) % 1;\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    this._value = newVal;\n    this.temp = normalize(newVal, this.min, this.max);\n    this.reflow();\n\n    this.output && this.output.setData(this._value);\n  }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.lastAngle = undefined;\n    this.deltaValue = this.pointToValue(realPosition);\n    this.temp = normalize(this.value, this.min, this.max);\n    this.onDrag(screenPosition, realPosition);\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    let currValue = this.pointToValue(realPosition);\n    let diffValue = currValue - this.deltaValue;\n    diffValue = (Math.abs(diffValue) > 0.5) ? 0 : diffValue;\n    this.deltaValue = currValue;\n    this.temp = this.temp + diffValue;\n    this.temp = clamp(this.temp, 0, 1);\n\n    let angle = this.temp * Constant.TAU;\n    if (angle < 0) angle += Constant.TAU;\n    if (typeof this.lastAngle !== 'undefined' && Math.abs(this.lastAngle - angle) > 2) {\n      angle = this.lastAngle > 3 ? Constant.TAU : 0;\n    }\n    this.lastAngle = angle;\n    let normalizedValue = angle / Constant.TAU;\n    this.value = denormalize(clamp(normalizedValue, 0, 1), this.min, this.max);\n    this.temp = normalizedValue;\n    this.reflow();\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.lastAngle = undefined;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedDial {\n    return {\n      min: this.min,\n      max: this.max,\n      value: this.value,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      size: this.height,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      style: this.style,\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedDial) {\n    return new Dial(node, data.min, data.max, data.size, {\n      value: data.value,\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface DialStyle extends UINodeStyle {\n  color?: string,\n  borderColor?: string,\n  borderWidth?: number,\n  shadowColor?: string,\n  shadowBlur?: number,\n  thumbColor?: string,\n  thumbBorderColor?: string,\n  thumbBorderWidth?: number,\n  thumbShadowColor?: string,\n  thumbShadowBlur?: number\n}\nlet DefaultDialStyle = (size: number) => {\n  return {\n    color: '#e3e3e3',\n    borderColor: '#000',\n    borderWidth: 1,\n    shadowColor: 'grey',\n    shadowBlur: 5,\n    thumbColor: '#c9c9c9',\n    thumbShadowColor: '#858585',\n    thumbShadowBlur: 5,\n    size,\n    visible: true\n  }\n}\n\nexport interface SerializedDial extends SerializedUINode {\n  min: number,\n  max: number,\n  value: number,\n  size: number\n}\n\ninterface DialOptions {\n  value?: number,\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  style?: DialStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultDialOptions = (min: number) => {\n  return {\n    value: min\n  };\n};\n","import { Color } from \"../core/color\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Node } from \"../core/node\";\nimport { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Vector2 } from \"../core/vector\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\n\nexport class Display extends UINode implements Serializable {\n  offCanvasConfigs: CustomOffCanvasConfig[] = [];\n\n  constructor(\n    node: Node,\n    height: number,\n    customRenderers: CustomRendererConfig[],\n    options: DisplayOptions = DefaultDisplayOptions()\n  ) {\n    super(node, Vector2.Zero(), UIType.Display, {\n      draggable: true,\n      zoomable: true,\n      style: options.style ? { ...DefaultDisplayStyle(), ...options.style } : DefaultDisplayStyle(),\n      input: options.clear && typeof options.clear !== 'boolean'\n        ? Terminal.deSerialize(node, options.clear)\n        : new Terminal(node, TerminalType.IN, 'event', '', {}),\n      id: options.id, hitColor: options.hitColor\n    });\n\n    this.height = height;\n\n    if (typeof OffscreenCanvas !== 'undefined') {\n      customRenderers.forEach(rendererConfig => {\n        let offCanvas, offContext, newOffCanvasConfig;\n        if (rendererConfig.canvasType === CanvasType.HTMLCanvasElement) {\n          offCanvas = document.createElement('canvas');\n          offCanvas.width = this.node.width - 2 * this.node.style.padding;\n          offCanvas.height = this.height;\n        } else {\n          offCanvas = new OffscreenCanvas(this.node.width - 2 * this.node.style.padding, this.height);\n        }\n        offContext = offCanvas.getContext('2d');\n        newOffCanvasConfig = { canvas: offCanvas, context: offContext, rendererConfig, shouldRender: true }\n        this.offCanvasConfigs.push(newOffCanvasConfig);\n      });\n    } else {\n      customRenderers.forEach(rendererConfig => {\n        let offCanvas = document.createElement('canvas');\n        offCanvas.width = this.node.width - 2 * this.node.style.padding;\n        offCanvas.height = this.height;\n        let offContext = offCanvas.getContext('2d');\n        let newOffCanvasConfig = { canvas: offCanvas, context: offContext, rendererConfig, shouldRender: true }\n        this.offCanvasConfigs.push(newOffCanvasConfig);\n      });\n    }\n\n    this.input.on('event', () => {\n      this.offCanvasConfigs.filter(config => !config.rendererConfig.auto).forEach(config => {\n        config.context.clearRect(0, 0, config.canvas.width, config.canvas.height);\n      });\n    });\n\n    this.node.flow.flowConnect.on('scale', () => this.reflow());\n  }\n\n  private customRender(canvasConfigs: CustomOffCanvasConfig[]) {\n    return Promise.all(canvasConfigs.map(config => {\n      return new Promise<boolean>(resolve => {\n        if (config.shouldRender) {\n          if (config.rendererConfig.clear)\n            config.context.clearRect(0, 0, config.canvas.width, config.canvas.height);\n          if (this.style.backgroundColor) {\n            config.context.fillStyle = this.style.backgroundColor;\n            config.context.fillRect(0, 0, config.canvas.width, config.canvas.height);\n          }\n          resolve(\n            config.rendererConfig.renderer(config.context, config.canvas.width, config.canvas.height)\n          );\n        } else resolve(false);\n      });\n    }));\n  }\n\n  paint(): void {\n    let context = this.context;\n    context.strokeStyle = this.style.borderColor;\n    context.lineWidth = 1;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n\n    let autoOffCanvasConfigs = this.offCanvasConfigs.filter(config => config.rendererConfig.auto);\n    this.customRender(autoOffCanvasConfigs).then((results: boolean[]) => {\n      results.forEach((result, index) => autoOffCanvasConfigs[index].shouldRender = result);\n    });\n\n    this.offCanvasConfigs.forEach(offCanvas => {\n      context.drawImage(\n        offCanvas.canvas, 0, 0,\n        offCanvas.canvas.width, offCanvas.canvas.height,\n        this.position.x, this.position.y,\n        this.node.width - 2 * this.node.style.padding, this.height\n      );\n    });\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = this.style.borderColor;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillStyle = 'lightgrey';\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    let newWidth = (this.node.width - 2 * this.node.style.padding) * this.node.flow.flowConnect.scale;\n    let newHeight = this.height * this.node.flow.flowConnect.scale;\n\n    this.offCanvasConfigs.forEach(offCanvas => {\n      // Optimization: Do not trigger re-render if width/height is same\n      if (Math.floor(offCanvas.canvas.width) !== Math.floor(newWidth) || Math.floor(offCanvas.canvas.height) !== Math.floor(newHeight)) {\n        offCanvas.canvas.width = newWidth;\n        offCanvas.canvas.height = newHeight;\n\n        if (!offCanvas.shouldRender) {\n          offCanvas.rendererConfig.renderer(offCanvas.context, offCanvas.canvas.width, offCanvas.canvas.height);\n          offCanvas.shouldRender = false;\n        }\n      }\n    });\n\n    this.input.position.assign(\n      this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n      this.position.y + this.height / 2\n    );\n  }\n\n  onPropChange() { /**/ }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n\n    this.call('rightclick', this);\n  }\n\n  serialize(): SerializedDisplay {\n    return {\n      height: this.height,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      style: this.style,\n      type: this.type,\n      childs: []\n    };\n  }\n  static deSerialize(node: Node, data: SerializedDisplay): Display {\n    return new Display(node, data.height, null, {\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor),\n      clear: data.input\n    });\n  }\n}\n\nexport enum CanvasType {\n  OffscreenCanvas,\n  HTMLCanvasElement\n}\n\nexport interface CustomOffCanvasConfig {\n  canvas: OffscreenCanvas | HTMLCanvasElement;\n  context: OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D;\n  rendererConfig: CustomRendererConfig,\n  shouldRender: boolean\n}\n\nexport interface CustomRendererConfig {\n  auto?: boolean,\n  clear?: boolean,\n  canvasType?: CanvasType,\n  renderer?: (context: CanvasRenderingContext2D | OffscreenCanvasRenderingContext2D, width: number, height: number) => boolean,\n}\n\nexport interface DisplayStyle extends UINodeStyle {\n  borderColor?: string,\n  backgroundColor?: string\n}\nlet DefaultDisplayStyle = () => {\n  return {\n    borderColor: '#000',\n    visible: true\n  };\n};\n\nexport interface SerializedDisplay extends SerializedUINode {\n  height: number\n}\n\ninterface DisplayOptions {\n  style?: DisplayStyle,\n  id?: string,\n  hitColor?: Color,\n  clear?: boolean | SerializedTerminal\n}\nlet DefaultDisplayOptions = () => {\n  return {}\n};\n","import { SerializedVector2, Vector2 } from \"../core/vector\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Node } from '../core/node';\nimport { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Constant } from \"../resource/constants\";\nimport { List, ListNode } from \"../utils/linked-list\";\nimport { BiMap } from \"../utils/bidirectional-map\";\n\nexport class Envelope extends UINode implements Serializable {\n  private _value: List<Vector2>;\n  private pointHitColorPoint: BiMap<string, ListNode<Vector2>> = new BiMap();\n  offPointsCanvas: OffscreenCanvas | HTMLCanvasElement;\n  private offPointsContext: OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D;\n  private pointDiameter: number = 10;\n\n  get value(): Vector2[] {\n    return this._value.toArray().map(vec => vec.clone());\n  }\n  set value(value: Vector2[]) {\n    let oldVal = this.value;\n    value.forEach(vector => vector.clampInPlace(0, 1, 0, 1));\n    value.sort((a, b) => a.x - b.x);\n    this._value = new List((a, b) => a.x - b.x, value);\n    this.pointHitColorPoint.clear();\n    this._value.forEach(node => this.pointHitColorPoint.set(Color.Random().hexValue, node));\n    this.renderOffPoints();\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, this._value.toArray());\n  }\n\n  constructor(\n    node: Node,\n    height: number,\n    values: Vector2[] = [],\n    options: EnvelopeOptions = DefaultEnvelopeOptions()\n  ) {\n    super(node, Vector2.Zero(), UIType.Envelope, {\n      draggable: true,\n      style: options.style ? { ...DefaultEnvelopeStyle(), ...options.style } : DefaultEnvelopeStyle(),\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'array', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'array', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.height = height;\n    values.forEach(vector => vector.clampInPlace(0, 1, 0, 1));\n    values.sort((a, b) => a.x - b.x);\n    this._value = new List((a, b) => a.x - b.x, values);\n    this.pointHitColorPoint.clear();\n    this._value.forEach(pointNode => this.pointHitColorPoint.set(Color.Random().hexValue, pointNode));\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this.value = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (data) this.value = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.value);\n\n    if (typeof OffscreenCanvas !== 'undefined') {\n      this.offPointsCanvas = new OffscreenCanvas(this.width, this.height);\n    } else {\n      this.offPointsCanvas = document.createElement('canvas');\n      this.offPointsCanvas.width = this.width;\n      this.offPointsCanvas.height = this.height;\n    }\n    this.offPointsContext = this.offPointsCanvas.getContext('2d');\n    this.renderOffPoints();\n  }\n\n  renderOffPoints() {\n    let [width, height] = [this.width - this.pointDiameter, this.height - this.pointDiameter];\n    this.offPointsContext.clearRect(0, 0, width, height);\n\n    this._value.forEach(node => {\n      let coord = new Vector2(node.data.x, 1 - node.data.y).multiply(width, height).add(this.pointDiameter / 2);\n      this.offPointsContext.fillStyle = this.pointHitColorPoint.get(node) as string;\n      this.offPointsContext.beginPath();\n      this.offPointsContext.arc(coord.x, coord.y, this.pointDiameter / 2, 0, Constant.TAU);\n      this.offPointsContext.fill();\n    });\n  }\n\n  paint(): void {\n    let context = this.node.context;\n\n    context.fillStyle = this.style.backgroundColor;\n    context.strokeStyle = this.style.borderColor;\n    context.lineWidth = this.style.borderWidth;\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n\n    let [width, height] = [this.width - this.pointDiameter, this.height - this.pointDiameter];\n    let points: Vector2[] = this._value.map(node =>\n      new Vector2(node.data.x, 1 - node.data.y)\n        .multiplyInPlace(width, height)\n        .addInPlace(this.position)\n        .addInPlace(this.pointDiameter / 2)\n    );\n\n    if (points.length > 0) {\n      context.strokeStyle = this.style.lineColor;\n      context.lineWidth = 2;\n      context.beginPath();\n      context.moveTo(this.position.x, points[0].y);\n      points.forEach(point => context.lineTo(point.x, point.y));\n      context.lineTo(this.position.x + this.width, points[points.length - 1].y);\n      context.stroke();\n    }\n\n    context.fillStyle = this.style.pointColor;\n    points.forEach(point => {\n      context.beginPath();\n      context.arc(point.x, point.y, this.pointDiameter / 2, 0, Constant.TAU);\n      context.fill();\n    });\n  }\n  paintLOD1() {\n    this.context.fillStyle = this.style.backgroundColor;\n    this.context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    let [newWidth, newHeight] = [this.width, this.height];\n\n    if (\n      Math.floor(this.offPointsCanvas.width) !== Math.floor(newWidth)\n      || Math.floor(this.offPointsCanvas.height) !== Math.floor(newHeight)\n    ) {\n\n      this.offPointsCanvas.width = newWidth;\n      this.offPointsCanvas.height = newHeight;\n      this.renderOffPoints();\n    }\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  getHitPoint(realPosition: Vector2): ListNode<Vector2> {\n    let coord = realPosition.subtract(this.position);\n    let hitColor = Color.rgbaToHex(this.offPointsContext.getImageData(coord.x, coord.y, 1, 1).data);\n    let hitPointNode = this.pointHitColorPoint.get(hitColor);\n    return hitPointNode as ListNode<Vector2>;\n  }\n  movePoint(realPosition: Vector2) {\n    let [width, height] = [this.width - this.pointDiameter, this.height - this.pointDiameter];\n\n    this.currHitPoint.data = realPosition\n      .clamp(\n        this.position.x + this.pointDiameter / 2, this.position.x + this.width - this.pointDiameter / 2,\n        this.position.y + this.pointDiameter / 2, this.position.y + this.height - this.pointDiameter / 2\n      )\n      .subtractInPlace(this.position.add(this.pointDiameter / 2))\n      .clampInPlace(0, width, 0, height)\n      .normalizeInPlace(0, width, 0, height)\n      .clampInPlace(\n        this.currHitPoint.prev?.data.x || 0, this.currHitPoint.next?.data.x || 1,\n        -Infinity, Infinity\n      );\n    this.currHitPoint.data = new Vector2(this.currHitPoint.data.x, 1 - this.currHitPoint.data.y);\n\n    this.renderOffPoints();\n  }\n  newPoint(realPosition: Vector2, width: number, height: number) {\n    let oldVal = this._value.toArray();\n\n    let newPoint = realPosition\n      .subtract(this.position.add(this.pointDiameter / 2))\n      .normalizeInPlace(0, width, 0, height);\n    newPoint = new Vector2(newPoint.x, 1 - newPoint.y);\n\n    let newPointNode;\n    let anchor = this._value.searchTail(node => node.data.x <= newPoint.x);\n\n    if (anchor === null) newPointNode = this._value.prepend(newPoint);\n    else newPointNode = this._value.addAfter(newPoint, anchor);\n\n    this.pointHitColorPoint.set(Color.Random().hexValue, newPointNode);\n    this.renderOffPoints();\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, this._value.toArray());\n  }\n  deletePoint() {\n    let oldVal = this._value.toArray();\n    this._value.delete(this.currHitPoint);\n    this.pointHitColorPoint.delete(this.currHitPoint);\n    this.renderOffPoints();\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, this._value.toArray());\n  }\n\n  onPropChange() { /**/ }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n\n  private currHitPoint: ListNode<Vector2>;\n  private lastDownPosition: Vector2;\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.currHitPoint = this.getHitPoint(realPosition);\n    this.lastDownPosition = realPosition;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    let [width, height] = [this.width - this.pointDiameter, this.height - this.pointDiameter];\n    if (!this.currHitPoint && this.lastDownPosition) {\n      if (Vector2.Distance(this.lastDownPosition, realPosition) <= 2) {\n        this.newPoint(realPosition, width, height);\n      }\n    } else if (\n      this.currHitPoint && this.currHitPoint === this.getHitPoint(realPosition)\n      && this.lastDownPosition && this.lastDownPosition.isEqual(realPosition, 0.5)\n    ) {\n      this.deletePoint();\n    } else if (this.currHitPoint) {\n      // Point has finished moving\n      if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, null, this._value.toArray());\n    }\n\n    this.currHitPoint = null;\n    this.lastDownPosition = null;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    if (this.currHitPoint) this.movePoint(realPosition);\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    if (this.currHitPoint) {\n      this.movePoint(realPosition);\n      if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, null, this._value.toArray());\n    }\n    this.currHitPoint = null;\n    this.lastDownPosition = null;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedEnvelope {\n    return {\n      values: this.value.map(vector => vector.serialize()),\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      style: this.style,\n      height: this.height,\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedEnvelope): Envelope {\n    return new Envelope(node, data.height, data.values.map(serialVec => Vector2.deSerialize(serialVec)), {\n      input: data.input,\n      output: data.output,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface EnvelopeStyle extends UINodeStyle {\n  backgroundColor?: string,\n  pointColor?: string,\n  lineColor?: string,\n  borderColor?: string,\n  borderWidth?: number\n}\nlet DefaultEnvelopeStyle = () => {\n  return {\n    backgroundColor: '#4a4a4a',\n    pointColor: '#9cffee',\n    lineColor: '#9cd6ff',\n    borderColor: '#000',\n    borderWidth: 1,\n    visible: true\n  };\n};\n\nexport interface SerializedEnvelope extends SerializedUINode {\n  values: SerializedVector2[],\n  height: number\n}\n\ninterface EnvelopeOptions {\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  style?: EnvelopeStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultEnvelopeOptions = () => {\n  return {};\n};\n","import { Color } from \"../core/color\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Node } from \"../core/node\";\nimport { Vector2 } from \"../core/vector\";\nimport { Button, Container, Display, Image, Input, Label, Select, Slider, Source, Stack, Toggle, } from \"./index\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { clamp } from \"../utils/utils\";\nimport { SerializedTerminal, Terminal, TerminalType } from \"../core/terminal\";\n\nexport class HorizontalLayout extends UINode implements Serializable {\n\n  constructor(\n    node: Node,\n    childs: UINode[] = [],\n    options: HorizontalLayoutOptions = DefaultHorizontalLayoutOptions()\n  ) {\n    super(node, Vector2.Zero(), UIType.HorizontalLayout, {\n      style: options.style ? { ...DefaultHorizontalLayoutStyle(), ...options.style } : DefaultHorizontalLayoutStyle(),\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'any', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'any', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    if (childs && childs.length > 0) this.children.push(...childs);\n  }\n\n  paint(): void { /**/ }\n  paintLOD1() { /**/ }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    let children = this.children.filter(child => child.visible);\n\n    let availableWidth = this.width - (children.length > 0 ? (children.length - 1) : 0) * this.style.spacing;\n    let originalWidth = availableWidth;\n\n    let maxHeight = 0;\n    children.forEach(child => maxHeight = Math.max(maxHeight, child.height));\n    this.height = maxHeight;\n\n    let fixedWidthChilds = this.children.filter(child => !!child.width);\n    fixedWidthChilds.forEach(child => child.width = clamp(child.width, 0, availableWidth));\n    let fixedWidth = fixedWidthChilds.reduce((acc, curr) => acc + curr.width, 0);\n\n    let remainingWidth = originalWidth;\n    fixedWidth = clamp(fixedWidth, 0, remainingWidth);\n    remainingWidth -= fixedWidth;\n    let flexWidth = remainingWidth;\n\n    let x = this.position.x;\n    children.forEach(child => {\n      let childWidth;\n      if (!!child.width) childWidth = child.width;\n      else if (typeof child.style.grow === 'number') {\n        childWidth = child.style.grow * flexWidth;\n      } else {\n        childWidth = 0;\n      }\n\n      childWidth = clamp(childWidth, 0, availableWidth);\n      child.width = childWidth;\n\n      let y;\n      if (child.height < this.height) {\n        y = this.position.y + this.height / 2 - child.height / 2;\n      } else {\n        child.height = this.height\n        y = this.position.y;\n      }\n      child.position.assign(x, y);\n\n      availableWidth -= childWidth;\n      x += childWidth + this.style.spacing;\n    });\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n\n    // To fix a bug, when creating HozLayout with childs argument, UI container's height won't update\n    this.node.ui.reflow();\n  }\n\n  onPropChange() { /**/ }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void { /**/ }\n\n  serialize(): SerializedHorizontalLayout {\n    return {\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      id: this.id,\n      style: this.style,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: this.children.map(child => (child as any).serialize())\n    }\n  }\n  static deSerialize(node: Node, data: SerializedHorizontalLayout): HorizontalLayout {\n    let hozLayout = new HorizontalLayout(node, [], {\n      style: data.style,\n      input: data.input,\n      output: data.output,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n\n    hozLayout.children.push(...data.childs.map(serializedChild => {\n      switch (serializedChild.type) {\n        case UIType.Button: return Button.deSerialize(node, serializedChild);\n        case UIType.Container: return Container.deSerialize(node, serializedChild);\n        case UIType.Display: return Display.deSerialize(node, serializedChild);\n        case UIType.HorizontalLayout: return HorizontalLayout.deSerialize(node, serializedChild);\n        case UIType.Stack: return Stack.deSerialize(node, serializedChild);\n        case UIType.Image: return Image.deSerialize(node, serializedChild);\n        case UIType.Input: return Input.deSerialize(node, serializedChild);\n        case UIType.Label: return Label.deSerialize(node, serializedChild);\n        case UIType.Select: return Select.deSerialize(node, serializedChild);\n        case UIType.Slider: return Slider.deSerialize(node, serializedChild);\n        case UIType.Source: return Source.deSerialize(node, serializedChild);\n        case UIType.Toggle: return Toggle.deSerialize(node, serializedChild);\n        default: return;\n      }\n    }));\n    return hozLayout;\n  }\n}\n\nexport interface HorizontalLayoutStyle extends UINodeStyle {\n  spacing?: number\n}\nlet DefaultHorizontalLayoutStyle = () => {\n  return {\n    spacing: 0,\n    visible: true\n  };\n};\n\nexport interface SerializedHorizontalLayout extends SerializedUINode { }\n\ninterface HorizontalLayoutOptions {\n  style?: HorizontalLayoutStyle,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultHorizontalLayoutOptions = (): HorizontalLayoutOptions => {\n  return {};\n};\n","import { Color } from \"../core/color\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Node } from \"../core/node\";\nimport { Vector2 } from \"../core/vector\";\nimport { imageIcon } from \"../resource/icons\";\nimport { Log } from \"../utils/logger\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Align } from \"../common/enums\";\nimport { SerializedTerminal, Terminal, TerminalType } from \"../core/terminal\";\nimport { FlowState } from '../core/flow';\nimport { get } from \"../utils/utils\";\n\nexport class Image extends UINode implements Serializable {\n  private imageCanvas: OffscreenCanvas | HTMLCanvasElement;\n  private imageContext: OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D;\n  private source: HTMLImageElement;\n  private ratio: number;\n  private _src: string;\n\n  get src(): string {\n    if (this.propName) return this.getProp();\n    return this._src;\n  }\n  set src(src: string) {\n    let oldVal = this._src;\n    let newVal = src;\n\n    if (this.propName) this.setProp(newVal);\n    else this._src = newVal;\n    this.setupImage();\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node,\n    sourceString: string,\n    options: ImageOptions = DefaultImageOptions()\n  ) {\n    super(node, Vector2.Zero(), UIType.Image, {\n      style: options.style ? { ...DefaultImageStyle(), ...options.style } : DefaultImageStyle(),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'string', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'string', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this._src = get(sourceString, imageIcon);\n    this.setupImage();\n  }\n\n  setupImage() {\n    if (!this.source) {\n      this.source = document.createElement('img');\n      this.source.onerror = (error) => Log.error(error);\n      this.source.onload = () => {\n        this.imageCanvas.width = this.source.width;\n        this.imageCanvas.height = this.source.height;\n\n        this.imageContext.drawImage(this.source, 0, 0);\n        this.ratio = this.source.width / this.source.height;\n        this.reflow();\n        this.node.ui.update();\n      };\n    }\n    if (!this.imageCanvas) {\n      if (typeof OffscreenCanvas !== 'undefined') this.imageCanvas = new OffscreenCanvas(0, 0);\n      else {\n        this.imageCanvas = document.createElement('canvas');\n        this.imageCanvas.width = 0;\n        this.imageCanvas.height = 0;\n      }\n      this.imageContext = this.imageCanvas.getContext('2d');\n    }\n\n    this.source.src = this._src;\n  }\n\n  paint(): void {\n    if (this.imageCanvas && this.imageCanvas.width > 0 && this.imageCanvas.height > 0) {\n      let x = this.position.x;\n      if (this.source.width < this.node.ui.contentWidth) {\n        if (this.style.align === Align.Center) x += this.node.ui.contentWidth / 2 - this.source.width / 2;\n        else if (this.style.align === Align.Right) x += + (this.node.ui.contentWidth - this.source.width);\n      }\n      this.context.drawImage(\n        this.imageCanvas, 0, 0, this.source.width, this.source.height,\n        x, this.position.y, this.source.width < this.width ? this.source.width : this.width, this.height\n      );\n    }\n  }\n  paintLOD1() {\n    if (this.imageCanvas) {\n      let x = this.position.x;\n      if (this.source.width < this.node.ui.contentWidth) {\n        if (this.style.align === Align.Center) x += this.node.ui.contentWidth / 2 - this.source.width / 2;\n        else if (this.style.align === Align.Right) x += + (this.node.ui.contentWidth - this.source.width);\n      }\n      let context = this.context;\n      context.fillStyle = 'lightgrey';\n      context.strokeStyle = '#000';\n      context.fillRect(x, this.position.y, this.source.width < this.width ? this.source.width : this.width, this.height);\n      context.strokeRect(x, this.position.y, this.source.width < this.width ? this.source.width : this.width, this.height)\n    }\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n\n    let x = this.position.x;\n    if (this.source.width < this.node.ui.contentWidth) {\n      if (this.style.align === Align.Center) x += this.node.ui.contentWidth / 2 - this.source.width / 2;\n      else if (this.style.align === Align.Right) x += + (this.node.ui.contentWidth - this.source.width);\n    }\n    this.offUIContext.fillRect(x, this.position.y, this.source.width < this.width ? this.source.width : this.width, this.height);\n  }\n\n  reflow(): void {\n    if (!this.source.width || !this.source.height) return;\n\n    if (this.source.width > this.width) {\n      this.height = this.width / this.ratio;\n    } else {\n      this.width = this.source.width;\n      this.height = this.source.height;\n    }\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    this._src = newVal;\n    this.setupImage();\n\n    this.output && this.output.setData(newVal);\n  }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void { /**/ }\n\n  serialize(): SerializedImage {\n    return {\n      source: this._src,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedImage): Image {\n    return new Image(node, data.source, {\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface ImageStyle extends UINodeStyle {\n  align?: Align\n}\nlet DefaultImageStyle = () => {\n  return {\n    align: Align.Left,\n    visible: true\n  };\n};\n\nexport interface SerializedImage extends SerializedUINode {\n  source: string\n}\n\ninterface ImageOptions {\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  style?: ImageStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultImageOptions = (): ImageOptions => {\n  return {};\n};\n","export * from './2d-slider';\nexport * from './button';\nexport * from './container';\nexport * from './dial';\nexport * from './display';\nexport * from './envelope';\nexport * from './horizontal-layout';\nexport * from './image';\nexport * from './input';\nexport * from './label';\nexport * from './radio-group';\nexport * from './select';\nexport * from './slider';\nexport * from './source';\nexport * from './stack';\nexport * from './toggle';\nexport * from './ui-node';\nexport * from './v-slider';\n","import { Vector2 } from \"../core/vector\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Node } from '../core/node';\nimport { Label } from './label';\nimport { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Align } from \"../common/enums\";\nimport { exists, get } from \"../utils/utils\";\n\nexport class Input extends UINode implements Serializable {\n  label: Label;\n  inputEl: HTMLInputElement;\n  private _value: string | number;\n\n  get value(): string | number {\n    if (this.propName) return this.getProp();\n    return this._value;\n  }\n  set value(value: string | number) {\n    let val: string | number;\n    if (this.style.type === InputType.Number && typeof value === 'string') val = parseFloat(value);\n    else val = value;\n\n    let oldVal = this.value;\n    let newVal = val;\n\n    if (this.propName) this.setProp(newVal);\n    else {\n      this._value = newVal;\n      this.setLabelText(this._value);\n      this.inputEl.value = this._value.toString();\n    }\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, newVal, oldVal);\n  }\n\n  constructor(\n    node: Node,\n    options: InputOptions = DefaultInputOptions(node)\n  ) {\n    super(\n      node, Vector2.Zero(), UIType.Input, {\n      style: options.style ? { ...DefaultInputStyle(), ...options.style } : DefaultInputStyle(),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, options.style.type, '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, options.style.type, '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.height = get(options.height, this.node.style.rowHeight);\n\n    if (this.style.type === InputType.Number && typeof options.value === 'string') options.value = parseFloat(options.value);\n    this._value = options.value;\n\n    this.setupLabel();\n    this.setupInputElement();\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this.value = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (data) this.value = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.value);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.value);\n    });\n  }\n\n  setupLabel() {\n    this.label = new Label(this.node, this.value.toString(), {\n      style: {\n        fontSize: this.style.fontSize,\n        font: this.style.font,\n        align: this.style.align,\n        color: this.style.color,\n        padding: 5,\n        precision: this.style.precision || null\n      }, height: this.height\n    });\n    this.label.on('click', () => {\n      if (document.activeElement !== this.inputEl) {\n        let realPosition = this.position.transform(this.node.flow.flowConnect.transform);\n        Object.assign(this.inputEl.style, {\n          'visibility': 'visible',\n          'pointer-events': 'all',\n          'top': (realPosition.y + this.node.flow.flowConnect.canvasDimensions.top + 1) + 'px',\n          'left': (realPosition.x + this.node.flow.flowConnect.canvasDimensions.left + 1) + 'px',\n          'width': (this.width - 1) * this.node.flow.flowConnect.scale + 'px',\n          'height': (this.height - 1) * this.node.flow.flowConnect.scale + 'px',\n          'font-family': this.style.font,\n          'font-size': parseInt(this.style.fontSize.replace('px', '')) * this.node.flow.flowConnect.scale + 'px',\n          'color': this.style.color,\n          'background-color': this.inputEl.validity.patternMismatch ? 'red' : this.style.backgroundColor,\n          'text-align': this.style.align\n        });\n        if (this.style.type === InputType.Number) this.inputEl.step = this.style.step;\n        this.inputEl.focus();\n      }\n    });\n    this.children.push(this.label);\n  }\n  setupInputElement() {\n    this.inputEl = document.createElement('input');\n    this.inputEl.className = 'flow-connect-input';\n    this.inputEl.spellcheck = false;\n    let inputType = this.style.type === 'string' ? 'text' : this.style.type\n    this.inputEl.type = this.style.pattern ? 'text' : inputType;\n    this.inputEl.value = this.value.toString();\n    if (this.style.pattern) this.inputEl.pattern = this.style.pattern;\n    if (this.style.type === InputType.Number && this.style.step) this.inputEl.step = this.style.step;\n    if (this.style.maxLength) this.inputEl.maxLength = this.style.maxLength;\n\n    this.inputEl.addEventListener('blur', () => {\n      this.inputEl.style.visibility = 'hidden';\n      this.inputEl.style.pointerEvents = 'none';\n      this.value = this.inputEl.value;\n\n      this.setLabelText(this.style.type === InputType.Number ? parseFloat(this.value) : this.value.toString());\n\n      this.call('blur', this);\n    });\n    this.inputEl.oninput = () => {\n      if (this.style.pattern) {\n        this.inputEl.style.backgroundColor = this.inputEl.validity.patternMismatch ? 'orange' : this.style.backgroundColor;\n        this.label.style.color = this.inputEl.validity.patternMismatch ? 'orange' : this.style.color;\n      }\n      this.call('input', this);\n    }\n    document.body.appendChild(this.inputEl);\n  }\n  setLabelText(value: any) {\n    this.label.text = typeof value === 'number' && exists(this.style.precision) ? value.toFixed(this.style.precision) : value;\n  }\n\n  paint(): void {\n    this.context.strokeStyle = this.style.border;\n    this.context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = this.style.border;\n    context.fillStyle = this.style.backgroundColor;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    this.label.position = this.position;\n    this.label.height = this.height;\n    this.label.width = this.width;\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    if (this.style.type === InputType.Number && typeof newVal === 'string') newVal = parseFloat(newVal);\n\n    this._value = newVal;\n    this.setLabelText(this._value);\n    this.inputEl.value = this._value.toString();\n\n    this.output && this.output.setData(this._value);\n  }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedInput {\n    return {\n      value: this.value,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedInput): Input {\n    return new Input(node, {\n      value: data.value,\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport enum InputType {\n  Text = 'string',\n  Number = 'number'\n}\n\nexport interface InputStyle extends UINodeStyle {\n  backgroundColor?: string,\n  color?: string,\n  fontSize?: string,\n  font?: string,\n  border?: string,\n  type?: InputType,\n  align?: Align,\n  precision?: number,\n  pattern?: string,\n  step?: string,\n  maxLength?: number,\n}\nlet DefaultInputStyle = (): InputStyle => {\n  return {\n    backgroundColor: '#eee',\n    color: '#000',\n    fontSize: '11px',\n    font: 'arial',\n    border: '1px solid black',\n    align: Align.Left,\n    type: InputType.Text\n  };\n};\n\nexport interface SerializedInput extends SerializedUINode {\n  value: string | number,\n  height: number\n}\n\ninterface InputOptions {\n  value?: string | number,\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: InputStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultInputOptions = (node: Node): InputOptions => {\n  return {\n    height: node.style.rowHeight * 1.5\n  };\n}\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { Vector2 } from \"../core/vector\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { binarySearch, exists, get } from \"../utils/utils\";\nimport { FlowState } from \"../core/flow\";\nimport { Align } from \"../common/enums\";\n\nexport class Label extends UINode implements Serializable {\n  private displayText: string;\n  private _text: string | number;\n  private textWidth: number;    // This may be smaller due to surrounding width constraints (this is som...)\n  private orgTextWidth: number; // While this is the actual width                           (this is some text)\n  private textHeight: number;\n\n  get text(): string {\n    let value;\n    if (this.propName) value = this.getProp();\n    else value = this._text;\n\n    if (typeof value === 'number') value = this.format(value);\n    return value;\n  }\n  set text(text: string | number) {\n    let oldVal = this._text;\n    let newVal = text;\n\n    if (this.propName) {\n      this.setProp(newVal);\n    } else {\n      this._text = newVal;\n      this.reflow();\n    }\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node,\n    text: string | number,\n    options: LabelOptions = DefaultLabelOptions(node)\n  ) {\n    super(node, Vector2.Zero(), UIType.Label, {\n      style: options.style ? { ...DefaultLabelStyle(), ...options.style } : DefaultLabelStyle(),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'any', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'string', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this._text = this.propName ? this.getProp() : text;\n    this.reflow();\n\n    this.height = get(options.height, this.textHeight + 5);\n    if (!this.style.grow) this.width = this.orgTextWidth;\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (exists(connector.data)) this.text = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (exists(data)) this.text = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.text);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.text);\n    });\n  }\n\n  paint(): void {\n    let context = this.context;\n\n    context.fillStyle = this.style.backgroundColor;\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n\n    context.fillStyle = this.style.color;\n    context.font = this.style.fontSize + ' ' + this.style.font;\n    context.textBaseline = 'middle';\n    let y = this.position.y + this.height / 2;\n    let x = this.position.x;\n    if (this.style.align === Align.Center) {\n      x += this.width / 2 - this.textWidth / 2;\n    } else if (this.style.align === Align.Right) {\n      x += this.width - this.textWidth - this.style.padding;\n    } else {\n      x += this.style.padding\n    }\n\n    context.fillText(this.displayText, x, y);\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = '#000';\n    context.fillStyle = this.style.color;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    let context = this.context;\n    context.font = this.style.fontSize + ' ' + this.style.font;\n    this.orgTextWidth = context.measureText(this.text).width;\n    this.displayText = this.getBestFitString();\n    let metrics = context.measureText(this.displayText);\n    context.font = null;\n    this.textWidth = metrics.width;\n\n    this.textHeight = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent + 5;\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n  getBestFitString(): string {\n    let text = this.text;\n    if (typeof (text as any) !== 'string') text = text.toString();\n\n    let width = this.context.measureText(text).width;\n    const ellipsis = '';\n    const ellipsisWidth = this.context.measureText(ellipsis).width;\n    if (width <= this.width || width <= ellipsisWidth) return text;\n\n    const index = binarySearch({\n      max: text.length,\n      getValue: (idx: number) => this.context.measureText(text.substring(0, idx)).width,\n      match: this.width - ellipsisWidth,\n    });\n\n    return text.substring(0, index) + ellipsis;\n  }\n  format(value: number): string {\n    return exists(this.style.precision) ? value.toFixed(this.style.precision) : value.toString();\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    this._text = newVal;\n    this.reflow();\n\n    this.output && this.output.setData(this._text);\n  }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedLabel {\n    return {\n      text: this.text,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedLabel): Label {\n    return new Label(node, data.text, {\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface LabelStyle extends UINodeStyle {\n  color?: string,\n  backgroundColor?: string,\n  fontSize?: string,\n  font?: string,\n  align?: Align,\n  precision?: number,\n  padding?: number\n}\nlet DefaultLabelStyle = () => {\n  return {\n    color: '#000',\n    backgroundColor: 'transparent',\n    fontSize: '11px',\n    font: 'arial',\n    align: Align.Left,\n    padding: 0,\n    visible: true\n  };\n};\n\nexport interface SerializedLabel extends SerializedUINode {\n  text: string,\n  height: number\n}\n\ninterface LabelOptions {\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: LabelStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultLabelOptions = (node: Node): LabelOptions => {\n  return {\n    height: node.style.rowHeight * 1.5\n  }\n};\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { Vector2 } from \"../core/vector\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Label } from \"./label\";\nimport { Align } from \"../common/enums\";\nimport { get } from \"../utils/utils\";\n\nexport class RadioGroup extends UINode implements Serializable {\n  private _values: string[];\n  private _selected: string;\n\n  get selected(): string {\n    if (this.propName) return this.getProp();\n    return this._selected;\n  }\n  set selected(selected: string) {\n    if (!this._values.includes(selected)) selected = this._values[0];\n\n    let oldVal = this.selected;\n    let newVal = selected;\n\n    if (this.propName) this.setProp(newVal);\n    else this._selected = newVal;\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node,\n    values: string[] = ['default'],\n    selected: string = 'default',\n    options: RadioGroupOptions = DefaultRadioGroupOptions(node)\n  ) {\n    super(node, Vector2.Zero(), UIType.RadioGroup, {\n      style: options.style ? { ...DefaultRadioGroupStyle(), ...options.style } : DefaultRadioGroupStyle(),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'boolean', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'boolean', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    if (values.length === 0) values = ['default'];\n    this._values = values;\n    let selectedValue = this.propName ? this.getProp() : selected;\n    this._selected = this._values.includes(selectedValue) ? selectedValue : this._values[0];\n    this.height = get(options.height, this.node.style.rowHeight);\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this._selected = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (typeof data !== 'undefined') this._selected = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this._selected);\n\n    this.setupLabels();\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this._selected);\n    });\n  }\n\n  setupLabels() {\n    this.children.push(...this._values.map(option => {\n      let label = new Label(this.node, option, {\n        style: { align: Align.Center, backgroundColor: this.style.backgroundColor, color: this.style.color }\n      });\n\n      label.on('click', (selectedLabel: Label) => {\n        if (selectedLabel.text === this.selected) return;\n        let lastSelectedLabel = this.children[this._values.indexOf(this.selected)];\n        Object.assign(lastSelectedLabel.style, {\n          backgroundColor: this.style.backgroundColor,\n          color: this.style.color\n        });\n        Object.assign(selectedLabel.style, {\n          backgroundColor: this.style.selectedBackgroundColor,\n          color: this.style.selectedColor\n        });\n        this.selected = selectedLabel.text;\n      });\n\n      return label;\n    }));\n    Object.assign(this.children[this._values.indexOf(this._selected)].style, {\n      backgroundColor: this.style.selectedBackgroundColor,\n      color: this.style.selectedColor\n    });\n  }\n\n  paint(): void {\n    let context = this.context;\n    context.strokeStyle = this.style.borderColor;\n    context.lineWidth = this.style.borderWidth\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n\n    let commonWidth = this.width / this.children.length;\n    let x = this.position.x + commonWidth;\n    for (let i = 0; i < this.children.length - 1; i += 1) {\n      context.beginPath();\n      context.moveTo(x, this.position.y);\n      context.lineTo(x, this.position.y + this.height);\n      context.stroke();\n      x += commonWidth;\n    }\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = this.style.borderColor;\n    context.fillStyle = this.style.backgroundColor;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    let x = this.position.x;\n    this.children.forEach(child => {\n      child.height = this.height;\n      child.width = this.width / this.children.length;\n      child.position.assign(x, this.position.y);\n      x += child.width;\n    });\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    if (!this._values.includes(newVal)) newVal = this._values[0];\n    this._selected = newVal;\n\n    this.output && this.output.setData(this._selected);\n  }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedRadioGroup {\n    return {\n      values: this._values,\n      selected: this.selected,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedRadioGroup): RadioGroup {\n    return new RadioGroup(node, data.values, data.selected, {\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface RadioGroupStyle extends UINodeStyle {\n  color?: string,\n  selectedColor?: string,\n  backgroundColor?: string,\n  selectedBackgroundColor?: string,\n  borderColor?: string,\n  borderWidth?: number,\n}\nlet DefaultRadioGroupStyle = () => {\n  return {\n    color: '#000',\n    selectedColor: '#fff',\n    backgroundColor: 'transparent',\n    selectedBackgroundColor: '#555',\n    borderColor: '#000',\n    borderWidth: 1,\n    visible: true\n  };\n};\n\nexport interface SerializedRadioGroup extends SerializedUINode {\n  values: string[],\n  selected: string,\n  height: number\n}\n\ninterface RadioGroupOptions {\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: RadioGroupStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultRadioGroupOptions = (node: Node): RadioGroupOptions => {\n  return {\n    height: node.style.rowHeight * 1.5\n  }\n};\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { Vector2 } from \"../core/vector\";\nimport { Label } from \"./label\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Constant } from \"../resource/constants\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Align } from \"../common/enums\";\nimport { exists, get } from \"../utils/utils\";\n\nexport class Select extends UINode implements Serializable {\n  label: Label;\n  private _selected: string;\n\n  get selected(): string {\n    if (this.propName) {\n      let value = this.getProp();\n      let slctdVal = this.values.includes(value) ? value : this.values[0];\n      value = this.values.length === 0 ? 'None' : slctdVal;\n      return value;\n    }\n    return this._selected;\n  }\n  set selected(selected: string) {\n    let slctdVal = this.values.includes(selected) ? selected : this.values[0];\n\n    let oldVal = this.selected;\n    let newVal = this.values.length === 0 ? 'None' : slctdVal;\n\n    if (this.propName) this.setProp(newVal);\n    else {\n      this._selected = newVal;\n      this.label.text = newVal;\n    }\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node,\n    public values: string[] = [],\n    options: SelectOptions = DefaultSelectOptions(node)\n  ) {\n    super(node, Vector2.Zero(), UIType.Select, {\n      style: options.style ? { ...DefaultSelectStyle(), ...options.style } : DefaultSelectStyle(),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'any', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'string', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.height = get(options.height, this.node.style.rowHeight);\n    this._selected = this.values.length === 0 ? 'None' : this.values[0];\n\n    this.label = new Label(this.node, this.selected, { style: { align: Align.Center, ...this.style }, height: this.height });\n    this.children.push(this.label);\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (typeof connector.data === 'number') this.selected = this.values[connector.data];\n        else if (typeof connector.data === 'string') this.selected = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (typeof data === 'number') this.selected = this.values[data];\n        else if (typeof data === 'string') this.selected = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.selected);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.selected);\n    });\n  }\n\n  paint(): void {\n    let context = this.context;\n    context.fillStyle = this.style.arrowColor;\n    context.beginPath();\n    context.moveTo(this.position.x, this.position.y + this.height / 2);\n    context.lineTo(this.position.x + this.height * Constant.SIN_60, this.position.y);\n    context.lineTo(this.position.x + this.height * Constant.SIN_60, this.position.y + this.height);\n    context.lineTo(this.position.x, this.position.y + this.height / 2);\n    context.closePath();\n    context.fill();\n\n    context.fillStyle = this.style.arrowColor;\n    context.beginPath();\n    context.moveTo(this.position.x + this.width, this.position.y + this.height / 2);\n    context.lineTo(this.position.x + this.width - (this.height * Constant.SIN_60), this.position.y);\n    context.lineTo(this.position.x + this.width - (this.height * Constant.SIN_60), this.position.y + this.height);\n    context.lineTo(this.position.x + this.width, this.position.y + this.height / 2);\n    context.closePath();\n    context.fill();\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.fillStyle = this.style.arrowColor;\n    context.strokeStyle = '#000';\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    this.label.width = this.width * .7;\n    this.label.position.assign(\n      this.position.x + this.width * .15,\n      this.position.y + this.height / 2 - this.label.height / 2\n    );\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange(_oldVal: any, newValue: any) {\n    let slctdVal = this.values.includes(newValue) ? newValue : this.values[0];\n    let value = this.values.length === 0 ? 'None' : slctdVal;\n    this._selected = value;\n    this.label.text = this._selected;\n\n    this.output && this.output.setData(this.selected);\n  }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    if (this.values.length === 0) return;\n    let direction;\n    if (realPosition.x < this.position.x + this.width * .15) {\n      direction = -1;\n    } else if (realPosition.x > this.position.x + this.width * .85) {\n      direction = 1;\n    } else return;\n\n    let length = this.values.length;\n    this.selected = this.values[(((this.values.indexOf(this.selected) + direction) % length) + length) % length];\n    this.label.text = this.selected;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedSelect {\n    return {\n      values: this.values,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedSelect): Select {\n    return new Select(node, data.values, {\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface SelectStyle extends UINodeStyle {\n  font?: string,\n  fontSize?: string,\n  color?: string,\n  arrowColor?: string\n}\nlet DefaultSelectStyle = () => {\n  return {\n    arrowColor: '#000',\n    visible: true\n  };\n};\n\nexport interface SerializedSelect extends SerializedUINode {\n  values: string[],\n  height: number\n}\n\ninterface SelectOptions {\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: SelectStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultSelectOptions = (node: Node): SelectOptions => {\n  return {\n    height: node.style.rowHeight * 1.5\n  }\n}\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { Vector2 } from \"../core/vector\";\nimport { clamp, denormalize, exists, get, normalize } from \"../utils/utils\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Constant } from \"../resource/constants\";\n\nexport class Slider extends UINode implements Serializable {\n  private thumbFill: number;\n  private _value: number;\n\n  get value(): number {\n    if (this.propName) return this.getProp();\n    return this._value;\n  }\n  set value(value: number) {\n    value = clamp(value, this.min, this.max);\n\n    let oldVal = this.value;\n    let newVal = value;\n    newVal = exists(this.style.precision) ? parseFloat(newVal.toFixed(this.style.precision)) : newVal;\n\n    if (this.propName) this.setProp(newVal);\n    else {\n      this._value = newVal;\n      this.reflow();\n    }\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node, public min: number, public max: number,\n    options: SliderOptions = DefaultSliderOptions(node)\n  ) {\n    super(node, Vector2.Zero(), UIType.Slider, {\n      draggable: true,\n      style: options.style ? { ...DefaultSliderStyle(node, options.height), ...options.style } : DefaultSliderStyle(node, options.height),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'number', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'number', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.height = get(options.height, this.node.style.rowHeight);\n    this._value = this.propName ? this.getProp() : get(options.value, min);\n    this._value = clamp(this._value, this.min, this.max);\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this.value = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (data) this.value = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.value);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.value);\n    });\n  }\n\n  paint(): void {\n    let context = this.context;\n    context.lineWidth = this.style.railHeight;\n    context.strokeStyle = this.style.color;\n    context.lineCap = 'butt';\n\n    let start = Math.max(this.position.x, this.position.x + this.thumbFill - 3);\n    if (start !== this.position.x) {\n      context.beginPath();\n      context.moveTo(this.position.x, this.position.y + this.height / 2);\n      context.lineTo(start, this.position.y + this.height / 2);\n      context.stroke();\n    }\n    start = Math.min(this.position.x + 2 * this.style.thumbRadius + this.thumbFill + 3, this.position.x + this.width);\n    if (start !== (this.position.x + this.width)) {\n      context.beginPath();\n      context.moveTo(start, this.position.y + this.height / 2);\n      context.lineTo(this.position.x + this.width, this.position.y + this.height / 2);\n      context.stroke();\n    }\n\n    context.fillStyle = this.style.thumbColor;\n    context.beginPath();\n    context.arc(\n      this.position.x + this.style.thumbRadius + this.thumbFill,\n      this.position.y + this.height / 2, this.style.thumbRadius, 0, Constant.TAU\n    );\n    context.fill();\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = '#000';\n    context.fillStyle = this.style.color;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    this.thumbFill = denormalize(normalize(this.value, this.min, this.max), 0, this.width - 2 * this.style.thumbRadius);\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    this._value = newVal;\n    this.reflow();\n\n    this.output && this.output.setData(this.value);\n  }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    let y = this.position.y + this.height / 2 - this.style.railHeight / 2;\n    this.thumbFill = realPosition\n      .clamp(this.position.x + this.style.thumbRadius, this.position.x + this.width - this.style.thumbRadius, y, y)\n      .subtractInPlace(this.position.x + this.style.thumbRadius, 0)\n      .x;\n\n    this.value = denormalize(normalize(this.thumbFill, 0, this.width - 2 * this.style.thumbRadius), this.min, this.max);\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedSlider {\n    return {\n      min: this.min,\n      max: this.max,\n      value: this.value,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedSlider) {\n    return new Slider(node, data.min, data.max, {\n      value: data.value,\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface SliderStyle extends UINodeStyle {\n  railHeight?: number,\n  thumbRadius?: number,\n  color?: string,\n  thumbColor?: string,\n  precision?: number\n}\nlet DefaultSliderStyle = (node: Node, height: number) => {\n  return {\n    color: '#444',\n    thumbColor: '#000',\n    railHeight: 3,\n    thumbRadius: typeof height !== 'undefined' ? height / 2 : (node.style.rowHeight * 1.5) / 2\n  }\n}\n\nexport interface SerializedSlider extends SerializedUINode {\n  min: number,\n  max: number,\n  value: number,\n  height: number\n}\n\ninterface SliderOptions {\n  value?: number,\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: SliderStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultSliderOptions = (node: Node): SliderOptions => {\n  return {\n    height: node.style.rowHeight * 1.5\n  }\n};\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { Vector2 } from \"../core/vector\";\nimport { fileIcon } from \"../resource/icons\";\nimport { Image } from \"./image\";\nimport { Label } from \"./label\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Align } from \"../common/enums\";\nimport { get } from \"../utils/utils\";\n\nexport class Source extends UINode implements Serializable {\n  private htmlInput: HTMLInputElement;\n  private fileIcon: Image;\n  private _file: File;\n\n  label: Label;\n  accept: string;\n\n  get file(): File {\n    if (this.propName) return this.getProp();\n    return this._file;\n  }\n  set file(file: File) {\n    let oldVal = this.file;\n    let newVal = file;\n\n    if (this.propName) this.setProp(newVal);\n    else {\n      this._file = newVal;\n      this.label.text = newVal.name.substring(0, this._file.name.toString().lastIndexOf('.'));\n    }\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node,\n    options: SourceOptions = DefaultSourceOptions(node)\n  ) {\n\n    super(node, Vector2.Zero(), UIType.Source, {\n      style: options.style ? { ...DefaultSourceStyle(), ...options.style } : DefaultSourceStyle(),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'file', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'file', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.accept = options.accept;\n    this.height = get(options.height, this.node.style.rowHeight);\n\n    this.setupInputElement(options);\n\n    this.label = new Label(this.node, 'Select', { style: { align: Align.Center, ...this.style }, height: this.height });\n    this.fileIcon = new Image(this.node, fileIcon);\n    this.label.on('click', () => this.htmlInput.click());\n    this.children.push(this.label, this.fileIcon);\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this.file = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (data) this.file = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.file);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.file);\n    });\n  }\n\n  setupInputElement(options: SourceOptions) {\n    this.htmlInput = document.createElement('input');\n    this.htmlInput.type = 'file';\n    if (options.accept) this.htmlInput.accept = options.accept;\n    this.htmlInput.onchange = () => {\n      if (this.htmlInput.files.length > 0) {\n        let oldVal = this.file;\n        this.file = this.htmlInput.files[0];\n        if (this.node.flow.state === FlowState.Stopped) this.call('upload', this, oldVal, this.file);\n      }\n    };\n  }\n\n  paint(): void {\n    this.context.strokeStyle = this.style.borderColor;\n    this.context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = this.style.borderColor;\n    context.fillStyle = this.style.color;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    this.label.width = this.width;\n    this.label.height = this.height;\n    this.label.position = this.position;\n\n    this.fileIcon.width = this.width * .1;\n    this.fileIcon.position.assign(this.position.x + 5, this.position.y + this.height / 2 - this.fileIcon.height / 2);\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    this._file = newVal;\n    this.label.text = this._file.name.substring(0, this._file.name.toString().lastIndexOf('.'));\n\n    this.output && this.output.setData(this._file);\n  }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedSource {\n    return {\n      accept: this.accept,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedSource) {\n    return new Source(node, {\n      accept: data.accept,\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface SourceStyle extends UINodeStyle {\n  borderColor?: string,\n  font?: string,\n  fontSize?: string,\n  color?: string\n}\nlet DefaultSourceStyle = () => {\n  return {\n    borderColor: '#000',\n    visible: true\n  };\n};\n\nexport interface SerializedSource extends SerializedUINode {\n  accept: string,\n  height: number\n}\n\ninterface SourceOptions {\n  accept?: string,\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: SourceStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultSourceOptions = (node: Node): SourceOptions => {\n  return {\n    height: node.style.rowHeight * 1.5\n  }\n};\n","import { Color } from \"../core/color\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Node } from \"../core/node\";\nimport { Vector2 } from \"../core/vector\";\nimport { Button, Container, Display, Image, Input, Label, Select, Slider, Source, Toggle } from \"./index\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\n\nexport class Stack extends UINode implements Serializable {\n\n  constructor(\n    node: Node,\n    options: StackOptions = DefaultStackOptions()\n  ) {\n    super(node, Vector2.Zero(), UIType.Stack, {\n      style: options.style ? { ...DefaultStackStyle(), ...options.style } : DefaultStackStyle(),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    if (options.childs) this.children.push(...options.childs);\n  }\n\n\n  paint(): void { /**/ }\n  paintLOD1() { /**/ }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    let children = this.children.filter(child => child.visible);\n    let actualTotalHeight = children.reduce((acc, curr) => (acc + curr.height), 0);\n    let effectiveSpacing = (children.length - 1) * this.style.spacing;\n    this.height = actualTotalHeight + effectiveSpacing;\n\n    let y = this.position.y;\n    children.forEach(child => {\n      child.position.assign(this.position.x, y);\n      child.width = this.width;\n      y += child.height + this.style.spacing;\n    });\n  }\n\n  onPropChange() { /**/ }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void { /**/ }\n\n  serialize(): SerializedStackLayout {\n    return {\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      propName: null,\n      input: null,\n      output: null,\n      childs: this.children.map(child => (child as any).serialize())\n    }\n  }\n  static deSerialize(node: Node, data: SerializedStackLayout): Stack {\n    let stack = new Stack(node, { style: data.style, id: data.id, hitColor: Color.deSerialize(data.hitColor), childs: [] });\n\n    stack.children.push(...data.childs.map(serializedChild => {\n      switch (serializedChild.type) {\n        case UIType.Button: return Button.deSerialize(node, serializedChild);\n        case UIType.Container: return Container.deSerialize(node, serializedChild);\n        case UIType.Display: return Display.deSerialize(node, serializedChild);\n        case UIType.HorizontalLayout: return Stack.deSerialize(node, serializedChild);\n        case UIType.Stack: return Stack.deSerialize(node, serializedChild);\n        case UIType.Image: return Image.deSerialize(node, serializedChild);\n        case UIType.Input: return Input.deSerialize(node, serializedChild);\n        case UIType.Label: return Label.deSerialize(node, serializedChild);\n        case UIType.Select: return Select.deSerialize(node, serializedChild);\n        case UIType.Slider: return Slider.deSerialize(node, serializedChild);\n        case UIType.Source: return Source.deSerialize(node, serializedChild);\n        case UIType.Toggle: return Toggle.deSerialize(node, serializedChild);\n        default: return;\n      }\n    }));\n    return stack;\n  }\n}\n\nexport interface StackStyle extends UINodeStyle {\n  spacing?: number\n}\nlet DefaultStackStyle = () => {\n  return {\n    spacing: 0,\n    visible: true\n  };\n};\n\nexport interface SerializedStackLayout extends SerializedUINode { }\n\ninterface StackOptions {\n  childs?: UINode[],\n  style?: StackStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultStackOptions = () => {\n  return {}\n};\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { Vector2 } from \"../core/vector\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { get } from \"../utils/utils\";\nimport { Constant } from \"../resource/constants\";\n\nexport class Toggle extends UINode implements Serializable {\n  private _checked: boolean = false;\n\n  get checked(): boolean {\n    if (this.propName) return this.getProp();\n    return this._checked;\n  }\n  set checked(checked: boolean) {\n    let oldVal = this.checked;\n    let newVal = checked;\n\n    if (this.propName)\n      this.setProp(newVal);\n    else\n      this._checked = newVal;\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node,\n    options: ToggleOptions = DefaultToggleOptions(node)\n  ) {\n    super(node, Vector2.Zero(), UIType.Toggle, {\n      style: options.style\n        ? { ...DefaultToggleStyle(), ...options.style }\n        : DefaultToggleStyle(),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'boolean', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'boolean', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this._checked = this.propName ? this.getProp() : options.value\n    this.height = get(options.height, this.node.style.rowHeight);\n    if (!this.style.grow) this.width = this.height * 2.5;\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this.checked = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (typeof data !== 'undefined') this.checked = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.checked);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.checked);\n    });\n  }\n\n  paint(): void {\n    let context = this.context;\n    context.strokeStyle = this.style.backgroundColor;\n    context.lineWidth = this.height * .75;\n    context.lineCap = 'round';\n    context.beginPath();\n    context.moveTo(this.position.x + this.context.lineWidth / 2, this.position.y + this.height / 2);\n    context.lineTo(this.position.x + this.width - this.context.lineWidth / 2, this.position.y + this.height / 2);\n    context.stroke();\n\n    context.fillStyle = this.style.color;\n    context.beginPath();\n    context.arc(\n      this.checked ? this.position.x + this.width - this.height / 2 : this.position.x + this.height / 2,\n      this.position.y + this.height / 2, this.height / 2, 0, Constant.TAU\n    );\n    context.fill();\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = this.style.color;\n    context.fillStyle = this.style.backgroundColor;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    this._checked = newVal;\n\n    this.output && this.output.setData(this.checked);\n  }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.checked = !this.checked;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedToggle {\n    return {\n      checked: this.checked,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedToggle): Toggle {\n    return new Toggle(node, {\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface ToggleOptions {\n  value?: boolean,\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  style?: ToggleStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultToggleOptions = (node: Node): ToggleOptions => {\n  return {\n    value: false,\n    height: node.style.rowHeight * 1.5,\n  }\n};\n\nexport interface ToggleStyle extends UINodeStyle {\n  backgroundColor?: string,\n  color?: string\n}\nlet DefaultToggleStyle = () => {\n  return {\n    backgroundColor: '#999',\n    color: '#000',\n    visible: true\n  };\n};\n\nexport interface SerializedToggle extends SerializedUINode {\n  checked: boolean,\n  height: number\n}\n","import { Color, SerializedColor } from \"../core/color\";\nimport { Hooks } from \"../core/hooks\";\nimport { Node, NodeState } from \"../core/node\";\nimport { SerializedTerminal, Terminal } from \"../core/terminal\";\nimport { SerializedVector2, Vector2 } from \"../core/vector\";\nimport { LOD, ViewPort } from '../common/enums';\nimport { get, getNewUUID, intersects } from \"../utils/utils\";\nimport { Events, Renderable } from \"../common/interfaces\";\n\nexport abstract class UINode extends Hooks implements Events, Renderable {\n  private _disabled: boolean;\n  private _visible: boolean;\n\n  renderState: ViewPort;\n  hitColor: Color;\n  style: any;\n  propName: string;\n  input: Terminal;\n  output: Terminal;\n  id: string;\n  draggable: boolean;\n  zoomable: boolean;\n  width: number = 0;\n  height: number = 0;\n  children: UINode[];\n  get context(): CanvasRenderingContext2D { return this.node.context }\n  get offUIContext(): OffscreenCanvasRenderingContext2D | CanvasRenderingContext2D { return this.node.offUIContext }\n  position: Vector2;\n\n  get disabled(): boolean { return this._disabled }\n  set disabled(disabled: boolean) {\n    this._disabled = disabled;\n    this.children.forEach(child => child.disabled = disabled);\n  }\n  get visible(): boolean { return this._visible }\n  set visible(value: boolean) { this._visible = value; this.node.ui.update(); }\n\n  constructor(public node: Node, position: Vector2, public type: UIType, options: UINodeOptions = DefaultUINodeOptions()) {\n    super();\n\n    this.setHitColor(options.hitColor);\n    this.id = get(options.id, getNewUUID());\n    this.draggable = get(options.draggable, false);\n    this.zoomable = get(options.zoomable, false);\n    this._visible = get(options.visible, true);\n    this.style = get(options.style, {});\n    this.children = [];\n    this.position = position;\n    this.disabled = false;\n    this.propName = options.propName;\n    if (this.propName) {\n      this.node.watch(this.propName, (oldVal, newVal) => this.onPropChange(oldVal, newVal));\n    }\n    this.input = options.input;\n    this.output = options.output;\n\n    if (this.input) {\n      this.node.inputsUI.push(this.input);\n      this.input.on('connect', () => this.disabled = true);\n      this.input.on('disconnect', () => this.disabled = false);\n    }\n    if (this.output) this.node.outputsUI.push(this.output);\n  }\n\n  append(childs: UINode | UINode[]) {\n    if (Array.isArray(childs))\n      this.children.push(...childs);\n    else\n      this.children.push(childs);\n\n    this.update();\n\n    // To fix a bug, when appending childs to UINodes in-between the tree, UI container's height won't update\n    this.node.ui.update();\n  }\n  update(): void {\n    this.reflow();\n    this.call('update', this);\n    this.children.forEach(child => child.update());\n  }\n  updateRenderState() {\n    if (this.node.renderState.nodeState === NodeState.MINIMIZED) return;\n\n    let realPos = this.position.transform(this.node.flow.flowConnect.transform);\n    this.renderState = intersects(\n      0, 0,\n      this.node.flow.flowConnect.canvasDimensions.width, this.node.flow.flowConnect.canvasDimensions.height,\n      realPos.x, realPos.y,\n      realPos.x + this.width * this.node.flow.flowConnect.scale, realPos.y + this.height * this.node.flow.flowConnect.scale\n    );\n\n    this.children.forEach(child => child.updateRenderState());\n  }\n  private setHitColor(hitColor: Color) {\n    if (!hitColor) {\n      hitColor = Color.Random();\n      while (this.node.uiNodes.get(hitColor.rgbaString) || this.node.terminals.get(hitColor.rgbaString)) hitColor = Color.Random();\n    }\n    this.hitColor = hitColor;\n    this.node.uiNodes.set(this.hitColor.rgbaString, this);\n  }\n  render() {\n    if (!this.visible) return;\n    if (this.renderState === ViewPort.OUTSIDE) return;\n\n    let context = this.context;\n    if (this.node.renderState.lod === LOD.LOD1) {\n      context.save();\n      this.paintLOD1();\n      context.restore();\n    } else if (this.node.renderState.lod === LOD.LOD2) {\n      context.save();\n      this.paint();\n      context.restore();\n\n      this.offUIContext.save();\n      this.offPaint();\n      this.offUIContext.restore();\n    } else {\n      if (this.type === UIType.Container) {\n        context.save();\n        this.paintLOD1();\n        context.restore();\n      }\n    }\n\n    if (this.node.renderState.lod > 0) {\n      if (this.input) this.input.render();\n      if (this.output) this.output.render();\n    }\n\n    this.call('render', this);\n    this.children.forEach(child => child.render());\n  }\n\n  getProp() {\n    return this.node.state[this.propName];\n  }\n  setProp(propValue: any) {\n    this.node.state[this.propName] = propValue;\n  }\n\n  query(query: string): Array<UINode> {\n    let result = [];\n    query = query.trim();\n    let queue: UINode[] = [this];\n    while (queue.length !== 0) {\n      let curr = queue.shift();\n      if (curr.type === query) result.push(curr);\n      curr.children.forEach(child => queue.push(child));\n    }\n\n    return result;\n  }\n\n  abstract reflow(): void;\n  abstract paint(): void;\n  abstract paintLOD1(): void;\n  abstract offPaint(): void;\n\n  abstract onOver(screenPosition: Vector2, realPosition: Vector2): void;\n  abstract onDown(screenPosition: Vector2, realPosition: Vector2): void;\n  abstract onUp(screenPosition: Vector2, realPosition: Vector2): void;\n  abstract onClick(screenPosition: Vector2, realPosition: Vector2): void;\n  abstract onDrag(screenPosition: Vector2, realPosition: Vector2): void;\n  abstract onEnter(screenPosition: Vector2, realPosition: Vector2): void;\n  abstract onExit(screenPosition: Vector2, realPosition: Vector2): void;\n  abstract onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2): void;\n  abstract onContextMenu(): void;\n  abstract onPropChange(oldValue: any, newValue: any): void;\n}\n\nexport interface UINodeStyle {\n  grow?: number\n}\n\nexport interface SerializedUINode {\n  id: string,\n  type: UIType\n  hitColor: SerializedColor,\n  style: any,\n  propName: string,\n  input: SerializedTerminal,\n  output: SerializedTerminal,\n  childs: any[]\n}\n\nexport enum UIType {\n  Button = 'button',\n  Container = 'container',\n  Display = 'display',\n  HorizontalLayout = 'horizontal-layout',\n  Stack = 'stack',\n  Image = 'image',\n  Input = 'input',\n  Label = 'label',\n  Select = 'select',\n  Slider = 'slider',\n  Dial = 'dial',\n  Source = 'source',\n  Toggle = 'toggle',\n  Envelope = 'envelope',\n  RadioGroup = 'radiogroup',\n  Slider2D = 'slider2d',\n  VSlider = 'vslider'\n}\n\ninterface UINodeOptions {\n  draggable?: boolean,\n  zoomable?: boolean,\n  visible?: boolean,\n  style?: any,\n  propName?: string,\n  input?: Terminal,\n  output?: Terminal,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultUINodeOptions = (): UINodeOptions => {\n  return {\n    draggable: false,\n    zoomable: false,\n    visible: true,\n    style: {},\n    propName: null,\n    input: null,\n    output: null,\n    id: getNewUUID(),\n    hitColor: null\n  };\n};\n\nexport interface UINodeRenderParams {\n  position: SerializedVector2,\n  width: number,\n  height: number\n}\n","import { Terminal, TerminalType, SerializedTerminal } from \"../core/terminal\";\nimport { Node } from \"../core/node\";\nimport { Vector2 } from \"../core/vector\";\nimport { clamp, denormalize, get, normalize } from \"../utils/utils\";\nimport { SerializedUINode, UINode, UINodeStyle, UIType } from \"./ui-node\";\nimport { Serializable } from \"../common/interfaces\";\nimport { Color } from \"../core/color\";\nimport { FlowState } from \"../core/flow\";\nimport { Constant } from \"../resource/constants\";\n\nexport class VSlider extends UINode implements Serializable {\n  private thumbFill: number;\n  private _value: number;\n\n  get value(): number {\n    if (this.propName) return this.getProp();\n    return this._value;\n  }\n  set value(value: number) {\n    value = clamp(value, this.min, this.max);\n\n    let oldVal = this.value;\n    let newVal = value;\n\n    if (this.propName) this.setProp(newVal);\n    else {\n      this._value = newVal;\n      this.reflow();\n    }\n\n    if (this.node.flow.state !== FlowState.Stopped) this.call('change', this, oldVal, newVal);\n  }\n\n  constructor(\n    node: Node, public min: number, public max: number,\n    options: VSliderOptions = DefaultVSliderOptions(node)\n  ) {\n    super(node, Vector2.Zero(), UIType.VSlider, {\n      draggable: true,\n      style: options.style ? { ...DefaultVSliderStyle(node, options.width), ...options.style } : DefaultVSliderStyle(node, options.width),\n      propName: options.propName,\n      input: options.input && (typeof options.input === 'boolean'\n        ? new Terminal(node, TerminalType.IN, 'number', '', {})\n        : Terminal.deSerialize(node, options.input)),\n      output: options.output && (typeof options.output === 'boolean'\n        ? new Terminal(node, TerminalType.OUT, 'number', '', {})\n        : Terminal.deSerialize(node, options.output)),\n      id: options.id,\n      hitColor: options.hitColor\n    });\n\n    this.height = get(options.height, this.node.style.rowHeight * 5);\n    this.width = get(options.width, this.node.style.rowHeight);\n    this._value = this.propName ? this.getProp() : get(options.value, min);\n    this._value = clamp(this._value, this.min, this.max);\n\n    if (this.input) {\n      this.input.on('connect', (_, connector) => {\n        if (connector.data) this.value = connector.data;\n      });\n      this.input.on('data', (_, data) => {\n        if (data) this.value = data;\n      });\n    }\n    if (this.output) this.output.on('connect', (_, connector) => connector.data = this.value);\n\n    this.node.on('process', () => {\n      if (this.output) this.output.setData(this.value);\n    });\n  }\n\n  paint(): void {\n    let context = this.context;\n    context.lineWidth = this.style.railWidth;\n    context.strokeStyle = this.style.color;\n    context.lineCap = 'butt';\n\n    let start = Math.max(this.position.y, this.position.y + this.thumbFill - 3);\n    if (start !== this.position.y) {\n      context.beginPath();\n      context.moveTo(this.position.x + this.width / 2, this.position.y);\n      context.lineTo(this.position.x + this.width / 2, start);\n      context.stroke();\n    }\n    start = Math.min(this.position.y + 2 * this.style.thumbRadius + this.thumbFill + 3, this.position.y + this.height);\n    if (start !== (this.position.y + this.height)) {\n      context.beginPath();\n      context.moveTo(this.position.x + this.width / 2, start);\n      context.lineTo(this.position.x + this.width / 2, this.position.y + this.height);\n      context.stroke();\n    }\n\n    context.fillStyle = this.style.thumbColor;\n    context.beginPath();\n    context.arc(\n      this.position.x + this.width / 2,\n      this.position.y + this.style.thumbRadius + this.thumbFill, this.style.thumbRadius, 0, Constant.TAU\n    );\n    context.fill();\n  }\n  paintLOD1() {\n    let context = this.context;\n    context.strokeStyle = '#000';\n    context.fillStyle = this.style.color;\n    context.strokeRect(this.position.x, this.position.y, this.width, this.height);\n    context.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n  offPaint(): void {\n    this.offUIContext.fillStyle = this.hitColor.hexValue;\n    this.offUIContext.fillRect(this.position.x, this.position.y, this.width, this.height);\n  }\n\n  reflow(): void {\n    this.thumbFill = denormalize(1 - normalize(this.value, this.min, this.max), 0, this.height - 2 * this.style.thumbRadius);\n\n    if (this.input) {\n      this.input.position.assign(\n        this.node.position.x - this.node.style.terminalStripMargin - this.input.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n    if (this.output) {\n      this.output.position.assign(\n        this.node.position.x + this.node.width + this.node.style.terminalStripMargin + this.output.style.radius,\n        this.position.y + this.height / 2\n      );\n    }\n  }\n\n  onPropChange(_oldVal: any, newVal: any) {\n    this._value = newVal;\n    this.reflow();\n\n    this.output && this.output.setData(this.value);\n  }\n  onOver(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('over', this, screenPosition, realPosition);\n  }\n  onDown(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('down', this, screenPosition, realPosition);\n  }\n  onUp(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('up', this, screenPosition, realPosition);\n  }\n  onClick(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    this.call('click', this, screenPosition, realPosition);\n  }\n  onDrag(screenPosition: Vector2, realPosition: Vector2): void {\n    if (this.disabled) return;\n\n    let x = this.position.x + this.width / 2 - this.style.railWidth / 2;\n    this.thumbFill = realPosition\n      .clamp(x, x, this.position.y + this.style.thumbRadius, this.position.y + this.height - this.style.thumbRadius)\n      .subtractInPlace(0, this.position.y + this.style.thumbRadius)\n      .y;\n\n    this.value = denormalize(1 - normalize(this.thumbFill, 0, this.height - 2 * this.style.thumbRadius), this.min, this.max);\n\n    this.call('drag', this, screenPosition, realPosition);\n  }\n  onEnter(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('enter', this, screenPosition, realPosition);\n  }\n  onExit(screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('exit', this, screenPosition, realPosition);\n  }\n  onWheel(direction: boolean, screenPosition: Vector2, realPosition: Vector2) {\n    if (this.disabled) return;\n\n    this.call('wheel', this, direction, screenPosition, realPosition);\n  }\n  onContextMenu(): void {\n    if (this.disabled) return;\n  }\n\n  serialize(): SerializedVSlider {\n    return {\n      min: this.min,\n      max: this.max,\n      value: this.value,\n      propName: this.propName,\n      input: this.input ? this.input.serialize() : null,\n      output: this.output ? this.output.serialize() : null,\n      height: this.height,\n      width: this.width,\n      style: this.style,\n      id: this.id,\n      hitColor: this.hitColor.serialize(),\n      type: this.type,\n      childs: []\n    }\n  }\n  static deSerialize(node: Node, data: SerializedVSlider) {\n    return new VSlider(node, data.min, data.max, {\n      value: data.value,\n      propName: data.propName,\n      input: data.input,\n      output: data.output,\n      height: data.height,\n      width: data.width,\n      style: data.style,\n      id: data.id,\n      hitColor: Color.deSerialize(data.hitColor)\n    });\n  }\n}\n\nexport interface VSliderStyle extends UINodeStyle {\n  railWidth?: number,\n  thumbRadius?: number,\n  color?: string,\n  thumbColor?: string\n}\nlet DefaultVSliderStyle = (node: Node, width: number) => {\n  return {\n    color: '#444',\n    thumbColor: '#000',\n    railWidth: 4,\n    thumbRadius: typeof width !== 'undefined' ? width / 2 : (node.style.rowHeight * 1.5) / 2\n  }\n}\n\nexport interface SerializedVSlider extends SerializedUINode {\n  min: number,\n  max: number,\n  value: number,\n  height: number,\n  width: number\n}\n\ninterface VSliderOptions {\n  value?: number,\n  propName?: string,\n  input?: boolean | SerializedTerminal,\n  output?: boolean | SerializedTerminal,\n  height?: number,\n  width?: number,\n  style?: VSliderStyle,\n  id?: string,\n  hitColor?: Color\n}\nlet DefaultVSliderOptions = (node: Node): VSliderOptions => {\n  return {\n    height: node.style.rowHeight * 5,\n    width: node.style.rowHeight\n  }\n};\n","export class AVLTree<T> {\n  root: AVLTreeNode<T>;\n  dataRefToTreeNode: Record<string, AVLTreeNode<T>>;\n  size: number;\n\n  constructor(public comparator: (a: T, b: T) => number, public dataToTreeNodeMapper: (data: T) => string) {\n    this.root = null;\n    this.dataRefToTreeNode = {};\n    this.size = 0;\n  }\n\n  height(node: AVLTreeNode<T>) {\n    if (!node) return 0;\n    return node.height;\n  }\n  rightRotate(node: AVLTreeNode<T>) {\n    let newRoot = node.left;\n    node.left = newRoot.right;\n    newRoot.right = node;\n\n    node.height = Math.max(node.left ? node.left.height : 0, node.right ? node.right.height : 0) + 1;\n    newRoot.height = Math.max(newRoot.left ? newRoot.left.height : 0, newRoot.right ? newRoot.right.height : 0) + 1;\n\n    return newRoot;\n  }\n  leftRotate(node: AVLTreeNode<T>) {\n    let newRoot = node.right;\n    node.right = newRoot.left;\n    newRoot.left = node;\n\n    node.height = Math.max(node.left ? node.left.height : 0, node.right ? node.right.height : 0) + 1;\n    newRoot.height = Math.max(newRoot.left ? newRoot.left.height : 0, newRoot.right ? newRoot.right.height : 0) + 1;\n\n    return newRoot;\n  }\n  getBalance(node: AVLTreeNode<T>) {\n    if (!node) return 0;\n    return (node.left ? node.left.height : 0) - (node.right ? node.right.height : 0);\n  }\n\n  add(data: T): AVLTreeNode<T> {\n    let res: { node: AVLTreeNode<T> } = { node: null };\n    this.root = this._insert(this.root, data, res);\n    this.dataRefToTreeNode[this.dataToTreeNodeMapper(data)] = res.node;\n    this.size += 1;\n    return res.node;\n  }\n  private _insert(node: AVLTreeNode<T>, data: T, res: { node: AVLTreeNode<T> }): AVLTreeNode<T> {\n    if (!node) {\n      let newNode = new AVLTreeNode([data]);\n      res.node = newNode;\n      return newNode;\n    }\n\n    // Duplicate Keys\n    if (this.comparator(data, node.data[0]) === 0) {\n      node.data.push(data);\n      res.node = node;\n      return node;\n    }\n\n    if (this.comparator(data, node.data[0]) < 0) node.left = this._insert(node.left, data, res);\n    else node.right = this._insert(node.right, data, res);\n\n    node.height = 1 + Math.max(node.left ? node.left.height : 0, node.right ? node.right.height : 0);\n    let balance = this.getBalance(node);\n\n    if (balance > 1 && this.comparator(data, node.left.data[0]) < 0) return this.rightRotate(node);\n    if (balance > 1 && this.comparator(data, node.left.data[0]) > 0) {\n      node.left = this.leftRotate(node.left);\n      return this.rightRotate(node);\n    }\n    if (balance < -1 && this.comparator(data, node.right.data[0]) > 0) return this.leftRotate(node);\n    if (balance < -1 && this.comparator(data, node.right.data[0]) < 0) {\n      node.right = this.rightRotate(node.right);\n      return this.leftRotate(node);\n    }\n\n    return node;\n  }\n\n  remove(data: T): boolean {\n    let res: { deleted: boolean } = { deleted: false };\n    this.root = this._delete(this.root, data, res);\n    delete this.dataRefToTreeNode[this.dataToTreeNodeMapper(data)];\n    this.size -= 1;\n    return res.deleted;\n  }\n  private _delete(node: AVLTreeNode<T>, data: T, res: { deleted: boolean }): AVLTreeNode<T> {\n    if (!node) return node;\n\n    if (this.comparator(data, node.data[0]) < 0) node.left = this._delete(node.left, data, res);\n    else if (this.comparator(data, node.data[0]) > 0) node.right = this._delete(node.right, data, res);\n    else {\n      // Duplicate Keys\n      if (node.data.length > 1) {\n        let index = node.data.findIndex(currData => this.dataToTreeNodeMapper(currData) === this.dataToTreeNodeMapper(data));\n        if (index > -1) {\n          node.data.splice(index, 1);\n          res.deleted = true;\n        } else {\n          res.deleted = false;\n        }\n        return node;\n      } else {\n        if (!node.left || !node.right) {\n          let temp = null;\n          if (!node.left) temp = node.right;\n          else temp = node.left;\n\n          if (!temp) {\n            // temp = node;\n            node = null;\n          } else node = temp;\n          res.deleted = true;\n        } else {\n          let temp = this.minValue(node.right);\n          node.data = temp.data;\n          node.right = this._delete(node.right, temp.data[0], res);\n          res.deleted = true;\n        }\n      }\n    }\n    if (!node) return node;\n\n    node.height = Math.max(node.left ? node.left.height : 0, node.right ? node.right.height : 0) + 1;\n    let balance = this.getBalance(node);\n\n    if (balance > 1 && this.getBalance(node.left) >= 0) return this.rightRotate(node);\n    if (balance > 1 && this.getBalance(node.left) < 0) {\n      node.left = this.leftRotate(node.left);\n      return this.rightRotate(node);\n    }\n    if (balance < -1 && this.getBalance(node.right) <= 0) return this.leftRotate(node);\n    if (balance < -1 && this.getBalance(node.right) > 0) {\n      node.right = this.rightRotate(node.right);\n      return this.leftRotate(node);\n    }\n    return node;\n  }\n\n  minValue(node: AVLTreeNode<T>) {\n    let curr = node;\n    while (curr.left) curr = curr.left;\n    return curr;\n  }\n  forEach(action: (item: T) => void) {\n    this._inorder(this.root, action);\n  }\n\n  private _inorder(node: AVLTreeNode<T>, action: (item: T) => void) {\n    if (node !== null) {\n      this._inorder(node.left, action);\n      node.data.forEach(data => action(data));\n      this._inorder(node.right, action);\n    }\n  }\n  private _reverseInorder(node: AVLTreeNode<T>, action: (item: T) => void) {\n    if (node !== null) {\n      this._inorder(node.right, action);\n      node.data.forEach(data => action(data));\n      this._inorder(node.left, action);\n    }\n  }\n}\n\n\nexport class AVLTreeNode<T> {\n  height: number;\n  left: AVLTreeNode<T>;\n  right: AVLTreeNode<T>;\n\n  constructor(public data: T[]) {\n    this.height = 1;\n    this.left = null;\n    this.right = null;\n  }\n}\n","// This is strictly for one-to-one mapping, many-to-one mapping will not work\nexport class BiMap<K, V> {\n  map: Map<K | V, V | K>;\n  reverseMap: Map<V | K, K | V>;\n\n  constructor() {\n    this.map = new Map();\n    this.reverseMap = new Map();\n  }\n\n  get(keyOrVal: K | V): V | K {\n    return this.map.get(keyOrVal) || this.reverseMap.get(keyOrVal);\n  }\n  set(key: K | V, value: V | K) {\n    this.map.set(key, value);\n    this.reverseMap.set(value, key);\n  }\n  has(keyOrVal: K | V): boolean {\n    return this.map.has(keyOrVal) || this.reverseMap.has(keyOrVal);\n  }\n  delete(keyOrVal: K | V) {\n    let temp1 = this.map.get(keyOrVal);\n    let temp2 = this.reverseMap.get(keyOrVal);\n    if (typeof temp1 !== 'undefined') { this.map.delete(keyOrVal); }\n    if (typeof temp2 !== 'undefined') { this.reverseMap.delete(keyOrVal); }\n\n    // I have a gut feeling that this is required, for some edge case that I cannot grab from my subconscious mind\n    this.map.delete(temp1);\n    this.reverseMap.delete(temp1);\n    this.map.delete(temp2);\n    this.reverseMap.delete(temp2);\n  }\n  clear() {\n    this.map.clear();\n    this.reverseMap.clear();\n  }\n}\n","import { Token, TokenType } from \"./lexer\";\nimport { Constant } from \"../resource/constants\";\nimport { Parser } from \"./parser\";\n\nexport class Evaluator {\n  parser: Parser;\n  static constants = {\n    tau: Constant.TAU,\n    pi: Math.PI,\n    phi: Constant.PHI,\n    ln2: Math.LN2,\n    ln10: Math.LN10,\n    log2e: Math.LOG2E,\n    log10e: Math.LOG10E,\n  };\n  static functions = {\n    cos: Math.cos,\n    acos: Math.acos,\n    acosh: Math.acosh,\n    sin: Math.sin,\n    asin: Math.asin,\n    asinh: Math.asinh,\n    tan: Math.tan,\n    atan: Math.atan,\n    atanh: Math.atanh,\n    atan2: Math.atan2,\n    abs: Math.abs,\n    ceil: Math.ceil,\n    round: Math.round,\n    floor: Math.floor,\n    exp: Math.exp,\n    random: Math.random,\n    sqrt: Math.sqrt,\n    cbrt: Math.cbrt,\n    log10: Math.log10,\n    log2: Math.log2,\n    log: (value: number, base?: number) => { return base ? (Math.log(value) / Math.log(base)) : Math.log(value); },\n    dist: (x1: number, y1: number, x2: number, y2: number) => { return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)); },\n    gcd: (a: number, b: number) => { while (b !== 0) { const r = a % b; a = b; b = r; } return a < 0 ? -a : a; },\n    max: (...args: any[]) => { return Array.isArray(args[0]) ? Math.max(...args[0]) : Math.max(...args) },\n    min: (...args: any[]) => { return Array.isArray(args[0]) ? Math.min(...args[0]) : Math.min(...args) },\n    hypot: (...args: number[]) => {\n      let result = 0;\n      let largest = 0;\n      let input = Array.isArray(args[0]) ? args[0] : args;\n      input.forEach(x => {\n        const value = Math.abs(x);\n        if (largest < value) {\n          result = result * (largest / value) * (largest / value);\n          result += 1;\n          largest = value;\n        } else {\n          result = result + (value > 0 ? ((value / largest) * (value / largest)) : value);\n        }\n      });\n      return largest * Math.sqrt(result);\n    },\n    lcm: (a: number, b: number) => {\n      if (a === 0) return a;\n      if (b === 0) return b;\n      const prod = a * b;\n      while (b !== 0) { const t = b; b = a % t; a = t; }\n      return Math.abs(prod / a);\n    },\n    sum: (...args: any[]) => {\n      let input = Array.isArray(args[0]) ? args[0] : args;\n      return input.reduce((acc, curr) => acc + curr, 0);\n    },\n    mean: (...args: any[]) => {\n      let input = Array.isArray(args[0]) ? args[0] : args;\n      return Evaluator.functions.sum(input) / input.length\n    },\n    median: (...args: any[]) => {\n      let input = Array.isArray(args[0]) ? args[0] : args;\n      input.sort((a, b) => a - b);\n      return input.length % 2 === 0 ? (input[input.length / 2 - 1] + input[input.length / 2]) / 2 : input[Math.floor(input.length / 2)];\n    },\n    std: (...args: any[]) => {\n      let input = Array.isArray(args[0]) ? args[0] : args;\n      return Math.sqrt(Evaluator.functions.var(input));\n    },\n    var: (...args: any[]) => {\n      let input = Array.isArray(args[0]) ? args[0] : args;\n      let mean = Evaluator.functions.mean(input);\n      return input.reduce((acc, curr) => acc + Math.pow(curr - mean, 2), 0) / input.length;\n    },\n    fact: (n: number) => {\n      let res = 1;\n      for (let i = n; i > 1; i -= 1) res *= i;\n      return res;\n    }\n  };\n  static multiargFunctions = ['max', 'min', 'hypot', 'sum', 'mean', 'median', 'std', 'var'];\n\n  // Optimization: If the curr expr is present in history\n  // no need to invoke lexer and parser, get postfix tokens array from here\n  history: Record<string, Token[]> = {};\n  orderedExprs: string[] = [];\n  historyLimit: number = 3;\n\n  constructor(public variables: Record<string, any>) { this.parser = new Parser(); }\n\n  evaluate(expr: string, index?: number) {\n    let postFix;\n    if (this.history[expr]) postFix = this.history[expr];\n    else {\n      if (this.orderedExprs.length === this.historyLimit) {\n        let oldestExpr = this.orderedExprs.shift();\n        delete this.history[oldestExpr];\n      }\n      this.orderedExprs.push(expr);\n      this.history[expr] = this.parser.parse(expr);\n      postFix = this.history[expr];\n    }\n    let result: number[] = [];\n\n    for (let token of postFix) {\n      switch (token.type) {\n        case TokenType.Literal: {\n          result.push(token.value as number);\n          break;\n        }\n        case TokenType.Variable: {\n          // Character is uppercase = expression contained spread operator e.g ...a => A (this is done in lexical analysis)\n          if (token.value !== (token.value as string).toLowerCase()) {\n            if (!Array.isArray(this.variables[token.value])) {\n              throw new Error('Spread operator only allowed for array variables: ' + (token.value as string).toLowerCase());\n            } else result.push(this.variables[token.value]);\n          } else {\n            if (Array.isArray(this.variables[token.value]) && typeof index !== 'undefined') {\n              result.push(this.variables[token.value][index]);\n            } else {\n              result.push(this.variables[token.value]);\n            }\n          }\n          break;\n        }\n        case TokenType.Operator: {\n          let [left, right] = [result.pop(), result.pop()];\n          if (typeof left !== 'number' || typeof right !== 'number') throw new Error('Only numbers are allowed for operators');\n\n          switch (token.value) {\n            case '+': { result.push(left + right); break; }\n            case '*': { result.push(left * right); break; }\n            case '-': { result.push(right - left); break; }\n            case '/': { result.push(right / left); break; }\n            case '%': { result.push(right % left); break; }\n            case '^': { result.push(Math.pow(right, left)); break; }\n            case '&': { result.push(right & left); break; }\n            case '|': { result.push(right | left); break; }\n            default: throw new Error('Unknow operator: ' + token.value);\n          }\n          break;\n        }\n        case TokenType.Function: {\n          let args = [];\n          for (let i = 0; i < token.count; i += 1) args.push(result.pop());\n          result.push((Evaluator.functions as any)[token.value](...args));\n          break;\n        }\n        default: throw new Error('Unknown token type: ' + token.type);\n      }\n    }\n\n    return result[0];\n  }\n}\n","export * from './avl-tree';\nexport * from './evaluator';\nexport * from './lexer';\nexport * from './linked-list';\nexport * from './logger';\nexport * from './parser';\nexport * from './utils';\nexport * from './bidirectional-map';\n","import { Evaluator } from \"./evaluator\";\n\nexport class Lexer {\n  static operators = ['+', '-', '*', '/', '^', '%', '&', '|'];\n  private result: Token[] = [];\n  private numberBuffer: string[] = [];\n  private letterBuffer: string[] = [];\n\n  constructor() { /**/ }\n\n  tokenize(expr: string) {\n    this.result = [];\n    this.numberBuffer = [];\n    this.letterBuffer = [];\n\n    // Replace all variable spread operators with their equivalent capital letter\n    let index;\n    while ((index = expr.indexOf('...')) !== -1) {\n      expr = expr.substring(0, index) + expr.charAt(index + 3).toUpperCase() + expr.substring(index + 4);\n    }\n\n    expr = this.replaceConstants(expr);\n    let chars = expr.replace(/\\s+/g, \"\").split(\"\");\n\n    chars.forEach(char => {\n      if (this.isDigit(char)) {\n        this.numberBuffer.push(char);\n      } else if (this.isDecimalPoint(char)) {\n        this.numberBuffer.push(char);\n      } else if (this.isLetter(char)) {\n        if (this.numberBuffer.length) {\n          this.processNumberBuffer();\n          this.result.push(new Token(TokenType.Operator, '*'));\n        }\n\n        this.letterBuffer.push(char);\n      } else if (this.isOperator(char)) {\n        if (this.numberBuffer.length) this.processNumberBuffer();\n        else if (this.letterBuffer.length) this.processLetterBuffer();\n\n        this.result.push(new Token(TokenType.Operator, char));\n      } else if (this.isLeftParenthesis(char)) {\n        if (this.letterBuffer.length) {\n          this.result.push(new Token(TokenType.Function, this.letterBuffer.join('')));\n          this.letterBuffer = [];\n        } else if (this.numberBuffer.length) {\n          this.processNumberBuffer();\n          this.result.push(new Token(TokenType.Operator, '*'));\n        }\n\n        this.result.push(new Token(TokenType.LParenthesis, char));\n      } else if (this.isRightParenthesis(char)) {\n        if (this.letterBuffer.length) this.processLetterBuffer();\n        if (this.numberBuffer.length) this.processNumberBuffer();\n\n        this.result.push(new Token(TokenType.RParenthesis, char));\n      } else if (this.isComma(char)) {\n        if (this.numberBuffer.length) this.processNumberBuffer();\n        if (this.letterBuffer.length) this.processLetterBuffer();\n\n        this.result.push(new Token(TokenType.ArgSeperator, char));\n      } else throw Error('Unknown character: ' + char);\n    });\n    if (this.numberBuffer.length) this.processNumberBuffer();\n    if (this.letterBuffer.length) this.processLetterBuffer();\n\n    return this.result;\n  }\n  private replaceConstants(expr: string) {\n    return expr\n      .replace(/pi/g, Evaluator.constants.pi.toString())\n      .replace(/tau/g, Evaluator.constants.tau.toString())\n      .replace(/phi/g, Evaluator.constants.phi.toString())\n      .replace(/ln2/g, Evaluator.constants.ln2.toString())\n      .replace(/ln10/g, Evaluator.constants.ln10.toString())\n      .replace(/log2e/g, Evaluator.constants.log2e.toString())\n      .replace(/log10e/g, Evaluator.constants.log10e.toString());\n  }\n  private processNumberBuffer() {\n    let literal = parseFloat(this.numberBuffer.join(''));\n    this.numberBuffer = [];\n    if (!isNaN(literal)) { this.result.push(new Token(TokenType.Literal, literal)); }\n  }\n  private processLetterBuffer() {\n    for (var i = 0; i < this.letterBuffer.length; i++) {\n      this.result.push(new Token(TokenType.Variable, this.letterBuffer[i]));\n      if (i < this.letterBuffer.length - 1) this.result.push(new Token(TokenType.Operator, '*'));\n    }\n    this.letterBuffer = [];\n  }\n  private isComma(char: string) { return (char === \",\"); }\n  private isDigit(char: string) { return /\\d/.test(char); }\n  private isLetter(char: string) { return /[a-zA-Z]/.test(char); }\n  private isOperator(char: string) { return Lexer.operators.includes(char); }\n  private isLeftParenthesis(char: string) { return char === \"(\" }\n  private isRightParenthesis(char: string) { return char == \")\" }\n  private isDecimalPoint(char: string) { return char === '.' }\n}\n\nexport enum TokenType {\n  Literal = 'Literal',\n  Variable = 'Variable',\n  Operator = 'Operator',\n  LParenthesis = 'LParenthesis',\n  RParenthesis = 'RParenthesis',\n  Function = 'Function',\n  ArgSeperator = 'ArgSeperator'\n}\n\nexport class Token {\n  static associativity = {\n    '^': 'right',\n    '*': 'left',\n    '/': 'left',\n    '+': 'left',\n    '-': 'left',\n    '%': 'left',\n    '&': 'left',\n    '|': 'left'\n  };\n  static precedence = {\n    '|': 0,\n    '&': 1,\n    '+': 2,\n    '-': 2,\n    '*': 3,\n    '/': 3,\n    '%': 3,\n    '^': 4\n  };\n\n  count: number;\n  get precedence(): number { return (Token.precedence as any)[this.value]; }\n  get associativity(): string { return (Token.associativity as any)[this.value]; }\n\n  constructor(public type: TokenType, public value: string | number) { this.count = 0; }\n\n  toString(): string { return this.type + '(' + this.value + ')'; }\n}\n","import { Hooks } from \"../core/hooks\";\n\nexport class List<T> extends Hooks {\n  head: ListNode<T> = null;\n  tail: ListNode<T> = null;\n  length: number = 0;\n\n  constructor(public comparator?: (a: T, b: T) => number, source?: Array<T>) {\n    super();\n    if (source) source.forEach(value => this.append(value));\n  }\n\n  prepend(data: T) {\n    let newNode = new ListNode(data);\n    if (this.head === null) {\n      this.head = newNode;\n      this.tail = newNode;\n    } else {\n      this.head.prev = newNode;\n      newNode.next = this.head;\n      this.head = newNode;\n    }\n\n    this.length += 1;\n    this.call('prepend', this, newNode);\n    return newNode;\n  }\n  append(data: T | ListNode<T>) {\n    let newNode = data instanceof ListNode ? data : new ListNode(data);\n    if (this.tail === null) {\n      this.head = newNode;\n      this.tail = newNode;\n    } else {\n      this.tail.next = newNode;\n      newNode.prev = this.tail;\n      this.tail = newNode;\n    }\n\n    this.length += 1;\n    this.call('append', this, newNode);\n    return newNode;\n  }\n  removeFirst(hook: boolean = true): T {\n    let removed;\n    if (this.head === null) return null;\n    else if (this.length === 1) {\n      removed = this.head.data;\n      this.head = null;\n      this.tail = null;\n    } else {\n      removed = this.head.data;\n      this.head.next.prev = null;\n      this.head = this.head.next;\n    }\n\n    this.length -= 1;\n    if (hook) this.call('removefirst', this, removed);\n    return removed;\n  }\n  removeLast(): T {\n    let removed;\n    if (this.tail === null) return null;\n    else if (this.length === 1) {\n      removed = this.tail.data;\n      this.head = null;\n      this.tail = null;\n    } else {\n      removed = this.tail.data;\n      this.tail.prev.next = null;\n      this.tail = this.tail.prev;\n    }\n\n    this.length -= 1;\n    this.call('removelast', this, removed);\n    return removed;\n  }\n  addAfter(data: T, node: ListNode<T>): ListNode<T> {\n    let newNode = new ListNode<T>(data);\n    newNode.next = node.next;\n    newNode.prev = node;\n    node.next = newNode;\n    if (newNode.next) newNode.next.prev = newNode;\n    if (node === this.tail) this.tail = newNode;\n    this.length += 1;\n\n    return newNode;\n  }\n  addBefore(data: T, node: ListNode<T>): ListNode<T> {\n    let newNode = new ListNode<T>(data);\n    newNode.prev = node.prev;\n    newNode.next = node;\n    node.prev = newNode;\n    if (newNode.prev) newNode.prev.next = newNode;\n    if (node === this.head) this.head = newNode;\n    this.length += 1;\n\n    return newNode;\n  }\n  delete(node: ListNode<T>) {\n    if (this.length === 1) {\n      this.head = null;\n      this.tail = null;\n    }\n    else if (node === this.head)\n      this.removeFirst();\n    else if (node === this.tail)\n      this.removeLast();\n    else {\n      if (node.prev) node.prev.next = node.next;\n      if (node.next) node.next.prev = node.prev;\n      this.length -= 1;\n    }\n  }\n  searchHead(callback: (node: ListNode<T>) => boolean): ListNode<T> {\n    let curr = this.head;\n    while (curr !== null) {\n      if (callback(curr)) return curr;\n      curr = curr.next;\n    }\n    return null;\n  }\n  searchTail(callback: (node: ListNode<T>) => boolean): ListNode<T> {\n    let curr = this.tail;\n    while (curr !== null) {\n      if (callback(curr)) return curr;\n      curr = curr.prev;\n    }\n    return null;\n  }\n  get(index: number): T {\n    if (index >= this.length) return null;\n    else if (index === 0) return this.head ? this.head.data : null;\n    else if (index === (this.length - 1)) return this.tail ? this.tail.data : null;\n    else {\n      let count = 0;\n      let curr = this.head;\n      while (curr !== null) {\n        if (count === index) return curr.data;\n        count += 1;\n        curr = curr.next;\n      }\n      return null;\n    }\n  }\n\n  forEach(callback: (node: ListNode<T>) => void) {\n    let curr = this.head;\n    while (curr !== null) {\n      callback(curr);\n      curr = curr.next;\n    }\n  }\n  map(callback: (node: ListNode<T>) => any): any[] {\n    let mapped: any[] = [];\n    this.forEach(node => mapped.push(callback(node)));\n    return mapped;\n  }\n  toArray(): T[] {\n    let data: T[] = [];\n    this.forEach(node => data.push(node.data));\n    return data;\n  }\n  toString(): string {\n    return this.toArray().join(', ');\n  }\n}\n\nexport class ListNode<T> {\n  prev: ListNode<T>;\n  next: ListNode<T>;\n  data: T;\n\n  constructor(data?: T) {\n    this.prev = null;\n    this.next = null;\n    this.data = data ? data : null;\n  }\n}\n","export enum LogLevel {\n  TRACE = 0, DEBUG = 1, WARN = 2, INFO = 3, LOG = 3, ERROR = 4, DISABLED = 5\n}\n\nexport class Log {\n  static LOG_LEVEL: LogLevel = LogLevel.INFO;\n\n  static trace(...args: any): void {\n    if (this.LOG_LEVEL > LogLevel.TRACE) return;\n    console.trace.apply(this, args);\n  }\n  static debug(...args: any): void {\n    if (this.LOG_LEVEL > LogLevel.DEBUG) return;\n    console.debug.apply(this, args);\n  }\n  static info(...args: any): void {\n    if (this.LOG_LEVEL > LogLevel.INFO) return;\n    console.info.apply(this, args);\n  }\n  static log(...args: any): void {\n    if (this.LOG_LEVEL > LogLevel.LOG) return;\n    console.log.apply(this, args);\n  }\n  static warn(...args: any): void {\n    if (this.LOG_LEVEL > LogLevel.WARN) return;\n    console.warn.apply(this, args);\n  }\n  static error(...args: any): void {\n    if (this.LOG_LEVEL > LogLevel.ERROR) return;\n    console.error.apply(this, args);\n  }\n}\n","import { Lexer, Token, TokenType } from \"./lexer\";\n\nexport class Parser {\n  lexer: Lexer;\n\n  constructor() { this.lexer = new Lexer(); }\n\n  private peek(arr: any[]) { return arr.slice(-1)[0]; }\n\n  parse(expression: string) {\n    let tokens = this.lexer.tokenize(expression);\n    let stack: Token[] = [];\n    let output: Token[] = [];\n    let were: boolean[] = [];\n    let argCount: number[] = [];\n\n    tokens.forEach(token => {\n      if (token.type === TokenType.Literal || token.type === TokenType.Variable) {\n        output.push(token);\n        if (typeof this.peek(were) !== 'undefined') {\n          were.pop();\n          were.push(true);\n        }\n      } else if (token.type === TokenType.Function) {\n        stack.push(token);\n        argCount.push(0);\n        if (typeof this.peek(were) !== 'undefined') {\n          were.pop();\n          were.push(true);\n        }\n        were.push(false);\n      } else if (token.type === TokenType.ArgSeperator) {\n        while (this.peek(stack) && this.peek(stack).type !== TokenType.LParenthesis) {\n          output.push(stack.pop());\n        }\n        let w = were.pop();\n        if (w) { argCount.push(argCount.pop() + 1); }\n        were.push(false);\n      } else if (token.type == TokenType.Operator) {\n        while (this.peek(stack) && (this.peek(stack).type === TokenType.Operator)\n          && (\n            (token.associativity === \"left\" && token.precedence <= this.peek(stack).precedence)\n            || (token.associativity === \"right\" && token.precedence < this.peek(stack).precedence)\n          )\n        ) {\n          output.push(stack.pop());\n        }\n        stack.push(token);\n      } else if (token.type === TokenType.LParenthesis) {\n        stack.push(token);\n      } else if (token.type === TokenType.RParenthesis) {\n        while (this.peek(stack) && this.peek(stack).type !== TokenType.LParenthesis) {\n          output.push(stack.pop());\n        }\n        stack.pop();\n\n        if (this.peek(stack) && this.peek(stack).type === TokenType.Function) {\n          let funcToken = stack.pop();\n          let a = argCount.pop();\n          let w = were.pop();\n          if (w) { a += 1; }\n          funcToken.count = a;\n          output.push(funcToken);\n        }\n      }\n    });\n    while (this.peek(stack)) { output.push(stack.pop()); }\n\n    return output;\n  }\n}\n","import { Graph } from \"../core/graph\";\nimport { Rules } from \"../common/interfaces\";\nimport { Terminal } from \"../core/terminal\";\nimport { ViewPort } from \"../common/enums\";\n\nexport const getNewUUID = () => {\n  var S4 = () => (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\n  return (S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4());\n}\nexport const normalize = (value: number, min: number, max: number) => {\n  if (min === max) return 1;\n  return (value - min) / (max - min);\n}\nexport const denormalize = (normalized: number, min: number, max: number) => {\n  return (max - min) * normalized + min;\n}\nexport const getRandom = (min: number, max: number) => {\n  return Math.random() * (max - min) + min;\n}\nexport const intersects = (start1X: number, start1Y: number, end1X: number, end1Y: number, start2X: number, start2Y: number, end2X: number, end2Y: number): ViewPort => {\n  let res = !(start2X > end1X || end2X < start1X || start2Y > end1Y || end2Y < start1Y);\n  if (res) {\n    if (!(start2X < start1X || start2Y < start1Y || end2X > end1X || end2Y > end1Y)) return ViewPort.INSIDE;\n    else return ViewPort.INTERSECT;\n  } else return ViewPort.OUTSIDE;\n}\nexport const clamp = (value: number, min: number, max: number): number => {\n  return Math.min(Math.max(value, min), max);\n}\nexport const lerp = (a: number, b: number, t: number): number => {\n  return (1 - t) * a + t * b;\n}\nexport const canConnect = (source: Terminal, destination: Terminal, rules: Rules, executionGraph: Graph) => {\n  if (!destination) return false;\n  if (source === destination) return false;\n  if (source.node === destination.node) return false;\n  if (source.type === destination.type) return false;\n  if (!rules[source.dataType].includes(destination.dataType)) return false;\n  if (!executionGraph.canConnect(source.node, destination.node)) return false;\n  return true;\n}\nexport const isEmpty = (obj: any): boolean => {\n  for (let _ in obj) return false;\n  return true;\n}\nexport const isInRange = (value: number, min: number, max: number): boolean => {\n  return Math.min(value, min) >= min && Math.max(value, max) <= max;\n}\nexport const exists = (value: any): boolean => {\n  return typeof value !== 'undefined' && value !== null;\n}\nexport const get = <T>(value: T, defaultVal: T): T => {\n  if (typeof value === 'undefined' || value === null) return defaultVal;\n  return value;\n}\nexport const binarySearch = ({ max, getValue, match }: { max: number, getValue: Function, match: number }) => {\n  let min = 0;\n  while (min <= max) {\n    let mid = Math.floor((min + max) / 2);\n    const curr = getValue(mid);\n\n    if (curr === match) return mid;\n    if (curr < match) min = mid + 1;\n    else max = mid - 1;\n  }\n  return max;\n}\nexport const noop = () => { /**/ };\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t833: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkflow_connect\"] = self[\"webpackChunkflow_connect\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(6184);\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["root","factory","exports","module","define","amd","a","i","self","deferred","ViewPort","LOD","Align","GlobalEventType","Color","constructor","rgba","this","rgbaValue","hexValue","rgbaToHex","rgbaString","rgbaToString","rgbaCSSString","rgbaToCSSString","isEqual","color","static","Uint8ClampedArray","Math","floor","getRandom","hex","parseInt","slice","c","toString","length","_componentToHex","normalize","toFixed","colors","Array","isArray","Log","error","colorObjs","forEach","push","hexToRGBA","t","clamp","index","start","end","ceil","startColor","endColor","map","component","lerp","round","serialize","data","Connector","Hooks","flow","options","DefaultConnectorOptions","super","renderResolver","style","DefaultConnectorStyle","id","get","getNewUUID","floatingTip","startNode","node","endNode","connectors","removeConnection","isDeserialization","executionGraph","connect","onConnect","_data","call","state","FlowState","Stopped","setDirty","completeConnection","destination","includes","currHitTerminal","onExit","splice","indexOf","setData","canConnect","other","source","firstTerminal","type","TerminalType","IN","rules","dataType","render","context","flowConnect","save","flowRenderResolver","connector","flowConnectRenderResolver","_render","getRenderParams","restore","offContext","_offRender","params","ax","x","ay","y","dx","dy","offset","Vector2","Distance","bx","by","cx","cy","midx","midy","border","strokeStyle","borderColor","lineWidth","width","beginPath","moveTo","quadraticCurveTo","stroke","renderState","nodeState","NodeState","MAXIMIZED","position","terminalStripMargin","radius","titleHeight","startId","endId","startNodeId","endNodeId","Flow","name","terminalColors","globalEvents","parentFlow","listeners","nodes","Map","groups","nodeHitColors","groupHitColors","sortedNodes","AVLTree","b","zIndex","inputs","outputs","Graph","registerListeners","on","Running","deregisterListeners","off","existsInFlow","values","subFlow","addInput","flowInput","TunnelNode","proxyTerminal","getData","set","add","addOutput","flowOutput","addSubFlow","subFlowNode","SubFlowNode","inputNode","outputNode","createNode","inTerminals","outTerminals","DefaultNodeOptions","Node","terminalStyle","removeNode","nodeOrID","removeConnector","floatingConnector","delete","removeAllFocus","focused","group","stop","order","filter","graphNode","flowNode","input","output","serializedNode","deSerialize","serializedGroup","Group","serializedInput","serializedOutput","serializedConnector","startTerminal","concat","outputsUI","find","terminal","endTerminal","inputsUI","graphNodes","dirtyNodes","GraphNode","sourceNode","destinationNode","startGraphNode","endGraphNode","childs","updateOrder","disconnect","sourceGraphNode","destinationGraphNode","connectedEndNodes","Set","has","maxOrderOfConnectedStartNodes","reduce","acc","curr","max","_updateOrder","queue","currNode","shift","child","async","runAll","size","lowestDirty","Idle","Promise","all","resolve","run","clearDirty","lowestOrder","min","propagate","callback","List","append","currGNode","removeFirst","debugNode","indent","console","log","debugGraph","nodeToGraphNodeIds","_graphNode","groupedNodes","nodeToGraphNode","graph","serializedGraphNodes","deSerializedGraphNodes","serializedGroupedNodes","serializedGraphNode","nodeId","Object","keys","key","childId","DefaultGroupOptions","nodeDeltas","INSIDE","height","hitColor","DefaultGroupStyle","_position","DefaultGroupColors","Random","setHitColor","computeTextMetrics","updateRenderState","_name","trim","recomputeNodePositions","font","fontSize","metrics","measureText","textWidth","textHeight","actualBoundingBoxAscent","actualBoundingBoxDescent","d","document","createElement","textContent","body","appendChild","offsetHeight","removeChild","realPos","transform","intersects","canvasDimensions","scale","setContainedNodes","groupRealPos","viewport","nodeRealPos","ui","subtract","OUTSIDE","offGroupContext","fillStyle","strokeRect","fillRect","titleColor","textBaseline","fillText","onClick","screenPosition","realPosition","thisRealPosition","showGenericInput","replace","fontFamily","value","nodeDelata","serializedVector","RED","GREEN","BLUE","random","registeredEvents","lastId","eventKey","args","offAll","DefaultNodeConstructorOptions","stateObserver","lod","LOD2","_width","DefaultNodeStyle","setupState","uiNodes","terminals","nodeButtons","_zIndex","setupTerminals","Container","addNodeButton","toggleNodeState","_renderNodeButton","Left","reflow","update","offUIContext","remove","Terminal","OUT","Proxy","target","prop","oldValue","watch","propName","unwatch","align","deltaX","newNodeButton","NodeButton","noOfButtons","nodeButton","nodeButtonSize","nodeButtonSpacing","terminalRowHeight","padding","recalculateInputTerminals","recalculateOutputTerminals","LOD1","LOD0","INTERSECT","getHitTerminal","hitTerminal","onEnter","getHitUINode","uiNode","getHitNodeButton","renderTerminals","renderName","renderFocused","minimizedTerminalColor","titleFontSize","titleFont","inputTerminalsWidth","outputTerminalsWidth","outlineColor","strokeRoundRect","inputTerminalsStripWidth","outputTerminalsStripWidth","maximizeButtonColor","focus","addTerminal","removeTerminal","getInput","inputTerminal","currTerm","getInputs","setOutputs","outputTerminal","term","outputData","entries","entry","groupedConnectors","outputDataIterator","next","gCntrsIterator","MINIMIZED","dispose","onDown","getImageData","currHitUINode","onOver","prevHitTerminal","hitUINode","prevHitUINode","onUp","clone","hitNodeButton","onDrag","hitUINodeWhileDragging","draggable","currHitNode","pointers","onContextMenu","onWheel","direction","zoomable","createLabel","text","Label","createImage","Image","createSlider","Slider","createSlider2D","Slider2D","createVSlider","VSlider","createDial","Dial","createHozLayout","HorizontalLayout","createStack","Stack","createButton","Button","createToggle","Toggle","createRadioGroup","selected","RadioGroup","createSelect","Select","createSource","Source","createDisplay","renderers","Display","createInput","Input","createEnvelope","Envelope","expandButtonColor","spacing","rowHeight","defaultRenderFn","nodeRenderResolver","_offUIRender","DefaultSubFlowOptions","_","tunnel","lineTo","closePath","Right","DefaultTerminalOptions","DefaultTerminalStyle","Zero","_inst","_propName","oldPropName","newPropName","exists","watcherId","_oldVal","newVal","offUIRender","arc","Constant","TAU","outerFocusColor","fill","focusColor","shadowBlur","shadowColor","otherTerminal","newConnector","_disconnect","cntr","currCntr","startTerm","endTerm","findIndex","pop","onDisconnect","isConnected","cursor","removedConnector","onEvent","emit","DefaultTunnelNodeOptions","_proxyTerminal","proxyTerminalId","xOrDOMPoint","DOMPoint","addInPlace","arg1","arg2","multiplyInPlace","subtractInPlace","normalizeInPlace","minY","maxY","clampInPlace","transformInPlace","transformedPoint","transformPoint","absInPlace","abs","multiply","isInside","arg3","arg4","assign","vector","threshold","vector1OrX1","vector2OrY1","x2","y2","sqrt","pow","vector1","vector2","minX","maxX","FlowConnect","mount","audioBufferCache","arrayBufferCache","top","left","FlowConnectState","flows","keymap","touchControls","genericInput","minScale","maxScale","wheelScaleDelta","pinchScaleDelta","disableScale","_transform","DOMMatrix","inverseTransform","identity","startTime","prepareCanvas","setupHitCanvas","calculateCanvasDimension","registerChangeListeners","attachStyles","canvasUtils","registerEvents","setGenericInput","setupAudioContext","_context","audioContext","_audioContext","_offContext","_offUIContext","_offGroupContext","canvas","time","performance","now","throttle","addEventListener","window","requestAnimationFrame","registerObservers","parentElement","parent","parentResizeObserver","bodyResizeObserver","ResizeObserver","updateTransform","observe","HTMLDivElement","clientWidth","clientHeight","HTMLCanvasElement","getContext","OffscreenCanvas","OffscreenCanvasRenderingContext2D","offCanvas","offUICanvas","offGroupCanvas","touchAction","inputStyle","innerHTML","getElementsByTagName","adjust","parentBoundingRect","getBoundingClientRect","boundingRect","prototype","noop","CanvasRenderingContext2D","roundRect","fillRoundRect","dragDelta","prevPanPosition","prevPinchDistance","onkeydown","ev","onkeyup","onpointerdown","currFlow","addPointer","pointerId","getRelativePosition","getHitNode","Number","MAX_SAFE_INTEGER","groupStartPoint","currGroup","currHitGroup","getHitGroup","fallbackConnection","onpointerup","removePointer","handleGrouping","hitNode","newGroup","handleConnection","onpointerout","prevHitNode","onpointermove","updatePointer","currPinchDistance","handleZoom","Midpoint","hitGroup","nodeIndex","delta","pointerType","onclick","oncontextmenu","preventDefault","onwheel","deltaY","className","visibility","pointerEvents","onblur","onchange","__FLOWCONNECT_AUDIO_CTX__","AudioContext","audioWorklets","generateAudioWorklets","WorkletUtils","CircularBuffer","audioWorklet","addModule","styles","attributes","activeElement","changeParent","newParent","pointer","pntr","zoomIn","origin","scaleDelta","intersection","oldConnector","clientX","clientY","scaleOrigin","translate","realSpaceOrigin","translateSelf","scaleSelf","inverse","setTransform","translateBy","scaleBy","clear","clearRect","startGlobalTime","_startGlobalTime","timerId","bind","stopGlobalTime","isRootFlowStopped","cancelAnimationFrame","frameId","createFlow","DefaultRules","rootFlow","fromJson","json","JSON","parse","toJson","serializedFlow","stringify","URL","createObjectURL","Blob","utilsFileName","Worklet_ProxyParamForSource","Worklet_ProxyParam","Worklet_Debug","Worklet_MoogEffect","Worklet_BitcrusherEffect","Worklet_LFO","Worklet_Noise","Worklet_Proxy","PI","SIN_60","PHI","fileIcon","imageIcon","UINode","DefaultSlider2DOptions","UIType","DefaultSlider2DStyle","pointDiameter","_value","getProp","thumbHitColor","offThumbCanvas","offThumbContext","renderOffThumb","oldVal","setProp","coord","paint","backgroundColor","borderWidth","point","thumbColor","paintLOD1","offPaint","newWidth","newHeight","getHitPoint","movePoint","onPropChange","disabled","isHit","DefaultButtonOptions","DefaultButtonStyle","label","Center","_node","children","shadowOffsetX","shadowOffset","shadowOffsetY","DefaultContainerOptions","DefaultContainerStyle","contentWidth","uiContainer","_paint","container","terminalsDisplayHeight","visible","availableWidth","childX","serializedChild","DefaultDialOptions","DefaultDialStyle","thumbStart","thumbEnd","temp","lineCap","thumbShadowColor","thumbShadowBlur","center","angle","cos","sin","pointToValue","diff","atan2","lastAngle","undefined","deltaValue","currValue","diffValue","normalizedValue","denormalize","customRenderers","DefaultDisplayOptions","DefaultDisplayStyle","offCanvasConfigs","rendererConfig","newOffCanvasConfig","canvasType","CanvasType","shouldRender","config","auto","customRender","canvasConfigs","renderer","autoOffCanvasConfigs","then","results","result","drawImage","DefaultEnvelopeOptions","DefaultEnvelopeStyle","pointHitColorPoint","BiMap","sort","pointNode","offPointsCanvas","offPointsContext","renderOffPoints","toArray","vec","points","lineColor","pointColor","currHitPoint","prev","Infinity","newPoint","newPointNode","anchor","searchTail","prepend","addAfter","deletePoint","lastDownPosition","serialVec","DefaultHorizontalLayoutOptions","DefaultHorizontalLayoutStyle","originalWidth","maxHeight","fixedWidthChilds","fixedWidth","remainingWidth","flexWidth","childWidth","grow","hozLayout","sourceString","DefaultImageOptions","DefaultImageStyle","_src","setupImage","src","onerror","onload","imageCanvas","imageContext","ratio","DefaultInputOptions","DefaultInputStyle","InputType","parseFloat","setupLabel","setupInputElement","val","setLabelText","inputEl","precision","validity","patternMismatch","step","spellcheck","inputType","pattern","maxLength","oninput","Text","DefaultLabelOptions","DefaultLabelStyle","_text","orgTextWidth","format","displayText","getBestFitString","ellipsisWidth","binarySearch","getValue","idx","substring","match","DefaultRadioGroupOptions","DefaultRadioGroupStyle","_values","selectedValue","_selected","setupLabels","option","selectedLabel","lastSelectedLabel","selectedBackgroundColor","selectedColor","commonWidth","DefaultSelectOptions","DefaultSelectStyle","slctdVal","arrowColor","newValue","DefaultSliderOptions","DefaultSliderStyle","railHeight","thumbFill","thumbRadius","DefaultSourceOptions","DefaultSourceStyle","accept","htmlInput","click","file","_file","lastIndexOf","files","DefaultStackOptions","DefaultStackStyle","actualTotalHeight","effectiveSpacing","stack","DefaultToggleOptions","DefaultToggleStyle","_checked","checked","DefaultUINodeOptions","_visible","_disabled","propValue","query","DefaultVSliderOptions","DefaultVSliderStyle","railWidth","comparator","dataToTreeNodeMapper","dataRefToTreeNode","rightRotate","newRoot","right","leftRotate","getBalance","res","_insert","newNode","AVLTreeNode","balance","deleted","_delete","currData","minValue","action","_inorder","_reverseInorder","reverseMap","keyOrVal","temp1","temp2","Evaluator","variables","history","orderedExprs","historyLimit","parser","Parser","evaluate","expr","postFix","oldestExpr","token","TokenType","Literal","Variable","toLowerCase","Error","Operator","Function","count","functions","constants","tau","pi","phi","ln2","LN2","ln10","LN10","log2e","LOG2E","log10e","LOG10E","acos","acosh","asin","asinh","tan","atan","atanh","exp","cbrt","log10","log2","base","dist","x1","y1","gcd","r","hypot","largest","lcm","prod","sum","mean","median","std","var","fact","n","multiargFunctions","Lexer","numberBuffer","letterBuffer","tokenize","charAt","toUpperCase","replaceConstants","split","char","isDigit","isDecimalPoint","isLetter","processNumberBuffer","Token","isOperator","processLetterBuffer","isLeftParenthesis","join","LParenthesis","isRightParenthesis","RParenthesis","isComma","ArgSeperator","literal","isNaN","test","operators","precedence","associativity","head","tail","ListNode","hook","removed","removeLast","addBefore","searchHead","mapped","LogLevel","LOG_LEVEL","TRACE","trace","apply","DEBUG","debug","INFO","info","LOG","WARN","warn","ERROR","lexer","peek","arr","expression","tokens","were","argCount","funcToken","S4","normalized","start1X","start1Y","end1X","end1Y","start2X","start2Y","end2X","end2Y","isEmpty","obj","isInRange","defaultVal","mid","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","m","O","chunkIds","fn","priority","notFulfilled","fulfilled","j","every","o","hasOwnProperty","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","__webpack_exports__"],"sourceRoot":""}