!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var s=e();for(var i in s)("object"==typeof exports?exports:t)[i]=s[i]}}(self,(function(){return(self.webpackChunkflow_connect=self.webpackChunkflow_connect||[]).push([[568],{1941:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpatialPanner=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(8637);class r extends n.Node{constructor(t,e={}){super(t,e.name||"3D Spatial Panner",e.position||new i.Vector(50,50),e.width||200,[{name:"in",dataType:"audio"}],[{name:"out",dataType:"audio"}],{state:e.state?{value:new i.Vector(.5,.5),z:-1,bypass:!1,...e.state}:{value:new i.Vector(.5,.5),z:-1,bypass:!1},style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{}}),this.orientationX=0,this.orientationY=0,this.orientationZ=-1,this.posX=this.flow.flowConnect.audioContext.listener.positionX.value,this.posY=this.flow.flowConnect.audioContext.listener.positionY.value,this.posZ=-1,this.inGain=t.flowConnect.audioContext.createGain(),this.outGain=t.flowConnect.audioContext.createGain(),this.panner=new PannerNode(t.flowConnect.audioContext,{panningModel:"HRTF",distanceModel:"linear",positionX:this.posX,positionY:this.posY,positionZ:this.posZ,orientationX:this.orientationX,orientationY:this.orientationY,orientationZ:this.orientationZ}),this.inputs[0].ref=this.inGain,this.outputs[0].ref=this.outGain,this.setBypass(),this.setupUI(),this.watch("value",((t,e)=>{let s=(0,a.denormalize)(e.x,-1,1),i=(0,a.denormalize)(e.y,-1,1);this.panner.positionX.value=s,this.panner.positionY.value=i})),this.watch("z",((t,e)=>{(e<-1e4||e>1e4)&&(this.state.z=(0,a.clamp)(parseInt(e),-1e4,1e4)),this.panner.positionZ.value=this.state.z})),this.watch("bypass",this.setBypass.bind(this)),this.handleAudioConnections()}setBypass(){this.state.bypass?(this.panner.disconnect(),this.inGain.disconnect(),this.inGain.connect(this.outGain)):(this.inGain.disconnect(),this.inGain.connect(this.panner),this.panner.connect(this.outGain))}setupUI(){this.panSlider2D=this.createSlider2D({propName:"value",height:this.width-2*this.style.padding}),this.zSlider=this.createSlider(-1e4,1e4,{height:10,propName:"z",style:{grow:.6}}),this.zInput=this.createInput({propName:"z",height:20,style:{type:o.InputType.Number,grow:.3,precision:0}}),this.bypassToggle=this.createToggle({propName:"bypass",style:{grow:.15}}),this.ui.append([this.panSlider2D,this.createHozLayout([this.createLabel("Z",{style:{grow:.1}}),this.zSlider,this.zInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Bypass ?",{style:{grow:.3}}),this.bypassToggle],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.SpatialPanner=r},4106:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ADSR=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(8637);class r extends n.Node{constructor(t,e={}){super(t,e.name||"ADSR",e.position||new i.Vector(50,50),e.width||280,[{name:"trigger",dataType:"event"}],[{name:"out",dataType:"audio"}],{state:e.state?{...r.DefaultState,...e.state}:r.DefaultState,style:e.style||{rowHeight:10,spacing:15},terminalStyle:e.terminalStyle||{}}),this.proxyParamNode=new AudioWorkletNode(t.flowConnect.audioContext,"proxy-param",{numberOfOutputs:1,parameterData:{param:0}}),this.proxyParam=this.proxyParamNode.parameters.get("param"),this.outputs[0].ref=this.proxyParamNode,this.setMinMax(),this.state.s=(0,a.clamp)(this.state.s,0,1),this.setupUI(),this.minInput.on("blur",this.setMinMax),this.maxInput.on("blur",this.setMinMax),this.aInput.on("blur",(()=>this.adsrChanged())),this.dInput.on("blur",(()=>this.adsrChanged())),this.sInput.on("blur",(()=>this.adsrChanged())),this.rInput.on("blur",(()=>this.adsrChanged())),this.inputs[0].on("event",(()=>{this.state.trigger=!this.state.trigger;let e=t.flowConnect.audioContext.currentTime,{a:s,d:i,s:n,r:o}=this.state;this.state.trigger?(this.proxyParam.cancelScheduledValues(0),this.proxyParam.setValueAtTime(this.state.min,e),this.proxyParam.linearRampToValueAtTime(1*this.state.max,e+s),this.proxyParam.linearRampToValueAtTime((0,a.denormalize)(n,this.state.min,this.state.max),e+s+i)):(this.proxyParam.cancelScheduledValues(0),this.proxyParam.setValueAtTime(this.proxyParam.value,e),this.proxyParam.linearRampToValueAtTime(this.state.min,e+o))})),this.handleAudioConnections()}adsrChanged(){this.state.s=(0,a.clamp)(this.state.s,0,1);let{a:t,d:e,r:s}=this.state,n=t+e+s;this.envelopeInput.value=[i.Vector.Zero(),new i.Vector(t/n,1),new i.Vector((t+e)/n,this.state.s),new i.Vector(1,0)]}stopAutomation(){this.proxyParam.cancelScheduledValues(this.flow.flowConnect.audioContext.currentTime)}setMinMax(){this.state.proxyParamNode.port.postMessage({type:"set-range",value:{min:this.state.min,max:this.state.max}})}setupUI(){let{a:t,d:e,r:s}=this.state,a=t+e+s;this.envelopeInput=this.createEnvelope(145,[i.Vector.Zero(),new i.Vector(t/a,1),new i.Vector((t+e)/a,this.state.s),new i.Vector(1,0)],{style:{pointColor:"#fcba03"}}),this.envelopeInput.disabled=!0,this.minInput=this.createInput({propName:"min",height:20,style:{type:o.InputType.Number,grow:.5,step:"any"}}),this.maxInput=this.createInput({propName:"max",height:20,style:{type:o.InputType.Number,grow:.5,step:"any"}}),this.aInput=this.createInput({propName:"a",height:20,style:{type:o.InputType.Number,step:"any",grow:.5,precision:3}}),this.dInput=this.createInput({propName:"d",height:20,style:{type:o.InputType.Number,step:"any",grow:.5,precision:3}}),this.sInput=this.createInput({propName:"s",height:20,style:{type:o.InputType.Number,step:"any",grow:.5,precision:3}}),this.rInput=this.createInput({propName:"r",height:20,style:{type:o.InputType.Number,step:"any",grow:.5,precision:3}}),this.ui.append([this.envelopeInput,this.createHozLayout([this.createLabel("Min"),this.minInput,this.createLabel("Max"),this.maxInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("A"),this.aInput,this.createLabel("D"),this.dInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("S"),this.sInput,this.createLabel("R"),this.rInput],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>{if(e.end.ref instanceof AudioParam){let t=Math.max(0,e.end.ref.minValue);e.end.ref.value=t,0!==t&&this.proxyParamNode.port.postMessage({type:"set-offset",value:t})}this.outputs[0].ref.connect(e.end.ref)})),this.outputs[0].on("disconnect",((t,e,s,i)=>{this.stopAutomation(),this.outputs[0].ref.disconnect(i.ref)}))}}e.ADSR=r,r.DefaultState={min:0,max:1,a:.4,d:.2,s:.6,r:.4,trigger:!1}},346:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AudioBufferSource=void 0;const i=s(7892),a=s(7055);class n extends a.Node{constructor(t,e={}){super(t,e.name||"AudioBuffer Source",e.position||new i.Vector(50,50),e.width||170,[],[{name:"buffer",dataType:"audio-buffer"}],{state:e.state?{...n.DefaultState,...e.state}:n.DefaultState,style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.setupUI(),this.fileInput.on("change",(()=>this.processFile())),this.on("process",(()=>this.processFile()))}async processFile(){let t=this.state.file;if(!t)return;let e=this.flow.flowConnect.arrayBufferCache.get(t.name+t.type);e||(e=await t.arrayBuffer(),this.flow.flowConnect.arrayBufferCache.set(t.name+t.type,e)),this.processArrayBuffer(e)}async processArrayBuffer(t){let e=this.flow.flowConnect.audioBufferCache.get(t);e||(e=await this.flow.flowConnect.audioContext.decodeAudioData(t),this.flow.flowConnect.audioBufferCache.set(t,e)),this.state.buffer=e,this.setOutputs(0,this.state.buffer)}setupUI(){this.fileInput=this.createSource({height:20,propName:"file",style:{grow:1}}),this.ui.append(this.createHozLayout([this.createLabel("File"),this.fileInput],{style:{spacing:20}}))}}e.AudioBufferSource=n,n.DefaultState={file:null,buffer:null}},3645:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Automate=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(8637);class r extends n.Node{constructor(t,e={},s=[new i.Vector(.2,.5),new i.Vector(.5,.8),new i.Vector(.9,.2)]){super(t,e.name||"Automate",e.position||new i.Vector(50,50),e.width||280,[{name:"trigger",dataType:"event"}],[{name:"out",dataType:"audio"}],{state:e.state?{...r.DefaultState,...e.state}:r.DefaultState,style:e.style||{rowHeight:10,spacing:15},terminalStyle:e.terminalStyle||{}}),this.finiteLoop=2,this.proxyParamNode=new AudioWorkletNode(t.flowConnect.audioContext,"proxy-param",{numberOfOutputs:1,parameterData:{param:this.state.value}}),this.proxyParam=this.proxyParamNode.parameters.get("param"),this.setMinMax(),this.outputs[0].ref=this.proxyParamNode,this.setupUI(s),this.minInput.on("blur",(()=>{this.setMinMax(),this.startAutomation()})),this.maxInput.on("blur",(()=>{this.setMinMax(),this.startAutomation()})),this.envelopeInput.on("change",(()=>this.startAutomation())),this.durationInput.on("change",(()=>this.startAutomation())),this.loopToggle.on("change",(()=>this.startAutomation())),this.inputs[0].on("event",(()=>this.startAutomation())),t.flowConnect.on("start",(()=>this.state.auto&&this.startAutomation())),t.flowConnect.on("stop",(()=>this.stopAutomation())),this.handleAudioConnections()}startAutomation(){this.stopAutomation();let t=this.envelopeInput.value;for(let e of t)e.x=e.x*this.state.duration,e.y=(0,a.denormalize)(e.y,this.state.min,this.state.max);let e=t[t.length-1].x;this.state.loop?(this.schedule(t,this.flow.flowConnect.audioContext.currentTime,this.finiteLoop),this.timerId=window.setInterval((()=>{this.flow.flowConnect.audioContext.currentTime>this.scheduleEndTime-e&&this.schedule(t,this.scheduleEndTime,this.finiteLoop)}),50)):this.schedule(t,this.flow.flowConnect.audioContext.currentTime,1)}stopAutomation(){this.proxyParam.cancelScheduledValues(this.flow.flowConnect.audioContext.currentTime),clearInterval(this.timerId)}schedule(t,e,s){for(let i=0;i<s;i+=1)t.forEach((t=>{this.proxyParam.linearRampToValueAtTime(t.y,e+t.x)}));this.scheduleEndTime=e+t[t.length-1].x}setMinMax(){this.proxyParamNode.port.postMessage({type:"set-range",value:{min:this.state.min,max:this.state.max}})}setupUI(t){this.envelopeInput=this.createEnvelope(145,t,{input:!0,output:!0}),this.minInput=this.createInput({propName:"min",height:20,style:{type:o.InputType.Number,grow:.5,step:"any"}}),this.maxInput=this.createInput({propName:"max",height:20,style:{type:o.InputType.Number,grow:.5,step:"any"}}),this.durationInput=this.createInput({propName:"duration",height:20,style:{type:o.InputType.Number,step:"any",grow:.5}}),this.autoToggle=this.createToggle({propName:"auto"}),this.loopToggle=this.createToggle({propName:"loop"}),this.ui.append([this.envelopeInput,this.createHozLayout([this.createLabel("Min"),this.minInput,this.createLabel("Max"),this.maxInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Duration (seconds)",{style:{grow:.5}}),this.durationInput],{style:{spacing:5}}),this.createHozLayout([this.createHozLayout([this.createLabel("Auto Start ?",{height:20}),this.autoToggle],{style:{spacing:5,grow:.5}}),this.createHozLayout([this.createLabel("Loop ?",{height:20}),this.loopToggle],{style:{spacing:5,grow:.5}})])])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>{if(e.end.ref instanceof AudioParam){let t=Math.max(0,e.end.ref.minValue);e.end.ref.value=t,0!==t&&this.proxyParamNode.port.postMessage({type:"set-offset",value:t})}this.outputs[0].ref.connect(e.end.ref),this.startAutomation()})),this.outputs[0].on("disconnect",((t,e,s,i)=>{this.stopAutomation(),this.outputs[0].ref.disconnect(i.ref)}))}}e.Automate=r,r.DefaultState={min:0,max:1,value:.5,duration:1,auto:!0,loop:!1}},5431:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BiquadFilter=void 0;const i=s(7892),a=s(7055);class n extends a.Node{constructor(t,e={}){super(t,e.name||"Biquad Filter",e.position||new i.Vector(50,50),e.width||230,[{name:"in",dataType:"audio"},{name:"gain",dataType:"audioparam"},{name:"Q",dataType:"audioparam"},{name:"frequency",dataType:"audioparam"},{name:"detune",dataType:"audioparam"}],[{name:"out",dataType:"audio"}],{state:e.state?{...n.DefaultState,...e.state}:n.DefaultState,style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{}}),this.inGain=t.flowConnect.audioContext.createGain(),this.outGain=t.flowConnect.audioContext.createGain(),this.inputs[0].ref=this.inGain,this.outputs[0].ref=this.outGain,this.biquadFilter=t.flowConnect.audioContext.createBiquadFilter(),this.biquadFilter.gain.value=0,this.biquadFilter.Q.value=1,this.biquadFilter.frequency.value=800,this.biquadFilter.detune.value=0,this.biquadFilter.type=this.state.filterType,this.inputs[1].ref=this.biquadFilter.gain,this.inputs[2].ref=this.biquadFilter.Q,this.inputs[3].ref=this.biquadFilter.frequency,this.inputs[4].ref=this.biquadFilter.detune,this.inputs[1].on("data",((t,e)=>"number"==typeof e&&(this.inputs[1].ref.value=e))),this.inputs[2].on("data",((t,e)=>"number"==typeof e&&(this.inputs[2].ref.value=e))),this.inputs[3].on("data",((t,e)=>"number"==typeof e&&(this.inputs[3].ref.value=e))),this.inputs[4].on("data",((t,e)=>"number"==typeof e&&(this.inputs[4].ref.value=e))),this.setBypass(),this.setupUI(),this.typeSelect.on("change",(()=>{this.biquadFilter.type=this.state.filterType})),this.watch("bypass",(()=>this.setBypass())),this.handleAudioConnections()}setBypass(){this.state.bypass?(this.biquadFilter.disconnect(),this.inGain.disconnect(),this.inGain.connect(this.outGain)):(this.inGain.disconnect(),this.inGain.connect(this.biquadFilter),this.biquadFilter.connect(this.outGain))}setupUI(){this.typeSelect=this.createSelect(["lowpass","highpass","bandpass","lowshelf","highshelf","peaking","notch","allpass"],{propName:"filterType",height:15,style:{grow:.7}}),this.bypassToggle=this.createToggle({propName:"bypass",style:{grow:.1}}),this.ui.append([this.createHozLayout([this.createLabel("Type",{style:{grow:.3}}),this.typeSelect],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Bypass ?",{style:{grow:.3}}),this.bypassToggle],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.BiquadFilter=n,n.DefaultState={filterType:"lowpass",bypass:!1}},5749:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BitcrusherEffect=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(8637);class r extends n.Node{constructor(t,e={}){super(t,e.name||"Bitcrusher Effect",e.position||new i.Vector(50,50),e.width||230,[{name:"in",dataType:"audio"}],[{name:"out",dataType:"audio"}],{state:e.state?{...r.DefaultState,...e.state}:r.DefaultState,style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{}}),this.inGain=t.flowConnect.audioContext.createGain(),this.outGain=t.flowConnect.audioContext.createGain(),this.inputs[0].ref=this.inGain,this.outputs[0].ref=this.outGain,this.bitcrusher=new AudioWorkletNode(t.flowConnect.audioContext,"bitcrusher-effect",{numberOfInputs:1,numberOfOutputs:1,processorOptions:{bufferSize:4096}}),this.setBypass(),this.setupUI(),this.bitsSlider.on("change",(()=>this.paramsChanged())),this.normFreqSlider.on("change",(()=>this.paramsChanged())),this.bitsInput.on("change",(()=>this.paramsChanged())),this.normFreqInput.on("change",(()=>this.paramsChanged())),this.watch("bypass",(()=>this.setBypass())),this.watch("bits",(()=>{(this.state.bits<1||this.state.bits>16||!Number.isInteger(this.state.bits))&&(this.state.bits=(0,a.clamp)(Math.floor(this.state.bits),1,16))})),this.watch("normFreq",(()=>{(this.state.normFreq<0||this.state.normFreq>1)&&(this.state.normFreq=(0,a.clamp)(this.state.normFreq,0,1))})),t.flowConnect.on("start",(()=>this.paramsChanged())),this.handleAudioConnections()}setBypass(){this.state.bypass?(this.bitcrusher.disconnect(),this.inGain.disconnect(),this.inGain.connect(this.outGain)):(this.inGain.disconnect(),this.inGain.connect(this.bitcrusher),this.bitcrusher.connect(this.outGain))}paramsChanged(){this.bitcrusher.port.postMessage({bits:this.state.bits,normFreq:this.state.normFreq})}setupUI(){this.bitsSlider=this.createSlider(1,16,{height:10,propName:"bits",style:{grow:.5}}),this.normFreqSlider=this.createSlider(0,1,{height:10,propName:"normFreq",style:{grow:.5}}),this.bitsInput=this.createInput({propName:"bits",height:20,style:{type:o.InputType.Number,grow:.2}}),this.normFreqInput=this.createInput({propName:"normFreq",height:20,style:{type:o.InputType.Number,grow:.4,precision:2}}),this.bypassToggle=this.createToggle({propName:"bypass",style:{grow:.1}}),this.ui.append([this.createHozLayout([this.createLabel("Bits",{style:{grow:.3}}),this.bitsSlider,this.bitsInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Norm Freq.",{style:{grow:.3}}),this.normFreqSlider,this.normFreqInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Bypass ?",{style:{grow:.3}}),this.bypassToggle],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.BitcrusherEffect=r,r.DefaultState={bits:4,normFreq:.1,bypass:!1}},1744:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChannelMerger=void 0;const i=s(7892),a=s(7900),n=s(7055);class o extends n.Node{constructor(t,e={}){super(t,e.name||"Channel Merger",e.position||new i.Vector(50,50),e.width||160,[{name:"Channel 1",dataType:"audio"},{name:"Channel 2",dataType:"audio"}],[{name:"out",dataType:"audio"}],{state:e.state||{},style:e.style||{rowHeight:10,spacing:15},terminalStyle:e.terminalStyle||{}}),this.inputs[0].ref=t.flowConnect.audioContext.createGain(),this.inputs[1].ref=t.flowConnect.audioContext.createGain(),this.outputs[0].ref=t.flowConnect.audioContext.createGain(),this.merger=t.flowConnect.audioContext.createChannelMerger(2),this.inputs[0].ref.connect(this.merger,0,0),this.inputs[1].ref.connect(this.merger,0,1),this.merger.connect(this.outputs[0].ref),this.setupUI(),this.addChannelButton.on("click",(()=>{this.merger.disconnect(),this.inputs.forEach((t=>t.ref.disconnect())),this.merger=t.flowConnect.audioContext.createChannelMerger(this.inputs.length+1);let e=new a.Terminal(this,a.TerminalType.IN,"audio","Channel "+(this.inputs.length+1));e.ref=t.flowConnect.audioContext.createGain(),this.addTerminal(e),this.inputs.forEach(((t,e)=>t.ref.connect(this.merger,0,e))),this.merger.connect(this.outputs[0].ref)})),this.handleAudioConnections()}setupUI(){this.addChannelButton=this.createButton("Add In Channel",{height:20}),this.ui.append(this.addChannelButton)}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.ChannelMerger=o},5051:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChannelSplitter=void 0;const i=s(7892),a=s(7900),n=s(7055);class o extends n.Node{constructor(t,e={}){super(t,e.name||"Channel Splitter",e.position||new i.Vector(50,50),e.width||160,[{name:"in",dataType:"audio"}],[{name:"Channel 1",dataType:"audio"}],{state:e.state||{},style:e.style||{rowHeight:10,spacing:15},terminalStyle:e.terminalStyle||{}}),this.oldNoOfChannels=1,this.inputs[0].ref=t.flowConnect.audioContext.createGain(),this.outputs[0].ref=t.flowConnect.audioContext.createGain(),this.outputs[0].ref.channelCountMode="explicit",this.on("channel-count-change",(t=>this.checkChannels(t))),this.handleAudioConnections()}checkChannels(t){if(this.oldNoOfChannels===t)return;this.splitter&&this.splitter.disconnect(),this.inputs[0].ref.disconnect();let e=this.flow.flowConnect.audioContext.createChannelSplitter(t);this.inputs[0].ref.connect(e);let s=[];for(let i=0;i<Math.max(t,this.oldNoOfChannels);i+=1)if(i<t)if(i<this.oldNoOfChannels)e.connect(this.outputs[i].ref,i);else{let t=new a.Terminal(this,a.TerminalType.OUT,"audio","Channel "+(i+1));t.ref=this.flow.flowConnect.audioContext.createGain(),t.ref.channelCountMode="explicit",this.addTerminal(t),this.outputs[i].on("connect",((t,e)=>this.outputs[i].ref.connect(e.end.ref))),this.outputs[i].on("disconnect",((t,e,s,a)=>this.outputs[i].ref.disconnect(a.ref))),e.connect(this.outputs[i].ref,i)}else s.push(this.outputs[i]);s.forEach((t=>{t.ref.disconnect(),this.removeTerminal(t)})),this.oldNoOfChannels=t,this.splitter=e}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.ChannelSplitter=o},8561:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChorusEffect=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(8637);let r=s(1252);class h extends n.Node{constructor(t,e={}){super(t,e.name||"Chorus Effect",e.position||new i.Vector(50,50),e.width||230,[{name:"in",dataType:"audio"}],[{name:"out",dataType:"audio"}],{style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{},state:e.state?{...h.DefaultState,...e.state}:h.DefaultState}),window.__tuna__||(window.__tuna__=new r(t.flowConnect.audioContext)),this.chorus=new window.__tuna__.Chorus,this.inputs[0].ref=this.outputs[0].ref=this.chorus,this.setupUI(),Object.assign(this.chorus,{delay:this.state.delay,depth:this.state.depth,feedback:this.state.feedback,rate:this.state.rate}),this.watch("delay",((t,e)=>{(e<0||e>1)&&(this.state.delay=(0,a.clamp)(e,0,1)),this.chorus.delay=this.state.delay})),this.watch("depth",((t,e)=>{(e<0||e>1)&&(this.state.depth=(0,a.clamp)(e,0,1)),this.chorus.depth=this.state.depth})),this.watch("feedback",((t,e)=>{(e<0||e>.95)&&(this.state.feedback=(0,a.clamp)(e,0,.95)),this.chorus.feedback=this.state.feedback})),this.watch("rate",((t,e)=>{(e<0||e>.1)&&(this.state.rate=(0,a.clamp)(e,0,.1)),this.chorus.rate=this.state.rate})),this.watch("bypass",((t,e)=>this.chorus.bypass=e)),this.handleAudioConnections()}setupUI(){this.delaySlider=this.createSlider(0,1,{height:10,propName:"delay",style:{grow:.5}}),this.delayInput=this.createInput({propName:"delay",height:20,style:{type:o.InputType.Number,grow:.2,precision:4}}),this.depthSlider=this.createSlider(0,1,{height:10,propName:"depth",style:{grow:.5}}),this.depthInput=this.createInput({propName:"depth",height:20,style:{type:o.InputType.Number,grow:.2,precision:2}}),this.feedbackSlider=this.createSlider(0,.95,{height:10,propName:"feedback",style:{grow:.5}}),this.feedbackInput=this.createInput({propName:"feedback",height:20,style:{type:o.InputType.Number,grow:.2,precision:2}}),this.rateSlider=this.createSlider(0,.1,{height:10,propName:"rate",style:{grow:.5}}),this.rateInput=this.createInput({propName:"rate",height:20,style:{type:o.InputType.Number,grow:.2,precision:2}}),this.bypassToggle=this.createToggle({propName:"bypass",style:{grow:.1}}),this.ui.append([this.createHozLayout([this.createLabel("Delay",{style:{grow:.3}}),this.delaySlider,this.delayInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Depth",{style:{grow:.3}}),this.depthSlider,this.depthInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Feedback",{style:{grow:.3}}),this.feedbackSlider,this.feedbackInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Rate",{style:{grow:.3}}),this.rateSlider,this.rateInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Bypass ?",{style:{grow:.3}}),this.bypassToggle],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.ChorusEffect=h,h.DefaultState={feedback:.4,delay:.0045,depth:.7,rate:.01,bypass:!1}},6021:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Convolver=void 0;const i=s(7892),a=s(7055);class n extends a.Node{constructor(t,e={}){super(t,e.name||"Convolver",e.position||new i.Vector(50,50),e.width||160,[{name:"in",dataType:"audio"},{name:"impulse",dataType:"audio-buffer"}],[{name:"out",dataType:"audio"}],{state:e.state?{...n.DefaultState,...e.state}:n.DefaultState,style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{}}),this.inGain=t.flowConnect.audioContext.createGain(),this.outGain=t.flowConnect.audioContext.createGain(),this.convolver=t.flowConnect.audioContext.createConvolver(),this.inputs[0].ref=this.inGain,this.outputs[0].ref=this.outGain,this.setBypass(),this.setupUI(),this.watch("bypass",(()=>this.setBypass())),this.inputs[1].on("data",((t,e)=>{this.convolver.buffer=e})),this.handleAudioConnections()}setBypass(){this.state.bypass?(this.inGain.disconnect(),this.convolver.disconnect(),this.inGain.connect(this.outGain)):(this.inGain.disconnect(),this.inGain.connect(this.convolver),this.convolver.connect(this.outGain))}setupUI(){this.bypassToggle=this.createToggle({propName:"bypass",style:{grow:.25}}),this.ui.append([this.createHozLayout([this.createLabel("Bypass ?"),this.bypassToggle],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.Convolver=n,n.DefaultState={bypass:!1}},2776:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Debug=void 0;const i=s(6894),a=s(7892),n=s(7055);class o extends n.Node{constructor(t,e={}){super(t,e.name||"Debug",e.position||new a.Vector(50,50),e.width||120,[{name:"in",dataType:"audio"}],[{name:"out",dataType:"audio"},{name:"debug",dataType:"any"}],{state:e.state||{},style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.inGain=t.flowConnect.audioContext.createGain(),this.outGain=t.flowConnect.audioContext.createGain(),this.inputs[0].ref=this.inGain,this.outputs[0].ref=this.outGain,this.debugNode=new AudioWorkletNode(t.flowConnect.audioContext,"debug",{numberOfInputs:1,numberOfOutputs:1}),this.debugNode.port.onmessage=e=>{t.state!==i.FlowState.Stopped&&this.setOutputs(1,e.data)},this.inputs[0].ref.connect(this.debugNode),this.debugNode.connect(this.outputs[0].ref),this.handleAudioConnections()}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.Debug=o},3146:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DelayEffect=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(8637);class r extends n.Node{constructor(t,e={}){super(t,e.name||"Delay",e.position||new i.Vector(50,50),e.width||230,[{name:"in",dataType:"audio"}],[{name:"out",dataType:"audio"}],{state:e.state?{...r.DefaultState,...e.state}:r.DefaultState,style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{}}),this.inGain=t.flowConnect.audioContext.createGain(),this.outGain=t.flowConnect.audioContext.createGain(),this.dryGain=t.flowConnect.audioContext.createGain(),this.wetGain=t.flowConnect.audioContext.createGain(),this.filter=t.flowConnect.audioContext.createBiquadFilter(),this.delay=t.flowConnect.audioContext.createDelay(10),this.feedbackNode=t.flowConnect.audioContext.createGain(),this.state.filterType="lowpass",this.delay.delayTime.value=this.state.delayTime/1e3,this.feedbackNode.gain.value=this.state.feedback,this.filter.frequency.value=this.state.cutoff,this.wetGain.gain.value=this.state.wet,this.dryGain.gain.value=this.state.dry,this.inputs[0].ref=this.inGain,this.outputs[0].ref=this.outGain,this.delay.connect(this.filter),this.filter.connect(this.feedbackNode),this.feedbackNode.connect(this.delay),this.feedbackNode.connect(this.wetGain),this.setBypass(),this.setupUI();let s=()=>this.delay.delayTime.value=this.state.delayTime/1e3;this.delaySlider.on("change",s),this.watch("delayTime",(()=>{(this.state.delayTime<10||this.state.delayTime>1e4)&&(this.state.delayTime=(0,a.clamp)(this.state.delayTime,10,1e4),s())}));let n=()=>this.feedbackNode.gain.setTargetAtTime(this.state.feedback,t.flowConnect.audioContext.currentTime,.01);this.feedbackSlider.on("change",n),this.watch("feedback",(()=>{(this.state.feedback<0||this.state.feedback>.9)&&(this.state.feedback=(0,a.clamp)(this.state.feedback,0,.9),n())}));let o=()=>this.filter.frequency.setTargetAtTime(this.state.cutoff,t.flowConnect.audioContext.currentTime,.01);this.cutoffSlider.on("change",o),this.watch("cutoff",(()=>{(this.state.cutoff<20||this.state.cutoff>2e4)&&(this.state.cutoff=(0,a.clamp)(this.state.cutoff,20,2e4),o())}));let h=()=>this.wetGain.gain.setTargetAtTime(this.state.wet,t.flowConnect.audioContext.currentTime,.01);this.wetSlider.on("change",h),this.watch("wet",(()=>{(this.state.wet<0||this.state.wet>1)&&(this.state.wet=(0,a.clamp)(this.state.wet,0,1),h())}));let u=()=>this.dryGain.gain.setTargetAtTime(this.state.dry,t.flowConnect.audioContext.currentTime,.01);this.drySlider.on("change",u),this.watch("dry",(()=>{(this.state.dry<0||this.state.dry>1)&&(this.state.dry=(0,a.clamp)(this.state.dry,0,1),u())})),this.watch("bypass",(()=>this.setBypass())),this.handleAudioConnections()}setBypass(){this.state.bypass?(this.inGain.disconnect(),this.wetGain.disconnect(),this.dryGain.disconnect(),this.inGain.connect(this.outGain)):(this.inGain.connect(this.delay),this.inGain.connect(this.dryGain),this.wetGain.connect(this.outGain),this.dryGain.connect(this.outGain))}setupUI(){let t=this.createToggle({propName:"bypass",style:{grow:.1}});this.delaySlider=this.createSlider(0,1e4,{height:10,propName:"delayTime",style:{grow:.5}});let e=this.createInput({propName:"delayTime",height:20,style:{type:o.InputType.Number,grow:.3,precision:0}});this.feedbackSlider=this.createSlider(0,.9,{height:10,propName:"feedback",style:{grow:.5}});let s=this.createInput({propName:"feedback",height:20,style:{type:o.InputType.Number,grow:.3,precision:2}});this.cutoffSlider=this.createSlider(20,2e4,{height:10,propName:"cutoff",style:{grow:.5}});let i=this.createInput({propName:"cutoff",height:20,style:{type:o.InputType.Number,grow:.3,precision:0}});this.wetSlider=this.createSlider(0,1,{height:10,propName:"wet",style:{grow:.5}});let a=this.createInput({propName:"wet",height:20,style:{type:o.InputType.Number,grow:.3,precision:2}});this.drySlider=this.createSlider(0,1,{height:10,propName:"dry",style:{grow:.5}});let n=this.createInput({propName:"dry",height:20,style:{type:o.InputType.Number,grow:.3,precision:2}});this.ui.append([this.createHozLayout([this.createLabel("Delay",{style:{grow:.3}}),this.delaySlider,e],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Feedback",{style:{grow:.3}}),this.feedbackSlider,s],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Cutoff",{style:{grow:.3}}),this.cutoffSlider,i],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Wet",{style:{grow:.3}}),this.wetSlider,a],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Dry",{style:{grow:.3}}),this.drySlider,n],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Bypass ?",{style:{grow:.3}}),t],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.DelayEffect=r,r.DefaultState={feedback:.45,cutoff:2e4,wet:.5,dry:1,delayTime:100,bypass:!1}},7751:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Destination=void 0;const i=s(7892),a=s(7055);class n extends a.Node{constructor(t,e={}){super(t,e.name||"Audio Destination",e.position||new i.Vector(50,50),e.width||160,[{name:"out",dataType:"audio"},{name:"gain",dataType:"audioparam"}],[],{state:e.state||{},style:e.style||{rowHeight:10,spacing:15},terminalStyle:e.terminalStyle||{}}),this.masterVolumeGainNode=t.flowConnect.audioContext.createGain(),this.inputs[0].ref=this.masterVolumeGainNode,this.inputs[0].ref.connect(t.flowConnect.audioContext.destination),this.inputs[1].ref=this.inputs[0].ref.gain,this.inputs[1].on("data",((t,e)=>"number"==typeof e&&(this.inputs[1].ref.value=e)))}}e.Destination=n},3547:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Distorter=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(8637);class r extends n.Node{constructor(t,e={}){super(t,e.name||"Distorter",e.position||new i.Vector(50,50),e.width||200,[{name:"in",dataType:"audio"}],[{name:"out",dataType:"audio"}],{style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{},state:e.state?{...r.DefaultState,...e.state}:r.DefaultState}),this.oversampleOptions=["none","2x","4x"],this.inGain=t.flowConnect.audioContext.createGain(),this.outGain=t.flowConnect.audioContext.createGain(),this.distorter=t.flowConnect.audioContext.createWaveShaper(),this.distorter.oversample="none",this.distorter.curve=this.makeDistortionCurve(400),this.inputs[0].ref=this.inGain,this.outputs[0].ref=this.outGain,this.setBypass(),this.setupUI(),this.watch("oversample",((t,e)=>{this.oversampleOptions.includes(e)||(this.state.oversample="none"),this.distorter.oversample=this.state.oversample})),this.watch("amount",((t,e)=>{(e<0||e>1e3)&&(this.state.amount=(0,a.clamp)(parseInt(e),0,1e3)),this.distorter.curve=this.makeDistortionCurve(parseInt(this.state.amount))})),this.watch("bypass",this.setBypass.bind(this)),this.handleAudioConnections()}makeDistortionCurve(t){let e,s="number"==typeof t?t:50,i=44100,a=new Float32Array(i),n=Math.PI/180,o=0;for(;o<i;++o)e=2*o/i-1,a[o]=(3+s)*e*20*n/(Math.PI+s*Math.abs(e));return a}setBypass(){this.state.bypass?(this.distorter.disconnect(),this.inGain.disconnect(),this.inGain.connect(this.outGain)):(this.inGain.disconnect(),this.inGain.connect(this.distorter),this.distorter.connect(this.outGain))}setupUI(){this.amountInput=this.createInput({propName:"amount",height:20,style:{grow:1,type:o.InputType.Number,precision:0}}),this.oversampleSelect=this.createSelect(this.oversampleOptions,{height:15,propName:"oversample",style:{grow:1}}),this.bypassToggle=this.createToggle({propName:"bypass",style:{grow:.15}}),this.ui.append([this.createHozLayout([this.createLabel("Amount"),this.amountInput],{style:{spacing:10}}),this.createHozLayout([this.createLabel("Oversample"),this.oversampleSelect],{style:{spacing:10}}),this.createHozLayout([this.createLabel("Bypass ?",{style:{grow:.3}}),this.bypassToggle],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.Distorter=r,r.DefaultState={oversample:"none",amount:50,bypass:!1}},1370:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DynamicsCompressor=void 0;const i=s(7892),a=s(974),n=s(7055);class o extends n.Node{constructor(t,e={}){super(t,e.name||"Dynamics Compressor",e.position||new i.Vector(50,50),e.width||230,[{name:"in",dataType:"audio"},{name:"threshold",dataType:"audioparam"},{name:"ratio",dataType:"audioparam"},{name:"knee",dataType:"audioparam"},{name:"attack",dataType:"audioparam"},{name:"release",dataType:"audioparam"}],[{name:"out",dataType:"audio"}],{state:e.state?{bypass:!1,...e.state}:{bypass:!1},style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{}}),this.inGain=t.flowConnect.audioContext.createGain(),this.outGain=t.flowConnect.audioContext.createGain(),this.compressor=t.flowConnect.audioContext.createDynamicsCompressor(),this.compressor.threshold.value=-20,this.compressor.ratio.value=4,this.compressor.knee.value=5,this.compressor.attack.value=.01,this.compressor.release.value=.12,this.inputs[0].ref=this.inGain,this.inputs[1].ref=this.compressor.threshold,this.inputs[2].ref=this.compressor.ratio,this.inputs[3].ref=this.compressor.knee,this.inputs[4].ref=this.compressor.attack,this.inputs[5].ref=this.compressor.release,this.outputs[0].ref=this.outGain,this.inputs[1].on("data",((t,e)=>"number"==typeof e&&(this.inputs[1].ref.value=(0,a.clamp)(e,-100,0)))),this.inputs[2].on("data",((t,e)=>"number"==typeof e&&(this.inputs[2].ref.value=(0,a.clamp)(e,1,20)))),this.inputs[3].on("data",((t,e)=>"number"==typeof e&&(this.inputs[3].ref.value=(0,a.clamp)(e,0,40)))),this.inputs[4].on("data",((t,e)=>"number"==typeof e&&(this.inputs[4].ref.value=(0,a.clamp)(e,0,1)))),this.inputs[5].on("data",((t,e)=>"number"==typeof e&&(this.inputs[5].ref.value=(0,a.clamp)(e,0,1)))),this.setBypass(),this.setupUI(),this.watch("bypass",(()=>this.setBypass())),this.handleAudioConnections()}setBypass(){this.state.bypass?(this.compressor.disconnect(),this.inGain.disconnect(),this.inGain.connect(this.outGain)):(this.inGain.disconnect(),this.inGain.connect(this.compressor),this.compressor.connect(this.outGain))}setupUI(){this.bypassToggle=this.createToggle({propName:"bypass",style:{grow:.1}}),this.ui.append([this.createHozLayout([this.createLabel("Bypass ?",{style:{grow:.3}}),this.bypassToggle],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.DynamicsCompressor=o},7959:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Equalizer=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(712);class r extends n.Node{constructor(t,e={}){super(t,e.name||"Equalizer",e.position||new i.Vector(50,50),e.width||300,[{name:"in",dataType:"audio"}],[{name:"out",dataType:"audio"}],{style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{},state:e.state?{...r.DefaultState,...e.state}:r.DefaultState}),this.vSliders=[],this.filters=[],this.frequencies=[32,64,125,250,500,1e3,2e3,4e3,8e3,16e3],this.freqDisplay=["32","64","125","250","500","1K","2K","4K","8K","16K"],this.inGain=t.flowConnect.audioContext.createGain(),this.outGain=t.flowConnect.audioContext.createGain(),this.frequencies.forEach(((e,s)=>{let i=t.flowConnect.audioContext.createBiquadFilter();i.frequency.value=e,i.type=0===s?"lowshelf":9===s?"highshelf":"peaking",this.filters.push(i)}));for(let t=1;t<10;++t)this.filters[t-1].connect(this.filters[t]);this.inputs[0].ref=this.inGain,this.outputs[0].ref=this.outGain,this.setBypass(),this.setupUI(),this.watch("bypass",this.setBypass.bind(this));for(let t=1;t<=10;++t)this.watch(`eq${t}`,((e,s)=>{(0,a.isInRange)(s,-40,40)||(this.state[`eq${t}`]=(0,a.clamp)(s,-40,40)),this.filters[t-1].gain.value=this.state[`eq${t}`]}));this.handleAudioConnections()}setBypass(){this.state.bypass?(this.inGain.disconnect(),this.filters[9].disconnect(),this.inGain.connect(this.outGain)):(this.inGain.disconnect(),this.inGain.connect(this.filters[0]),this.filters[9].connect(this.outGain))}setupUI(){let t=[];this.frequencies.forEach(((e,s)=>{let i=this.createVSlider(-40,40,{height:120,propName:`eq${s+1}`});this.vSliders.push(i);let a=this.createStack({childs:[this.createLabel(this.freqDisplay[s],{style:{align:o.Align.Center}}),i,this.createLabel(this.state[`eq${s+1}`],{propName:`eq${s+1}`,style:{align:o.Align.Center,precision:0}})],style:{grow:.1,spacing:5}});t.push(a)})),this.bypassToggle=this.createToggle({propName:"bypass",height:10,style:{grow:.1}}),this.ui.append([this.createHozLayout(t,{style:{spacing:5}}),this.createHozLayout([this.createLabel("Bypass ?"),this.bypassToggle],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.Equalizer=r,r.DefaultState={eq1:0,eq2:0,eq3:0,eq4:0,eq5:0,eq6:0,eq7:0,eq8:0,eq9:0,eq10:0,bypass:!1}},1907:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FrequencyAnalyser=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(712);class r extends n.Node{constructor(t,e={}){super(t,e.name||"Frequency Analyser",e.position||new i.Vector(50,50),e.width||350,[{name:"in",dataType:"audio"}],[{name:"out",dataType:"audio"}],{style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{},state:e.state?{...r.DefaultState,...e.state}:r.DefaultState}),this.fftSizes=[32,64,128,256,512,1024,2048,4096,8192,16384,32768],this.analyser=t.flowConnect.audioContext.createAnalyser(),this.analyser.fftSize=this.getFFTSize(),this.inputs[0].ref=this.outputs[0].ref=this.analyser,this.setupUI(),this.watch("fftSize",((t,e)=>{(e<5||e>15)&&(this.state.fftSize=(0,a.clamp)(Math.round(e),5,15));let s=this.getFFTSize();this.fftSizeLabel.text=s,this.analyser.fftSize=s})),this.display.on("over",((t,e)=>{this.state.currFreq=Math.floor(e.subtract(this.display.position.transform(this.flow.flowConnect.transform)).x/this.display.offCanvasConfigs[0].canvas.width*this.analyser.frequencyBinCount)*this.flow.flowConnect.audioContext.sampleRate/(2*this.analyser.frequencyBinCount)})),this.display.on("exit",(()=>this.state.currFreq=0)),this.handleAudioConnections()}getFFTSize(){return this.fftSizes[(0,a.clamp)(Math.round(this.state.fftSize),5,15)-5]}setupUI(){this.freqLabel=this.createLabel("Frequency:"),this.fftSizeSlider=this.createSlider(5,15,{height:10,propName:"fftSize",style:{grow:.6,precision:0}}),this.fftSizeLabel=this.createLabel(this.getFFTSize(),{height:20,style:{grow:.2,align:o.Align.Right}}),this.display=this.createDisplay(200,[{auto:!0,renderer:(...t)=>this.customRenderer(t[0],t[1],t[2])}]),this.ui.append([this.createHozLayout([this.freqLabel,this.createLabel(this.state.currFreq,{propName:"currFreq",style:{precision:0,grow:1}})],{style:{spacing:5}}),this.display,this.createHozLayout([this.createLabel("FFT Size",{style:{grow:.2}}),this.fftSizeSlider,this.fftSizeLabel],{style:{spacing:5}})])}customRenderer(t,e,s){let i,a,n,o,r=0,h=this.analyser.frequencyBinCount,u=new Uint8Array(h),l=s,c=e/h;for(this.analyser.getByteFrequencyData(u);r<h;r++)i=u[r],a=i/256,n=l-(s=l*a)-1,o=r/h*360,t.fillStyle="hsl("+o+", 100%, 50%)",t.fillRect(r*c,n,c,s);return!0}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.FrequencyAnalyser=r,r.DefaultState={fftSize:11,currFreq:0}},8544:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Gain=void 0;const i=s(7892),a=s(7055);class n extends a.Node{constructor(t,e={}){super(t,e.name||"Gain",e.position||new i.Vector(50,50),e.width||120,[{name:"in",dataType:"audio"},{name:"gain",dataType:"audioparam"}],[{name:"out",dataType:"audio"}],{state:e.state?{...n.DefaultState,...e.state}:n.DefaultState,style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.gain=t.flowConnect.audioContext.createGain(),this.inputs[0].ref=this.gain,this.outputs[0].ref=this.gain,this.inputs[1].ref=this.inputs[0].ref.gain,this.inputs[1].on("data",((t,e)=>"number"==typeof e&&(this.inputs[1].ref.value=e))),this.handleAudioConnections()}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.Gain=n,n.DefaultState={gain:1}},2328:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Metronome=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(6184),r=s(3612),h=s(8637);class u extends n.Node{constructor(t,e={}){super(t,e.name||"Metronome",e.position||new i.Vector(50,50),e.width||200,[{name:"trigger",dataType:"event"},{name:"gain",dataType:"audioparam"},{name:"detune",dataType:"audioparam"},{name:"playback-rate",dataType:"audioparam"}],[{name:"out",dataType:"audio"}],{state:e.state?{...u.DefaultState,...e.state}:u.DefaultState,style:e.style||{rowHeight:10,spacing:15},terminalStyle:e.terminalStyle||{}}),this.volumeGainNode=t.flowConnect.audioContext.createGain(),this.proxyParamSourceNode=new AudioWorkletNode(t.flowConnect.audioContext,"proxy-param-for-source",{numberOfOutputs:2,parameterData:{detune:0,playbackRate:1}}),this.inputs[1].ref=this.volumeGainNode.gain,this.inputs[2].ref=this.proxyParamSourceNode.parameters.get("detune"),this.inputs[3].ref=this.proxyParamSourceNode.parameters.get("playbackRate"),this.inputs[1].on("data",((t,e)=>"number"==typeof e&&(this.inputs[1].ref.value=e))),this.inputs[2].on("data",((t,e)=>"number"==typeof e&&(this.inputs[2].ref.value=e))),this.inputs[3].on("data",((t,e)=>"number"==typeof e&&(this.inputs[3].ref.value=e))),this.outputs[0].ref=this.volumeGainNode,this.fillBuffer(),this.setupUI(),this.bpmInput.on("change",(()=>{this.source&&(this.source.loopEnd=1/((0,a.clamp)(this.state.bpm,30,300)/60))})),this.freqInput.on("change",(()=>{this.source?(this.stopSource(),this.fillBuffer(),this.playSource()):this.fillBuffer()})),this.inputs[0].on("event",(()=>this.playSource())),t.flowConnect.on("start",(()=>this.state.auto&&this.playSource())),t.flowConnect.on("stop",(()=>this.stopSource())),this.handleAudioConnections()}fillBuffer(){let t=this.flow.flowConnect.audioContext,e=t.createBuffer(1,2*t.sampleRate,t.sampleRate),s=e.getChannelData(0),i=0,a=1,n=t.sampleRate/50;const o=this.state.frequency;for(let e=0;e<n;e++)s[e]=Math.sin(i)*a,i+=r.Constant.TAU*o/t.sampleRate,i>r.Constant.TAU&&(i-=r.Constant.TAU),a-=1/n;this.state.buffer=e}setupUI(){this.autoToggle=this.createToggle({propName:"auto",height:10,style:{grow:.2}}),this.freqInput=this.createInput({propName:"frequency",height:20,style:{type:h.InputType.Number,grow:.5}}),this.bpmInput=this.createInput({propName:"bpm",height:20,style:{type:h.InputType.Number,grow:.5}}),this.ui.append([this.createHozLayout([this.createLabel("Auto ?"),this.autoToggle],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Frequency"),this.freqInput,this.createLabel("BPM"),this.bpmInput],{style:{spacing:5}})])}playSource(){if(this.flow.flowConnect.state===o.FlowConnectState.Stopped||!this.state.buffer)return;let t=new AudioBufferSourceNode(this.flow.flowConnect.audioContext);t.buffer=this.state.buffer,t.loop=!0,this.source=t,t.loopEnd=1/((0,a.clamp)(this.state.bpm,30,300)/60),this.proxyParamSourceNode.connect(t.detune,0),this.proxyParamSourceNode.connect(t.playbackRate,1),t.connect(this.outputs[0].ref),t.start(0)}stopSource(){this.source&&(this.source.stop(),this.source=null)}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.Metronome=u,u.DefaultState={frequency:330,buffer:null,bpm:130,loop:!0,auto:!0}},3155:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Microphone=void 0;const i=s(6894),a=s(7892),n=s(7055),o=s(6645);class r extends n.Node{constructor(t,e={}){super(t,e.name||"Microphone",e.position||new a.Vector(50,50),e.width||120,[],[{name:"out",dataType:"audio"}],{style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{},state:e.state?{...r.DefaultState,...e.state}:r.DefaultState}),this.outGain=t.flowConnect.audioContext.createGain(),this.outputs[0].ref=this.outGain,this.flow.flowConnect.on("start",(()=>{this.stream?this.microphone.connect(this.outGain):this.getMicrophone().then((()=>{this.flow.state!==i.FlowState.Stopped&&this.microphone.connect(this.outGain)}),(t=>{o.Log.error("Cannot access microphone: ",t)})).catch((t=>o.Log.error(t)))})),this.flow.flowConnect.on("stop",(()=>this.microphone&&this.microphone.disconnect())),this.handleAudioConnections(),this.getMicrophone().then((()=>{}),(t=>{o.Log.error("Cannot access microphone: ",t)})).catch((t=>o.Log.error(t)))}async getMicrophone(){this.stream=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1}),this.microphone=this.flow.flowConnect.audioContext.createMediaStreamSource(this.stream)}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.Microphone=r,r.DefaultState={}},522:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MoogEffect=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(8637);class r extends n.Node{constructor(t,e={}){super(t,e.name||"Moog Effect",e.position||new i.Vector(50,50),e.width||230,[{name:"in",dataType:"audio"}],[{name:"out",dataType:"audio"}],{state:e.state?{...r.DefaultState,...e.state}:r.DefaultState,style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{}}),this.inGain=t.flowConnect.audioContext.createGain(),this.outGain=t.flowConnect.audioContext.createGain(),this.inputs[0].ref=this.inGain,this.outputs[0].ref=this.outGain,this.moog=new AudioWorkletNode(t.flowConnect.audioContext,"moog-effect",{numberOfInputs:1,numberOfOutputs:1,processorOptions:{bufferSize:4096}}),this.setBypass(),this.setupUI(),this.watch("bypass",(()=>this.setBypass())),this.watch("cutoff",(()=>{(this.state.cutoff<1e-4||this.state.cutoff>1)&&(this.state.cutoff=(0,a.clamp)(this.state.cutoff,1e-4,1)),this.paramsChanged()})),this.watch("resonance",(()=>{(this.state.resonance<0||this.state.resonance>4)&&(this.state.resonance=(0,a.clamp)(this.state.resonance,0,4)),this.paramsChanged()})),t.flowConnect.on("start",(()=>this.paramsChanged())),this.handleAudioConnections()}paramsChanged(){this.moog.port.postMessage({cutoff:this.state.cutoff,resonance:this.state.resonance})}setBypass(){this.state.bypass?(this.moog.disconnect(),this.inGain.disconnect(),this.inGain.connect(this.outGain)):(this.inGain.disconnect(),this.inGain.connect(this.moog),this.moog.connect(this.outGain))}setupUI(){this.cutoffSlider=this.createSlider(1e-4,1,{height:10,propName:"cutoff",style:{grow:.5}}),this.resonanceSlider=this.createSlider(0,4,{height:10,propName:"resonance",style:{grow:.5}});let t=this.createInput({propName:"cutoff",height:20,style:{type:o.InputType.Number,grow:.2,precision:2}}),e=this.createInput({propName:"resonance",height:20,style:{type:o.InputType.Number,grow:.4,precision:2}});this.bypassToggle=this.createToggle({propName:"bypass",style:{grow:.1}}),this.ui.append([this.createHozLayout([this.createLabel("Cutoff",{style:{grow:.3}}),this.cutoffSlider,t],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Resonance",{style:{grow:.3}}),this.resonanceSlider,e],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Bypass ?",{style:{grow:.3}}),this.bypassToggle],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.MoogEffect=r,r.DefaultState={cutoff:.065,resonance:3.5,bypass:!1}},9668:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Noise=void 0;const i=s(7892),a=s(7055);class n extends a.Node{constructor(t,e={}){super(t,e.name||"Noise",e.position||new i.Vector(50,50),e.width||170,[],[{name:"out",dataType:"audio"}],{style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{},state:e.state?{...n.DefaultState,...e.state}:n.DefaultState}),this.outGain=t.flowConnect.audioContext.createGain(),this.outputs[0].ref=this.outGain,this.noise=new AudioWorkletNode(t.flowConnect.audioContext,"noise",{channelCount:1,channelCountMode:"explicit",outputChannelCount:[1],numberOfInputs:1,numberOfOutputs:1}),this.noise.port.postMessage(this.state.type),this.setupUI(),this.watch("type",((t,e)=>{this.noiseSelect.values.includes(e)||(e="white"),this.noise.port.postMessage(e)})),this.handleAudioConnections(),this.flow.flowConnect.on("start",(()=>{this.noise.connect(this.outGain)})),this.flow.flowConnect.on("stop",(()=>{this.noise.disconnect()}))}setupUI(){this.noiseSelect=this.createSelect(["white","pink","brownian"],{height:15,propName:"type",style:{grow:.7}}),this.ui.append([this.createHozLayout([this.createLabel("Type",{style:{grow:.3}}),this.noiseSelect],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.Noise=n,n.DefaultState={type:"white"}},6846:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Oscillator=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(8637);class r extends n.Node{constructor(t,e={}){super(t,e.name||"Oscillator",e.position||new i.Vector(50,50),e.width||250,[],[{name:"out",dataType:"audio"}],{style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{},state:e.state?{...r.DefaultState,...e.state}:r.DefaultState}),this.types=["sine","square","sawtooth","triangle"],this.freqProxy=new AudioWorkletNode(t.flowConnect.audioContext,"proxy"),this.detuneProxy=new AudioWorkletNode(t.flowConnect.audioContext,"proxy"),this.outGain=t.flowConnect.audioContext.createGain(),this.setupUI(),this.inputsUI[0].ref=this.freqProxy,this.inputsUI[1].ref=this.detuneProxy,this.inputsUI[0].dataType="audioparam",this.inputsUI[1].dataType="audioparam",this.outputs[0].ref=this.outGain,this.inputsUI[0].on("data",((t,e)=>"number"==typeof e&&(this.state.frequency=e))),this.inputsUI[1].on("data",((t,e)=>"number"==typeof e&&(this.state.detune=e))),this.watch("frequency",((t,e)=>{(e<0||e>2e4)&&(e=(0,a.clamp)(e,0,2e4)),this.freqHozLayout.disabled||this.oscillator&&(this.oscillator.frequency.value=e)})),this.watch("detune",((t,e)=>{this.detuneHozLayout.disabled||this.oscillator&&(this.oscillator.detune.value=e)})),this.watch("type",((t,e)=>{this.types.includes(e)&&this.oscillator&&(this.oscillator.type=e)})),this.flow.flowConnect.on("start",(()=>this.startOscillator())),this.flow.flowConnect.on("stop",(()=>this.stopOscillator())),this.handleAudioConnections()}startOscillator(){this.stopOscillator(),this.oscillator=this.flow.flowConnect.audioContext.createOscillator(),this.inputsUI[0].isConnected()?(this.freqProxy.connect(this.oscillator.frequency),this.oscillator.frequency.value=0):this.oscillator.frequency.value=this.state.frequency,this.inputsUI[1].isConnected()?(this.detuneProxy.connect(this.oscillator.detune),this.oscillator.detune.value=0):this.oscillator.detune.value=this.state.detune,this.oscillator.type=this.state.type,this.oscillator.connect(this.outGain),this.oscillator.start()}stopOscillator(){this.oscillator&&(this.freqProxy.disconnect(),this.detuneProxy.disconnect(),this.oscillator.disconnect(),this.oscillator.stop(),this.oscillator=null)}setupUI(){this.freqSlider=this.createSlider(0,2e4,{height:10,propName:"frequency",style:{grow:.5}}),this.freqInput=this.createInput({propName:"frequency",height:20,style:{type:o.InputType.Number,grow:.3,precision:0}}),this.freqHozLayout=this.createHozLayout([this.createLabel("Freq.",{style:{grow:.2}}),this.freqSlider,this.freqInput],{input:!0,style:{spacing:5}}),this.detuneSlider=this.createSlider(-2400,2400,{height:10,propName:"detune",style:{grow:.5}}),this.detuneInput=this.createInput({propName:"detune",height:20,style:{type:o.InputType.Number,grow:.3,precision:0}}),this.detuneHozLayout=this.createHozLayout([this.createLabel("Detune",{style:{grow:.2}}),this.detuneSlider,this.detuneInput],{input:!0,style:{spacing:5}}),this.typeGroup=this.createRadioGroup(this.types,this.state.type,{propName:"type",height:20}),this.ui.append([this.freqHozLayout,this.detuneHozLayout,this.typeGroup])}handleAudioConnections(){this.inputsUI[0].on("connect",(()=>{this.oscillator&&(this.freqProxy.connect(this.oscillator.frequency),this.oscillator.frequency.value=0)})),this.inputsUI[0].on("disconnect",(()=>{this.oscillator&&(this.freqProxy.disconnect(),this.oscillator.frequency.value=this.state.frequency)})),this.inputsUI[1].on("connect",(()=>{this.oscillator&&(this.detuneProxy.connect(this.oscillator.detune),this.oscillator.detune.value=0)})),this.inputsUI[1].on("disconnect",(()=>{this.oscillator&&(this.detuneProxy.disconnect(),this.oscillator.detune.value=this.state.detune)})),this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.Oscillator=r,r.DefaultState={frequency:440,detune:0,type:"sine"}},7737:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OverdriveEffect=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(8637);let r=s(1252);class h extends n.Node{constructor(t,e={}){super(t,e.name||"Overdrive Effect",e.position||new i.Vector(50,50),e.width||230,[{name:"in",dataType:"audio"}],[{name:"out",dataType:"audio"}],{style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{},state:e.state?{...h.DefaultState,...e.state}:h.DefaultState}),window.__tuna__||(window.__tuna__=new r(t.flowConnect.audioContext)),this.overdrive=new window.__tuna__.Overdrive,this.inputs[0].ref=this.outputs[0].ref=this.overdrive,this.setupUI(),Object.assign(this.overdrive,{drive:this.state.drive,outputGain:this.state.outGain,curveAmount:this.state.curveAmount,algorithmIndex:parseInt(this.state.algorithm)-1}),this.watch("drive",((t,e)=>{(e<0||e>1)&&(this.state.drive=(0,a.clamp)(e,0,1)),this.overdrive.drive=this.state.drive})),this.watch("outGain",((t,e)=>{(e<-46||e>0)&&(this.state.outGain=(0,a.clamp)(e,-46,0)),this.overdrive.outputGain=this.state.outGain})),this.watch("curveAmount",((t,e)=>{(e<0||e>1)&&(this.state.curveAmount=(0,a.clamp)(e,0,1)),this.overdrive.curveAmount=this.state.curveAmount})),this.watch("algorithm",((t,e)=>{(e=parseInt(e))||(e=1),(e<1||e>6)&&(e=(0,a.clamp)(e,1,6)),this.overdrive.algorithmIndex=e-1})),this.watch("bypass",((t,e)=>this.overdrive.bypass=e)),this.handleAudioConnections()}setupUI(){this.driveSlider=this.createSlider(0,1,{height:10,propName:"drive",style:{grow:.5}}),this.driveInput=this.createInput({propName:"drive",height:20,style:{type:o.InputType.Number,grow:.2,precision:4}}),this.outGainSlider=this.createSlider(-46,0,{height:10,propName:"outGain",style:{grow:.5}}),this.outGainInput=this.createInput({propName:"outGain",height:20,style:{type:o.InputType.Number,grow:.2,precision:2}}),this.curveAmountSlider=this.createSlider(0,.95,{height:10,propName:"curveAmount",style:{grow:.5}}),this.curveAmountInput=this.createInput({propName:"curveAmount",height:20,style:{type:o.InputType.Number,grow:.2,precision:2}}),this.algorithmSelect=this.createSelect(["1","2","3","4","5","6"],{propName:"algorithm",height:20,style:{grow:.7}}),this.bypassToggle=this.createToggle({propName:"bypass",style:{grow:.1}}),this.ui.append([this.createHozLayout([this.createLabel("Drive",{style:{grow:.3}}),this.driveSlider,this.driveInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Output Gain",{style:{grow:.3}}),this.outGainSlider,this.outGainInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Curve Amount",{style:{grow:.3}}),this.curveAmountSlider,this.curveAmountInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Algorithm",{style:{grow:.3}}),this.algorithmSelect],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Bypass ?",{style:{grow:.3}}),this.bypassToggle],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.OverdriveEffect=h,h.DefaultState={drive:.197,outGain:-9.154,curveAmount:.979,algorithm:1,bypass:!1}},1923:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PingPongEffect=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(8637);let r=s(1252);class h extends n.Node{constructor(t,e={}){super(t,e.name||"PingPong Effect",e.position||new i.Vector(50,50),e.width||230,[{name:"in",dataType:"audio"}],[{name:"out",dataType:"audio"}],{style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{},state:e.state?{...h.DefaultState,...e.state}:h.DefaultState}),window.__tuna__||(window.__tuna__=new r(t.flowConnect.audioContext)),this.pingPong=new window.__tuna__.PingPongDelay,this.inputs[0].ref=this.outputs[0].ref=this.pingPong,Object.assign(this.pingPong,{delayTimeLeft:this.state.delayLeft,delayTimeRight:this.state.delayRight,feedback:this.state.feedback,wetLevel:this.state.wet}),this.setupUI(),this.watch("delayLeft",((t,e)=>{(e<1||e>1e4)&&(this.state.delayLeft=(0,a.clamp)(e,1,1e4)),this.pingPong.delayTimeLeft=this.state.delayLeft})),this.watch("delayRight",((t,e)=>{(e<1||e>1e4)&&(this.state.delayRight=(0,a.clamp)(e,1,1e4)),this.pingPong.delayTimeRight=this.state.delayRight})),this.watch("feedback",((t,e)=>{(e<0||e>1)&&(this.state.feedback=(0,a.clamp)(e,0,1)),this.pingPong.feedback=this.state.feedback})),this.watch("wet",((t,e)=>{(e<0||e>1)&&(this.state.wet=(0,a.clamp)(e,0,1)),this.pingPong.wetLevel=this.state.wet})),this.watch("bypass",((t,e)=>this.pingPong.bypass=e)),this.handleAudioConnections()}setupUI(){this.delayLeftSlider=this.createSlider(1,1e4,{height:10,propName:"delayLeft",style:{grow:.5}}),this.delayLeftInput=this.createInput({propName:"delayLeft",height:20,style:{type:o.InputType.Number,grow:.2,precision:4}}),this.delayRightSlider=this.createSlider(1,1e4,{height:10,propName:"delayRight",style:{grow:.5}}),this.delayRightInput=this.createInput({propName:"delayRight",height:20,style:{type:o.InputType.Number,grow:.2,precision:2}}),this.feedbackSlider=this.createSlider(0,1,{height:10,propName:"feedback",style:{grow:.5}}),this.feedbackInput=this.createInput({propName:"feedback",height:20,style:{type:o.InputType.Number,grow:.2,precision:2}}),this.wetSlider=this.createSlider(0,1,{height:10,propName:"wet",style:{grow:.5}}),this.wetInput=this.createInput({propName:"wet",height:20,style:{type:o.InputType.Number,grow:.2,precision:2}}),this.bypassToggle=this.createToggle({propName:"bypass",style:{grow:.1}}),this.ui.append([this.createHozLayout([this.createLabel("Delay L",{style:{grow:.3}}),this.delayLeftSlider,this.delayLeftInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Delay R",{style:{grow:.3}}),this.delayRightSlider,this.delayRightInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Feedback",{style:{grow:.3}}),this.feedbackSlider,this.feedbackInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Wet",{style:{grow:.3}}),this.wetSlider,this.wetInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Bypass ?",{style:{grow:.3}}),this.bypassToggle],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.PingPongEffect=h,h.DefaultState={delayLeft:200,delayRight:400,feedback:.3,wet:.5,bypass:!1}},9197:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Source=void 0;const i=s(7892),a=s(6184),n=s(6645),o=s(7055);class r extends o.Node{constructor(t,e={}){super(t,e.name||"Audio Source",e.position||new i.Vector(50,50),e.width||200,[{name:"array-buffer",dataType:"event"},{name:"gain",dataType:"audioparam"},{name:"detune",dataType:"audioparam"},{name:"playback-rate",dataType:"audioparam"}],[{name:"out",dataType:"audio"},{name:"ended",dataType:"event"}],{state:e.state?{...r.DefaultState,...e.state}:r.DefaultState,style:e.style||{rowHeight:10,spacing:15},terminalStyle:e.terminalStyle||{}}),this.volumeGainNode=t.flowConnect.audioContext.createGain(),this.proxyParamSourceNode=new AudioWorkletNode(t.flowConnect.audioContext,"proxy-param-for-source",{numberOfOutputs:2,parameterData:{detune:0,playbackRate:1}}),this.inputs[1].ref=this.volumeGainNode.gain,this.inputs[2].ref=this.proxyParamSourceNode.parameters.get("detune"),this.inputs[3].ref=this.proxyParamSourceNode.parameters.get("playbackRate"),this.inputs[1].on("data",((t,e)=>"number"==typeof e&&(this.inputs[1].ref.value=e))),this.inputs[2].on("data",((t,e)=>"number"==typeof e&&(this.inputs[2].ref.value=e))),this.inputs[3].on("data",((t,e)=>"number"==typeof e&&(this.inputs[3].ref.value=e))),this.outputs[0].ref=this.volumeGainNode,this.setupUI(),this.loopToggle.on("change",(()=>{this.state.loop?(this.stopSource(),this.playSource()):this.source&&(this.source.loop=this.state.loop)})),this.inputs[0].on("event",((t,e)=>{e instanceof ArrayBuffer?this.processArrayBuffer(e):n.Log.error("Data received on Audio Source Node is not of type ArrayBuffer")})),this.fileInput.on("change",((t,e,s)=>this.processFile(s))),this.fileInput.on("upload",((t,e,s)=>this.processFile(s))),t.flowConnect.on("start",(()=>this.playSource())),t.flowConnect.on("stop",(()=>this.stopSource())),this.handleAudioConnections()}propagateChannelChange(t){this.flow.executionGraph.propagate(this,(e=>{e.call("channel-count-change",t)}))}async processFile(t){let e=this.flow.flowConnect.arrayBufferCache.get(t.name+t.type);e||(e=await t.arrayBuffer(),this.flow.flowConnect.arrayBufferCache.set(t.name+t.type,e)),this.processArrayBuffer(e)}async processArrayBuffer(t){let e=this.flow.flowConnect.audioBufferCache.get(t);e||(e=await this.flow.flowConnect.audioContext.decodeAudioData(t),this.flow.flowConnect.audioBufferCache.set(t,e),(this.state.prevChannelCount<0||this.state.prevChannelCount!==e.numberOfChannels)&&this.propagateChannelChange(e.numberOfChannels),this.state.prevChannelCount=e.numberOfChannels),this.state.buffer=e,this.stopSource(),this.playSource()}playSource(){if(this.flow.flowConnect.state===a.FlowConnectState.Stopped||!this.state.buffer)return;let t=new AudioBufferSourceNode(this.flow.flowConnect.audioContext);t.buffer=this.state.buffer,t.loop=this.state.loop,this.source=t,this.proxyParamSourceNode.connect(t.detune,0),this.proxyParamSourceNode.connect(t.playbackRate,1),t.connect(this.outputs[0].ref),t.start()}stopSource(){this.source&&(this.source.stop(),this.source=null)}setupUI(){this.fileInput=this.createSource({input:!0,output:!0,height:25,style:{grow:.7}}),this.loopToggle=this.createToggle({propName:"loop",input:!0,output:!0,height:10,style:{grow:.2}}),this.ui.append([this.createHozLayout([this.createLabel("File",{style:{grow:.3}}),this.fileInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Loop ?"),this.loopToggle],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>{this.state.buffer&&this.propagateChannelChange(this.state.buffer.numberOfChannels),this.outputs[0].ref.connect(e.end.ref)})),this.outputs[0].on("disconnect",((t,e,s,i)=>{this.outputs[0].ref.disconnect(i.ref)}))}}e.Source=r,r.DefaultState={buffer:null,loop:!0,prevChannelCount:-1}},1462:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpectrogramAnalyser=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(712),r=s(1278),h=s(8637);class u extends n.Node{constructor(t,e={}){super(t,e.name||"Spectrogram Analyser",e.position||new i.Vector(50,50),e.width||350,[{name:"in",dataType:"audio"}],[{name:"out",dataType:"audio"}],{style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{},state:e.state?{...u.DefaultState,...e.state}:u.DefaultState}),this.colorScales=["Heated Metal","Monochrome","Inverted Monochrome","Spectrum"],this.fftSizes=[32,64,128,256,512,1024,2048,4096,8192,16384,32768],this.colorScaleToInterp={},this.analyser=t.flowConnect.audioContext.createAnalyser(),this.analyser.fftSize=this.getFFTSize(),this.inputs[0].ref=this.outputs[0].ref=this.analyser,this.setupUI(),this.watch("fftSize",((t,e)=>{(e<5||e>15)&&(this.state.fftSize=(0,a.clamp)(Math.round(e),5,15));let s=this.getFFTSize();this.fftSizeLabel.text=s,this.analyser.fftSize=s})),this.watch("colorScale",((t,e)=>{this.colorScales.includes(e)||(this.state.colorScale=this.colorScales[0]),this.currInterpolator=this.colorScaleToInterp[this.state.colorScale]})),this.handleAudioConnections(),this.colorScaleToInterp["Heated Metal"]=r.Color.scale([[0,0,0,1],[160,32,240,1],[255,0,0,1],[255,165,0,1],[255,255,0,1],[255,255,255,1]]),this.colorScaleToInterp.Monochrome=r.Color.scale([[0,0,0,1],[255,255,255,1]]),this.colorScaleToInterp["Inverted Monochrome"]=r.Color.scale([[255,255,255,1],[0,0,0,1]]),this.colorScaleToInterp.Spectrum=r.Color.scale([[135,206,235,1],[0,255,0,1],[255,255,0,1],[255,165,0,1],[255,0,0,1]]),this.currInterpolator=this.colorScaleToInterp["Heated Metal"],this.display.offCanvasConfigs[0].shouldRender=!1,this.flow.flowConnect.on("start",(()=>{this.display.offCanvasConfigs[0].shouldRender=!0})),this.flow.flowConnect.on("stop",(()=>{this.display.offCanvasConfigs[0].shouldRender=!1}))}getFFTSize(){return this.fftSizes[(0,a.clamp)(Math.round(this.state.fftSize),5,15)-5]}setupUI(){this.fftSizeSlider=this.createSlider(5,15,{height:10,propName:"fftSize",style:{grow:.6,precision:0}}),this.fftSizeLabel=this.createLabel(this.getFFTSize(),{height:20,style:{grow:.2,align:o.Align.Right}}),this.display=this.createDisplay(200,[{auto:!0,canvasType:h.CanvasType.HTMLCanvasElement,renderer:(t,e,s)=>this.customRenderer(t,e,s)}]),this.colorScaleSelect=this.createSelect(this.colorScales,{propName:"colorScale",height:15,style:{grow:.6}}),this.ui.append([this.display,this.createHozLayout([this.createLabel("FFT Size",{style:{grow:.2}}),this.fftSizeSlider,this.fftSizeLabel],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Color Scale",{style:{grow:.2}}),this.colorScaleSelect],{style:{spacing:5}})])}customRenderer(t,e,s){let i,n=0,o=this.analyser.frequencyBinCount,r=new Uint8Array(o),h=s/o;for(this.analyser.getByteFrequencyData(r);n<o;n++)i=r[n],t.fillStyle=this.currInterpolator(i/256),t.fillRect(e-1,(0,a.denormalize)(1-(0,a.normalize)(n,0,o),0,s),1,h);return t.globalCompositeOperation="copy",t.drawImage(t.canvas,-1,0),t.globalCompositeOperation="source-over",!0}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.SpectrogramAnalyser=u,u.DefaultState={fftSize:11,colorScale:"Heated Metal"}},4537:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StereoPanner=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(8637);class r extends n.Node{constructor(t,e={}){super(t,e.name||"Stereo Panner",e.position||new i.Vector(50,50),e.width||200,[{name:"in",dataType:"audio"}],[{name:"out",dataType:"audio"}],{style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{},state:e.state?{...r.DefaultState,...e.state}:r.DefaultState}),this.inGain=t.flowConnect.audioContext.createGain(),this.outGain=t.flowConnect.audioContext.createGain(),this.panner=new StereoPannerNode(t.flowConnect.audioContext),this.panner.pan.value=this.state.pan,this.inputs[0].ref=this.inGain,this.outputs[0].ref=this.outGain,this.setBypass(),this.setupUI(),this.watch("pan",((t,e)=>{(e<-1||e>1)&&(this.state.pan=(0,a.clamp)(e,-1,1)),this.panner.pan.value=this.state.pan})),this.watch("bypass",this.setBypass.bind(this)),this.handleAudioConnections()}setBypass(){this.state.bypass?(this.panner.disconnect(),this.inGain.disconnect(),this.inGain.connect(this.outGain)):(this.inGain.disconnect(),this.inGain.connect(this.panner),this.panner.connect(this.outGain))}setupUI(){this.panSlider=this.createSlider(-1,1,{height:10,propName:"pan",style:{grow:.5}}),this.panInput=this.createInput({propName:"pan",height:20,style:{type:o.InputType.Number,grow:.2,precision:2}}),this.bypassToggle=this.createToggle({propName:"bypass",style:{grow:.15}}),this.ui.append([this.createHozLayout([this.createLabel("Pan",{style:{grow:.3}}),this.panSlider,this.panInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Bypass ?",{style:{grow:.3}}),this.bypassToggle],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.StereoPanner=r,r.DefaultState={pan:0,bypass:!1}},1094:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TremoloEffect=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(8637);let r=s(1252);class h extends n.Node{constructor(t,e={}){super(t,e.name||"Tremolo Effect",e.position||new i.Vector(50,50),e.width||230,[{name:"in",dataType:"audio"}],[{name:"out",dataType:"audio"}],{style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{},state:e.state?{...h.DefaultState,...e.state}:h.DefaultState}),window.__tuna__||(window.__tuna__=new r(t.flowConnect.audioContext)),this.tremolo=new window.__tuna__.Tremolo,this.inputs[0].ref=this.outputs[0].ref=this.tremolo,Object.assign(this.tremolo,{intensity:this.state.intensity,stereoPhase:this.state.stereoPhase,rate:this.state.rate}),this.setupUI(),this.watch("intensity",((t,e)=>{(e<0||e>1)&&(this.state.intensity=(0,a.clamp)(e,0,1)),this.tremolo.intensity=this.state.intensity})),this.watch("stereoPhase",((t,e)=>{(e<0||e>180)&&(this.state.stereoPhase=(0,a.clamp)(e,0,180)),this.tremolo.stereoPhase=this.state.stereoPhase})),this.watch("rate",((t,e)=>{(e<.1||e>11)&&(this.state.rate=(0,a.clamp)(e,.1,11)),this.tremolo.rate=this.state.rate})),this.watch("bypass",((t,e)=>this.tremolo.bypass=e)),this.handleAudioConnections()}setupUI(){this.intensitySlider=this.createSlider(0,1,{height:10,propName:"intensity",style:{grow:.5}}),this.intensityInput=this.createInput({propName:"intensity",height:20,style:{type:o.InputType.Number,grow:.2,precision:4}}),this.stereoPhaseSlider=this.createSlider(0,180,{height:10,propName:"stereoPhase",style:{grow:.5}}),this.stereoPhaseInput=this.createInput({propName:"stereoPhase",height:20,style:{type:o.InputType.Number,grow:.2,precision:2}}),this.rateSlider=this.createSlider(.1,11,{height:10,propName:"rate",style:{grow:.5}}),this.rateInput=this.createInput({propName:"rate",height:20,style:{type:o.InputType.Number,grow:.2,precision:2}}),this.bypassToggle=this.createToggle({propName:"bypass",style:{grow:.1}}),this.ui.append([this.createHozLayout([this.createLabel("Intensity",{style:{grow:.3}}),this.intensitySlider,this.intensityInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Stereo Phase",{style:{grow:.3}}),this.stereoPhaseSlider,this.stereoPhaseInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Rate",{style:{grow:.3}}),this.rateSlider,this.rateInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Bypass ?",{style:{grow:.3}}),this.bypassToggle],{style:{spacing:5}})])}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.TremoloEffect=h,h.DefaultState={intensity:.3,stereoPhase:0,rate:5,bypass:!1}},1457:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WaveformAnalyser=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(712);class r extends n.Node{constructor(t,e={}){super(t,e.name||"Waveform Analyser",e.position||new i.Vector(50,50),e.width||350,[{name:"in",dataType:"audio"}],[{name:"out",dataType:"audio"}],{style:e.style||{rowHeight:10,spacing:10},terminalStyle:e.terminalStyle||{},state:e.state?{...r.DefaultState,...e.state}:r.DefaultState}),this.fftSizes=[32,64,128,256,512,1024,2048,4096,8192,16384,32768],this.analyser=t.flowConnect.audioContext.createAnalyser(),this.analyser.fftSize=this.getFFTSize(),this.inputs[0].ref=this.outputs[0].ref=this.analyser,this.setupUI(),this.watch("fftSize",((t,e)=>{(e<5||e>15)&&(this.state.fftSize=(0,a.clamp)(Math.round(e),5,15));let s=this.getFFTSize();this.fftSizeLabel.text=s,this.analyser.fftSize=s})),this.handleAudioConnections()}getFFTSize(){return this.fftSizes[(0,a.clamp)(Math.round(this.state.fftSize),5,15)-5]}setupUI(){this.fftSizeSlider=this.createSlider(5,15,{height:10,propName:"fftSize",style:{grow:.6,precision:0}}),this.fftSizeLabel=this.createLabel(this.getFFTSize(),{height:20,style:{grow:.2,align:o.Align.Right}}),this.display=this.createDisplay(200,[{auto:!0,renderer:(...t)=>this.customRenderer(t[0],t[1],t[2])}]),this.ui.append([this.display,this.createHozLayout([this.createLabel("FFT Size",{style:{grow:.2}}),this.fftSizeSlider,this.fftSizeLabel],{style:{spacing:5}})])}customRenderer(t,e,s){let i,a,n,o,r=this.analyser.frequencyBinCount,h=new Uint8Array(r),u=s,l=1;for(this.analyser.getByteTimeDomainData(h),i=h[0],a=i/256,n=u-(s=u*a)-1,o=e/r,t.strokeStyle="#000",t.beginPath(),t.moveTo(0,n);l<r;l++)i=h[l],a=i/256,n=u-(s=u*a)-1,o=e/r,t.lineTo(l*o,n);return t.stroke(),!0}handleAudioConnections(){this.outputs[0].on("connect",((t,e)=>this.outputs[0].ref.connect(e.end.ref))),this.outputs[0].on("disconnect",((t,e,s,i)=>this.outputs[0].ref.disconnect(i.ref)))}}e.WaveformAnalyser=r,r.DefaultState={fftSize:11}},9322:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ArrayIndex=void 0;const i=s(7892),a=s(7055);class n extends a.Node{constructor(t,e={}){super(t,e.name||"Array Index",e.position||new i.Vector(50,50),e.width||120,[{name:"data",dataType:"array"},{name:"index",dataType:"number"}],[{name:"value",dataType:"any"}],{state:e.state?{...e.state}:{},style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.on("process",((t,e)=>{e&&e[0]&&"number"==typeof e[1]&&this.setOutputs(0,e[0][e[1]])}))}}e.ArrayIndex=n},3161:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ArraySource=void 0;const i=s(7892),a=s(7055),n=s(712),o=s(8637);class r extends a.Node{constructor(t,e={}){super(t,e.name||"Array Source",e.position||new i.Vector(50,50),e.width||180,[],[{name:"array",dataType:"array"}],{state:e.state?{...r.DefaultState,...e.state}:r.DefaultState,style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.setupUI(),this.minInput.on("change",(()=>this.process())),this.maxInput.on("change",(()=>this.process())),this.numberToggle.on("change",(()=>this.process())),this.arrayInput.on("change",(()=>this.process())),this.stepInput.on("change",(()=>this.process())),this.on("process",(()=>this.process())),this.watch("number",(()=>this.numberToggled())),this.watch("range",(()=>this.rangeToggled())),this.numberToggled(),this.rangeToggled()}numberToggled(){this.rangeLayout.visible=this.state.number,this.state.number||(this.state.range=!1)}rangeToggled(){this.state.number&&this.state.range?(this.arrayInput.visible=!1,this.rangeStack.visible=!0):(this.arrayInput.visible=!0,this.rangeStack.visible=!1)}process(){if(this.state.range){let t=[];for(let e=this.state.min;e<=this.state.max;e+=this.state.step)t.push(e);this.state.value=t}else if(!this.arrayInput.inputEl.validity.patternMismatch){if(!this.arrayInput.value||""===this.arrayInput.value)return;let t=this.arrayInput.value.split(",");this.state.number&&(t=t.map((t=>Number(t.trim())))),this.state.value=t}this.setOutputs(0,this.state.value)}setupUI(){this.numberToggle=this.createToggle({propName:"number",input:!0,output:!0,height:10,style:{grow:.2}}),this.rangeToggle=this.createToggle({propName:"range",input:!0,output:!0,height:10,style:{grow:.2}}),this.rangeLayout=this.createHozLayout([this.createLabel("Range ?",{style:{grow:.4}}),this.rangeToggle],{style:{spacing:10}}),this.minInput=this.createInput({propName:"min",height:20,style:{type:o.InputType.Number,grow:.4,step:"any"}}),this.maxInput=this.createInput({propName:"max",height:20,style:{type:o.InputType.Number,grow:.4,step:"any"}});let t=this.createHozLayout([this.minInput,this.createLabel("to",{style:{grow:.2,align:n.Align.Center}}),this.maxInput],{style:{spacing:5}});this.stepInput=this.createInput({propName:"step",height:20,style:{type:o.InputType.Number,step:"any",grow:.6}}),this.rangeStack=this.createStack({childs:[t,this.createHozLayout([this.createLabel("Step",{style:{grow:.4}}),this.stepInput],{style:{spacing:5}})],style:{spacing:10}}),this.arrayInput=this.createInput({value:"",height:20,style:{pattern:"^[^,]+(s*,s*[^,]+)*$"}}),this.ui.append([this.createHozLayout([this.createLabel("Numbers ?",{style:{grow:.4}}),this.numberToggle],{style:{spacing:10}}),this.rangeLayout,this.rangeStack,this.arrayInput])}}e.ArraySource=r,r.DefaultState={number:!0,range:!1,min:0,max:100,step:.1,value:[]}},5527:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BooleanSource=void 0;const i=s(7892),a=s(7055);class n extends a.Node{constructor(t,e={}){super(t,e.name||"Boolean Source",e.position||new i.Vector(50,50),e.width||130,[],[{name:"value",dataType:"boolean"}],{state:e.state?{...n.DefaultState,...e.state}:n.DefaultState,style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.setupUI(),this.toggle.on("change",(()=>this.process())),this.on("process",(()=>this.process()))}process(){this.setOutputs(0,this.state.value)}setupUI(){this.toggle=this.createToggle({propName:"value",input:!0,output:!0,height:10,style:{grow:.4}}),this.ui.append(this.createHozLayout([this.createLabel("Value"),this.toggle],{style:{spacing:20}}))}}e.BooleanSource=n,n.DefaultState={value:!1}},3528:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Buffer=void 0;const i=s(7892),a=s(7055),n=s(8637);class o extends a.Node{constructor(t,e={}){super(t,e.name||"Buffer",e.position||new i.Vector(50,50),e.width||150,[{name:"data",dataType:"any"}],[{name:"buffer",dataType:"array"}],{state:e.state?{buffer:[],size:10,...e.state}:{buffer:[],size:10},style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.setupUI(),this.sizeInput.on("change",(()=>this.process(this.getInputs()))),this.on("process",((t,e)=>this.process(e)))}process(t){null!==t[0]&&void 0!==t[0]&&(this.state.size<=0&&(this.state.size=1),this.state.buffer.length===this.state.size?this.state.buffer.shift():this.state.buffer.length>this.state.size&&this.state.buffer.splice(0,this.state.buffer.length-this.state.size+1),this.state.buffer.push(t[0]),this.setOutputs("buffer",this.state.buffer))}setupUI(){this.sizeInput=this.createInput({propName:"size",input:!0,output:!0,height:20,style:{type:n.InputType.Number,grow:.7}}),this.ui.append(this.createHozLayout([this.createLabel("Size",{style:{grow:.3}}),this.sizeInput],{style:{spacing:20}}))}}e.Buffer=o},5100:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Compare=void 0;const i=s(7892),a=s(7055);class n extends a.Node{constructor(t,e={}){super(t,e.name||"Compare",e.position||new i.Vector(50,50),e.width||150,[{name:"x",dataType:"any"},{name:"y",dataType:"any"}],[{name:"result",dataType:"boolean"}],{state:e.state?{...n.DefaultState,...e.state}:n.DefaultState,style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.setupUI(),this.select.on("change",(()=>this.process(this.getInputs()))),this.on("process",((t,e)=>this.process(e)))}process(t){if(null===t[0]||void 0===t[0]||null===t[1]||void 0===t[1])return;let e;switch(this.state.value){case"==":e=t[0]==t[1];break;case"===":e=t[0]===t[1];break;case"!=":e=t[0]!=t[1];break;case"!==":e=t[0]!==t[1];break;case"<":e=t[0]<t[1];break;case"<=":e=t[0]<=t[1];break;case">":e=t[0]>t[1];break;case">=":e=t[0]>=t[1];break;case"&&":e=t[0]&&t[1];break;case"||":e=t[0]||t[1];break;default:e=!1}this.setOutputs(0,e)}setupUI(){let t=this.createSelect(["==","===","!=","!==","<","<=",">",">=","&&","||"],{propName:"value",input:!0,output:!0,height:15,style:{fontSize:"14px"}});this.ui.append(t)}}e.Compare=n,n.DefaultState={value:"=="}},4727:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Delay=void 0;const i=s(7892),a=s(8240),n=s(7055),o=s(8637);class r extends n.Node{constructor(t,e={}){super(t,e.name||"Delay",e.position||new i.Vector(50,50),e.width||130,[{name:"event",dataType:"event"}],[{name:"trigger",dataType:"event"}],{state:e.state?{...r.DefaultState,...e.state}:r.DefaultState,style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.setupUI(),this.state.eventQueue=new a.List(((t,e)=>t.timeoutId-e.timeoutId)),this.state.eventQueue.on("removefirst",(()=>{for(;this.state.eventQueue.head&&performance.now()-this.state.eventQueue.head.data.start>=this.state.delay;){let t=this.state.eventQueue.removeFirst(!1);this.outputs[0].emit(t.data)}})),this.inputs[0].on("event",((t,e)=>{let s=new a.ListNode;s.data={data:e,timeoutId:window.setTimeout((()=>this.triggerEvent(s)),this.state.delay),start:performance.now()},this.state.eventQueue.append(s)})),t.on("start",(()=>{this.state.eventQueue.forEach((t=>{t.data.start=performance.now()+t.data.remaining-this.state.delay,t.data.timeoutId=window.setTimeout((()=>this.triggerEvent(t)),t.data.remaining)}))})),t.on("stop",(()=>{this.state.eventQueue.forEach((t=>{clearTimeout(t.data.timeoutId),t.data.remaining=performance.now()-t.data.start}))}))}triggerEvent(t){if(t===this.state.eventQueue.head){let t=this.state.eventQueue.removeFirst();this.outputs[0].emit(t.data)}}setupUI(){this.ui.append(this.createHozLayout([this.createLabel("Delay",{style:{grow:.3}}),this.createInput({propName:"delay",input:!0,output:!0,height:20,style:{type:o.InputType.Number,grow:.7}})],{style:{spacing:10}}))}}e.Delay=r,r.DefaultState={delay:0,eventQueue:null}},781:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FileSource=void 0;const i=s(7892),a=s(7055);class n extends a.Node{constructor(t,e={}){super(t,e.name||"File Source",e.position||new i.Vector(50,50),e.width||130,[],[{name:"file",dataType:"file"}],{state:e.state?{...n.DefaultState,...e.state}:n.DefaultState,style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.setupUI(),this.fileInput.on("change",(()=>this.process())),this.on("process",(()=>this.process()))}process(){this.setOutputs(0,this.state.file)}setupUI(){this.fileInput=this.createSource({propName:"file",input:!0,output:!0,height:20}),this.ui.append(this.fileInput)}}e.FileSource=n,n.DefaultState={file:null}},3715:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalEvent=void 0;const i=s(7892),a=s(712),n=s(7055),o=s(974),r=s(8637);class h extends n.Node{constructor(t,e,s,n={}){super(t,n.name||"Global Event",n.position||new i.Vector(50,50),n.width||150,e===a.GlobalEventType.Emitter?[{name:"emit",dataType:"event"}]:[],e===a.GlobalEventType.Receiver?[{name:"receive",dataType:"event"}]:[],{state:n.state?{...h.DefaultState,...n.state}:h.DefaultState,style:n.style||{rowHeight:10},terminalStyle:n.terminalStyle||{}}),this.state.prevEvent=s,this.state.name=(0,o.get)(s,(0,o.getNewUUID)()),this.setupUI(),e===a.GlobalEventType.Emitter?this.inputs[0].on("event",((e,s)=>t.globalEvents.call(this.state.name,s))):(this.state.eventId=t.globalEvents.on(this.state.name,(t=>this.outputs[0].emit(t))),this.on("change",((e,s,i)=>{t.globalEvents.off(i,this.state.eventId),this.state.eventId=t.globalEvents.on(this.state.name,(t=>this.outputs[0].emit(t)))})))}setupUI(){this.eventInput=this.createInput({propName:"name",height:20,style:{type:r.InputType.Text,grow:.6}}),this.ui.append(this.createHozLayout([this.createLabel("Event",{style:{grow:.4}}),this.eventInput],{style:{spacing:10}}))}}e.GlobalEvent=h,h.DefaultState={prevEvent:"",eventId:-1}},2302:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.JsonSource=void 0;const i=s(7892),a=s(6645),n=s(7055),o=s(8637);class r extends n.Node{constructor(t,e={}){super(t,e.name||"JSON Source",e.position||new i.Vector(50,50),e.width||150,[],[{name:"value",dataType:"any"}],{state:e.state?{...e.state}:{},style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.setupUI(),this.input.on("change",(()=>this.process())),this.on("process",(()=>this.process()))}process(){if(this.input.value&&""!==this.input.value)try{let t=JSON.parse(this.input.value);this.setOutputs(0,t)}catch(t){this.input.inputEl.style.backgroundColor="red",a.Log.error("StandardNode 'JsonSource' json parse error",t)}}setupUI(){this.input=this.createInput({value:"",input:!0,output:!0,height:20,style:{type:o.InputType.Text,grow:.7}}),this.ui.append(this.createHozLayout([this.createLabel("Value",{style:{grow:.3}}),this.input],{style:{spacing:20}}))}}e.JsonSource=r},1433:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Log=void 0;const i=s(7892),a=s(7900),n=s(6645),o=s(7055);class r extends o.Node{constructor(t,e={}){super(t,e.name||"Log",e.position||new i.Vector(50,50),e.width||170,[{name:"Log 1",dataType:"event"},{name:"Log 2",dataType:"any"}],[],{state:e.state?{...e.state}:{},style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.inputs[0].on("event",((t,e)=>n.Log.log(t.name+":",e))),this.inputs[1].on("data",((t,e)=>n.Log.log(t.name+":",e))),this.setupUI(),this.addEventButton.on("click",(()=>this.addNewTerminal("event"))),this.addDataButton.on("click",(()=>this.addNewTerminal("data")))}setupUI(){this.addEventButton=this.createButton("Add Event",{style:{grow:.5}}),this.addDataButton=this.createButton("Add Data",{style:{grow:.5}}),this.ui.append(this.createHozLayout([this.addEventButton,this.addDataButton],{style:{spacing:20}}))}addNewTerminal(t){let e=new a.Terminal(this,a.TerminalType.IN,"event"===t?t:"any","Log "+(this.inputs.length+1));e.on(t,((t,e)=>n.Log.log(t.name,e))),this.addTerminal(e)}}e.Log=r},6110:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NumberRange=void 0;const i=s(7892),a=s(7055),n=s(8637);class o extends a.Node{constructor(t,e={}){super(t,e.name||"Number Range",e.position||new i.Vector(50,50),e.width||200,[{name:"trigger",dataType:"event"},{name:"reset",dataType:"event"}],[{name:"value",dataType:"number"}],{state:e.state?{...o.DefaultState,...e.state}:o.DefaultState,style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.state.startValue=this.state.value,this.setupUI(),this.minInput.on("change",(()=>this.process())),this.maxInput.on("change",(()=>this.process())),this.stepInput.on("change",(()=>this.process())),this.loopToggle.on("change",(()=>this.process())),this.inputs[0].on("event",(()=>this.process())),this.inputs[1].on("event",(()=>this.state.value=this.state.min))}process(){let t=this.state.value;if(this.state.value=t+this.state.step,this.state.value<this.state.min){if(this.state.value=this.state.min,!this.state.loop)return;this.state.value=this.state.startValue}else if(this.state.value>this.state.max){if(this.state.value=this.state.max,!this.state.loop)return;this.state.value=this.state.startValue}else this.setOutputs(0,t)}setupUI(){this.minInput=this.createInput({propName:"min",input:!0,output:!0,height:20,style:{type:n.InputType.Number,grow:.3,step:"any"}}),this.maxInput=this.createInput({propName:"max",input:!0,output:!0,height:20,style:{type:n.InputType.Number,grow:.3,step:"any"}}),this.stepInput=this.createInput({propName:"step",input:!0,output:!0,height:20,style:{type:n.InputType.Number,grow:.3,step:"any"}}),this.loopToggle=this.createToggle({propName:"loop",input:!0,output:!0,height:10,style:{grow:.2}}),this.ui.append([this.createHozLayout([this.createLabel("Min",{style:{grow:.2}}),this.minInput,this.createLabel("Max",{style:{grow:.2}}),this.maxInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Step",{style:{grow:.2}}),this.stepInput],{style:{spacing:5}}),this.createHozLayout([this.createLabel("Loop ?",{style:{grow:.2}}),this.loopToggle],{style:{spacing:10}})])}}e.NumberRange=o,o.DefaultState={value:0,min:0,max:100,step:1,loop:!1}},3355:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NumberSource=void 0;const i=s(7892),a=s(7055),n=s(8637);class o extends a.Node{constructor(t,e={}){super(t,e.name||"Number Source",e.position||new i.Vector(50,50),e.width||160,[],[{name:"value",dataType:"number"}],{state:e.state?{...o.DefaultState,...e.state}:o.DefaultState,style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.setupUI(),this.fractionalToggle.on("change",((t,e,s)=>{this.input.style.step=s?"any":"",s||(this.state.value=Math.floor(this.state.value)),this.process()})),this.input.on("change",(()=>{this.state.fractional||(this.state.value=Math.floor(this.state.value)),this.process()})),this.outputs[0].on("connect",(()=>this.process())),this.on("process",(()=>this.process()))}process(){this.setOutputs(0,this.state.fractional?this.state.value:Math.floor(this.state.value))}setupUI(){this.fractionalToggle=this.createToggle({propName:"fractional",input:!0,output:!0,height:10,style:{grow:.2}}),this.input=this.createInput({value:0,propName:"value",input:!0,output:!0,height:20,style:{type:n.InputType.Number,grow:.6,step:this.state.fractional?"any":""}}),this.ui.append([this.createHozLayout([this.createLabel("Value",{style:{grow:.4}}),this.input],{style:{spacing:20}}),this.createHozLayout([this.createLabel("Fractional ?",{style:{grow:.5}}),this.fractionalToggle],{style:{spacing:20}})])}}e.NumberSource=o,o.DefaultState={fractional:!1,value:0}},1777:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Property=void 0;const i=s(7892),a=s(7055);class n extends a.Node{constructor(t,e={}){super(t,e.name||"Property",e.position||new i.Vector(50,50),e.width||130,[{name:"object",dataType:"any"},{name:"key",dataType:"string"}],[{name:"value",dataType:"any"}],{state:e.state?{...e.state}:{},style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.on("process",((t,e)=>{e[0]&&this.setOutputs(0,e[0][e[1]])}))}}e.Property=n},4054:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Random=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(8637);class r extends n.Node{constructor(t,e={}){super(t,e.name||"Random",e.position||new i.Vector(50,50),e.width||150,[{name:"trigger",dataType:"event"}],[{name:"value",dataType:"number"}],{state:e.state?{...r.DefaultState,...e.state}:r.DefaultState,style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.setupUI(),this.minInput.on("change",(()=>this.process())),this.maxInput.on("change",(()=>this.process())),this.fractionalToggle.on("change",(()=>this.process())),this.inputs[0].on("event",(()=>this.process())),this.on("process",(()=>this.process()))}process(){let t;t=this.state.fractional?(0,a.getRandom)(this.state.min,this.state.max):Math.floor((0,a.getRandom)(Math.floor(this.state.min),Math.floor(this.state.max))),this.setOutputs(0,t)}setupUI(){this.minInput=this.createInput({propName:"min",input:!0,output:!0,height:20,style:{type:o.InputType.Number,grow:1,step:"any"}}),this.maxInput=this.createInput({propName:"max",input:!0,output:!0,height:20,style:{type:o.InputType.Number,grow:1,step:"any"}}),this.fractionalToggle=this.createToggle({propName:"fractional",input:!0,output:!0,height:10,style:{grow:.2}}),this.ui.append([this.createHozLayout([this.createLabel("Min:",{style:{grow:.3}}),this.minInput],{style:{spacing:20}}),this.createHozLayout([this.createLabel("Max:",{style:{grow:.3}}),this.maxInput],{style:{spacing:20}}),this.createHozLayout([this.createLabel("Fractional ?",{style:{grow:.8}}),this.fractionalToggle],{style:{spacing:10}})])}}e.Random=r,r.DefaultState={min:0,max:100,fractional:!1}},3068:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StringSource=void 0;const i=s(7892),a=s(7055),n=s(8637);class o extends a.Node{constructor(t,e={}){super(t,e.name||"String Source",e.position||new i.Vector(50,50),e.width||160,[],[{name:"value",dataType:"string"}],{state:e.state?{...o.DefaultState,...e.state}:o.DefaultState,style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.process=()=>this.setOutputs(0,this.state.value),this.setupUI(),this.input.on("change",(()=>this.process())),this.on("process",(()=>this.process()))}setupUI(){this.input=this.createInput({value:"",propName:"value",input:!0,output:!0,height:20,style:{type:n.InputType.Text,grow:.7}}),this.ui.append(this.createHozLayout([this.createLabel("Value",{style:{grow:.3}}),this.input],{style:{spacing:10}}))}}e.StringSource=o,o.DefaultState={value:""}},584:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SyncData=void 0;const i=s(7892),a=s(7900),n=s(7055);class o extends n.Node{constructor(t,e={},s){if(super(t,e.name||"Sync Data",e.position||new i.Vector(50,50),e.width||160,[{name:"Data 1",dataType:"any"},{name:"Data 2",dataType:"any"}],[{name:"synced",dataType:"any"}],{state:e.state?{...o.DefaultState,...e.state,hold:{}}:{...o.DefaultState,hold:{}},style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.eventIds=[],s)for(let t=0;t<s-2;t++)this.addTerminal(new a.Terminal(this,a.TerminalType.IN,"any","Data "+(this.inputs.length+1)));this.setupUI();for(let t of this.inputs)this.eventIds.push(t.on("data",((t,e)=>this.process(t,e))));this.on("process",(()=>process))}setupUI(){this.syncTypeInput=this.createRadioGroup(["partial","full"],this.state.syncType,{propName:"syncType",height:20}),this.addButton=this.createButton("Add",{input:!0,output:!0,height:20}),this.ui.append([this.syncTypeInput,this.addButton]),this.addButton.on("click",(()=>{let t=new a.Terminal(this,a.TerminalType.IN,"any","Data "+(this.inputs.length+1));this.addTerminal(t),this.eventIds.push(t.on("data",((t,e)=>this.process(t,e))))}))}process(t,e){this.state.hold[t.id]=e;let s=[];for(let t of this.inputs){if(!this.state.hold.hasOwnProperty(t.id))return;s.push(this.state.hold[t.id])}"full"===this.state.syncType&&(this.state.hold={}),this.outputs[0].emit(s);for(let t of this.inputs)if(t.connectors.length>0&&void 0===t.getData())return;this.setOutputs(0,this.getInputs())}}e.SyncData=o,o.DefaultState={syncType:"partial"}},4599:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SyncEvent=void 0;const i=s(7892),a=s(7900),n=s(7055);class o extends n.Node{constructor(t,e={},s){if(super(t,e.name||"Sync Event",e.position||new i.Vector(50,50),e.width||160,[{name:"Event 1",dataType:"event"},{name:"Event 2",dataType:"event"}],[{name:"synced",dataType:"event"}],{state:e.state?{...e.state,hold:{}}:{hold:{}},style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),s)for(let t=0;t<s-2;t++)this.addTerminal(new a.Terminal(this,a.TerminalType.IN,"event","Event "+(this.inputs.length+1)));this.inputs.forEach((t=>t.on("event",((t,e)=>this.process(t,e))))),this.setupUI(),this.addButton.on("click",(()=>{let t=new a.Terminal(this,a.TerminalType.IN,"event","Event "+(this.inputs.length+1));this.addTerminal(t),t.on("event",((t,e)=>this.process(t,e)))}))}process(t,e){this.state.hold[t.id]=e;let s=[];for(let t of this.inputs){if(!this.state.hold.hasOwnProperty(t.id))return;s.push(this.state.hold[t.id])}this.state.hold={},this.outputs[0].emit(s)}setupUI(){this.addButton=this.createButton("Add",{input:!0,output:!0,height:20}),this.ui.append(this.addButton)}}e.SyncEvent=o},5801:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Timer=void 0;const i=s(7892),a=s(7055),n=s(8637);class o extends a.Node{constructor(t,e={}){super(t,e.name||"Timer",e.position||new i.Vector(50,50),e.width||120,[],[{name:"timer",dataType:"event"}],{state:e.state?{...o.DefaultState,...e.state}:o.DefaultState,style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.lastTrigger=Number.MIN_VALUE,this.setupUI(),t.flowConnect.on("tickreset",(()=>this.lastTrigger=Number.MIN_VALUE)),t.flowConnect.on("tick",(()=>{let e=t.flowConnect.time;e-this.lastTrigger>=this.state.delay&&(this.outputs[0].emit(this.state.emitValue),this.lastTrigger=e)}))}setupUI(){this.ui.append(this.createInput({propName:"delay",height:20,style:{type:n.InputType.Number}}))}}e.Timer=o,o.DefaultState={delay:1e3,emitValue:null}},3736:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ToArray=void 0;const i=s(7892),a=s(7900),n=s(7055);class o extends n.Node{constructor(t,e,s={}){super(t,s.name||"To Array",s.position||new i.Vector(50,50),s.width||100,e&&e>0?new Array(e).fill(null).map(((t,e)=>({name:"In "+(e+1),dataType:"any"}))):[{name:"In 1",dataType:"any"}],[{name:"out",dataType:"array"}],{state:s.state?{...s.state}:{},style:s.style||{rowHeight:10},terminalStyle:s.terminalStyle||{}}),this.setupUI(),this.addButton.on("click",(()=>this.addTerminal(new a.Terminal(this,a.TerminalType.IN,"any","In "+this.inputs.length+1)))),this.on("process",((t,e)=>this.setOutputs(0,[...e])))}setupUI(){this.addButton=this.createButton("Add",{style:{grow:.5}}),this.ui.append(this.addButton)}}e.ToArray=o},7637:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ToVector2=void 0;const i=s(7892),a=s(6645),n=s(7055);class o extends n.Node{constructor(t,e={}){super(t,e.name||"To Vector",e.position||new i.Vector(50,50),e.width||100,[{name:"x",dataType:"any"},{name:"y",dataType:"any"}],[{name:"vector2",dataType:"any"}],{state:e.state?{...e.state}:{},style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.on("process",((t,e)=>{if("number"==typeof e[0]&&"number"==typeof e[1])this.setOutputs(0,{x:e[0],y:e[1]});else if(Array.isArray(e[0])&&Array.isArray(e[1])){let t=[];for(let s=0;s<e[0].length;s++)t.push({x:e[0][s],y:e[1][s]});this.setOutputs(0,t)}else a.Log.error("Type mismatch: Inputs to standard node 'ToVector2' should be of same type")}))}}e.ToVector2=o},7577:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StandardNodes=void 0;const i=s(5801),a=s(1433),n=s(3528),o=s(3736),r=s(9322),h=s(3161),u=s(4054),l=s(5527),c=s(2302),p=s(3355),d=s(3068),y=s(781),f=s(5100),m=s(1777),g=s(4599),v=s(584),b=s(4727),w=s(7637),S=s(6110),T=s(3715),C=s(5943),x=s(325),I=s(8410),N=s(2583),L=s(8740),M=s(5158),_=s(1142),G=s(6334),k=s(82),A=s(6430),D=s(9197),P=s(7751),z=s(3645),q=s(5051),O=s(2776),F=s(1744),H=s(4106),B=s(8544),R=s(2328),V=s(522),U=s(5749),E=s(5431),j=s(3146),W=s(1370),Q=s(8561),X=s(7737),Z=s(346),Y=s(6021),$=s(1094),J=s(1923),K=s(4537),tt=s(1941),et=s(9668),st=s(6846),it=s(3155),at=s(3547),nt=s(7959),ot=s(1907),rt=s(1457),ht=s(1462),ut=s(5182);!function(t){!function(t){t.Timer=i.Timer,t.Log=a.Log,t.Buffer=n.Buffer,t.ToArray=o.ToArray,t.ArrayIndex=r.ArrayIndex,t.ArraySource=h.ArraySource,t.BooleanSource=l.BooleanSource,t.JsonSource=c.JsonSource,t.NumberSource=p.NumberSource,t.StringSource=d.StringSource,t.FileSource=y.FileSource,t.Random=u.Random,t.Compare=f.Compare,t.Property=m.Property,t.SyncEvent=g.SyncEvent,t.SyncData=v.SyncData,t.Delay=b.Delay,t.ToVector2=w.ToVector2,t.NumberRange=S.NumberRange,t.GlobalEvent=T.GlobalEvent}(t.Common||(t.Common={}))}(e.StandardNodes||(e.StandardNodes={})),function(t){!function(t){t.Abs=C.Abs,t.Average=x.Average,t.Normalize=I.Normalize,t.Clamp=N.Clamp,t.Floor=L.Floor,t.Ceil=M.Ceil,t.Function=_.Func}(t.Math||(t.Math={}))}(e.StandardNodes||(e.StandardNodes={})),function(t){!function(t){t.API=G.API}(t.Net||(t.Net={}))}(e.StandardNodes||(e.StandardNodes={})),function(t){!function(t){t.LineChartMini=A.LineChartMini,t.FunctionPlotter=k.FunctionPlotter}(t.Visual||(t.Visual={}))}(e.StandardNodes||(e.StandardNodes={})),function(t){!function(t){t.Source=D.Source,t.Destination=P.Destination,t.Automate=z.Automate,t.ChannelSplitter=q.ChannelSplitter,t.Debug=O.Debug,t.ChannelMerger=F.ChannelMerger,t.ADSR=H.ADSR,t.Gain=B.Gain,t.Metronome=R.Metronome,t.MoogEffect=V.MoogEffect,t.BitcrusherEffect=U.BitcrusherEffect,t.BiquadFilter=E.BiquadFilter,t.DelayEffect=j.DelayEffect,t.DynamicsCompressor=W.DynamicsCompressor,t.ChorusEffect=Q.ChorusEffect,t.OverdriveEffect=X.OverdriveEffect,t.AudioBufferSource=Z.AudioBufferSource,t.Convolver=Y.Convolver,t.TremoloEffect=$.TremoloEffect,t.PingPongDelay=J.PingPongEffect,t.StereoPanner=K.StereoPanner,t.SpatialPanner=tt.SpatialPanner,t.Noise=et.Noise,t.Oscillator=st.Oscillator,t.Microphone=it.Microphone,t.Distorter=at.Distorter,t.Equalizer=nt.Equalizer,t.FrequencyAnalyser=ot.FrequencyAnalyser,t.WaveformAnalyser=rt.WaveformAnalyser,t.SpectrogramAnalyser=ht.SpectrogramAnalyser}(t.Audio||(t.Audio={}))}(e.StandardNodes||(e.StandardNodes={})),function(t){!function(t){t.Dial=ut.Dial}(t.UI||(t.UI={}))}(e.StandardNodes||(e.StandardNodes={}))},5943:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Abs=void 0;const i=s(7892),a=s(7055);class n extends a.Node{constructor(t,e={}){super(t,e.name||"Abs",e.position||new i.Vector(50,50),e.width||120,[{name:"x",dataType:"any"}],[{name:"|x|",dataType:"any"}],{state:e.state?{...e.state}:{},style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.on("process",((t,e)=>{"number"==typeof e[0]?this.setOutputs(0,Math.abs(e[0])):Array.isArray(e[0])&&this.setOutputs(0,e[0].map((t=>Math.abs(t))))}))}}e.Abs=n},325:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Average=void 0;const i=s(7892),a=s(7055);class n extends a.Node{constructor(t,e={}){super(t,e.name||"Average",e.position||new i.Vector(50,50),e.width||120,[{name:"n",dataType:"any"}],[{name:"μ",dataType:"any"}],{state:e.state?{...e.state}:{},style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.on("process",((t,e)=>{Array.isArray(e[0])&&this.setOutputs(0,e[0].reduce(((t,e)=>t+e),0)/e[0].length)}))}}e.Average=n},5158:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ceil=void 0;const i=s(7892),a=s(7055);class n extends a.Node{constructor(t,e={}){super(t,e.name||"Ceil",e.position||new i.Vector(50,50),e.width||120,[{name:"x",dataType:"any"}],[{name:"|x|",dataType:"any"}],{state:e.state?{...e.state}:{},style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.on("process",((t,e)=>{"number"==typeof e[0]?this.setOutputs(0,Math.ceil(e[0])):Array.isArray(e[0])&&this.setOutputs(0,e[0].map((t=>Math.ceil(t))))}))}}e.Ceil=n},2583:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Clamp=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(8637);class r extends n.Node{constructor(t,e={}){super(t,e.name||"Clamp",e.position||new i.Vector(50,50),e.width||150,[{name:"x",dataType:"any"}],[{name:"[x]",dataType:"any"}],{state:e.state?{...r.DefaultState,...e.state}:r.DefaultState,style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.setupUI(),this.minInput.on("change",(()=>this.process(this.getInputs()[0]))),this.maxInput.on("change",(()=>this.process(this.getInputs()[0]))),this.on("process",((t,e)=>this.process(e[0])))}setupUI(){this.minInput=this.createInput({propName:"min",input:!0,output:!0,height:20,style:{type:o.InputType.Number,grow:.7}}),this.maxInput=this.createInput({propName:"max",input:!0,output:!0,height:20,style:{type:o.InputType.Number,grow:.7}}),this.ui.append([this.createHozLayout([this.createLabel("Min",{style:{grow:.3}}),this.minInput],{style:{spacing:10}}),this.createHozLayout([this.createLabel("Max",{style:{grow:.3}}),this.maxInput],{style:{spacing:10}})])}process(t){"number"==typeof t?this.setOutputs(0,(0,a.clamp)(t,this.state.min,this.state.max)):Array.isArray(t)&&this.setOutputs(0,t.map((t=>(0,a.clamp)(t,this.state.min,this.state.max))))}}e.Clamp=r,r.DefaultState={min:0,max:100}},8740:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Floor=void 0;const i=s(7892),a=s(7055);class n extends a.Node{constructor(t,e={}){super(t,e.name||"Floor",e.position||new i.Vector(50,50),e.width||120,[{name:"x",dataType:"any"}],[{name:"|x|",dataType:"any"}],{state:e.state?{...e.state}:{},style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.on("process",((t,e)=>{"number"==typeof e[0]?this.setOutputs(0,Math.floor(e[0])):Array.isArray(e[0])&&this.setOutputs(0,e[0].map((t=>Math.floor(t))))}))}}e.Floor=n},1142:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Func=void 0;const i=s(7892),a=s(7900),n=s(9433),o=s(6645),r=s(3855),h=s(3814),u=s(7055),l=s(8637);class c extends u.Node{constructor(t,e={},s){super(t,e.name||"Function",e.position||new i.Vector(50,50),e.width||200,[],[{name:"𝒇",dataType:"any"}],{state:e.state?{...c.DefaultState,...e.state,expression:s||"a*sin(a^2)+cos(a*tan(a))",evaluator:new n.Evaluator({})}:{...c.DefaultState,expression:s||"a*sin(a^2)+cos(a*tan(a))",evaluator:new n.Evaluator({})},style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}});let u,l=new Set,p=new r.Parser;try{u=p.parse(s)}catch(t){return void o.Log.error("Error while parsing expression: ",s,t)}try{u.forEach((t=>{if(t.type===h.TokenType.Variable){if(t.value.length>1)throw new Error("Only single character variables are allowed: "+t.value);l.add(t.value)}}))}catch(t){return void o.Log.error(t)}l.forEach((t=>this.addTerminal(new a.Terminal(this,a.TerminalType.IN,"any",t)))),this.state.expression=s,this.setupUI(),this.watch("expression",(()=>this.process())),this.addVarButton.on("click",(()=>{this.state.newVar&&""!==this.state.newVar.trim()&&(this.inputs.map((t=>t.name)).includes(this.state.newVar.trim().toLowerCase())?o.Log.error("Variable",this.state.newVar.trim(),"already exists"):this.addTerminal(new a.Terminal(this,a.TerminalType.IN,"any",this.state.newVar.trim())))})),this.on("process",(()=>this.process()))}process(){let t=-1;this.state.evaluator.variables={};for(let e of this.inputs){let s=e.getData();if(Array.isArray(s)){let i=this.state.expression,a=new RegExp("([a-z]+)\\("+e.name+"\\)","g");i=i.replace(/\s+/g,""),[...i.matchAll(a)].map((t=>!n.Evaluator.multiargFunctions.includes(t[1]))).reduce(((t,e)=>t&&e),!0)&&(t=Math.max(t,s.length))}this.state.evaluator.variables[e.name]=null!=s?s:0}try{let e;if(-1!==t){let s=[];for(let e=0;e<t;e+=1)s.push(this.state.evaluator.evaluate(this.state.expression,e));e=s}else e=this.state.evaluator.evaluate(this.state.expression);this.setOutputs(0,e)}catch(t){o.Log.error("Error while evaluating the expression: ",this.state.expression,t)}}lowerCase(t){/[A-Z]/g.test(t.inputEl.value)&&(t.inputEl.value=t.inputEl.value.toLowerCase())}setupUI(){let t=this.createInput({propName:"expression",input:!0,output:!0,height:20,style:{type:l.InputType.Text,grow:.9}});t.on("input",this.lowerCase),this.addVarButton=this.createButton("Add",{height:20,style:{grow:.4}}),this.ui.append([this.createHozLayout([this.createLabel("𝒇",{style:{grow:.1}}),t],{style:{spacing:10}}),this.createHozLayout([this.createInput({propName:"newVar",height:20,style:{type:l.InputType.Text,maxLength:1,grow:.6}}),this.addVarButton],{style:{spacing:10}})])}}e.Func=c,c.DefaultState={newVar:"y"}},8410:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Normalize=void 0;const i=s(7892),a=s(974),n=s(7055),o=s(8637);class r extends n.Node{constructor(t,e,s={}){if(super(t,s.name||"Normalize",s.position||new i.Vector(50,50),s.width||150,[{name:"data",dataType:e}],[{name:"normalized",dataType:e}],{state:s.state?{...r.DefaultState,...s.state}:r.DefaultState,style:s.style||{rowHeight:10},terminalStyle:s.terminalStyle||{}}),this.type=e,this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER,"array"===e){let t=this.createToggle({propName:"relative",height:10,style:{grow:.5}});this.ui.append(this.createHozLayout([this.createLabel("Relative ?"),t],{style:{spacing:20}})),t.on("change",(()=>this.process()))}if("number"===e||!this.state.relative){let t=this.createInput({propName:"min",height:20,style:{type:o.InputType.Number,grow:.3}}),e=this.createInput({propName:"max",height:20,style:{type:o.InputType.Number,grow:.3}});this.ui.append(this.createHozLayout([this.createLabel("Min",{style:{grow:.2}}),t,this.createLabel("Max",{style:{grow:.2}}),e],{style:{spacing:5}})),t.on("change",(()=>this.process())),e.on("change",(()=>this.process()))}if(this.state.constant){let t=this.createInput({propName:"constant",height:20,style:{type:o.InputType.Number,grow:.5}});this.ui.append(this.createHozLayout([this.createLabel("Constant"),t],{style:{spacing:20}})),t.on("change",(()=>this.process()))}this.on("process",(()=>this.process()))}process(){let t,e=this.getInput(0);if(e){if("number"===this.type)t=Number((0,a.normalize)(e,this.state.min,this.state.max).toFixed(2));else if(this.state.relative){let s=Math.min(...e),i=Math.max(...e);s<this.min&&(this.min=s-(this.state.constant||0)),i>this.max&&(this.max=i+(this.state.constant||0)),t=e.map((t=>Number((0,a.normalize)(t,this.min,this.max).toFixed(2))))}else t=e.map((t=>Number((0,a.normalize)(t,this.state.min,this.state.max).toFixed(2))));this.setOutputs("normalized",t)}}}e.Normalize=r,r.DefaultState={min:0,max:100,relative:!1}},6334:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.API=void 0;const i=s(7892),a=s(712),n=s(6645),o=s(974),r=s(7055);class h extends r.Node{constructor(t,e={}){super(t,e.name||"API",e.position||new i.Vector(50,50),e.width||150,[{name:"trigger",dataType:"event"}],[{name:"text",dataType:"string"},{name:"json",dataType:"any"},{name:"array-buffer",dataType:"array-buffer"}],{state:e.state?{...h.DefaultState,...e.state}:h.DefaultState,style:e.style||{rowHeight:10},terminalStyle:e.terminalStyle||{}}),this.setupUI(),this.inputs[0].on("event",(async()=>{if(this.state.src&&""!==this.state.src){let e,s={};if(this.outputs.map((t=>t.connectors.length)).reduce(((t,e)=>t+e),0)>0){if(e=await fetch(this.state.src),this.outputs[0].connectors.length>0)s[this.outputs[0].name]=await e.text();else if(this.outputs[1].connectors.length>0)s[this.outputs[1].name]=await e.json();else if(this.outputs[2].connectors.length>0)if(this.outputs[2].connectors.map((t=>t.end.dataType)).includes("audio")){let i=t.flowConnect.arrayBufferCache.get(this.state.src);i||(i=await e.arrayBuffer(),t.flowConnect.arrayBufferCache.set(this.state.src,i)),s[this.outputs[2].name]=i}else s[this.outputs[2].name]=await e.arrayBuffer();(0,o.isEmpty)(s)||this.setOutputs(s)}}else n.Log.error("Prop 'src' of API Node is invalid, cannot make an API call")}))}setupUI(){this.ui.append(this.createLabel("",{propName:"src",input:!0,output:!0,style:{align:a.Align.Center}}))}}e.API=h,h.DefaultState={src:""}},5182:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Dial=void 0;const i=s(7892),a=s(712),n=s(7055);class o extends n.Node{constructor(t,e=new Object,s=new Object){super(t,e.name||"Dial",e.position||new i.Vector(50,50),e.width||90,[],[],{state:e.state?{...o.DefaultState,...e.state}:o.DefaultState,style:e.style||{rowHeight:10,padding:5,spacing:10},terminalStyle:e.terminalStyle||{}}),Object.assign(this.ui.style,{backgroundColor:"transparent",borderColor:"transparent",borderWidth:0,shadowBlur:0,shadowColor:"transparent"}),this.setupUI(s),this.outputsUI[0].on("connect",((t,e)=>{e.end.ref instanceof AudioParam&&(this.state.value=e.end.ref.value)}))}setupUI(t){let e=this.createDial(this.state.min,this.state.max,this.width,{value:this.state.value,propName:"value",input:!0,output:!0,style:t});this.ui.append([e,this.createStack({childs:[this.createHozLayout([this.createLabel("",{propName:"min",style:{precision:1,fontSize:"11px",align:a.Align.Left,grow:.5}}),this.createLabel("",{propName:"max",style:{precision:1,fontSize:"11px",align:a.Align.Right,grow:.5}})]),this.createHozLayout([this.createLabel("",{propName:"value",style:{precision:1,fontSize:"20px",align:a.Align.Center,grow:1}})])],style:{spacing:5}})])}}e.Dial=o,o.DefaultState={value:0,min:0,max:1}},82:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FunctionPlotter=void 0;const i=s(7892),a=s(7055),n=s(974);class o extends a.Node{constructor(t,e,s=new Object,a={}){super(t,a.name||"Parametric Plotter",a.position||new i.Vector(50,50),a.width||300,[{name:"data",dataType:"any"}],[],{state:a.state?{...o.DefaultState,...a.state}:o.DefaultState,style:a.style||{rowHeight:10},terminalStyle:a.terminalStyle||{}}),this.plotStyle=s,this.setupUI(e),this.polarToggle.on("change",(()=>this.process(this.getInputs())));let n=null;this.display.on("up",(()=>n=null)),this.display.on("exit",(()=>n=null)),this.display.on("down",((e,s)=>{n=s.subtract(this.display.position.transform(t.flowConnect.transform)),n.x=this.xPixToCoord(this.state.config,this.display.offCanvasConfigs[0].canvas.width,n.x),n.y=this.yPixToCoord(this.state.config,this.display.offCanvasConfigs[0].canvas.height,n.y)})),this.display.on("drag",((e,s)=>{if(n){let e=s.subtract(this.display.position.transform(t.flowConnect.transform));e.x=this.xPixToCoord(this.state.config,this.display.offCanvasConfigs[0].canvas.width,e.x),e.y=this.yPixToCoord(this.state.config,this.display.offCanvasConfigs[0].canvas.height,e.y);let i=n.subtract(e);Object.assign(this.state.config,{xMin:this.state.config.xMin+i.x,xMax:this.state.config.xMax+i.x,yMin:this.state.config.yMin+i.y,yMax:this.state.config.yMax+i.y}),this.gridRenderer(this.display.offCanvasConfigs[0].context,this.display.offCanvasConfigs[0].canvas.width,this.display.offCanvasConfigs[0].canvas.height),this.functionRenderer(this.display.offCanvasConfigs[1].context,this.display.offCanvasConfigs[1].canvas.width,this.display.offCanvasConfigs[1].canvas.height)}})),this.display.on("wheel",((e,s,i)=>{let a=i.subtract(this.display.position.transform(t.flowConnect.transform));a.x=this.xPixToCoord(this.state.config,this.display.offCanvasConfigs[0].canvas.width,a.x),a.y=this.yPixToCoord(this.state.config,this.display.offCanvasConfigs[0].canvas.height,a.y),Object.assign(this.state.config,{xMin:this.state.config.xMin-a.x,xMax:this.state.config.xMax-a.x,yMin:this.state.config.yMin-a.y,yMax:this.state.config.yMax-a.y}),s?Object.assign(this.state.config,{xMin:this.state.config.xMin-.1*this.state.config.xMin,xMax:this.state.config.xMax-.1*this.state.config.xMax,yMin:this.state.config.yMin-.1*this.state.config.yMin,yMax:this.state.config.yMax-.1*this.state.config.yMax}):Object.assign(this.state.config,{xMin:this.state.config.xMin+.1*this.state.config.xMin,xMax:this.state.config.xMax+.1*this.state.config.xMax,yMin:this.state.config.yMin+.1*this.state.config.yMin,yMax:this.state.config.yMax+.1*this.state.config.yMax}),Object.assign(this.state.config,{xMin:this.state.config.xMin+a.x,xMax:this.state.config.xMax+a.x,yMin:this.state.config.yMin+a.y,yMax:this.state.config.yMax+a.y}),this.gridRenderer(this.display.offCanvasConfigs[0].context,this.display.offCanvasConfigs[0].canvas.width,this.display.offCanvasConfigs[0].canvas.height),this.functionRenderer(this.display.offCanvasConfigs[1].context,this.display.offCanvasConfigs[1].canvas.width,this.display.offCanvasConfigs[1].canvas.height)})),t.flowConnect.on("scale",(()=>this.functionRenderer(this.display.offCanvasConfigs[1].context,this.display.offCanvasConfigs[1].canvas.width,this.display.offCanvasConfigs[1].canvas.height))),this.inputsUI[0].on("event",(()=>this.state.points=[])),this.on("process",((t,e)=>this.process(e)))}gridRenderer(t,e,s){return this.drawGrid(t,e,s),!1}process(t){if(Array.isArray(t[0]))if(this.state.polar){this.state.points=[];for(let e of t[0])this.state.points.push({x:e.x*Math.cos(e.y),y:e.x*Math.sin(e.y)})}else this.state.points=t[0];else this.state.points.push(this.state.polar?{x:t[0].x*Math.cos(t[0].y),y:t[0].x*Math.sin(t[0].y)}:t[0]);this.functionRenderer(this.display.offCanvasConfigs[1].context,this.display.offCanvasConfigs[1].canvas.width,this.display.offCanvasConfigs[1].canvas.height)}xCoordToPix(t,e,s){const i=e/(t.xMax-t.xMin);return Math.round((s-t.xMin)*i)}yCoordToPix(t,e,s){const i=e/(t.yMax-t.yMin);return Math.round(e-(s-t.yMin)*i)}xPixToCoord(t,e,s){return s/(e/(t.xMax-t.xMin))+t.xMin}yPixToCoord(t,e,s){return-(s-e)/(e/(t.yMax-t.yMin))+t.yMin}drawLine(t,e,s,i,a){t.beginPath(),t.moveTo(e,s),t.lineTo(i,a),t.stroke()}getGridPointDist(t,e,s){const i=e-t;let a=Math.pow(10,Math.ceil(Math.log(i)/Math.log(10))-1);switch(Math.floor(i/a)){case 9:a/=2;break;case 8:a/=3;break;case 7:a/=4;break;case 6:a/=5;break;case 5:a/=6;break;case 4:a/=7;break;case 3:a/=8;break;case 2:a/=9;break;case 1:a/=10}return a*=s,a}drawGrid(t,e,s){t.clearRect(0,0,e,s);const i=this.state.config.xMax-this.state.config.xMin,a=e/i,o=this.state.config.yMax-this.state.config.yMin,r=s/o,h=this.getGridPointDist(this.state.config.xMin,this.state.config.xMax,this.state.config.gX),u=this.getGridPointDist(this.state.config.yMin,this.state.config.yMax,this.state.config.gY);this.plotStyle.axisColor=(0,n.get)(this.plotStyle.axisColor,"#000000"),this.plotStyle.gridColor=(0,n.get)(this.plotStyle.gridColor,"#b0b0b0");let l,c=Math.ceil(this.state.config.xMin/h)*h,p=Math.round(Math.floor(i/h))+1;l=this.state.config.yMin<0&&this.state.config.yMax>0?s+this.state.config.yMin*r+12:s-12,t.strokeStyle=this.plotStyle.gridColor;for(let e=0;e<p;e++){Math.abs(c)<.5*h&&(t.strokeStyle=this.plotStyle.axisColor);const e=Math.round((c-this.state.config.xMin)*a);this.drawLine(t,e,0,e,s),t.fillStyle=this.plotStyle.axisColor;const i=Math.round(100*c)/100;t.fillText(i+"",e+4,l),t.strokeStyle=this.plotStyle.gridColor,c+=h}c=Math.ceil(this.state.config.yMin/u)*u,p=Math.round(Math.floor(o/u))+1,l=this.state.config.xMin<0&&this.state.config.xMax>0?-this.state.config.xMin*a+5:5,t.strokeStyle=this.plotStyle.gridColor;for(let i=0;i<p;i++){Math.abs(c)<.5*u&&(t.strokeStyle=this.plotStyle.axisColor);const i=s-Math.round((c-this.state.config.yMin)*r);this.drawLine(t,0,i,e,i);let a=Math.round(100*c)/100;if(0!==a){t.fillStyle=this.plotStyle.axisColor;const e=a;t.fillText(e+"",l,i-4)}t.strokeStyle=this.plotStyle.gridColor,c+=u}}functionRenderer(t,e,s){if(this.state.points.length<=0)return;t.clearRect(0,0,e,s),t.strokeStyle=(0,n.get)(this.plotStyle.plotColor,"#000"),t.lineWidth=2,t.beginPath();let i=this.xCoordToPix(this.state.config,e,this.state.points[0].x),a=this.yCoordToPix(this.state.config,s,this.state.points[0].y);t.moveTo(i,a);for(let i=1;i<this.state.points.length;i+=1){const a=this.xCoordToPix(this.state.config,e,this.state.points[i].x),n=this.yCoordToPix(this.state.config,s,this.state.points[i].y);t.lineTo(a,n)}t.stroke()}setupUI(t){this.display=this.createDisplay(t,[{auto:!0,renderer:(t,e,s)=>this.gridRenderer(t,e,s)},{auto:!1}]),this.polarToggle=this.createToggle({propName:"polar",height:10,style:{grow:.1}}),this.ui.append([this.display,this.createHozLayout([this.createLabel("Polar ?",{style:{grow:.2}}),this.polarToggle],{style:{spacing:5}})])}}e.FunctionPlotter=o,o.DefaultState={points:[],polar:!1,config:{gX:3,gY:3,xMin:-1.5,xMax:1.5,yMin:-1.5,yMax:1.5}}},6430:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LineChartMini=void 0;const i=s(7892),a=s(1278),n=s(7055),o=s(8637);class r extends n.Node{constructor(t,e,s,a,n={}){super(t,n.name||"Line Chart Mini",n.position||new i.Vector(50,50),n.width||150,[{name:"data",dataType:"array"}],[],{state:n.state?{...r.DefaultState,...n.state}:r.DefaultState,style:n.style||{rowHeight:10},terminalStyle:n.terminalStyle||{}}),this.setupUI(e,s,a)}setupUI(t,e,s){let i=this.createDisplay(t,[{auto:!0,renderer:(t,s,i)=>{let n=this.getInputs();return!n||!n[0]||(n[0].forEach(((n,o)=>{if(!n)return;let r=Number((s/(this.state.size-1)).toFixed(2));t.strokeStyle=e[o]||a.Color.Random().rgbaCSSString,t.lineWidth=2,t.beginPath(),t.moveTo(0,(1-n[0])*i);for(let e=1;e<n.length;e+=1)t.lineTo(e*r,(1-n[e])*i);t.stroke()})),!0)}}],{style:s||{}});this.ui.append(i);let n=this.createInput({propName:"size",input:!0,output:!0,height:20,style:{type:o.InputType.Number,grow:.5}});this.ui.append(this.createHozLayout([this.createLabel("Size"),n],{style:{spacing:20}}))}}e.LineChartMini=r,r.DefaultState={size:10}},1252:t=>{var e,s,i=function(t,e){t.value=e},a=Object.create(null,{activate:{writable:!0,value:function(t){t?(this.input.disconnect(),this.input.connect(this.activateNode),this.activateCallback&&this.activateCallback(t)):(this.input.disconnect(),this.input.connect(this.output))}},bypass:{get:function(){return this._bypass},set:function(t){this._lastBypassValue!==t&&(this._bypass=t,this.activate(!t),this._lastBypassValue=t)}},connect:{value:function(t){this.output.connect(t)}},disconnect:{value:function(t){this.output.disconnect(t)}},connectInOrder:{value:function(t){for(var e=t.length-1;e--;){if(!t[e].connect)return console.error("AudioNode.connectInOrder: TypeError: Not an AudioNode.",t[e]);t[e+1].input?t[e].connect(t[e+1].input):t[e].connect(t[e+1])}}},getDefaults:{value:function(){var t={};for(var e in this.defaults)t[e]=this.defaults[e].value;return t}},automate:{value:function(t,s,i,a){var n,o=a?~~(a/1e3):e.currentTime,r=i?~~(i/1e3):0,h=this.defaults[t],u=this[t];u?h.automatable?(i?(n="linearRampToValueAtTime",u.cancelScheduledValues(o),u.setValueAtTime(u.value,o)):n="setValueAtTime",u[n](s,r+o)):u=s:console.error("Invalid Property for "+this.name)}}}),n="float",o="boolean",r="int";function h(t){if(!(this instanceof h))return new h(t);var i="undefined"==typeof window?{}:window;if(i.AudioContext||(i.AudioContext=i.webkitAudioContext),t||(console.log("tuna.js: Missing audio context! Creating a new context for you."),t=i.AudioContext&&new i.AudioContext),!t)throw new Error("Tuna cannot initialize because this environment does not support web audio.");!function(t){if(!0===t.__connectified__)return;var e=t.createGain(),s=Object.getPrototypeOf(Object.getPrototypeOf(e)),i=s.connect;function n(){var t=arguments[0];return arguments[0]=a.isPrototypeOf?a.isPrototypeOf(t)?t.input:t:t.input||t,i.apply(this,arguments),t}s.connect=n,t.__connectified__=!0}(t),e=t,s=this}function u(t){return Math.max(0,Math.round(100*Math.pow(2,t/6))/100)}function l(t,e){var s,i,a,n=0,o=0,r=0;return s=t.toExponential().match(/^.\.?(.*)e(.+)$/),n=parseInt(s[2],10)-(s[1]+"").length,s=e.toExponential().match(/^.\.?(.*)e(.+)$/),(a=parseInt(s[2],10)-(s[1]+"").length)>n&&(n=a),i=t%e,n<-100||n>20?(o=Math.round(Math.log(i)/Math.log(10)),(i/(r=Math.pow(10,o))).toFixed(o-n)*r):parseFloat(i.toFixed(-n))}function c(t){return 0===t?1:Math.abs(t)/t}function p(t){return(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}function d(t,e){return void 0===t?e:t}t.exports?t.exports=h:window.define("Tuna",(function(){return h})),h.prototype.Bitcrusher=function(t){t||(t=this.getDefaults()),this.bufferSize=t.bufferSize||this.defaults.bufferSize.value,this.input=e.createGain(),this.activateNode=e.createGain(),this.processor=e.createScriptProcessor(this.bufferSize,1,1),this.output=e.createGain(),this.activateNode.connect(this.processor),this.processor.connect(this.output);var s,i,a,n,o,r=0,h=0;this.processor.onaudioprocess=function(t){for(s=t.inputBuffer.getChannelData(0),i=t.outputBuffer.getChannelData(0),a=Math.pow(.5,this.bits),o=s.length,n=0;n<o;n++)(r+=this.normfreq)>=1&&(r-=1,h=a*Math.floor(s[n]/a+.5)),i[n]=h},this.bits=t.bits||this.defaults.bits.value,this.normfreq=d(t.normfreq,this.defaults.normfreq.value),this.bypass=t.bypass||this.defaults.bypass.value},h.prototype.Bitcrusher.prototype=Object.create(a,{name:{value:"Bitcrusher"},defaults:{writable:!0,value:{bits:{value:4,min:1,max:16,automatable:!1,type:r},bufferSize:{value:4096,min:256,max:16384,automatable:!1,type:r},bypass:{value:!1,automatable:!1,type:o},normfreq:{value:.1,min:1e-4,max:1,automatable:!1,type:n}}},bits:{enumerable:!0,get:function(){return this.processor.bits},set:function(t){this.processor.bits=t}},normfreq:{enumerable:!0,get:function(){return this.processor.normfreq},set:function(t){this.processor.normfreq=t}}}),h.prototype.Cabinet=function(t){t||(t=this.getDefaults()),this.input=e.createGain(),this.activateNode=e.createGain(),this.convolver=this.newConvolver(t.impulsePath||"../impulses/impulse_guitar.wav"),this.makeupNode=e.createGain(),this.output=e.createGain(),this.activateNode.connect(this.convolver.input),this.convolver.output.connect(this.makeupNode),this.makeupNode.connect(this.output),this.makeupNode.gain.value=d(t.makeupGain,this.defaults.makeupGain.value),this.bypass=t.bypass||this.defaults.bypass.value},h.prototype.Cabinet.prototype=Object.create(a,{name:{value:"Cabinet"},defaults:{writable:!0,value:{makeupGain:{value:1,min:0,max:20,automatable:!0,type:n},bypass:{value:!1,automatable:!1,type:o}}},makeupGain:{enumerable:!0,get:function(){return this.makeupNode.gain},set:function(t){this.makeupNode.gain.setTargetAtTime(t,e.currentTime,.01)}},newConvolver:{value:function(t){return new s.Convolver({impulse:t,dryLevel:0,wetLevel:1})}}}),h.prototype.Chorus=function(t){t||(t=this.getDefaults()),this.input=e.createGain(),this.attenuator=this.activateNode=e.createGain(),this.splitter=e.createChannelSplitter(2),this.delayL=e.createDelay(),this.delayR=e.createDelay(),this.feedbackGainNodeLR=e.createGain(),this.feedbackGainNodeRL=e.createGain(),this.merger=e.createChannelMerger(2),this.output=e.createGain(),this.delayL.delayTime=0,this.delayR.delayTime=0,this.lfoL=new s.LFO({target:this.delayL.delayTime,callback:i}),this.lfoR=new s.LFO({target:this.delayR.delayTime,callback:i}),this.input.connect(this.attenuator),this.attenuator.connect(this.output),this.attenuator.connect(this.splitter),this.splitter.connect(this.delayL,0),this.splitter.connect(this.delayR,1),this.delayL.connect(this.feedbackGainNodeLR),this.delayR.connect(this.feedbackGainNodeRL),this.feedbackGainNodeLR.connect(this.delayR),this.feedbackGainNodeRL.connect(this.delayL),this.delayL.connect(this.merger,0,0),this.delayR.connect(this.merger,0,1),this.merger.connect(this.output),this.feedback=d(t.feedback,this.defaults.feedback.value),this.rate=d(t.rate,this.defaults.rate.value),this.delay=d(t.delay,this.defaults.delay.value),this.depth=d(t.depth,this.defaults.depth.value),this.lfoR.phase=Math.PI/2,this.attenuator.gain.value=.6934,this.lfoL.activate(!0),this.lfoR.activate(!0),this.bypass=t.bypass||this.defaults.bypass.value},h.prototype.Chorus.prototype=Object.create(a,{name:{value:"Chorus"},defaults:{writable:!0,value:{feedback:{value:.4,min:0,max:.95,automatable:!1,type:n},delay:{value:.0045,min:0,max:1,automatable:!1,type:n},depth:{value:.7,min:0,max:1,automatable:!1,type:n},rate:{value:1.5,min:0,max:8,automatable:!1,type:n},bypass:{value:!1,automatable:!1,type:o}}},delay:{enumerable:!0,get:function(){return this._delay},set:function(t){this._delay=2*Math.pow(10,t)*2e-4,this.lfoL.offset=this._delay,this.lfoR.offset=this._delay,this._depth=this._depth}},depth:{enumerable:!0,get:function(){return this._depth},set:function(t){this._depth=t,this.lfoL.oscillation=this._depth*this._delay,this.lfoR.oscillation=this._depth*this._delay}},feedback:{enumerable:!0,get:function(){return this._feedback},set:function(t){this._feedback=t,this.feedbackGainNodeLR.gain.setTargetAtTime(this._feedback,e.currentTime,.01),this.feedbackGainNodeRL.gain.setTargetAtTime(this._feedback,e.currentTime,.01)}},rate:{enumerable:!0,get:function(){return this._rate},set:function(t){this._rate=t,this.lfoL.frequency=this._rate,this.lfoR.frequency=this._rate}}}),h.prototype.Compressor=function(t){t||(t=this.getDefaults()),this.input=e.createGain(),this.compNode=this.activateNode=e.createDynamicsCompressor(),this.makeupNode=e.createGain(),this.output=e.createGain(),this.compNode.connect(this.makeupNode),this.makeupNode.connect(this.output),this.automakeup=d(t.automakeup,this.defaults.automakeup.value),this.automakeup?this.makeupNode.gain.value=u(this.computeMakeup()):this.makeupNode.gain.value=u(d(t.makeupGain,this.defaults.makeupGain.value)),this.threshold=d(t.threshold,this.defaults.threshold.value),this.release=d(t.release,this.defaults.release.value),this.attack=d(t.attack,this.defaults.attack.value),this.ratio=t.ratio||this.defaults.ratio.value,this.knee=d(t.knee,this.defaults.knee.value),this.bypass=t.bypass||this.defaults.bypass.value},h.prototype.Compressor.prototype=Object.create(a,{name:{value:"Compressor"},defaults:{writable:!0,value:{threshold:{value:-20,min:-60,max:0,automatable:!0,type:n},release:{value:250,min:10,max:2e3,automatable:!0,type:n},makeupGain:{value:1,min:1,max:100,automatable:!0,type:n},attack:{value:1,min:0,max:1e3,automatable:!0,type:n},ratio:{value:4,min:1,max:50,automatable:!0,type:n},knee:{value:5,min:0,max:40,automatable:!0,type:n},automakeup:{value:!1,automatable:!1,type:o},bypass:{value:!1,automatable:!1,type:o}}},computeMakeup:{value:function(){var t=this.compNode;return-(t.threshold.value-t.threshold.value/t.ratio.value)/4}},automakeup:{enumerable:!0,get:function(){return this._automakeup},set:function(t){this._automakeup=t,this._automakeup&&(this.makeupGain=this.computeMakeup())}},threshold:{enumerable:!0,get:function(){return this.compNode.threshold},set:function(t){this.compNode.threshold.value=t,this._automakeup&&(this.makeupGain=this.computeMakeup())}},ratio:{enumerable:!0,get:function(){return this.compNode.ratio},set:function(t){this.compNode.ratio.value=t,this._automakeup&&(this.makeupGain=this.computeMakeup())}},knee:{enumerable:!0,get:function(){return this.compNode.knee},set:function(t){this.compNode.knee.value=t,this._automakeup&&(this.makeupGain=this.computeMakeup())}},attack:{enumerable:!0,get:function(){return this.compNode.attack},set:function(t){this.compNode.attack.value=t/1e3}},release:{enumerable:!0,get:function(){return this.compNode.release},set:function(t){this.compNode.release.value=t/1e3}},makeupGain:{enumerable:!0,get:function(){return this.makeupNode.gain},set:function(t){this.makeupNode.gain.setTargetAtTime(u(t),e.currentTime,.01)}}}),h.prototype.Convolver=function(t){t||(t=this.getDefaults()),this.input=e.createGain(),this.activateNode=e.createGain(),this.convolver=e.createConvolver(),this.dry=e.createGain(),this.filterLow=e.createBiquadFilter(),this.filterHigh=e.createBiquadFilter(),this.wet=e.createGain(),this.output=e.createGain(),this.activateNode.connect(this.filterLow),this.activateNode.connect(this.dry),this.filterLow.connect(this.filterHigh),this.filterHigh.connect(this.convolver),this.convolver.connect(this.wet),this.wet.connect(this.output),this.dry.connect(this.output),this.dry.gain.value=d(t.dryLevel,this.defaults.dryLevel.value),this.wet.gain.value=d(t.wetLevel,this.defaults.wetLevel.value),this.filterHigh.frequency.value=t.highCut||this.defaults.highCut.value,this.filterLow.frequency.value=t.lowCut||this.defaults.lowCut.value,this.output.gain.value=d(t.level,this.defaults.level.value),this.filterHigh.type="lowpass",this.filterLow.type="highpass",this.buffer=t.impulse||"../impulses/ir_rev_short.wav",this.bypass=t.bypass||this.defaults.bypass.value},h.prototype.Convolver.prototype=Object.create(a,{name:{value:"Convolver"},defaults:{writable:!0,value:{highCut:{value:22050,min:20,max:22050,automatable:!0,type:n},lowCut:{value:20,min:20,max:22050,automatable:!0,type:n},dryLevel:{value:1,min:0,max:1,automatable:!0,type:n},wetLevel:{value:1,min:0,max:1,automatable:!0,type:n},level:{value:1,min:0,max:1,automatable:!0,type:n},bypass:{value:!1,automatable:!1,type:o}}},lowCut:{get:function(){return this.filterLow.frequency},set:function(t){this.filterLow.frequency.setTargetAtTime(t,e.currentTime,.01)}},highCut:{get:function(){return this.filterHigh.frequency},set:function(t){this.filterHigh.frequency.setTargetAtTime(t,e.currentTime,.01)}},level:{get:function(){return this.output.gain},set:function(t){this.output.gain.setTargetAtTime(t,e.currentTime,.01)}},dryLevel:{get:function(){return this.dry.gain},set:function(t){this.dry.gain.setTargetAtTime(t,e.currentTime,.01)}},wetLevel:{get:function(){return this.wet.gain},set:function(t){this.wet.gain.setTargetAtTime(t,e.currentTime,.01)}},buffer:{enumerable:!1,get:function(){return this.convolver.buffer},set:function(t){var s=this.convolver,i=new XMLHttpRequest;t?(i.open("GET",t,!0),i.responseType="arraybuffer",i.onreadystatechange=function(){4===i.readyState&&(i.status<300&&i.status>199||302===i.status)&&e.decodeAudioData(i.response,(function(t){s.buffer=t}),(function(t){t&&console.log("Tuna.Convolver.setBuffer: Error decoding data"+t)}))},i.send(null)):console.log("Tuna.Convolver.setBuffer: Missing impulse path!")}}}),h.prototype.Delay=function(t){t||(t=this.getDefaults()),this.input=e.createGain(),this.activateNode=e.createGain(),this.dry=e.createGain(),this.wet=e.createGain(),this.filter=e.createBiquadFilter(),this.delay=e.createDelay(10),this.feedbackNode=e.createGain(),this.output=e.createGain(),this.activateNode.connect(this.delay),this.activateNode.connect(this.dry),this.delay.connect(this.filter),this.filter.connect(this.feedbackNode),this.feedbackNode.connect(this.delay),this.feedbackNode.connect(this.wet),this.wet.connect(this.output),this.dry.connect(this.output),this.delayTime=t.delayTime||this.defaults.delayTime.value,this.feedbackNode.gain.value=d(t.feedback,this.defaults.feedback.value),this.wet.gain.value=d(t.wetLevel,this.defaults.wetLevel.value),this.dry.gain.value=d(t.dryLevel,this.defaults.dryLevel.value),this.filter.frequency.value=t.cutoff||this.defaults.cutoff.value,this.filter.type="lowpass",this.bypass=t.bypass||this.defaults.bypass.value},h.prototype.Delay.prototype=Object.create(a,{name:{value:"Delay"},defaults:{writable:!0,value:{delayTime:{value:100,min:20,max:1e3,automatable:!1,type:n},feedback:{value:.45,min:0,max:.9,automatable:!0,type:n},cutoff:{value:2e4,min:20,max:2e4,automatable:!0,type:n},wetLevel:{value:.5,min:0,max:1,automatable:!0,type:n},dryLevel:{value:1,min:0,max:1,automatable:!0,type:n},bypass:{value:!1,automatable:!1,type:o}}},delayTime:{enumerable:!0,get:function(){return this.delay.delayTime},set:function(t){this.delay.delayTime.value=t/1e3}},wetLevel:{enumerable:!0,get:function(){return this.wet.gain},set:function(t){this.wet.gain.setTargetAtTime(t,e.currentTime,.01)}},dryLevel:{enumerable:!0,get:function(){return this.dry.gain},set:function(t){this.dry.gain.setTargetAtTime(t,e.currentTime,.01)}},feedback:{enumerable:!0,get:function(){return this.feedbackNode.gain},set:function(t){this.feedbackNode.gain.setTargetAtTime(t,e.currentTime,.01)}},cutoff:{enumerable:!0,get:function(){return this.filter.frequency},set:function(t){this.filter.frequency.setTargetAtTime(t,e.currentTime,.01)}}}),h.prototype.Filter=function(t){t||(t=this.getDefaults()),this.input=e.createGain(),this.activateNode=e.createGain(),this.filter=e.createBiquadFilter(),this.output=e.createGain(),this.activateNode.connect(this.filter),this.filter.connect(this.output),this.filter.frequency.value=t.frequency||this.defaults.frequency.value,this.Q=t.resonance||this.defaults.Q.value,this.filterType=d(t.filterType,this.defaults.filterType.value),this.filter.gain.value=d(t.gain,this.defaults.gain.value),this.bypass=t.bypass||this.defaults.bypass.value},h.prototype.Filter.prototype=Object.create(a,{name:{value:"Filter"},defaults:{writable:!0,value:{frequency:{value:800,min:20,max:22050,automatable:!0,type:n},Q:{value:1,min:.001,max:100,automatable:!0,type:n},gain:{value:0,min:-40,max:40,automatable:!0,type:n},bypass:{value:!1,automatable:!1,type:o},filterType:{value:"lowpass",automatable:!1,type:"string"}}},filterType:{enumerable:!0,get:function(){return this.filter.type},set:function(t){this.filter.type=t}},Q:{enumerable:!0,get:function(){return this.filter.Q},set:function(t){this.filter.Q.value=t}},gain:{enumerable:!0,get:function(){return this.filter.gain},set:function(t){this.filter.gain.setTargetAtTime(t,e.currentTime,.01)}},frequency:{enumerable:!0,get:function(){return this.filter.frequency},set:function(t){this.filter.frequency.setTargetAtTime(t,e.currentTime,.01)}}}),h.prototype.Gain=function(t){t||(t=this.getDefaults()),this.input=e.createGain(),this.activateNode=e.createGain(),this.gainNode=e.createGain(),this.output=e.createGain(),this.activateNode.connect(this.gainNode),this.gainNode.connect(this.output),this.gainNode.gain.value=d(t.gain,this.defaults.gain.value),this.bypass=t.bypass||this.defaults.bypass.value},h.prototype.Gain.prototype=Object.create(a,{name:{value:"Gain"},defaults:{writable:!0,value:{bypass:{value:!1,automatable:!1,type:o},gain:{value:1,automatable:!0,type:n}}},gain:{enumerable:!0,get:function(){return this.gainNode.gain},set:function(t){this.gainNode.gain.setTargetAtTime(t,e.currentTime,.01)}}}),h.prototype.MoogFilter=function(t){var s,i,a,n,o,r,h,u,l,c,p,y,f,m,g;t||(t=this.getDefaults()),this.bufferSize=t.bufferSize||this.defaults.bufferSize.value,this.input=e.createGain(),this.activateNode=e.createGain(),this.processor=e.createScriptProcessor(this.bufferSize,1,1),this.output=e.createGain(),this.activateNode.connect(this.processor),this.processor.connect(this.output),s=i=a=n=o=r=h=u=0,this.processor.onaudioprocess=function(t){for(l=t.inputBuffer.getChannelData(0),c=t.outputBuffer.getChannelData(0),p=1.16*this.cutoff,g=p*p*.35013*(p*p),y=this.resonance*(1-.15*p*p),m=l.length,f=0;f<m;f++)l[f]-=u*y,l[f]*=g,o=l[f]+.3*s+(1-p)*o,s=l[f],r=o+.3*i+(1-p)*r,i=o,h=r+.3*a+(1-p)*h,a=r,u=h+.3*n+(1-p)*u,n=h,c[f]=u},this.cutoff=d(t.cutoff,this.defaults.cutoff.value),this.resonance=d(t.resonance,this.defaults.resonance.value),this.bypass=t.bypass||this.defaults.bypass.value},h.prototype.MoogFilter.prototype=Object.create(a,{name:{value:"MoogFilter"},defaults:{writable:!0,value:{bufferSize:{value:4096,min:256,max:16384,automatable:!1,type:r},bypass:{value:!1,automatable:!1,type:o},cutoff:{value:.065,min:1e-4,max:1,automatable:!1,type:n},resonance:{value:3.5,min:0,max:4,automatable:!1,type:n}}},cutoff:{enumerable:!0,get:function(){return this.processor.cutoff},set:function(t){this.processor.cutoff=t}},resonance:{enumerable:!0,get:function(){return this.processor.resonance},set:function(t){this.processor.resonance=t}}}),h.prototype.Overdrive=function(t){t||(t=this.getDefaults()),this.input=e.createGain(),this.activateNode=e.createGain(),this.inputDrive=e.createGain(),this.waveshaper=e.createWaveShaper(),this.outputDrive=e.createGain(),this.output=e.createGain(),this.activateNode.connect(this.inputDrive),this.inputDrive.connect(this.waveshaper),this.waveshaper.connect(this.outputDrive),this.outputDrive.connect(this.output),this.ws_table=new Float32Array(this.k_nSamples),this.drive=d(t.drive,this.defaults.drive.value),this.outputGain=d(t.outputGain,this.defaults.outputGain.value),this.curveAmount=d(t.curveAmount,this.defaults.curveAmount.value),this.algorithmIndex=d(t.algorithmIndex,this.defaults.algorithmIndex.value),this.bypass=t.bypass||this.defaults.bypass.value},h.prototype.Overdrive.prototype=Object.create(a,{name:{value:"Overdrive"},defaults:{writable:!0,value:{drive:{value:.197,min:0,max:1,automatable:!0,type:n,scaled:!0},outputGain:{value:-9.154,min:-46,max:0,automatable:!0,type:n,scaled:!0},curveAmount:{value:.979,min:0,max:1,automatable:!1,type:n},algorithmIndex:{value:0,min:0,max:5,automatable:!1,type:r},bypass:{value:!1,automatable:!1,type:o}}},k_nSamples:{value:8192},drive:{get:function(){return this.inputDrive.gain},set:function(t){this.inputDrive.gain.value=t}},curveAmount:{get:function(){return this._curveAmount},set:function(t){this._curveAmount=t,void 0===this._algorithmIndex&&(this._algorithmIndex=0),this.waveshaperAlgorithms[this._algorithmIndex](this._curveAmount,this.k_nSamples,this.ws_table),this.waveshaper.curve=this.ws_table}},outputGain:{get:function(){return this.outputDrive.gain},set:function(t){this._outputGain=u(t),this.outputDrive.gain.setValueAtTime(this._outputGain,e.currentTime,.01)}},algorithmIndex:{get:function(){return this._algorithmIndex},set:function(t){this._algorithmIndex=t,this.curveAmount=this._curveAmount}},waveshaperAlgorithms:{value:[function(t,e,s){var i,a,n=2*(t=Math.min(t,.9999))/(1-t);for(i=0;i<e;i++)a=2*i/e-1,s[i]=(1+n)*a/(1+n*Math.abs(a))},function(t,e,s){var i,a,n;for(i=0;i<e;i++)a=2*i/e-1,n=(.5*Math.pow(a+1.4,2)-1)*(n>=0?5.8:1.2),s[i]=p(n)},function(t,e,s){var i,a,n,o=1-t;for(i=0;i<e;i++)n=(a=2*i/e-1)<0?-Math.pow(Math.abs(a),o+.04):Math.pow(a,o),s[i]=p(2*n)},function(t,e,s){var i,a,n,o,r=1-t>.99?.99:1-t;for(i=0;i<e;i++)a=2*i/e-1,(o=Math.abs(a))<r?n=o:o>r?n=r+(o-r)/(1+Math.pow((o-r)/(1-r),2)):o>1&&(n=o),s[i]=c(a)*n*(1/((r+1)/2))},function(t,e,s){var i,a;for(i=0;i<e;i++)a=2*i/e-1,s[i]=a<-.08905?-3/4*(1-Math.pow(1-(Math.abs(a)-.032857),12)+1/3*(Math.abs(a)-.032847))+.01:a>=-.08905&&a<.320018?a*a*-6.153+3.9375*a:.630035},function(t,e,s){var i,a,n=2+Math.round(14*t),o=Math.round(Math.pow(2,n-1));for(i=0;i<e;i++)a=2*i/e-1,s[i]=Math.round(a*o)/o}]}}),h.prototype.Panner=function(t){t||(t=this.getDefaults()),this.input=e.createGain(),this.activateNode=e.createGain(),this.panner=e.createStereoPanner(),this.output=e.createGain(),this.activateNode.connect(this.panner),this.panner.connect(this.output),this.pan=d(t.pan,this.defaults.pan.value),this.bypass=t.bypass||this.defaults.bypass.value},h.prototype.Panner.prototype=Object.create(a,{name:{value:"Panner"},defaults:{writable:!0,value:{bypass:{value:!1,automatable:!1,type:o},pan:{value:0,min:-1,max:1,automatable:!0,type:n}}},pan:{enumerable:!0,get:function(){return this.panner.pan},set:function(t){this.panner.pan.value=t}}}),h.prototype.Phaser=function(t){t||(t=this.getDefaults()),this.input=e.createGain(),this.splitter=this.activateNode=e.createChannelSplitter(2),this.filtersL=[],this.filtersR=[],this.feedbackGainNodeL=e.createGain(),this.feedbackGainNodeR=e.createGain(),this.merger=e.createChannelMerger(2),this.filteredSignal=e.createGain(),this.output=e.createGain(),this.lfoL=new s.LFO({target:this.filtersL,callback:this.callback}),this.lfoR=new s.LFO({target:this.filtersR,callback:this.callback});for(var i=this.stage;i--;)this.filtersL[i]=e.createBiquadFilter(),this.filtersR[i]=e.createBiquadFilter(),this.filtersL[i].type="allpass",this.filtersR[i].type="allpass";this.input.connect(this.splitter),this.input.connect(this.output),this.splitter.connect(this.filtersL[0],0,0),this.splitter.connect(this.filtersR[0],1,0),this.connectInOrder(this.filtersL),this.connectInOrder(this.filtersR),this.filtersL[this.stage-1].connect(this.feedbackGainNodeL),this.filtersL[this.stage-1].connect(this.merger,0,0),this.filtersR[this.stage-1].connect(this.feedbackGainNodeR),this.filtersR[this.stage-1].connect(this.merger,0,1),this.feedbackGainNodeL.connect(this.filtersL[0]),this.feedbackGainNodeR.connect(this.filtersR[0]),this.merger.connect(this.output),this.rate=d(t.rate,this.defaults.rate.value),this.baseModulationFrequency=t.baseModulationFrequency||this.defaults.baseModulationFrequency.value,this.depth=d(t.depth,this.defaults.depth.value),this.feedback=d(t.feedback,this.defaults.feedback.value),this.stereoPhase=d(t.stereoPhase,this.defaults.stereoPhase.value),this.lfoL.activate(!0),this.lfoR.activate(!0),this.bypass=t.bypass||this.defaults.bypass.value},h.prototype.Phaser.prototype=Object.create(a,{name:{value:"Phaser"},stage:{value:4},defaults:{writable:!0,value:{rate:{value:.1,min:0,max:8,automatable:!1,type:n},depth:{value:.6,min:0,max:1,automatable:!1,type:n},feedback:{value:.7,min:0,max:1,automatable:!1,type:n},stereoPhase:{value:40,min:0,max:180,automatable:!1,type:n},baseModulationFrequency:{value:700,min:500,max:1500,automatable:!1,type:n},bypass:{value:!1,automatable:!1,type:o}}},callback:{value:function(t,e){for(var s=0;s<4;s++)t[s].frequency.value=e}},depth:{get:function(){return this._depth},set:function(t){this._depth=t,this.lfoL.oscillation=this._baseModulationFrequency*this._depth,this.lfoR.oscillation=this._baseModulationFrequency*this._depth}},rate:{get:function(){return this._rate},set:function(t){this._rate=t,this.lfoL.frequency=this._rate,this.lfoR.frequency=this._rate}},baseModulationFrequency:{enumerable:!0,get:function(){return this._baseModulationFrequency},set:function(t){this._baseModulationFrequency=t,this.lfoL.offset=this._baseModulationFrequency,this.lfoR.offset=this._baseModulationFrequency,this.depth=this._depth}},feedback:{get:function(){return this._feedback},set:function(t){this._feedback=t,this.feedbackGainNodeL.gain.setTargetAtTime(this._feedback,e.currentTime,.01),this.feedbackGainNodeR.gain.setTargetAtTime(this._feedback,e.currentTime,.01)}},stereoPhase:{get:function(){return this._stereoPhase},set:function(t){this._stereoPhase=t;var e=this.lfoL._phase+this._stereoPhase*Math.PI/180;e=l(e,2*Math.PI),this.lfoR._phase=e}}}),h.prototype.PingPongDelay=function(t){t||(t=this.getDefaults()),this.input=e.createGain(),this.wet=e.createGain(),this.stereoToMonoMix=e.createGain(),this.feedbackLevel=e.createGain(),this.output=e.createGain(),this.delayLeft=e.createDelay(10),this.delayRight=e.createDelay(10),this.activateNode=e.createGain(),this.splitter=e.createChannelSplitter(2),this.merger=e.createChannelMerger(2),this.activateNode.connect(this.splitter),this.splitter.connect(this.stereoToMonoMix,0,0),this.splitter.connect(this.stereoToMonoMix,1,0),this.stereoToMonoMix.gain.value=.5,this.stereoToMonoMix.connect(this.wet),this.wet.connect(this.delayLeft),this.feedbackLevel.connect(this.wet),this.delayLeft.connect(this.delayRight),this.delayRight.connect(this.feedbackLevel),this.delayLeft.connect(this.merger,0,0),this.delayRight.connect(this.merger,0,1),this.merger.connect(this.output),this.activateNode.connect(this.output),this.delayTimeLeft=void 0!==t.delayTimeLeft?t.delayTimeLeft:this.defaults.delayTimeLeft.value,this.delayTimeRight=void 0!==t.delayTimeRight?t.delayTimeRight:this.defaults.delayTimeRight.value,this.feedbackLevel.gain.value=void 0!==t.feedback?t.feedback:this.defaults.feedback.value,this.wet.gain.value=void 0!==t.wetLevel?t.wetLevel:this.defaults.wetLevel.value,this.bypass=t.bypass||this.defaults.bypass.value},h.prototype.PingPongDelay.prototype=Object.create(a,{name:{value:"PingPongDelay"},delayTimeLeft:{enumerable:!0,get:function(){return this._delayTimeLeft},set:function(t){this._delayTimeLeft=t,this.delayLeft.delayTime.value=t/1e3}},delayTimeRight:{enumerable:!0,get:function(){return this._delayTimeRight},set:function(t){this._delayTimeRight=t,this.delayRight.delayTime.value=t/1e3}},wetLevel:{enumerable:!0,get:function(){return this.wet.gain},set:function(t){this.wet.gain.setTargetAtTime(t,e.currentTime,.01)}},feedback:{enumerable:!0,get:function(){return this.feedbackLevel.gain},set:function(t){this.feedbackLevel.gain.setTargetAtTime(t,e.currentTime,.01)}},defaults:{writable:!0,value:{delayTimeLeft:{value:200,min:1,max:1e4,automatable:!1,type:r},delayTimeRight:{value:400,min:1,max:1e4,automatable:!1,type:r},feedback:{value:.3,min:0,max:1,automatable:!0,type:n},wetLevel:{value:.5,min:0,max:1,automatable:!0,type:n},bypass:{value:!1,automatable:!1,type:o}}}}),h.prototype.Tremolo=function(t){t||(t=this.getDefaults()),this.input=e.createGain(),this.splitter=this.activateNode=e.createChannelSplitter(2),this.amplitudeL=e.createGain(),this.amplitudeR=e.createGain(),this.merger=e.createChannelMerger(2),this.output=e.createGain(),this.lfoL=new s.LFO({target:this.amplitudeL.gain,callback:i}),this.lfoR=new s.LFO({target:this.amplitudeR.gain,callback:i}),this.input.connect(this.splitter),this.splitter.connect(this.amplitudeL,0),this.splitter.connect(this.amplitudeR,1),this.amplitudeL.connect(this.merger,0,0),this.amplitudeR.connect(this.merger,0,1),this.merger.connect(this.output),this.rate=t.rate||this.defaults.rate.value,this.intensity=d(t.intensity,this.defaults.intensity.value),this.stereoPhase=d(t.stereoPhase,this.defaults.stereoPhase.value),this.lfoL.offset=1-this.intensity/2,this.lfoR.offset=1-this.intensity/2,this.lfoL.phase=this.stereoPhase*Math.PI/180,this.lfoL.activate(!0),this.lfoR.activate(!0),this.bypass=t.bypass||this.defaults.bypass.value},h.prototype.Tremolo.prototype=Object.create(a,{name:{value:"Tremolo"},defaults:{writable:!0,value:{intensity:{value:.3,min:0,max:1,automatable:!1,type:n},stereoPhase:{value:0,min:0,max:180,automatable:!1,type:n},rate:{value:5,min:.1,max:11,automatable:!1,type:n},bypass:{value:!1,automatable:!1,type:o}}},intensity:{enumerable:!0,get:function(){return this._intensity},set:function(t){this._intensity=t,this.lfoL.offset=1-this._intensity/2,this.lfoR.offset=1-this._intensity/2,this.lfoL.oscillation=this._intensity,this.lfoR.oscillation=this._intensity}},rate:{enumerable:!0,get:function(){return this._rate},set:function(t){this._rate=t,this.lfoL.frequency=this._rate,this.lfoR.frequency=this._rate}},stereoPhase:{enumerable:!0,get:function(){return this._stereoPhase},set:function(t){this._stereoPhase=t;var e=this.lfoL._phase+this._stereoPhase*Math.PI/180;e=l(e,2*Math.PI),this.lfoR.phase=e}}}),h.prototype.WahWah=function(t){t||(t=this.getDefaults()),this.input=e.createGain(),this.activateNode=e.createGain(),this.envelopeFollower=new s.EnvelopeFollower({target:this,callback:function(t,e){t.sweep=e}}),this.filterBp=e.createBiquadFilter(),this.filterPeaking=e.createBiquadFilter(),this.output=e.createGain(),this.activateNode.connect(this.filterBp),this.filterBp.connect(this.filterPeaking),this.filterPeaking.connect(this.output),this.init(),this.automode=d(t.automode,this.defaults.automode.value),this.resonance=t.resonance||this.defaults.resonance.value,this.sensitivity=d(t.sensitivity,this.defaults.sensitivity.value),this.baseFrequency=d(t.baseFrequency,this.defaults.baseFrequency.value),this.excursionOctaves=t.excursionOctaves||this.defaults.excursionOctaves.value,this.sweep=d(t.sweep,this.defaults.sweep.value),this.activateNode.gain.value=2,this.envelopeFollower.activate(!0),this.bypass=t.bypass||this.defaults.bypass.value},h.prototype.WahWah.prototype=Object.create(a,{name:{value:"WahWah"},defaults:{writable:!0,value:{automode:{value:!0,automatable:!1,type:o},baseFrequency:{value:.153,min:0,max:1,automatable:!1,type:n},excursionOctaves:{value:3.3,min:1,max:6,automatable:!1,type:n},sweep:{value:.35,min:0,max:1,automatable:!1,type:n},resonance:{value:19,min:1,max:100,automatable:!1,type:n},sensitivity:{value:-.5,min:-1,max:1,automatable:!1,type:n},bypass:{value:!1,automatable:!1,type:o}}},automode:{get:function(){return this._automode},set:function(t){this._automode=t,t?(this.activateNode.connect(this.envelopeFollower.input),this.envelopeFollower.activate(!0)):(this.envelopeFollower.activate(!1),this.activateNode.disconnect(),this.activateNode.connect(this.filterBp))}},filterFreqTimeout:{writable:!0,value:0},setFilterFreq:{value:function(){try{this.filterBp.frequency.value=Math.min(22050,this._baseFrequency+this._excursionFrequency*this._sweep),this.filterPeaking.frequency.value=Math.min(22050,this._baseFrequency+this._excursionFrequency*this._sweep)}catch(t){clearTimeout(this.filterFreqTimeout),this.filterFreqTimeout=setTimeout(function(){this.setFilterFreq()}.bind(this),0)}}},sweep:{enumerable:!0,get:function(){return this._sweep},set:function(t){this._sweep=Math.pow(t>1?1:t<0?0:t,this._sensitivity),this.setFilterFreq()}},baseFrequency:{enumerable:!0,get:function(){return this._baseFrequency},set:function(t){this._baseFrequency=50*Math.pow(10,2*t),this._excursionFrequency=Math.min(e.sampleRate/2,this.baseFrequency*Math.pow(2,this._excursionOctaves)),this.setFilterFreq()}},excursionOctaves:{enumerable:!0,get:function(){return this._excursionOctaves},set:function(t){this._excursionOctaves=t,this._excursionFrequency=Math.min(e.sampleRate/2,this.baseFrequency*Math.pow(2,this._excursionOctaves)),this.setFilterFreq()}},sensitivity:{enumerable:!0,get:function(){return this._sensitivity},set:function(t){this._sensitivity=Math.pow(10,t)}},resonance:{enumerable:!0,get:function(){return this._resonance},set:function(t){this._resonance=t,this.filterPeaking.Q.value=this._resonance}},init:{value:function(){this.output.gain.value=1,this.filterPeaking.type="peaking",this.filterBp.type="bandpass",this.filterPeaking.frequency.value=100,this.filterPeaking.gain.value=20,this.filterPeaking.Q.value=5,this.filterBp.frequency.value=100,this.filterBp.Q.value=1}}}),h.prototype.EnvelopeFollower=function(t){t||(t=this.getDefaults()),this.input=e.createGain(),this.jsNode=this.output=e.createScriptProcessor(this.buffersize,1,1),this.input.connect(this.output),this.attackTime=d(t.attackTime,this.defaults.attackTime.value),this.releaseTime=d(t.releaseTime,this.defaults.releaseTime.value),this._envelope=0,this.target=t.target||{},this.callback=t.callback||function(){},this.bypass=t.bypass||this.defaults.bypass.value},h.prototype.EnvelopeFollower.prototype=Object.create(a,{name:{value:"EnvelopeFollower"},defaults:{value:{attackTime:{value:.003,min:0,max:.5,automatable:!1,type:n},releaseTime:{value:.5,min:0,max:.5,automatable:!1,type:n},bypass:{value:!1,automatable:!1,type:o}}},buffersize:{value:256},envelope:{value:0},sampleRate:{value:44100},attackTime:{enumerable:!0,get:function(){return this._attackTime},set:function(t){this._attackTime=t,this._attackC=Math.exp(-1/this._attackTime*this.sampleRate/this.buffersize)}},releaseTime:{enumerable:!0,get:function(){return this._releaseTime},set:function(t){this._releaseTime=t,this._releaseC=Math.exp(-1/this._releaseTime*this.sampleRate/this.buffersize)}},callback:{get:function(){return this._callback},set:function(t){"function"==typeof t?this._callback=t:console.error("tuna.js: "+this.name+": Callback must be a function!")}},target:{get:function(){return this._target},set:function(t){this._target=t}},activate:{value:function(t){this.activated=t,t?(this.jsNode.connect(e.destination),this.jsNode.onaudioprocess=this.returnCompute(this)):(this.jsNode.disconnect(),this.jsNode.onaudioprocess=null),this.activateCallback&&this.activateCallback(t)}},returnCompute:{value:function(t){return function(e){t.compute(e)}}},compute:{value:function(t){var e,s,i,a,n=t.inputBuffer.getChannelData(0).length,o=t.inputBuffer.numberOfChannels;for(s=i=a=0,s=0;s<o;++s)for(a=0;a<n;++a)i+=(e=t.inputBuffer.getChannelData(s)[a])*e;i=Math.sqrt(i/o),this._envelope<i?(this._envelope*=this._attackC,this._envelope+=(1-this._attackC)*i):(this._envelope*=this._releaseC,this._envelope+=(1-this._releaseC)*i),this._callback(this._target,this._envelope)}}}),h.prototype.LFO=function(t){t||(t=this.getDefaults()),this.input=e.createGain(),this.output=new AudioWorkletNode(e,"lfo",{processorOptions:{sampleRate:e.sampleRate},channelCount:1,channelCountMode:"explicit",outputChannelCount:[1]}),this.output.connect(t.target),this.activateNode=e.destination,this.frequency=d(t.frequency,this.defaults.frequency.value),this.offset=d(t.offset,this.defaults.offset.value),this.oscillation=d(t.oscillation,this.defaults.oscillation.value),this.phase=d(t.phase,this.defaults.phase.value),this.bypass=t.bypass||this.defaults.bypass.value,this.output.port.postMessage({type:"set-all",value:{oscillation:this.oscillation,offset:this.offset,frequency:this.frequency,phase:this.phase}})},h.prototype.LFO.prototype=Object.create(a,{name:{value:"LFO"},bufferSize:{value:128},sampleRate:{value:44100},defaults:{value:{frequency:{value:1,min:0,max:20,automatable:!1,type:n},offset:{value:.85,min:0,max:22049,automatable:!1,type:n},oscillation:{value:.3,min:-22050,max:22050,automatable:!1,type:n},phase:{value:0,min:0,max:2*Math.PI,automatable:!1,type:n},bypass:{value:!1,automatable:!1,type:o}}},frequency:{get:function(){return this._frequency},set:function(t){this._frequency=t,this._phaseInc=2*Math.PI*this._frequency*this.bufferSize/this.sampleRate,this.output.port.postMessage({type:"set-frequency",value:this.frequency})}},offset:{get:function(){return this._offset},set:function(t){this._offset=t,this.output.port.postMessage({type:"set-offset",value:this.offset})}},oscillation:{get:function(){return this._oscillation},set:function(t){this._oscillation=t,this.output.port.postMessage({type:"set-oscillation",value:this.oscillation})}},phase:{get:function(){return this._phase},set:function(t){this._phase=t,this.output.port.postMessage({type:"set-phase",value:this.phase})}},activate:{value:function(t){t&&this.activateCallback&&this.activateCallback(t)}}}),h.toString=h.prototype.toString=function(){return"Please visit https://github.com/Theodeus/tuna/wiki for instructions on how to use Tuna.js"}}},t=>{var e;return e=7577,t(t.s=e)}])}));
//# sourceMappingURL=standard-nodes.js.map
